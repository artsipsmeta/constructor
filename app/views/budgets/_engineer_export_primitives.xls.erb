<?xml version="1.0"?>
<Workbook xmlns="urn:schemas-microsoft-com:office:spreadsheet"
  xmlns:o="urn:schemas-microsoft-com:office:office"
  xmlns:x="urn:schemas-microsoft-com:office:excel"
  xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet"
  xmlns:html="http://www.w3.org/TR/REC-html40">
  <Styles>
    <Style ss:ID="ce1">
      <Alignment ss:Horizontal="Right" ss:Vertical="Center" ss:Indent="0"/>
    </Style>
    <Style ss:ID="ce2">
      <Alignment ss:Horizontal="Left" ss:Vertical="Center" ss:WrapText="1" ss:Indent="0"/>
    </Style>
    <Style ss:ID="ce3">
      <Alignment ss:Horizontal="Center" ss:Vertical="Center" ss:Indent="0"/>
    </Style>
  </Styles>
  <ss:Worksheet ss:Name="Перечень материалов на объект">
    <Table>
      <Column/>
      <Row>
        <Cell><Data ss:Type="String">Объект:</Data></Cell>
      </Row>
      <Row></Row>
      <Row>
        <Cell><Data ss:Type="String">Наименование</Data></Cell>
        <Cell><Data ss:Type="String">ед. изм.</Data></Cell>
        <% products.each do |product| %>
          <Cell><Data ss:Type="String"><%= product %></Data></Cell>
        <% end %>
        <Cell><Data ss:Type="String">Общее количество</Data></Cell>
      </Row>
      <% result.each do |category, primitives| %>
        <Row>
          <Cell><Data ss:Type="String"><%= category %></Data></Cell>
        </Row>
        <% number += 1 %>
        <% primitives.each do |primitive, value|%>
          <%= number += 1 %>
          <Row>
            <Cell><Data ss:Type="String"><%= primitive %></Data></Cell>
            <Cell><Data ss:Type="String"><%= value[:unit] %></Data></Cell>
            <% products.each do |product| %>
              <Cell><Data ss:Type="Number"><%= value[product].present? ? value[product] : '' %></Data></Cell>
            <% end %>
            <% last_column = "#{column}#{number}"%>
            <Cell ss:Formula="=SUM([.C<%= number %>]:[.<%= last_column %>])"></Cell>
          </Row>
        <% end %>
        <Row></Row>
        <Row>
          <Cell><Data ss:Type="String">Общестроительные элементы:</Data></Cell>
        </Row>
        <Row>
          <Cell><Data ss:Type="String">Перчатки:</Data></Cell>
          <Cell><Data ss:Type="String">шт</Data></Cell>
        </Row>
        <Row>
          <Cell><Data ss:Type="String">Пакеты для мусора:</Data></Cell>
          <Cell><Data ss:Type="String">шт</Data></Cell>
        </Row>
        <Row>
          <Cell><Data ss:Type="String">Леса строительные:</Data></Cell>
          <Cell><Data ss:Type="String">комплект</Data></Cell>
        </Row>
      <% end %>
    </Table>
    <x:WorksheetOptions/>
  </ss:Worksheet>
</Workbook>
