DEPRECATION WARNING: to_cleanup is deprecated and will be removed from Rails 5.1 (use ActiveSupport::Reloader.to_complete instead) (called from <top (required)> at /home/g1nc/Development/ruby/constructor/config/environment.rb:5)
Started GET "/" for 127.0.0.1 at 2017-04-26 22:36:21 +0300
  [1m[36mActiveRecord::SchemaMigration Load (2.7ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
Processing by HomeController#index as HTML
Completed 401 Unauthorized in 19ms (ActiveRecord: 0.0ms)


Started GET "/signin" for 127.0.0.1 at 2017-04-26 22:36:21 +0300
Processing by Devise::SessionsController#new as HTML
  Rendering devise/sessions/new.html.haml within layouts/application
  Rendered devise/sessions/new.html.haml within layouts/application (904.2ms)
  Rendered layouts/_header.html.haml (8.9ms)
Completed 200 OK in 2052ms (Views: 2020.9ms | ActiveRecord: 14.3ms)


Started POST "/signin" for 127.0.0.1 at 2017-04-26 22:36:32 +0300
Processing by Devise::SessionsController#create as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"0StYxYQSONcVGoq/O24MBDD5IPCa7Kk9pXCjd+/NIsHBtzwRUYdAVqaZ+gemq/NE+a2I1mK58w9sS8JhqcKe1Q==", "user"=>{"email"=>"admin@test.test", "password"=>"[FILTERED]"}, "commit"=>"Войти"}
  [1m[36mUser Load (3.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."email" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["email", "admin@test.test"], ["LIMIT", 1]]
Redirected to http://localhost:3000/
Completed 302 Found in 161ms (ActiveRecord: 3.6ms)


Started GET "/" for 127.0.0.1 at 2017-04-26 22:36:33 +0300
Processing by HomeController#index as HTML
  [1m[36mUser Load (2.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering home/index.html.haml within layouts/application
  Rendered home/index.html.haml within layouts/application (1.2ms)
  Rendered layouts/_header.html.haml (77.7ms)
Completed 200 OK in 653ms (Views: 647.1ms | ActiveRecord: 2.5ms)


Started GET "/composites" for 127.0.0.1 at 2017-04-26 22:36:37 +0300
Processing by CompositesController#index as HTML
  [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering composites/index.html.haml within layouts/application
  [1m[36mCategory Load (1.8ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."product" = $1[0m  [["product", false]]
  [1m[36mComposite Load (3.5ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Composite') AND "constructor_objects"."deleted_at" IS NULL[0m
  [1m[36mCategory Load (0.6ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" IN (1, 2)[0m
  [1m[36mUnit Load (2.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (1, 3)[0m
  Rendered composites/_listing.html.haml (3.4ms)
  Rendered composites/_listing.html.haml (0.8ms)
  Rendered composites/index.html.haml within layouts/application (93.7ms)
  Rendered layouts/_header.html.haml (9.4ms)
Completed 200 OK in 645ms (Views: 609.6ms | ActiveRecord: 28.3ms)


Started GET "/primitives" for 127.0.0.1 at 2017-04-26 22:36:43 +0300
Processing by PrimitivesController#index as HTML
  [1m[36mUser Load (1.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering primitives/index.html.haml within layouts/application
  [1m[36mCategory Load (4.5ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."product" = $1[0m  [["product", false]]
  [1m[35m (2.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL[0m
  [1m[36mCategory Load (1.9ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 1[0m
  [1m[36mPrimitive Load (1.1ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 1[0m
  [1m[36mCategory Load (0.8ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" = 1[0m
  [1m[36mUnit Load (0.9ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  Rendered primitives/_listing.html.haml (7.9ms)
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 2[0m
  [1m[36mPrimitive Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 2[0m
  [1m[36mCategory Load (0.6ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" = 2[0m
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 2[0m
  Rendered primitives/_listing.html.haml (3.7ms)
  [1m[35m (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 3[0m
  [1m[36mPrimitive Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 3[0m
  [1m[36mCategory Load (0.6ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" = 3[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  Rendered primitives/_listing.html.haml (3.6ms)
  [1m[35m (1.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 4[0m
  [1m[36mPrimitive Load (1.2ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 4[0m
  [1m[36mCategory Load (0.9ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" = 4[0m
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 5)[0m
  Rendered primitives/_listing.html.haml (3.6ms)
  Rendered primitives/_listing.html.haml (3.5ms)
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 5[0m
  [1m[36mPrimitive Load (0.8ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 5[0m
  [1m[36mCategory Load (3.4ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" = 5[0m
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (1, 5)[0m
  Rendered primitives/_listing.html.haml (3.4ms)
  Rendered primitives/_listing.html.haml (4.0ms)
  Rendered primitives/_listing.html.haml (3.9ms)
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 6[0m
  [1m[36mPrimitive Load (0.9ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 6[0m
  [1m[36mCategory Load (0.7ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" = 6[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 2[0m
  Rendered primitives/_listing.html.haml (3.4ms)
  Rendered primitives/_listing.html.haml (3.3ms)
  [1m[35m (1.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 7[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 8[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 9[0m
  [1m[35m (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 10[0m
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 11[0m
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 12[0m
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 13[0m
  [1m[35m (1.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 14[0m
  [1m[35m (1.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 15[0m
  Rendered primitives/index.html.haml within layouts/application (154.4ms)
  Rendered layouts/_header.html.haml (10.7ms)
Completed 200 OK in 699ms (Views: 647.3ms | ActiveRecord: 42.8ms)


Started GET "/clients" for 127.0.0.1 at 2017-04-26 22:36:46 +0300
Processing by ClientsController#index as HTML
  [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering clients/index.html.haml within layouts/application
  [1m[36mUserClient Load (3.2ms)[0m  [1m[34mSELECT "user_clients".* FROM "user_clients" INNER JOIN "clients" ON "clients"."id" = "user_clients"."client_id" AND "clients"."deleted_at" IS NULL WHERE "clients"."archived" = $1 AND (user_id = 1 and owner = true)[0m  [["archived", false]]
  [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" IN (1, 2, 3)[0m
  [1m[36mEstimate Load (2.4ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" IN (1, 2, 3)[0m
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 1]]
  Rendered clients/_listing.html.haml (13.3ms)
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 2]]
  Rendered clients/_listing.html.haml (4.5ms)
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 3]]
  Rendered clients/_listing.html.haml (4.3ms)
  Rendered clients/_table.html.haml (29.6ms)
  [1m[36mUserClient Load (1.1ms)[0m  [1m[34mSELECT "user_clients".* FROM "user_clients" INNER JOIN "clients" ON "clients"."id" = "user_clients"."client_id" AND "clients"."deleted_at" IS NULL WHERE "clients"."archived" = $1 AND (user_id = 1 and owner = false)[0m  [["archived", false]]
  Rendered clients/index.html.haml within layouts/application (142.6ms)
  Rendered layouts/_header.html.haml (11.1ms)
Completed 200 OK in 699ms (Views: 651.6ms | ActiveRecord: 28.0ms)


Started GET "/estimates?client_id=1" for 127.0.0.1 at 2017-04-26 22:36:56 +0300
Processing by EstimatesController#index as HTML
  Parameters: {"client_id"=>"1"}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering estimates/index.html.haml within layouts/application
  [1m[36mEstimate Load (1.1ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 1]]
  Rendered estimates/_listing.html.haml (3.7ms)
  Rendered estimates/_listing.html.haml (1.0ms)
  Rendered estimates/index.html.haml within layouts/application (16.6ms)
  Rendered layouts/_header.html.haml (9.9ms)
Completed 200 OK in 553ms (Views: 546.7ms | ActiveRecord: 1.8ms)


Started GET "/estimates/new?client_id=1" for 127.0.0.1 at 2017-04-26 22:37:08 +0300
Processing by EstimatesController#new as HTML
  Parameters: {"client_id"=>"1"}
  [1m[36mProduct Load (5.9ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (1.8ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (2.1ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (1.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = 1[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.7ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (1.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (4.2ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.9ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (1.8ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  [1m[36mProductTemplateSet Load (0.6ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mClient Load (2.1ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering estimates/new.html.haml within layouts/application
  [1m[36mClient Load (1.2ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (13.1ms)
  Rendered estimates/_technical_file_fields.html.haml (6.1ms)
  Rendered estimates/_discount.html.haml (9.0ms)
  Rendered estimates/_stages.html.haml (21.0ms)
  Rendered estimates/_form.html.haml (150.7ms)
  Rendered estimates/new.html.haml within layouts/application (155.1ms)
  Rendered layouts/_header.html.haml (12.0ms)
Completed 200 OK in 928ms (Views: 698.9ms | ActiveRecord: 74.5ms)


Started GET "/estimates/2/edit" for 127.0.0.1 at 2017-04-26 22:55:59 +0300
Processing by EstimatesController#edit as HTML
  Parameters: {"id"=>"2"}
  [1m[36mProduct Load (3.2ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (0.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (4.3ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = 1[0m
  [1m[36mProduct Load (0.9ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.6ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (1.6ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.6ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mConstructorObject Load (1.9ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  [1m[36mProductTemplateSet Load (0.6ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.5ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (1.2ms)[0m  [1m[34mSELECT  "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStage Load (3.2ms)[0m  [1m[34mSELECT "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mStageProduct Load (2.3ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" IN (4, 5, 6)[0m
  [1m[36mStageProduct Load (0.6ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 4]]
  [1m[36mStageProductSet Load (2.0ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 4[0m
  [1m[36mProduct Load (1.3ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 1[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mStageProduct Load (0.7ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 5]]
  [1m[36mStageProductSet Load (0.7ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 5[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 2[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mStageProduct Load (0.7ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 6]]
  [1m[36mStageProductSet Load (1.0ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 6[0m
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 3[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mStageProductSet Load (0.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = $1[0m  [["stage_product_id", 6]]
  [1m[36mStageProductSetValue Load (3.5ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = 2[0m
  [1m[36mProductSet Load (1.0ms)[0m  [1m[34mSELECT  "product_sets".* FROM "product_sets" WHERE "product_sets"."deleted_at" IS NULL AND "product_sets"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStageProductSetValue Load (0.7ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1[0m  [["stage_product_set_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  Rendering estimates/edit.html.haml within layouts/application
  [1m[36mClient Load (0.9ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (3.7ms)
  [1m[36mClientFile Load (2.6ms)[0m  [1m[34mSELECT "client_files".* FROM "client_files" WHERE "client_files"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mAssetFile Load (1.6ms)[0m  [1m[34mSELECT  "asset_files".* FROM "asset_files" WHERE "asset_files"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendered estimates/_client_file_fields.html.haml (23.1ms)
  Rendered estimates/_technical_file_fields.html.haml (3.2ms)
  [1m[36mTechnicalFile Load (2.1ms)[0m  [1m[34mSELECT "technical_files".* FROM "technical_files" WHERE "technical_files"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mAssetFile Load (0.4ms)[0m  [1m[34mSELECT  "asset_files".* FROM "asset_files" WHERE "asset_files"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  Rendered estimates/_technical_file_fields.html.haml (7.0ms)
  Rendered estimates/_discount.html.haml (8.0ms)
  Rendered estimates/_stages.html.haml (18.9ms)
  Rendered estimates/_form.html.haml (122.1ms)
  Rendered estimates/edit.html.haml within layouts/application (127.1ms)
  Rendered layouts/_header.html.haml (19.7ms)
Completed 200 OK in 1040ms (Views: 786.6ms | ActiveRecord: 74.8ms)


DEPRECATION WARNING: to_cleanup is deprecated and will be removed from Rails 5.1 (use ActiveSupport::Reloader.to_complete instead) (called from <top (required)> at /home/g1nc/Development/ruby/constructor/config/environment.rb:5)
Started GET "/estimates/2/edit" for 127.0.0.1 at 2017-04-26 23:04:05 +0300
Processing by EstimatesController#edit as HTML
  Parameters: {"id"=>"2"}
  [1m[36mProduct Load (2.9ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (0.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (0.5ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = 1[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.6ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (4.2ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.6ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (1.2ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mUnit Load (5.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  [1m[36mProductTemplateSet Load (0.8ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (1.5ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.9ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (1.7ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (1.0ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (1.6ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (2.2ms)[0m  [1m[34mSELECT  "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStage Load (0.8ms)[0m  [1m[34mSELECT "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mStageProduct Load (0.7ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" IN (4, 5, 6)[0m
  [1m[36mStageProduct Load (0.6ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 4]]
  [1m[36mStageProductSet Load (0.8ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 4[0m
  [1m[36mProduct Load (0.9ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 1[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mStageProduct Load (2.1ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 5]]
  [1m[36mStageProductSet Load (0.7ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 5[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 2[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mStageProduct Load (1.1ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 6]]
  [1m[36mStageProductSet Load (1.2ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 6[0m
  [1m[36mProduct Load (1.5ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 3[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mStageProductSet Load (0.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = $1[0m  [["stage_product_id", 6]]
  [1m[36mStageProductSetValue Load (0.8ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = 2[0m
  [1m[36mProductSet Load (0.5ms)[0m  [1m[34mSELECT  "product_sets".* FROM "product_sets" WHERE "product_sets"."deleted_at" IS NULL AND "product_sets"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStageProductSetValue Load (0.7ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1[0m  [["stage_product_set_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  Rendering estimates/edit.html.haml within layouts/application
  [1m[36mClient Load (0.6ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (7.7ms)
  [1m[36mClientFile Load (0.9ms)[0m  [1m[34mSELECT "client_files".* FROM "client_files" WHERE "client_files"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mAssetFile Load (0.5ms)[0m  [1m[34mSELECT  "asset_files".* FROM "asset_files" WHERE "asset_files"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendered estimates/_client_file_fields.html.haml (25.0ms)
  Rendered estimates/_technical_file_fields.html.haml (5.8ms)
  [1m[36mTechnicalFile Load (1.3ms)[0m  [1m[34mSELECT "technical_files".* FROM "technical_files" WHERE "technical_files"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mAssetFile Load (0.7ms)[0m  [1m[34mSELECT  "asset_files".* FROM "asset_files" WHERE "asset_files"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  Rendered estimates/_technical_file_fields.html.haml (9.6ms)
  Rendered estimates/_discount.html.haml (7.8ms)
  Rendered estimates/_stages.html.haml (21.7ms)
  Rendered estimates/_form.html.haml (184.5ms)
  Rendered estimates/edit.html.haml within layouts/application (187.9ms)
  Rendered layouts/_header.html.haml (28.1ms)
Completed 200 OK in 2373ms (Views: 1909.9ms | ActiveRecord: 90.6ms)


Started POST "/expenses/1" for 127.0.0.1 at 2017-04-26 23:04:10 +0300
  
Started POST "/expenses/1" for 127.0.0.1 at 2017-04-26 23:04:10 +0300
ActionController::RoutingError (No route matches [POST] "/expenses/1"):
  
actionpack (5.0.2) lib/action_dispatch/middleware/debug_exceptions.rb:53:in `call'
web-console (3.4.0) lib/web_console/middleware.rb:135:in `call_app'
web-console (3.4.0) lib/web_console/middleware.rb:28:in `block in call'
web-console (3.4.0) lib/web_console/middleware.rb:18:in `catch'
web-console (3.4.0) lib/web_console/middleware.rb:18:in `call'
actionpack (5.0.2) lib/action_dispatch/middleware/show_exceptions.rb:31:in `call'
railties (5.0.2) lib/rails/rack/logger.rb:36:in `call_app'
railties (5.0.2) lib/rails/rack/logger.rb:24:in `block in call'
activesupport (5.0.2) lib/active_support/tagged_logging.rb:69:in `block in tagged'
activesupport (5.0.2) lib/active_support/tagged_logging.rb:26:in `tagged'
activesupport (5.0.2) lib/active_support/tagged_logging.rb:69:in `tagged'
railties (5.0.2) lib/rails/rack/logger.rb:24:in `call'
sprockets-rails (3.2.0) lib/sprockets/rails/quiet_assets.rb:13:in `call'
request_store (1.2.0) lib/request_store/middleware.rb:8:in `call'
actionpack (5.0.2) lib/action_dispatch/middleware/request_id.rb:24:in `call'
rack (2.0.1) lib/rack/method_override.rb:22:in `call'
rack (2.0.1) lib/rack/runtime.rb:22:in `call'
activesupport (5.0.2) lib/active_support/cache/strategy/local_cache_middleware.rb:28:in `call'
actionpack (5.0.2) lib/action_dispatch/middleware/executor.rb:12:in `call'
actionpack (5.0.2) lib/action_dispatch/middleware/static.rb:136:in `call'
rack (2.0.1) lib/rack/sendfile.rb:111:in `call'
railties (5.0.2) lib/rails/engine.rb:522:in `call'
puma (3.7.1) lib/puma/configuration.rb:232:in `call'
puma (3.7.1) lib/puma/server.rb:578:in `handle_request'
puma (3.7.1) lib/puma/server.rb:415:in `process_client'
puma (3.7.1) lib/puma/server.rb:275:in `block in run'
puma (3.7.1) lib/puma/thread_pool.rb:120:in `block in spawn_thread'
  
Started POST "/expenses/1" for 127.0.0.1 at 2017-04-26 23:04:10 +0300
ActionController::RoutingError (No route matches [POST] "/expenses/1"):
  
actionpack (5.0.2) lib/action_dispatch/middleware/debug_exceptions.rb:53:in `call'
web-console (3.4.0) lib/web_console/middleware.rb:135:in `call_app'
web-console (3.4.0) lib/web_console/middleware.rb:28:in `block in call'
web-console (3.4.0) lib/web_console/middleware.rb:18:in `catch'
web-console (3.4.0) lib/web_console/middleware.rb:18:in `call'
actionpack (5.0.2) lib/action_dispatch/middleware/show_exceptions.rb:31:in `call'
railties (5.0.2) lib/rails/rack/logger.rb:36:in `call_app'
railties (5.0.2) lib/rails/rack/logger.rb:24:in `block in call'
activesupport (5.0.2) lib/active_support/tagged_logging.rb:69:in `block in tagged'
activesupport (5.0.2) lib/active_support/tagged_logging.rb:26:in `tagged'
activesupport (5.0.2) lib/active_support/tagged_logging.rb:69:in `tagged'
railties (5.0.2) lib/rails/rack/logger.rb:24:in `call'
sprockets-rails (3.2.0) lib/sprockets/rails/quiet_assets.rb:13:in `call'
request_store (1.2.0) lib/request_store/middleware.rb:8:in `call'
actionpack (5.0.2) lib/action_dispatch/middleware/request_id.rb:24:in `call'
rack (2.0.1) lib/rack/method_override.rb:22:in `call'
rack (2.0.1) lib/rack/runtime.rb:22:in `call'
activesupport (5.0.2) lib/active_support/cache/strategy/local_cache_middleware.rb:28:in `call'
actionpack (5.0.2) lib/action_dispatch/middleware/executor.rb:12:in `call'
actionpack (5.0.2) lib/action_dispatch/middleware/static.rb:136:in `call'
rack (2.0.1) lib/rack/sendfile.rb:111:in `call'
railties (5.0.2) lib/rails/engine.rb:522:in `call'
puma (3.7.1) lib/puma/configuration.rb:232:in `call'
puma (3.7.1) lib/puma/server.rb:578:in `handle_request'
puma (3.7.1) lib/puma/server.rb:415:in `process_client'
puma (3.7.1) lib/puma/server.rb:275:in `block in run'
puma (3.7.1) lib/puma/thread_pool.rb:120:in `block in spawn_thread'
  
ActionController::RoutingError (No route matches [POST] "/expenses/1"):
  
actionpack (5.0.2) lib/action_dispatch/middleware/debug_exceptions.rb:53:in `call'
web-console (3.4.0) lib/web_console/middleware.rb:135:in `call_app'
web-console (3.4.0) lib/web_console/middleware.rb:28:in `block in call'
web-console (3.4.0) lib/web_console/middleware.rb:18:in `catch'
web-console (3.4.0) lib/web_console/middleware.rb:18:in `call'
actionpack (5.0.2) lib/action_dispatch/middleware/show_exceptions.rb:31:in `call'
railties (5.0.2) lib/rails/rack/logger.rb:36:in `call_app'
railties (5.0.2) lib/rails/rack/logger.rb:24:in `block in call'
activesupport (5.0.2) lib/active_support/tagged_logging.rb:69:in `block in tagged'
activesupport (5.0.2) lib/active_support/tagged_logging.rb:26:in `tagged'
activesupport (5.0.2) lib/active_support/tagged_logging.rb:69:in `tagged'
railties (5.0.2) lib/rails/rack/logger.rb:24:in `call'
sprockets-rails (3.2.0) lib/sprockets/rails/quiet_assets.rb:13:in `call'
request_store (1.2.0) lib/request_store/middleware.rb:8:in `call'
actionpack (5.0.2) lib/action_dispatch/middleware/request_id.rb:24:in `call'
rack (2.0.1) lib/rack/method_override.rb:22:in `call'
rack (2.0.1) lib/rack/runtime.rb:22:in `call'
activesupport (5.0.2) lib/active_support/cache/strategy/local_cache_middleware.rb:28:in `call'
actionpack (5.0.2) lib/action_dispatch/middleware/executor.rb:12:in `call'
actionpack (5.0.2) lib/action_dispatch/middleware/static.rb:136:in `call'
rack (2.0.1) lib/rack/sendfile.rb:111:in `call'
railties (5.0.2) lib/rails/engine.rb:522:in `call'
puma (3.7.1) lib/puma/configuration.rb:232:in `call'
puma (3.7.1) lib/puma/server.rb:578:in `handle_request'
puma (3.7.1) lib/puma/server.rb:415:in `process_client'
puma (3.7.1) lib/puma/server.rb:275:in `block in run'
puma (3.7.1) lib/puma/thread_pool.rb:120:in `block in spawn_thread'
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/routing_error.html.erb within rescues/layout
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/routing_error.html.erb within rescues/layout
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/routing_error.html.erb within rescues/layout
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (1.5ms)
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (1.4ms)
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (1.3ms)
  Rendered collection of /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/routes/_route.html.erb [91 times] (33.4ms)
  Rendered collection of /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/routes/_route.html.erb [91 times] (68.5ms)
  Rendered collection of /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/routes/_route.html.erb [91 times] (36.6ms)
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/routes/_table.html.erb (6.5ms)
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/routes/_table.html.erb (4.6ms)
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/routes/_table.html.erb (3.2ms)
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_request_and_response.html.erb
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_request_and_response.html.erb
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_request_and_response.html.erb (1.2ms)
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/routing_error.html.erb within rescues/layout (289.6ms)
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_request_and_response.html.erb (1.2ms)
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/routing_error.html.erb within rescues/layout (258.5ms)
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_request_and_response.html.erb
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_request_and_response.html.erb (1.4ms)
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/routing_error.html.erb within rescues/layout (248.7ms)
Started GET "/estimates/2/edit" for 127.0.0.1 at 2017-04-26 23:04:32 +0300
Processing by EstimatesController#edit as HTML
  Parameters: {"id"=>"2"}
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (3.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (2.2ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = 1[0m
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.6ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (0.7ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.6ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (2.3ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mUnit Load (0.9ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  [1m[36mProductTemplateSet Load (0.8ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.5ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (2.5ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (1.5ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.5ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUnit Load (0.5ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (0.7ms)[0m  [1m[34mSELECT  "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStage Load (0.7ms)[0m  [1m[34mSELECT "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mStageProduct Load (0.7ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" IN (4, 5, 6)[0m
  [1m[36mStageProduct Load (0.5ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 4]]
  [1m[36mStageProductSet Load (0.7ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 4[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 1[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mStageProduct Load (0.8ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 5]]
  [1m[36mStageProductSet Load (0.7ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 5[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 2[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mStageProduct Load (0.6ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 6]]
  [1m[36mStageProductSet Load (0.5ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 6[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 3[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mStageProductSet Load (0.8ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = $1[0m  [["stage_product_id", 6]]
  [1m[36mStageProductSetValue Load (0.5ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = 2[0m
  [1m[36mProductSet Load (0.7ms)[0m  [1m[34mSELECT  "product_sets".* FROM "product_sets" WHERE "product_sets"."deleted_at" IS NULL AND "product_sets"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStageProductSetValue Load (0.7ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1[0m  [["stage_product_set_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  Rendering estimates/edit.html.haml within layouts/application
  [1m[36mClient Load (0.8ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (3.3ms)
  [1m[36mClientFile Load (0.5ms)[0m  [1m[34mSELECT "client_files".* FROM "client_files" WHERE "client_files"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mAssetFile Load (0.9ms)[0m  [1m[34mSELECT  "asset_files".* FROM "asset_files" WHERE "asset_files"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendered estimates/_client_file_fields.html.haml (6.3ms)
  Rendered estimates/_technical_file_fields.html.haml (3.3ms)
  [1m[36mTechnicalFile Load (0.7ms)[0m  [1m[34mSELECT "technical_files".* FROM "technical_files" WHERE "technical_files"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mAssetFile Load (1.3ms)[0m  [1m[34mSELECT  "asset_files".* FROM "asset_files" WHERE "asset_files"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  Rendered estimates/_technical_file_fields.html.haml (6.4ms)
  Rendered estimates/_discount.html.haml (7.1ms)
  Rendered estimates/_stages.html.haml (23.4ms)
  Rendered estimates/_form.html.haml (99.9ms)
  Rendered estimates/edit.html.haml within layouts/application (104.3ms)
  Rendered layouts/_header.html.haml (7.7ms)
Completed 200 OK in 1633ms (Views: 1489.5ms | ActiveRecord: 38.2ms)


Started GET "/expenses/1" for 127.0.0.1 at 2017-04-26 23:04:35 +0300
Processing by ExpensesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mUser Load (1.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Started GET "/estimates/2/edit" for 127.0.0.1 at 2017-04-26 23:05:00 +0300
Processing by EstimatesController#edit as HTML
  Parameters: {"id"=>"2"}
Completed 500 Internal Server Error in 56153ms (ActiveRecord: 1.4ms)


Started GET "/expenses/1" for 127.0.0.1 at 2017-04-26 23:05:31 +0300
Started GET "/expenses/1" for 127.0.0.1 at 2017-04-26 23:05:31 +0300
Started GET "/estimates/2/edit" for 127.0.0.1 at 2017-04-26 23:05:31 +0300
  
  [1m[36mProduct Load (82.1ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
SystemExit (exit):
  
  [1m[36mUnit Load (3.1ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
app/controllers/expenses_controller.rb:10:in `show'
  [1m[36mProductComposition Load (440.7ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
Completed 401 Unauthorized in 1125ms (ActiveRecord: 525.8ms)


DEPRECATION WARNING: to_cleanup is deprecated and will be removed from Rails 5.1 (use ActiveSupport::Reloader.to_complete instead) (called from <top (required)> at /home/g1nc/Development/ruby/constructor/config/environment.rb:5)
Started GET "/estimates/2/edit" for 127.0.0.1 at 2017-04-26 23:05:40 +0300
  [1m[36mActiveRecord::SchemaMigration Load (2.1ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
Processing by EstimatesController#edit as HTML
  Parameters: {"id"=>"2"}
  [1m[36mProduct Load (1.1ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (2.3ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (1.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = 1[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (5.5ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (4.1ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (2.7ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.6ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.8ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  [1m[36mProductTemplateSet Load (0.6ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.5ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.8ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUnit Load (1.5ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (1.2ms)[0m  [1m[34mSELECT  "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStage Load (1.1ms)[0m  [1m[34mSELECT "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mStageProduct Load (0.9ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" IN (4, 5, 6)[0m
  [1m[36mStageProduct Load (1.1ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 4]]
  [1m[36mStageProductSet Load (0.7ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 4[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 1[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mStageProduct Load (0.6ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 5]]
  [1m[36mStageProductSet Load (0.5ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 5[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 2[0m
  [1m[36mCACHE (0.1ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mStageProduct Load (0.7ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 6]]
  [1m[36mStageProductSet Load (0.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 6[0m
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 3[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mStageProductSet Load (1.0ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = $1[0m  [["stage_product_id", 6]]
  [1m[36mStageProductSetValue Load (0.8ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = 2[0m
  [1m[36mProductSet Load (0.7ms)[0m  [1m[34mSELECT  "product_sets".* FROM "product_sets" WHERE "product_sets"."deleted_at" IS NULL AND "product_sets"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStageProductSetValue Load (0.7ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1[0m  [["stage_product_set_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  Rendering estimates/edit.html.haml within layouts/application
  [1m[36mClient Load (0.8ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (1879.9ms)
  [1m[36mClientFile Load (4.3ms)[0m  [1m[34mSELECT "client_files".* FROM "client_files" WHERE "client_files"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mAssetFile Load (1.3ms)[0m  [1m[34mSELECT  "asset_files".* FROM "asset_files" WHERE "asset_files"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendered estimates/_client_file_fields.html.haml (24.1ms)
  Rendered estimates/_technical_file_fields.html.haml (5.9ms)
  [1m[36mTechnicalFile Load (1.4ms)[0m  [1m[34mSELECT "technical_files".* FROM "technical_files" WHERE "technical_files"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mAssetFile Load (0.6ms)[0m  [1m[34mSELECT  "asset_files".* FROM "asset_files" WHERE "asset_files"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  Rendered estimates/_technical_file_fields.html.haml (7.6ms)
  Rendered estimates/_discount.html.haml (7.4ms)
  Rendered estimates/_stages.html.haml (16.6ms)
  Rendered estimates/_form.html.haml (2064.3ms)
  Rendered estimates/edit.html.haml within layouts/application (2073.2ms)
  Rendered layouts/_header.html.haml (49.2ms)
Completed 200 OK in 3267ms (Views: 2665.9ms | ActiveRecord: 134.9ms)


Started GET "/expenses/1" for 127.0.0.1 at 2017-04-26 23:05:45 +0300
Processing by ExpensesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mUser Load (11.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (1.7ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 406 Not Acceptable in 109ms (ActiveRecord: 17.0ms)


  
ActionController::UnknownFormat (ExpensesController#show is missing a template for this request format and variant.

request.formats: ["text/html"]
request.variant: []

NOTE! For XHR/Ajax or API requests, this action would normally respond with 204 No Content: an empty white screen. Since you're loading it in a web browser, we assume that you expected to actually render a template, not nothing, so we're showing an error to be extra-clear. If you expect 204 No Content, carry on. That's what you'll get from an XHR or API request. Give it a shot.):
  
actionpack (5.0.2) lib/action_controller/metal/implicit_render.rb:56:in `default_render'
actionpack (5.0.2) lib/action_controller/metal/basic_implicit_render.rb:4:in `block in send_action'
actionpack (5.0.2) lib/action_controller/metal/basic_implicit_render.rb:4:in `tap'
actionpack (5.0.2) lib/action_controller/metal/basic_implicit_render.rb:4:in `send_action'
actionpack (5.0.2) lib/abstract_controller/base.rb:188:in `process_action'
actionpack (5.0.2) lib/action_controller/metal/rendering.rb:30:in `process_action'
actionpack (5.0.2) lib/abstract_controller/callbacks.rb:20:in `block in process_action'
activesupport (5.0.2) lib/active_support/callbacks.rb:126:in `call'
activesupport (5.0.2) lib/active_support/callbacks.rb:506:in `block (2 levels) in compile'
activesupport (5.0.2) lib/active_support/callbacks.rb:455:in `call'
activesupport (5.0.2) lib/active_support/callbacks.rb:448:in `block (2 levels) in around'
activesupport (5.0.2) lib/active_support/callbacks.rb:286:in `block (2 levels) in halting'
audited (4.3.0) lib/audited/sweeper.rb:10:in `around'
activesupport (5.0.2) lib/active_support/callbacks.rb:405:in `public_send'
activesupport (5.0.2) lib/active_support/callbacks.rb:405:in `block in make_lambda'
activesupport (5.0.2) lib/active_support/callbacks.rb:285:in `block in halting'
activesupport (5.0.2) lib/active_support/callbacks.rb:447:in `block in around'
activesupport (5.0.2) lib/active_support/callbacks.rb:455:in `call'
activesupport (5.0.2) lib/active_support/callbacks.rb:448:in `block (2 levels) in around'
activesupport (5.0.2) lib/active_support/callbacks.rb:286:in `block (2 levels) in halting'
audited (4.3.0) lib/audited/sweeper.rb:10:in `around'
activesupport (5.0.2) lib/active_support/callbacks.rb:405:in `public_send'
activesupport (5.0.2) lib/active_support/callbacks.rb:405:in `block in make_lambda'
activesupport (5.0.2) lib/active_support/callbacks.rb:285:in `block in halting'
activesupport (5.0.2) lib/active_support/callbacks.rb:447:in `block in around'
activesupport (5.0.2) lib/active_support/callbacks.rb:455:in `call'
activesupport (5.0.2) lib/active_support/callbacks.rb:101:in `__run_callbacks__'
activesupport (5.0.2) lib/active_support/callbacks.rb:750:in `_run_process_action_callbacks'
activesupport (5.0.2) lib/active_support/callbacks.rb:90:in `run_callbacks'
actionpack (5.0.2) lib/abstract_controller/callbacks.rb:19:in `process_action'
actionpack (5.0.2) lib/action_controller/metal/rescue.rb:20:in `process_action'
actionpack (5.0.2) lib/action_controller/metal/instrumentation.rb:32:in `block in process_action'
activesupport (5.0.2) lib/active_support/notifications.rb:164:in `block in instrument'
activesupport (5.0.2) lib/active_support/notifications/instrumenter.rb:21:in `instrument'
activesupport (5.0.2) lib/active_support/notifications.rb:164:in `instrument'
actionpack (5.0.2) lib/action_controller/metal/instrumentation.rb:30:in `process_action'
actionpack (5.0.2) lib/action_controller/metal/params_wrapper.rb:248:in `process_action'
activerecord (5.0.2) lib/active_record/railties/controller_runtime.rb:18:in `process_action'
actionpack (5.0.2) lib/abstract_controller/base.rb:126:in `process'
actionview (5.0.2) lib/action_view/rendering.rb:30:in `process'
actionpack (5.0.2) lib/action_controller/metal.rb:190:in `dispatch'
actionpack (5.0.2) lib/action_controller/metal.rb:262:in `dispatch'
actionpack (5.0.2) lib/action_dispatch/routing/route_set.rb:50:in `dispatch'
actionpack (5.0.2) lib/action_dispatch/routing/route_set.rb:32:in `serve'
actionpack (5.0.2) lib/action_dispatch/journey/router.rb:39:in `block in serve'
actionpack (5.0.2) lib/action_dispatch/journey/router.rb:26:in `each'
actionpack (5.0.2) lib/action_dispatch/journey/router.rb:26:in `serve'
actionpack (5.0.2) lib/action_dispatch/routing/route_set.rb:725:in `call'
warden (1.2.7) lib/warden/manager.rb:36:in `block in call'
warden (1.2.7) lib/warden/manager.rb:35:in `catch'
warden (1.2.7) lib/warden/manager.rb:35:in `call'
rack (2.0.1) lib/rack/etag.rb:25:in `call'
rack (2.0.1) lib/rack/conditional_get.rb:25:in `call'
rack (2.0.1) lib/rack/head.rb:12:in `call'
rack (2.0.1) lib/rack/session/abstract/id.rb:222:in `context'
rack (2.0.1) lib/rack/session/abstract/id.rb:216:in `call'
actionpack (5.0.2) lib/action_dispatch/middleware/cookies.rb:613:in `call'
activerecord (5.0.2) lib/active_record/migration.rb:553:in `call'
actionpack (5.0.2) lib/action_dispatch/middleware/callbacks.rb:38:in `block in call'
activesupport (5.0.2) lib/active_support/callbacks.rb:97:in `__run_callbacks__'
activesupport (5.0.2) lib/active_support/callbacks.rb:750:in `_run_call_callbacks'
activesupport (5.0.2) lib/active_support/callbacks.rb:90:in `run_callbacks'
actionpack (5.0.2) lib/action_dispatch/middleware/callbacks.rb:36:in `call'
actionpack (5.0.2) lib/action_dispatch/middleware/executor.rb:12:in `call'
actionpack (5.0.2) lib/action_dispatch/middleware/remote_ip.rb:79:in `call'
actionpack (5.0.2) lib/action_dispatch/middleware/debug_exceptions.rb:49:in `call'
web-console (3.4.0) lib/web_console/middleware.rb:135:in `call_app'
web-console (3.4.0) lib/web_console/middleware.rb:28:in `block in call'
web-console (3.4.0) lib/web_console/middleware.rb:18:in `catch'
web-console (3.4.0) lib/web_console/middleware.rb:18:in `call'
actionpack (5.0.2) lib/action_dispatch/middleware/show_exceptions.rb:31:in `call'
railties (5.0.2) lib/rails/rack/logger.rb:36:in `call_app'
railties (5.0.2) lib/rails/rack/logger.rb:24:in `block in call'
activesupport (5.0.2) lib/active_support/tagged_logging.rb:69:in `block in tagged'
activesupport (5.0.2) lib/active_support/tagged_logging.rb:26:in `tagged'
activesupport (5.0.2) lib/active_support/tagged_logging.rb:69:in `tagged'
railties (5.0.2) lib/rails/rack/logger.rb:24:in `call'
sprockets-rails (3.2.0) lib/sprockets/rails/quiet_assets.rb:13:in `call'
request_store (1.2.0) lib/request_store/middleware.rb:8:in `call'
actionpack (5.0.2) lib/action_dispatch/middleware/request_id.rb:24:in `call'
rack (2.0.1) lib/rack/method_override.rb:22:in `call'
rack (2.0.1) lib/rack/runtime.rb:22:in `call'
activesupport (5.0.2) lib/active_support/cache/strategy/local_cache_middleware.rb:28:in `call'
actionpack (5.0.2) lib/action_dispatch/middleware/executor.rb:12:in `call'
actionpack (5.0.2) lib/action_dispatch/middleware/static.rb:136:in `call'
rack (2.0.1) lib/rack/sendfile.rb:111:in `call'
railties (5.0.2) lib/rails/engine.rb:522:in `call'
puma (3.7.1) lib/puma/configuration.rb:232:in `call'
puma (3.7.1) lib/puma/server.rb:578:in `handle_request'
puma (3.7.1) lib/puma/server.rb:415:in `process_client'
puma (3.7.1) lib/puma/server.rb:275:in `block in run'
puma (3.7.1) lib/puma/thread_pool.rb:120:in `block in spawn_thread'
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/diagnostics.html.erb within rescues/layout
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_source.html.erb
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_source.html.erb (6.2ms)
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (2.1ms)
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_request_and_response.html.erb
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_request_and_response.html.erb (1.5ms)
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/diagnostics.html.erb within rescues/layout (54.0ms)
Started GET "/expenses/1" for 127.0.0.1 at 2017-04-26 23:05:46 +0300
Processing by ExpensesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.9ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 406 Not Acceptable in 99ms (ActiveRecord: 1.6ms)


  
ActionController::UnknownFormat (ExpensesController#show is missing a template for this request format and variant.

request.formats: ["text/html"]
request.variant: []

NOTE! For XHR/Ajax or API requests, this action would normally respond with 204 No Content: an empty white screen. Since you're loading it in a web browser, we assume that you expected to actually render a template, not nothing, so we're showing an error to be extra-clear. If you expect 204 No Content, carry on. That's what you'll get from an XHR or API request. Give it a shot.):
  
actionpack (5.0.2) lib/action_controller/metal/implicit_render.rb:56:in `default_render'
actionpack (5.0.2) lib/action_controller/metal/basic_implicit_render.rb:4:in `block in send_action'
actionpack (5.0.2) lib/action_controller/metal/basic_implicit_render.rb:4:in `tap'
actionpack (5.0.2) lib/action_controller/metal/basic_implicit_render.rb:4:in `send_action'
actionpack (5.0.2) lib/abstract_controller/base.rb:188:in `process_action'
actionpack (5.0.2) lib/action_controller/metal/rendering.rb:30:in `process_action'
actionpack (5.0.2) lib/abstract_controller/callbacks.rb:20:in `block in process_action'
activesupport (5.0.2) lib/active_support/callbacks.rb:126:in `call'
activesupport (5.0.2) lib/active_support/callbacks.rb:506:in `block (2 levels) in compile'
activesupport (5.0.2) lib/active_support/callbacks.rb:455:in `call'
activesupport (5.0.2) lib/active_support/callbacks.rb:448:in `block (2 levels) in around'
activesupport (5.0.2) lib/active_support/callbacks.rb:286:in `block (2 levels) in halting'
audited (4.3.0) lib/audited/sweeper.rb:10:in `around'
activesupport (5.0.2) lib/active_support/callbacks.rb:405:in `public_send'
activesupport (5.0.2) lib/active_support/callbacks.rb:405:in `block in make_lambda'
activesupport (5.0.2) lib/active_support/callbacks.rb:285:in `block in halting'
activesupport (5.0.2) lib/active_support/callbacks.rb:447:in `block in around'
activesupport (5.0.2) lib/active_support/callbacks.rb:455:in `call'
activesupport (5.0.2) lib/active_support/callbacks.rb:448:in `block (2 levels) in around'
activesupport (5.0.2) lib/active_support/callbacks.rb:286:in `block (2 levels) in halting'
audited (4.3.0) lib/audited/sweeper.rb:10:in `around'
activesupport (5.0.2) lib/active_support/callbacks.rb:405:in `public_send'
activesupport (5.0.2) lib/active_support/callbacks.rb:405:in `block in make_lambda'
activesupport (5.0.2) lib/active_support/callbacks.rb:285:in `block in halting'
activesupport (5.0.2) lib/active_support/callbacks.rb:447:in `block in around'
activesupport (5.0.2) lib/active_support/callbacks.rb:455:in `call'
activesupport (5.0.2) lib/active_support/callbacks.rb:101:in `__run_callbacks__'
activesupport (5.0.2) lib/active_support/callbacks.rb:750:in `_run_process_action_callbacks'
activesupport (5.0.2) lib/active_support/callbacks.rb:90:in `run_callbacks'
actionpack (5.0.2) lib/abstract_controller/callbacks.rb:19:in `process_action'
actionpack (5.0.2) lib/action_controller/metal/rescue.rb:20:in `process_action'
actionpack (5.0.2) lib/action_controller/metal/instrumentation.rb:32:in `block in process_action'
activesupport (5.0.2) lib/active_support/notifications.rb:164:in `block in instrument'
activesupport (5.0.2) lib/active_support/notifications/instrumenter.rb:21:in `instrument'
activesupport (5.0.2) lib/active_support/notifications.rb:164:in `instrument'
actionpack (5.0.2) lib/action_controller/metal/instrumentation.rb:30:in `process_action'
actionpack (5.0.2) lib/action_controller/metal/params_wrapper.rb:248:in `process_action'
activerecord (5.0.2) lib/active_record/railties/controller_runtime.rb:18:in `process_action'
actionpack (5.0.2) lib/abstract_controller/base.rb:126:in `process'
actionview (5.0.2) lib/action_view/rendering.rb:30:in `process'
actionpack (5.0.2) lib/action_controller/metal.rb:190:in `dispatch'
actionpack (5.0.2) lib/action_controller/metal.rb:262:in `dispatch'
actionpack (5.0.2) lib/action_dispatch/routing/route_set.rb:50:in `dispatch'
actionpack (5.0.2) lib/action_dispatch/routing/route_set.rb:32:in `serve'
actionpack (5.0.2) lib/action_dispatch/journey/router.rb:39:in `block in serve'
actionpack (5.0.2) lib/action_dispatch/journey/router.rb:26:in `each'
actionpack (5.0.2) lib/action_dispatch/journey/router.rb:26:in `serve'
actionpack (5.0.2) lib/action_dispatch/routing/route_set.rb:725:in `call'
warden (1.2.7) lib/warden/manager.rb:36:in `block in call'
warden (1.2.7) lib/warden/manager.rb:35:in `catch'
warden (1.2.7) lib/warden/manager.rb:35:in `call'
rack (2.0.1) lib/rack/etag.rb:25:in `call'
rack (2.0.1) lib/rack/conditional_get.rb:25:in `call'
rack (2.0.1) lib/rack/head.rb:12:in `call'
rack (2.0.1) lib/rack/session/abstract/id.rb:222:in `context'
rack (2.0.1) lib/rack/session/abstract/id.rb:216:in `call'
actionpack (5.0.2) lib/action_dispatch/middleware/cookies.rb:613:in `call'
activerecord (5.0.2) lib/active_record/migration.rb:553:in `call'
actionpack (5.0.2) lib/action_dispatch/middleware/callbacks.rb:38:in `block in call'
activesupport (5.0.2) lib/active_support/callbacks.rb:97:in `__run_callbacks__'
activesupport (5.0.2) lib/active_support/callbacks.rb:750:in `_run_call_callbacks'
activesupport (5.0.2) lib/active_support/callbacks.rb:90:in `run_callbacks'
actionpack (5.0.2) lib/action_dispatch/middleware/callbacks.rb:36:in `call'
actionpack (5.0.2) lib/action_dispatch/middleware/executor.rb:12:in `call'
actionpack (5.0.2) lib/action_dispatch/middleware/remote_ip.rb:79:in `call'
actionpack (5.0.2) lib/action_dispatch/middleware/debug_exceptions.rb:49:in `call'
web-console (3.4.0) lib/web_console/middleware.rb:135:in `call_app'
web-console (3.4.0) lib/web_console/middleware.rb:28:in `block in call'
web-console (3.4.0) lib/web_console/middleware.rb:18:in `catch'
web-console (3.4.0) lib/web_console/middleware.rb:18:in `call'
actionpack (5.0.2) lib/action_dispatch/middleware/show_exceptions.rb:31:in `call'
railties (5.0.2) lib/rails/rack/logger.rb:36:in `call_app'
railties (5.0.2) lib/rails/rack/logger.rb:24:in `block in call'
activesupport (5.0.2) lib/active_support/tagged_logging.rb:69:in `block in tagged'
activesupport (5.0.2) lib/active_support/tagged_logging.rb:26:in `tagged'
activesupport (5.0.2) lib/active_support/tagged_logging.rb:69:in `tagged'
railties (5.0.2) lib/rails/rack/logger.rb:24:in `call'
sprockets-rails (3.2.0) lib/sprockets/rails/quiet_assets.rb:13:in `call'
request_store (1.2.0) lib/request_store/middleware.rb:8:in `call'
actionpack (5.0.2) lib/action_dispatch/middleware/request_id.rb:24:in `call'
rack (2.0.1) lib/rack/method_override.rb:22:in `call'
rack (2.0.1) lib/rack/runtime.rb:22:in `call'
activesupport (5.0.2) lib/active_support/cache/strategy/local_cache_middleware.rb:28:in `call'
actionpack (5.0.2) lib/action_dispatch/middleware/executor.rb:12:in `call'
actionpack (5.0.2) lib/action_dispatch/middleware/static.rb:136:in `call'
rack (2.0.1) lib/rack/sendfile.rb:111:in `call'
railties (5.0.2) lib/rails/engine.rb:522:in `call'
puma (3.7.1) lib/puma/configuration.rb:232:in `call'
puma (3.7.1) lib/puma/server.rb:578:in `handle_request'
puma (3.7.1) lib/puma/server.rb:415:in `process_client'
puma (3.7.1) lib/puma/server.rb:275:in `block in run'
puma (3.7.1) lib/puma/thread_pool.rb:120:in `block in spawn_thread'
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/diagnostics.html.erb within rescues/layout
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_source.html.erb
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_source.html.erb (10.6ms)
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (2.2ms)
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_request_and_response.html.erb
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_request_and_response.html.erb (1.3ms)
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/diagnostics.html.erb within rescues/layout (51.9ms)
Started GET "/expenses/1" for 127.0.0.1 at 2017-04-26 23:05:46 +0300
Processing by ExpensesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.9ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 406 Not Acceptable in 93ms (ActiveRecord: 1.7ms)


  
ActionController::UnknownFormat (ExpensesController#show is missing a template for this request format and variant.

request.formats: ["text/html"]
request.variant: []

NOTE! For XHR/Ajax or API requests, this action would normally respond with 204 No Content: an empty white screen. Since you're loading it in a web browser, we assume that you expected to actually render a template, not nothing, so we're showing an error to be extra-clear. If you expect 204 No Content, carry on. That's what you'll get from an XHR or API request. Give it a shot.):
  
actionpack (5.0.2) lib/action_controller/metal/implicit_render.rb:56:in `default_render'
actionpack (5.0.2) lib/action_controller/metal/basic_implicit_render.rb:4:in `block in send_action'
actionpack (5.0.2) lib/action_controller/metal/basic_implicit_render.rb:4:in `tap'
actionpack (5.0.2) lib/action_controller/metal/basic_implicit_render.rb:4:in `send_action'
actionpack (5.0.2) lib/abstract_controller/base.rb:188:in `process_action'
actionpack (5.0.2) lib/action_controller/metal/rendering.rb:30:in `process_action'
actionpack (5.0.2) lib/abstract_controller/callbacks.rb:20:in `block in process_action'
activesupport (5.0.2) lib/active_support/callbacks.rb:126:in `call'
activesupport (5.0.2) lib/active_support/callbacks.rb:506:in `block (2 levels) in compile'
activesupport (5.0.2) lib/active_support/callbacks.rb:455:in `call'
activesupport (5.0.2) lib/active_support/callbacks.rb:448:in `block (2 levels) in around'
activesupport (5.0.2) lib/active_support/callbacks.rb:286:in `block (2 levels) in halting'
audited (4.3.0) lib/audited/sweeper.rb:10:in `around'
activesupport (5.0.2) lib/active_support/callbacks.rb:405:in `public_send'
activesupport (5.0.2) lib/active_support/callbacks.rb:405:in `block in make_lambda'
activesupport (5.0.2) lib/active_support/callbacks.rb:285:in `block in halting'
activesupport (5.0.2) lib/active_support/callbacks.rb:447:in `block in around'
activesupport (5.0.2) lib/active_support/callbacks.rb:455:in `call'
activesupport (5.0.2) lib/active_support/callbacks.rb:448:in `block (2 levels) in around'
activesupport (5.0.2) lib/active_support/callbacks.rb:286:in `block (2 levels) in halting'
audited (4.3.0) lib/audited/sweeper.rb:10:in `around'
activesupport (5.0.2) lib/active_support/callbacks.rb:405:in `public_send'
activesupport (5.0.2) lib/active_support/callbacks.rb:405:in `block in make_lambda'
activesupport (5.0.2) lib/active_support/callbacks.rb:285:in `block in halting'
activesupport (5.0.2) lib/active_support/callbacks.rb:447:in `block in around'
activesupport (5.0.2) lib/active_support/callbacks.rb:455:in `call'
activesupport (5.0.2) lib/active_support/callbacks.rb:101:in `__run_callbacks__'
activesupport (5.0.2) lib/active_support/callbacks.rb:750:in `_run_process_action_callbacks'
activesupport (5.0.2) lib/active_support/callbacks.rb:90:in `run_callbacks'
actionpack (5.0.2) lib/abstract_controller/callbacks.rb:19:in `process_action'
actionpack (5.0.2) lib/action_controller/metal/rescue.rb:20:in `process_action'
actionpack (5.0.2) lib/action_controller/metal/instrumentation.rb:32:in `block in process_action'
activesupport (5.0.2) lib/active_support/notifications.rb:164:in `block in instrument'
activesupport (5.0.2) lib/active_support/notifications/instrumenter.rb:21:in `instrument'
activesupport (5.0.2) lib/active_support/notifications.rb:164:in `instrument'
actionpack (5.0.2) lib/action_controller/metal/instrumentation.rb:30:in `process_action'
actionpack (5.0.2) lib/action_controller/metal/params_wrapper.rb:248:in `process_action'
activerecord (5.0.2) lib/active_record/railties/controller_runtime.rb:18:in `process_action'
actionpack (5.0.2) lib/abstract_controller/base.rb:126:in `process'
actionview (5.0.2) lib/action_view/rendering.rb:30:in `process'
actionpack (5.0.2) lib/action_controller/metal.rb:190:in `dispatch'
actionpack (5.0.2) lib/action_controller/metal.rb:262:in `dispatch'
actionpack (5.0.2) lib/action_dispatch/routing/route_set.rb:50:in `dispatch'
actionpack (5.0.2) lib/action_dispatch/routing/route_set.rb:32:in `serve'
actionpack (5.0.2) lib/action_dispatch/journey/router.rb:39:in `block in serve'
actionpack (5.0.2) lib/action_dispatch/journey/router.rb:26:in `each'
actionpack (5.0.2) lib/action_dispatch/journey/router.rb:26:in `serve'
actionpack (5.0.2) lib/action_dispatch/routing/route_set.rb:725:in `call'
warden (1.2.7) lib/warden/manager.rb:36:in `block in call'
warden (1.2.7) lib/warden/manager.rb:35:in `catch'
warden (1.2.7) lib/warden/manager.rb:35:in `call'
rack (2.0.1) lib/rack/etag.rb:25:in `call'
rack (2.0.1) lib/rack/conditional_get.rb:25:in `call'
rack (2.0.1) lib/rack/head.rb:12:in `call'
rack (2.0.1) lib/rack/session/abstract/id.rb:222:in `context'
rack (2.0.1) lib/rack/session/abstract/id.rb:216:in `call'
actionpack (5.0.2) lib/action_dispatch/middleware/cookies.rb:613:in `call'
activerecord (5.0.2) lib/active_record/migration.rb:553:in `call'
actionpack (5.0.2) lib/action_dispatch/middleware/callbacks.rb:38:in `block in call'
activesupport (5.0.2) lib/active_support/callbacks.rb:97:in `__run_callbacks__'
activesupport (5.0.2) lib/active_support/callbacks.rb:750:in `_run_call_callbacks'
activesupport (5.0.2) lib/active_support/callbacks.rb:90:in `run_callbacks'
actionpack (5.0.2) lib/action_dispatch/middleware/callbacks.rb:36:in `call'
actionpack (5.0.2) lib/action_dispatch/middleware/executor.rb:12:in `call'
actionpack (5.0.2) lib/action_dispatch/middleware/remote_ip.rb:79:in `call'
actionpack (5.0.2) lib/action_dispatch/middleware/debug_exceptions.rb:49:in `call'
web-console (3.4.0) lib/web_console/middleware.rb:135:in `call_app'
web-console (3.4.0) lib/web_console/middleware.rb:28:in `block in call'
web-console (3.4.0) lib/web_console/middleware.rb:18:in `catch'
web-console (3.4.0) lib/web_console/middleware.rb:18:in `call'
actionpack (5.0.2) lib/action_dispatch/middleware/show_exceptions.rb:31:in `call'
railties (5.0.2) lib/rails/rack/logger.rb:36:in `call_app'
railties (5.0.2) lib/rails/rack/logger.rb:24:in `block in call'
activesupport (5.0.2) lib/active_support/tagged_logging.rb:69:in `block in tagged'
activesupport (5.0.2) lib/active_support/tagged_logging.rb:26:in `tagged'
activesupport (5.0.2) lib/active_support/tagged_logging.rb:69:in `tagged'
railties (5.0.2) lib/rails/rack/logger.rb:24:in `call'
sprockets-rails (3.2.0) lib/sprockets/rails/quiet_assets.rb:13:in `call'
request_store (1.2.0) lib/request_store/middleware.rb:8:in `call'
actionpack (5.0.2) lib/action_dispatch/middleware/request_id.rb:24:in `call'
rack (2.0.1) lib/rack/method_override.rb:22:in `call'
rack (2.0.1) lib/rack/runtime.rb:22:in `call'
activesupport (5.0.2) lib/active_support/cache/strategy/local_cache_middleware.rb:28:in `call'
actionpack (5.0.2) lib/action_dispatch/middleware/executor.rb:12:in `call'
actionpack (5.0.2) lib/action_dispatch/middleware/static.rb:136:in `call'
rack (2.0.1) lib/rack/sendfile.rb:111:in `call'
railties (5.0.2) lib/rails/engine.rb:522:in `call'
puma (3.7.1) lib/puma/configuration.rb:232:in `call'
puma (3.7.1) lib/puma/server.rb:578:in `handle_request'
puma (3.7.1) lib/puma/server.rb:415:in `process_client'
puma (3.7.1) lib/puma/server.rb:275:in `block in run'
puma (3.7.1) lib/puma/thread_pool.rb:120:in `block in spawn_thread'
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/diagnostics.html.erb within rescues/layout
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_source.html.erb
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_source.html.erb (5.1ms)
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (2.4ms)
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_request_and_response.html.erb
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_request_and_response.html.erb (1.2ms)
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/diagnostics.html.erb within rescues/layout (31.9ms)
Started GET "/estimates/2/edit" for 127.0.0.1 at 2017-04-26 23:06:44 +0300
Processing by EstimatesController#edit as HTML
  Parameters: {"id"=>"2"}
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (0.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (3.4ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = 1[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.5ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (5.3ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (3.0ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.5ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mConstructorObject Load (3.8ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  [1m[36mProductTemplateSet Load (3.7ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.5ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (0.7ms)[0m  [1m[34mSELECT  "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStage Load (0.8ms)[0m  [1m[34mSELECT "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mStageProduct Load (0.5ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" IN (4, 5, 6)[0m
  [1m[36mStageProduct Load (0.7ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 4]]
  [1m[36mStageProductSet Load (0.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 4[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 1[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mStageProduct Load (0.8ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 5]]
  [1m[36mStageProductSet Load (2.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 5[0m
  [1m[36mProduct Load (1.1ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 2[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mStageProduct Load (0.6ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 6]]
  [1m[36mStageProductSet Load (0.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 6[0m
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 3[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mStageProductSet Load (0.7ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = $1[0m  [["stage_product_id", 6]]
  [1m[36mStageProductSetValue Load (0.6ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = 2[0m
  [1m[36mProductSet Load (0.6ms)[0m  [1m[34mSELECT  "product_sets".* FROM "product_sets" WHERE "product_sets"."deleted_at" IS NULL AND "product_sets"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStageProductSetValue Load (0.6ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1[0m  [["stage_product_set_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  Rendering estimates/edit.html.haml within layouts/application
  [1m[36mClient Load (1.0ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (9.9ms)
  [1m[36mClientFile Load (2.2ms)[0m  [1m[34mSELECT "client_files".* FROM "client_files" WHERE "client_files"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mAssetFile Load (0.6ms)[0m  [1m[34mSELECT  "asset_files".* FROM "asset_files" WHERE "asset_files"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendered estimates/_client_file_fields.html.haml (25.4ms)
  Rendered estimates/_technical_file_fields.html.haml (40.2ms)
  [1m[36mTechnicalFile Load (0.7ms)[0m  [1m[34mSELECT "technical_files".* FROM "technical_files" WHERE "technical_files"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mAssetFile Load (1.0ms)[0m  [1m[34mSELECT  "asset_files".* FROM "asset_files" WHERE "asset_files"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  Rendered estimates/_technical_file_fields.html.haml (13.1ms)
  Rendered estimates/_discount.html.haml (11.0ms)
  Rendered estimates/_stages.html.haml (20.0ms)
  Rendered estimates/_form.html.haml (234.2ms)
  Rendered estimates/edit.html.haml within layouts/application (237.8ms)
  Rendered layouts/_header.html.haml (30.1ms)
Completed 200 OK in 1313ms (Views: 781.4ms | ActiveRecord: 128.5ms)


Started GET "/expenses/1" for 127.0.0.1 at 2017-04-26 23:06:48 +0300
Processing by ExpensesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mUser Load (1.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.5ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 406 Not Acceptable in 103ms (ActiveRecord: 7.8ms)


  
ActionController::UnknownFormat (ExpensesController#show is missing a template for this request format and variant.

request.formats: ["text/html"]
request.variant: []

NOTE! For XHR/Ajax or API requests, this action would normally respond with 204 No Content: an empty white screen. Since you're loading it in a web browser, we assume that you expected to actually render a template, not nothing, so we're showing an error to be extra-clear. If you expect 204 No Content, carry on. That's what you'll get from an XHR or API request. Give it a shot.):
  
actionpack (5.0.2) lib/action_controller/metal/implicit_render.rb:56:in `default_render'
actionpack (5.0.2) lib/action_controller/metal/basic_implicit_render.rb:4:in `block in send_action'
actionpack (5.0.2) lib/action_controller/metal/basic_implicit_render.rb:4:in `tap'
actionpack (5.0.2) lib/action_controller/metal/basic_implicit_render.rb:4:in `send_action'
actionpack (5.0.2) lib/abstract_controller/base.rb:188:in `process_action'
actionpack (5.0.2) lib/action_controller/metal/rendering.rb:30:in `process_action'
actionpack (5.0.2) lib/abstract_controller/callbacks.rb:20:in `block in process_action'
activesupport (5.0.2) lib/active_support/callbacks.rb:126:in `call'
activesupport (5.0.2) lib/active_support/callbacks.rb:506:in `block (2 levels) in compile'
activesupport (5.0.2) lib/active_support/callbacks.rb:455:in `call'
activesupport (5.0.2) lib/active_support/callbacks.rb:448:in `block (2 levels) in around'
activesupport (5.0.2) lib/active_support/callbacks.rb:286:in `block (2 levels) in halting'
audited (4.3.0) lib/audited/sweeper.rb:10:in `around'
activesupport (5.0.2) lib/active_support/callbacks.rb:405:in `public_send'
activesupport (5.0.2) lib/active_support/callbacks.rb:405:in `block in make_lambda'
activesupport (5.0.2) lib/active_support/callbacks.rb:285:in `block in halting'
activesupport (5.0.2) lib/active_support/callbacks.rb:447:in `block in around'
activesupport (5.0.2) lib/active_support/callbacks.rb:455:in `call'
activesupport (5.0.2) lib/active_support/callbacks.rb:448:in `block (2 levels) in around'
activesupport (5.0.2) lib/active_support/callbacks.rb:286:in `block (2 levels) in halting'
audited (4.3.0) lib/audited/sweeper.rb:10:in `around'
activesupport (5.0.2) lib/active_support/callbacks.rb:405:in `public_send'
activesupport (5.0.2) lib/active_support/callbacks.rb:405:in `block in make_lambda'
activesupport (5.0.2) lib/active_support/callbacks.rb:285:in `block in halting'
activesupport (5.0.2) lib/active_support/callbacks.rb:447:in `block in around'
activesupport (5.0.2) lib/active_support/callbacks.rb:455:in `call'
activesupport (5.0.2) lib/active_support/callbacks.rb:101:in `__run_callbacks__'
activesupport (5.0.2) lib/active_support/callbacks.rb:750:in `_run_process_action_callbacks'
activesupport (5.0.2) lib/active_support/callbacks.rb:90:in `run_callbacks'
actionpack (5.0.2) lib/abstract_controller/callbacks.rb:19:in `process_action'
actionpack (5.0.2) lib/action_controller/metal/rescue.rb:20:in `process_action'
actionpack (5.0.2) lib/action_controller/metal/instrumentation.rb:32:in `block in process_action'
activesupport (5.0.2) lib/active_support/notifications.rb:164:in `block in instrument'
activesupport (5.0.2) lib/active_support/notifications/instrumenter.rb:21:in `instrument'
activesupport (5.0.2) lib/active_support/notifications.rb:164:in `instrument'
actionpack (5.0.2) lib/action_controller/metal/instrumentation.rb:30:in `process_action'
actionpack (5.0.2) lib/action_controller/metal/params_wrapper.rb:248:in `process_action'
activerecord (5.0.2) lib/active_record/railties/controller_runtime.rb:18:in `process_action'
actionpack (5.0.2) lib/abstract_controller/base.rb:126:in `process'
actionview (5.0.2) lib/action_view/rendering.rb:30:in `process'
actionpack (5.0.2) lib/action_controller/metal.rb:190:in `dispatch'
actionpack (5.0.2) lib/action_controller/metal.rb:262:in `dispatch'
actionpack (5.0.2) lib/action_dispatch/routing/route_set.rb:50:in `dispatch'
actionpack (5.0.2) lib/action_dispatch/routing/route_set.rb:32:in `serve'
actionpack (5.0.2) lib/action_dispatch/journey/router.rb:39:in `block in serve'
actionpack (5.0.2) lib/action_dispatch/journey/router.rb:26:in `each'
actionpack (5.0.2) lib/action_dispatch/journey/router.rb:26:in `serve'
actionpack (5.0.2) lib/action_dispatch/routing/route_set.rb:725:in `call'
warden (1.2.7) lib/warden/manager.rb:36:in `block in call'
warden (1.2.7) lib/warden/manager.rb:35:in `catch'
warden (1.2.7) lib/warden/manager.rb:35:in `call'
rack (2.0.1) lib/rack/etag.rb:25:in `call'
rack (2.0.1) lib/rack/conditional_get.rb:25:in `call'
rack (2.0.1) lib/rack/head.rb:12:in `call'
rack (2.0.1) lib/rack/session/abstract/id.rb:222:in `context'
rack (2.0.1) lib/rack/session/abstract/id.rb:216:in `call'
actionpack (5.0.2) lib/action_dispatch/middleware/cookies.rb:613:in `call'
activerecord (5.0.2) lib/active_record/migration.rb:553:in `call'
actionpack (5.0.2) lib/action_dispatch/middleware/callbacks.rb:38:in `block in call'
activesupport (5.0.2) lib/active_support/callbacks.rb:97:in `__run_callbacks__'
activesupport (5.0.2) lib/active_support/callbacks.rb:750:in `_run_call_callbacks'
activesupport (5.0.2) lib/active_support/callbacks.rb:90:in `run_callbacks'
actionpack (5.0.2) lib/action_dispatch/middleware/callbacks.rb:36:in `call'
actionpack (5.0.2) lib/action_dispatch/middleware/executor.rb:12:in `call'
actionpack (5.0.2) lib/action_dispatch/middleware/remote_ip.rb:79:in `call'
actionpack (5.0.2) lib/action_dispatch/middleware/debug_exceptions.rb:49:in `call'
web-console (3.4.0) lib/web_console/middleware.rb:135:in `call_app'
web-console (3.4.0) lib/web_console/middleware.rb:28:in `block in call'
web-console (3.4.0) lib/web_console/middleware.rb:18:in `catch'
web-console (3.4.0) lib/web_console/middleware.rb:18:in `call'
actionpack (5.0.2) lib/action_dispatch/middleware/show_exceptions.rb:31:in `call'
railties (5.0.2) lib/rails/rack/logger.rb:36:in `call_app'
railties (5.0.2) lib/rails/rack/logger.rb:24:in `block in call'
activesupport (5.0.2) lib/active_support/tagged_logging.rb:69:in `block in tagged'
activesupport (5.0.2) lib/active_support/tagged_logging.rb:26:in `tagged'
activesupport (5.0.2) lib/active_support/tagged_logging.rb:69:in `tagged'
railties (5.0.2) lib/rails/rack/logger.rb:24:in `call'
sprockets-rails (3.2.0) lib/sprockets/rails/quiet_assets.rb:13:in `call'
request_store (1.2.0) lib/request_store/middleware.rb:8:in `call'
actionpack (5.0.2) lib/action_dispatch/middleware/request_id.rb:24:in `call'
rack (2.0.1) lib/rack/method_override.rb:22:in `call'
rack (2.0.1) lib/rack/runtime.rb:22:in `call'
activesupport (5.0.2) lib/active_support/cache/strategy/local_cache_middleware.rb:28:in `call'
actionpack (5.0.2) lib/action_dispatch/middleware/executor.rb:12:in `call'
actionpack (5.0.2) lib/action_dispatch/middleware/static.rb:136:in `call'
rack (2.0.1) lib/rack/sendfile.rb:111:in `call'
railties (5.0.2) lib/rails/engine.rb:522:in `call'
puma (3.7.1) lib/puma/configuration.rb:232:in `call'
puma (3.7.1) lib/puma/server.rb:578:in `handle_request'
puma (3.7.1) lib/puma/server.rb:415:in `process_client'
puma (3.7.1) lib/puma/server.rb:275:in `block in run'
puma (3.7.1) lib/puma/thread_pool.rb:120:in `block in spawn_thread'
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/diagnostics.html.erb within rescues/layout
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_source.html.erb
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_source.html.erb (7.2ms)
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (2.4ms)
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_request_and_response.html.erb
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_request_and_response.html.erb (1.2ms)
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/diagnostics.html.erb within rescues/layout (35.2ms)
Started GET "/expenses/1" for 127.0.0.1 at 2017-04-26 23:06:48 +0300
Processing by ExpensesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.6ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 406 Not Acceptable in 65ms (ActiveRecord: 1.4ms)


  
ActionController::UnknownFormat (ExpensesController#show is missing a template for this request format and variant.

request.formats: ["text/html"]
request.variant: []

NOTE! For XHR/Ajax or API requests, this action would normally respond with 204 No Content: an empty white screen. Since you're loading it in a web browser, we assume that you expected to actually render a template, not nothing, so we're showing an error to be extra-clear. If you expect 204 No Content, carry on. That's what you'll get from an XHR or API request. Give it a shot.):
  
actionpack (5.0.2) lib/action_controller/metal/implicit_render.rb:56:in `default_render'
actionpack (5.0.2) lib/action_controller/metal/basic_implicit_render.rb:4:in `block in send_action'
actionpack (5.0.2) lib/action_controller/metal/basic_implicit_render.rb:4:in `tap'
actionpack (5.0.2) lib/action_controller/metal/basic_implicit_render.rb:4:in `send_action'
actionpack (5.0.2) lib/abstract_controller/base.rb:188:in `process_action'
actionpack (5.0.2) lib/action_controller/metal/rendering.rb:30:in `process_action'
actionpack (5.0.2) lib/abstract_controller/callbacks.rb:20:in `block in process_action'
activesupport (5.0.2) lib/active_support/callbacks.rb:126:in `call'
activesupport (5.0.2) lib/active_support/callbacks.rb:506:in `block (2 levels) in compile'
activesupport (5.0.2) lib/active_support/callbacks.rb:455:in `call'
activesupport (5.0.2) lib/active_support/callbacks.rb:448:in `block (2 levels) in around'
activesupport (5.0.2) lib/active_support/callbacks.rb:286:in `block (2 levels) in halting'
audited (4.3.0) lib/audited/sweeper.rb:10:in `around'
activesupport (5.0.2) lib/active_support/callbacks.rb:405:in `public_send'
activesupport (5.0.2) lib/active_support/callbacks.rb:405:in `block in make_lambda'
activesupport (5.0.2) lib/active_support/callbacks.rb:285:in `block in halting'
activesupport (5.0.2) lib/active_support/callbacks.rb:447:in `block in around'
activesupport (5.0.2) lib/active_support/callbacks.rb:455:in `call'
activesupport (5.0.2) lib/active_support/callbacks.rb:448:in `block (2 levels) in around'
activesupport (5.0.2) lib/active_support/callbacks.rb:286:in `block (2 levels) in halting'
audited (4.3.0) lib/audited/sweeper.rb:10:in `around'
activesupport (5.0.2) lib/active_support/callbacks.rb:405:in `public_send'
activesupport (5.0.2) lib/active_support/callbacks.rb:405:in `block in make_lambda'
activesupport (5.0.2) lib/active_support/callbacks.rb:285:in `block in halting'
activesupport (5.0.2) lib/active_support/callbacks.rb:447:in `block in around'
activesupport (5.0.2) lib/active_support/callbacks.rb:455:in `call'
activesupport (5.0.2) lib/active_support/callbacks.rb:101:in `__run_callbacks__'
activesupport (5.0.2) lib/active_support/callbacks.rb:750:in `_run_process_action_callbacks'
activesupport (5.0.2) lib/active_support/callbacks.rb:90:in `run_callbacks'
actionpack (5.0.2) lib/abstract_controller/callbacks.rb:19:in `process_action'
actionpack (5.0.2) lib/action_controller/metal/rescue.rb:20:in `process_action'
actionpack (5.0.2) lib/action_controller/metal/instrumentation.rb:32:in `block in process_action'
activesupport (5.0.2) lib/active_support/notifications.rb:164:in `block in instrument'
activesupport (5.0.2) lib/active_support/notifications/instrumenter.rb:21:in `instrument'
activesupport (5.0.2) lib/active_support/notifications.rb:164:in `instrument'
actionpack (5.0.2) lib/action_controller/metal/instrumentation.rb:30:in `process_action'
actionpack (5.0.2) lib/action_controller/metal/params_wrapper.rb:248:in `process_action'
activerecord (5.0.2) lib/active_record/railties/controller_runtime.rb:18:in `process_action'
actionpack (5.0.2) lib/abstract_controller/base.rb:126:in `process'
actionview (5.0.2) lib/action_view/rendering.rb:30:in `process'
actionpack (5.0.2) lib/action_controller/metal.rb:190:in `dispatch'
actionpack (5.0.2) lib/action_controller/metal.rb:262:in `dispatch'
actionpack (5.0.2) lib/action_dispatch/routing/route_set.rb:50:in `dispatch'
actionpack (5.0.2) lib/action_dispatch/routing/route_set.rb:32:in `serve'
actionpack (5.0.2) lib/action_dispatch/journey/router.rb:39:in `block in serve'
actionpack (5.0.2) lib/action_dispatch/journey/router.rb:26:in `each'
actionpack (5.0.2) lib/action_dispatch/journey/router.rb:26:in `serve'
actionpack (5.0.2) lib/action_dispatch/routing/route_set.rb:725:in `call'
warden (1.2.7) lib/warden/manager.rb:36:in `block in call'
warden (1.2.7) lib/warden/manager.rb:35:in `catch'
warden (1.2.7) lib/warden/manager.rb:35:in `call'
rack (2.0.1) lib/rack/etag.rb:25:in `call'
rack (2.0.1) lib/rack/conditional_get.rb:25:in `call'
rack (2.0.1) lib/rack/head.rb:12:in `call'
rack (2.0.1) lib/rack/session/abstract/id.rb:222:in `context'
rack (2.0.1) lib/rack/session/abstract/id.rb:216:in `call'
actionpack (5.0.2) lib/action_dispatch/middleware/cookies.rb:613:in `call'
activerecord (5.0.2) lib/active_record/migration.rb:553:in `call'
actionpack (5.0.2) lib/action_dispatch/middleware/callbacks.rb:38:in `block in call'
activesupport (5.0.2) lib/active_support/callbacks.rb:97:in `__run_callbacks__'
activesupport (5.0.2) lib/active_support/callbacks.rb:750:in `_run_call_callbacks'
activesupport (5.0.2) lib/active_support/callbacks.rb:90:in `run_callbacks'
actionpack (5.0.2) lib/action_dispatch/middleware/callbacks.rb:36:in `call'
actionpack (5.0.2) lib/action_dispatch/middleware/executor.rb:12:in `call'
actionpack (5.0.2) lib/action_dispatch/middleware/remote_ip.rb:79:in `call'
actionpack (5.0.2) lib/action_dispatch/middleware/debug_exceptions.rb:49:in `call'
web-console (3.4.0) lib/web_console/middleware.rb:135:in `call_app'
web-console (3.4.0) lib/web_console/middleware.rb:28:in `block in call'
web-console (3.4.0) lib/web_console/middleware.rb:18:in `catch'
web-console (3.4.0) lib/web_console/middleware.rb:18:in `call'
actionpack (5.0.2) lib/action_dispatch/middleware/show_exceptions.rb:31:in `call'
railties (5.0.2) lib/rails/rack/logger.rb:36:in `call_app'
railties (5.0.2) lib/rails/rack/logger.rb:24:in `block in call'
activesupport (5.0.2) lib/active_support/tagged_logging.rb:69:in `block in tagged'
activesupport (5.0.2) lib/active_support/tagged_logging.rb:26:in `tagged'
activesupport (5.0.2) lib/active_support/tagged_logging.rb:69:in `tagged'
railties (5.0.2) lib/rails/rack/logger.rb:24:in `call'
sprockets-rails (3.2.0) lib/sprockets/rails/quiet_assets.rb:13:in `call'
request_store (1.2.0) lib/request_store/middleware.rb:8:in `call'
actionpack (5.0.2) lib/action_dispatch/middleware/request_id.rb:24:in `call'
rack (2.0.1) lib/rack/method_override.rb:22:in `call'
rack (2.0.1) lib/rack/runtime.rb:22:in `call'
activesupport (5.0.2) lib/active_support/cache/strategy/local_cache_middleware.rb:28:in `call'
actionpack (5.0.2) lib/action_dispatch/middleware/executor.rb:12:in `call'
actionpack (5.0.2) lib/action_dispatch/middleware/static.rb:136:in `call'
rack (2.0.1) lib/rack/sendfile.rb:111:in `call'
railties (5.0.2) lib/rails/engine.rb:522:in `call'
puma (3.7.1) lib/puma/configuration.rb:232:in `call'
puma (3.7.1) lib/puma/server.rb:578:in `handle_request'
puma (3.7.1) lib/puma/server.rb:415:in `process_client'
puma (3.7.1) lib/puma/server.rb:275:in `block in run'
puma (3.7.1) lib/puma/thread_pool.rb:120:in `block in spawn_thread'
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/diagnostics.html.erb within rescues/layout
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_source.html.erb
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_source.html.erb (7.0ms)
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (2.3ms)
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_request_and_response.html.erb
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_request_and_response.html.erb (1.0ms)
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/diagnostics.html.erb within rescues/layout (37.0ms)
Started GET "/expenses/1" for 127.0.0.1 at 2017-04-26 23:06:48 +0300
Processing by ExpensesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.6ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 406 Not Acceptable in 67ms (ActiveRecord: 1.3ms)


  
ActionController::UnknownFormat (ExpensesController#show is missing a template for this request format and variant.

request.formats: ["text/html"]
request.variant: []

NOTE! For XHR/Ajax or API requests, this action would normally respond with 204 No Content: an empty white screen. Since you're loading it in a web browser, we assume that you expected to actually render a template, not nothing, so we're showing an error to be extra-clear. If you expect 204 No Content, carry on. That's what you'll get from an XHR or API request. Give it a shot.):
  
actionpack (5.0.2) lib/action_controller/metal/implicit_render.rb:56:in `default_render'
actionpack (5.0.2) lib/action_controller/metal/basic_implicit_render.rb:4:in `block in send_action'
actionpack (5.0.2) lib/action_controller/metal/basic_implicit_render.rb:4:in `tap'
actionpack (5.0.2) lib/action_controller/metal/basic_implicit_render.rb:4:in `send_action'
actionpack (5.0.2) lib/abstract_controller/base.rb:188:in `process_action'
actionpack (5.0.2) lib/action_controller/metal/rendering.rb:30:in `process_action'
actionpack (5.0.2) lib/abstract_controller/callbacks.rb:20:in `block in process_action'
activesupport (5.0.2) lib/active_support/callbacks.rb:126:in `call'
activesupport (5.0.2) lib/active_support/callbacks.rb:506:in `block (2 levels) in compile'
activesupport (5.0.2) lib/active_support/callbacks.rb:455:in `call'
activesupport (5.0.2) lib/active_support/callbacks.rb:448:in `block (2 levels) in around'
activesupport (5.0.2) lib/active_support/callbacks.rb:286:in `block (2 levels) in halting'
audited (4.3.0) lib/audited/sweeper.rb:10:in `around'
activesupport (5.0.2) lib/active_support/callbacks.rb:405:in `public_send'
activesupport (5.0.2) lib/active_support/callbacks.rb:405:in `block in make_lambda'
activesupport (5.0.2) lib/active_support/callbacks.rb:285:in `block in halting'
activesupport (5.0.2) lib/active_support/callbacks.rb:447:in `block in around'
activesupport (5.0.2) lib/active_support/callbacks.rb:455:in `call'
activesupport (5.0.2) lib/active_support/callbacks.rb:448:in `block (2 levels) in around'
activesupport (5.0.2) lib/active_support/callbacks.rb:286:in `block (2 levels) in halting'
audited (4.3.0) lib/audited/sweeper.rb:10:in `around'
activesupport (5.0.2) lib/active_support/callbacks.rb:405:in `public_send'
activesupport (5.0.2) lib/active_support/callbacks.rb:405:in `block in make_lambda'
activesupport (5.0.2) lib/active_support/callbacks.rb:285:in `block in halting'
activesupport (5.0.2) lib/active_support/callbacks.rb:447:in `block in around'
activesupport (5.0.2) lib/active_support/callbacks.rb:455:in `call'
activesupport (5.0.2) lib/active_support/callbacks.rb:101:in `__run_callbacks__'
activesupport (5.0.2) lib/active_support/callbacks.rb:750:in `_run_process_action_callbacks'
activesupport (5.0.2) lib/active_support/callbacks.rb:90:in `run_callbacks'
actionpack (5.0.2) lib/abstract_controller/callbacks.rb:19:in `process_action'
actionpack (5.0.2) lib/action_controller/metal/rescue.rb:20:in `process_action'
actionpack (5.0.2) lib/action_controller/metal/instrumentation.rb:32:in `block in process_action'
activesupport (5.0.2) lib/active_support/notifications.rb:164:in `block in instrument'
activesupport (5.0.2) lib/active_support/notifications/instrumenter.rb:21:in `instrument'
activesupport (5.0.2) lib/active_support/notifications.rb:164:in `instrument'
actionpack (5.0.2) lib/action_controller/metal/instrumentation.rb:30:in `process_action'
actionpack (5.0.2) lib/action_controller/metal/params_wrapper.rb:248:in `process_action'
activerecord (5.0.2) lib/active_record/railties/controller_runtime.rb:18:in `process_action'
actionpack (5.0.2) lib/abstract_controller/base.rb:126:in `process'
actionview (5.0.2) lib/action_view/rendering.rb:30:in `process'
actionpack (5.0.2) lib/action_controller/metal.rb:190:in `dispatch'
actionpack (5.0.2) lib/action_controller/metal.rb:262:in `dispatch'
actionpack (5.0.2) lib/action_dispatch/routing/route_set.rb:50:in `dispatch'
actionpack (5.0.2) lib/action_dispatch/routing/route_set.rb:32:in `serve'
actionpack (5.0.2) lib/action_dispatch/journey/router.rb:39:in `block in serve'
actionpack (5.0.2) lib/action_dispatch/journey/router.rb:26:in `each'
actionpack (5.0.2) lib/action_dispatch/journey/router.rb:26:in `serve'
actionpack (5.0.2) lib/action_dispatch/routing/route_set.rb:725:in `call'
warden (1.2.7) lib/warden/manager.rb:36:in `block in call'
warden (1.2.7) lib/warden/manager.rb:35:in `catch'
warden (1.2.7) lib/warden/manager.rb:35:in `call'
rack (2.0.1) lib/rack/etag.rb:25:in `call'
rack (2.0.1) lib/rack/conditional_get.rb:25:in `call'
rack (2.0.1) lib/rack/head.rb:12:in `call'
rack (2.0.1) lib/rack/session/abstract/id.rb:222:in `context'
rack (2.0.1) lib/rack/session/abstract/id.rb:216:in `call'
actionpack (5.0.2) lib/action_dispatch/middleware/cookies.rb:613:in `call'
activerecord (5.0.2) lib/active_record/migration.rb:553:in `call'
actionpack (5.0.2) lib/action_dispatch/middleware/callbacks.rb:38:in `block in call'
activesupport (5.0.2) lib/active_support/callbacks.rb:97:in `__run_callbacks__'
activesupport (5.0.2) lib/active_support/callbacks.rb:750:in `_run_call_callbacks'
activesupport (5.0.2) lib/active_support/callbacks.rb:90:in `run_callbacks'
actionpack (5.0.2) lib/action_dispatch/middleware/callbacks.rb:36:in `call'
actionpack (5.0.2) lib/action_dispatch/middleware/executor.rb:12:in `call'
actionpack (5.0.2) lib/action_dispatch/middleware/remote_ip.rb:79:in `call'
actionpack (5.0.2) lib/action_dispatch/middleware/debug_exceptions.rb:49:in `call'
web-console (3.4.0) lib/web_console/middleware.rb:135:in `call_app'
web-console (3.4.0) lib/web_console/middleware.rb:28:in `block in call'
web-console (3.4.0) lib/web_console/middleware.rb:18:in `catch'
web-console (3.4.0) lib/web_console/middleware.rb:18:in `call'
actionpack (5.0.2) lib/action_dispatch/middleware/show_exceptions.rb:31:in `call'
railties (5.0.2) lib/rails/rack/logger.rb:36:in `call_app'
railties (5.0.2) lib/rails/rack/logger.rb:24:in `block in call'
activesupport (5.0.2) lib/active_support/tagged_logging.rb:69:in `block in tagged'
activesupport (5.0.2) lib/active_support/tagged_logging.rb:26:in `tagged'
activesupport (5.0.2) lib/active_support/tagged_logging.rb:69:in `tagged'
railties (5.0.2) lib/rails/rack/logger.rb:24:in `call'
sprockets-rails (3.2.0) lib/sprockets/rails/quiet_assets.rb:13:in `call'
request_store (1.2.0) lib/request_store/middleware.rb:8:in `call'
actionpack (5.0.2) lib/action_dispatch/middleware/request_id.rb:24:in `call'
rack (2.0.1) lib/rack/method_override.rb:22:in `call'
rack (2.0.1) lib/rack/runtime.rb:22:in `call'
activesupport (5.0.2) lib/active_support/cache/strategy/local_cache_middleware.rb:28:in `call'
actionpack (5.0.2) lib/action_dispatch/middleware/executor.rb:12:in `call'
actionpack (5.0.2) lib/action_dispatch/middleware/static.rb:136:in `call'
rack (2.0.1) lib/rack/sendfile.rb:111:in `call'
railties (5.0.2) lib/rails/engine.rb:522:in `call'
puma (3.7.1) lib/puma/configuration.rb:232:in `call'
puma (3.7.1) lib/puma/server.rb:578:in `handle_request'
puma (3.7.1) lib/puma/server.rb:415:in `process_client'
puma (3.7.1) lib/puma/server.rb:275:in `block in run'
puma (3.7.1) lib/puma/thread_pool.rb:120:in `block in spawn_thread'
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/diagnostics.html.erb within rescues/layout
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_source.html.erb
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_source.html.erb (11.3ms)
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (4.1ms)
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_request_and_response.html.erb
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_request_and_response.html.erb (2.3ms)
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/diagnostics.html.erb within rescues/layout (43.8ms)
Started GET "/estimates/2/edit" for 127.0.0.1 at 2017-04-26 23:07:23 +0300
Processing by EstimatesController#edit as HTML
  Parameters: {"id"=>"2"}
  [1m[36mProduct Load (3.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (3.1ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (2.9ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (1.5ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = 1[0m
  [1m[36mProduct Load (1.5ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (3.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.5ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (1.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (3.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (0.7ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (1.3ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (2.1ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  [1m[36mProductTemplateSet Load (0.6ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.8ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.5ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (1.3ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (2.1ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUnit Load (2.9ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (2.1ms)[0m  [1m[34mSELECT  "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStage Load (0.5ms)[0m  [1m[34mSELECT "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mStageProduct Load (0.6ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" IN (4, 5, 6)[0m
  [1m[36mStageProduct Load (0.5ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 4]]
  [1m[36mStageProductSet Load (1.2ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 4[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 1[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mStageProduct Load (0.6ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 5]]
  [1m[36mStageProductSet Load (0.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 5[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 2[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mStageProduct Load (4.5ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 6]]
  [1m[36mStageProductSet Load (0.9ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 6[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 3[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mStageProductSet Load (2.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = $1[0m  [["stage_product_id", 6]]
  [1m[36mStageProductSetValue Load (0.6ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = 2[0m
  [1m[36mProductSet Load (0.6ms)[0m  [1m[34mSELECT  "product_sets".* FROM "product_sets" WHERE "product_sets"."deleted_at" IS NULL AND "product_sets"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStageProductSetValue Load (0.7ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1[0m  [["stage_product_set_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  Rendering estimates/edit.html.haml within layouts/application
  [1m[36mClient Load (0.8ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (3.1ms)
  [1m[36mClientFile Load (2.6ms)[0m  [1m[34mSELECT "client_files".* FROM "client_files" WHERE "client_files"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mAssetFile Load (3.0ms)[0m  [1m[34mSELECT  "asset_files".* FROM "asset_files" WHERE "asset_files"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendered estimates/_client_file_fields.html.haml (8.6ms)
  Rendered estimates/_technical_file_fields.html.haml (5.6ms)
  [1m[36mTechnicalFile Load (0.8ms)[0m  [1m[34mSELECT "technical_files".* FROM "technical_files" WHERE "technical_files"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mAssetFile Load (0.4ms)[0m  [1m[34mSELECT  "asset_files".* FROM "asset_files" WHERE "asset_files"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  Rendered estimates/_technical_file_fields.html.haml (5.7ms)
  Rendered estimates/_discount.html.haml (9.3ms)
  Rendered estimates/_stages.html.haml (19.2ms)
  Rendered estimates/_form.html.haml (169.2ms)
  Rendered estimates/edit.html.haml within layouts/application (181.8ms)
  Rendered layouts/_header.html.haml (9.3ms)
Completed 200 OK in 2001ms (Views: 1738.4ms | ActiveRecord: 62.3ms)


Started GET "/expenses/1.json" for 127.0.0.1 at 2017-04-26 23:07:27 +0300
Processing by ExpensesController#show as JSON
  Parameters: {"id"=>"1"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (2.2ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
No template found for ExpensesController#show, rendering head :no_content
Completed 204 No Content in 89ms (ActiveRecord: 2.8ms)


Started GET "/expenses/1.json" for 127.0.0.1 at 2017-04-26 23:07:27 +0300
Processing by ExpensesController#show as JSON
  Parameters: {"id"=>"1"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.3ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
No template found for ExpensesController#show, rendering head :no_content
Completed 204 No Content in 72ms (ActiveRecord: 0.9ms)


Started GET "/expenses/1.json" for 127.0.0.1 at 2017-04-26 23:07:28 +0300
Processing by ExpensesController#show as JSON
  Parameters: {"id"=>"1"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (1.7ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
No template found for ExpensesController#show, rendering head :no_content
Completed 204 No Content in 71ms (ActiveRecord: 2.3ms)


Started GET "/estimates/2/edit" for 127.0.0.1 at 2017-04-26 23:07:50 +0300
Processing by EstimatesController#edit as HTML
  Parameters: {"id"=>"2"}
  [1m[36mProduct Load (2.5ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (0.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (0.7ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = 1[0m
  [1m[36mProduct Load (3.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.6ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (2.0ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.7ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.5ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mConstructorObject Load (6.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  [1m[36mProductTemplateSet Load (0.6ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (6.9ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (2.3ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (1.6ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (1.1ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (2.3ms)[0m  [1m[34mSELECT  "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUser Load (1.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStage Load (1.7ms)[0m  [1m[34mSELECT "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mStageProduct Load (0.5ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" IN (4, 5, 6)[0m
  [1m[36mStageProduct Load (5.9ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 4]]
  [1m[36mStageProductSet Load (1.7ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 4[0m
  [1m[36mProduct Load (1.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 1[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mStageProduct Load (1.2ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 5]]
  [1m[36mStageProductSet Load (2.7ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 5[0m
  [1m[36mProduct Load (1.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 2[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mStageProduct Load (0.8ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 6]]
  [1m[36mStageProductSet Load (1.4ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 6[0m
  [1m[36mProduct Load (2.9ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 3[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mStageProductSet Load (0.5ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = $1[0m  [["stage_product_id", 6]]
  [1m[36mStageProductSetValue Load (5.0ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = 2[0m
  [1m[36mProductSet Load (0.5ms)[0m  [1m[34mSELECT  "product_sets".* FROM "product_sets" WHERE "product_sets"."deleted_at" IS NULL AND "product_sets"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStageProductSetValue Load (1.2ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1[0m  [["stage_product_set_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  Rendering estimates/edit.html.haml within layouts/application
  [1m[36mClient Load (0.5ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (14.5ms)
  [1m[36mClientFile Load (1.1ms)[0m  [1m[34mSELECT "client_files".* FROM "client_files" WHERE "client_files"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mAssetFile Load (0.4ms)[0m  [1m[34mSELECT  "asset_files".* FROM "asset_files" WHERE "asset_files"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendered estimates/_client_file_fields.html.haml (23.3ms)
  Rendered estimates/_technical_file_fields.html.haml (7.0ms)
  [1m[36mTechnicalFile Load (0.9ms)[0m  [1m[34mSELECT "technical_files".* FROM "technical_files" WHERE "technical_files"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mAssetFile Load (0.9ms)[0m  [1m[34mSELECT  "asset_files".* FROM "asset_files" WHERE "asset_files"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  Rendered estimates/_technical_file_fields.html.haml (8.7ms)
  Rendered estimates/_discount.html.haml (10.1ms)
  Rendered estimates/_stages.html.haml (52.3ms)
  Rendered estimates/_form.html.haml (258.5ms)
  Rendered estimates/edit.html.haml within layouts/application (263.7ms)
  Rendered layouts/_header.html.haml (28.7ms)
Completed 200 OK in 1370ms (Views: 761.5ms | ActiveRecord: 166.9ms)


Started GET "/expenses/1.json" for 127.0.0.1 at 2017-04-26 23:07:53 +0300
Processing by ExpensesController#show as JSON
  Parameters: {"id"=>"1"}
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.5ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
No template found for ExpensesController#show, rendering head :no_content
Completed 204 No Content in 95ms (ActiveRecord: 5.4ms)


Started GET "/expenses/1.json" for 127.0.0.1 at 2017-04-26 23:07:53 +0300
Processing by ExpensesController#show as JSON
  Parameters: {"id"=>"1"}
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (1.4ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
No template found for ExpensesController#show, rendering head :no_content
Completed 204 No Content in 89ms (ActiveRecord: 2.1ms)


Started GET "/expenses/1.json" for 127.0.0.1 at 2017-04-26 23:07:53 +0300
Processing by ExpensesController#show as JSON
  Parameters: {"id"=>"1"}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (1.2ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
No template found for ExpensesController#show, rendering head :no_content
Completed 204 No Content in 96ms (ActiveRecord: 1.8ms)


Started GET "/estimates/2/edit" for 127.0.0.1 at 2017-04-26 23:12:55 +0300
Processing by EstimatesController#edit as HTML
  Parameters: {"id"=>"2"}
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (0.9ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.5ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = 1[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.6ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (0.8ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (2.1ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.5ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  [1m[36mProductTemplateSet Load (0.8ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (1.4ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.9ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.8ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (0.9ms)[0m  [1m[34mSELECT  "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.4ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mStage Load (0.7ms)[0m  [1m[34mSELECT "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mStageProduct Load (0.5ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" IN (4, 5, 6)[0m
  [1m[36mStageProduct Load (0.8ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 4]]
  [1m[36mStageProductSet Load (0.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 4[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 1[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mStageProduct Load (0.5ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 5]]
  [1m[36mStageProductSet Load (0.5ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 5[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 2[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mStageProduct Load (1.3ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 6]]
  [1m[36mStageProductSet Load (0.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 6[0m
  [1m[36mProduct Load (3.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 3[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mStageProductSet Load (0.7ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = $1[0m  [["stage_product_id", 6]]
  [1m[36mStageProductSetValue Load (0.7ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = 2[0m
  [1m[36mProductSet Load (0.9ms)[0m  [1m[34mSELECT  "product_sets".* FROM "product_sets" WHERE "product_sets"."deleted_at" IS NULL AND "product_sets"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStageProductSetValue Load (0.7ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1[0m  [["stage_product_set_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  Rendering estimates/edit.html.haml within layouts/application
  [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (7.7ms)
  [1m[36mClientFile Load (0.5ms)[0m  [1m[34mSELECT "client_files".* FROM "client_files" WHERE "client_files"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mAssetFile Load (0.5ms)[0m  [1m[34mSELECT  "asset_files".* FROM "asset_files" WHERE "asset_files"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendered estimates/_client_file_fields.html.haml (16.7ms)
  Rendered estimates/_technical_file_fields.html.haml (5.0ms)
  [1m[36mTechnicalFile Load (0.8ms)[0m  [1m[34mSELECT "technical_files".* FROM "technical_files" WHERE "technical_files"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mAssetFile Load (0.6ms)[0m  [1m[34mSELECT  "asset_files".* FROM "asset_files" WHERE "asset_files"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  Rendered estimates/_technical_file_fields.html.haml (6.6ms)
  Rendered estimates/_discount.html.haml (11.8ms)
  Rendered estimates/_stages.html.haml (15.0ms)
  Rendered estimates/_form.html.haml (211.9ms)
  Rendered estimates/edit.html.haml within layouts/application (215.2ms)
  Rendered layouts/_header.html.haml (22.9ms)
Completed 200 OK in 2149ms (Views: 1631.7ms | ActiveRecord: 117.0ms)


Started GET "/estimates/2/edit" for 127.0.0.1 at 2017-04-26 23:14:37 +0300
Processing by EstimatesController#edit as HTML
  Parameters: {"id"=>"2"}
  [1m[36mProduct Load (3.3ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (3.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (5.3ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = 1[0m
  [1m[36mProduct Load (1.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (2.9ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (1.3ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (0.8ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.6ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.5ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mConstructorObject Load (2.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  [1m[36mProductTemplateSet Load (0.7ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.8ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (0.8ms)[0m  [1m[34mSELECT  "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (1.4ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mStage Load (0.7ms)[0m  [1m[34mSELECT "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mStageProduct Load (0.5ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" IN (4, 5, 6)[0m
  [1m[36mStageProduct Load (0.9ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 4]]
  [1m[36mStageProductSet Load (0.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 4[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 1[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mStageProduct Load (0.6ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 5]]
  [1m[36mStageProductSet Load (1.1ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 5[0m
  [1m[36mProduct Load (1.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 2[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mStageProduct Load (0.8ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 6]]
  [1m[36mStageProductSet Load (1.1ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 6[0m
  [1m[36mProduct Load (2.4ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 3[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mStageProductSet Load (0.8ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = $1[0m  [["stage_product_id", 6]]
  [1m[36mStageProductSetValue Load (0.7ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = 2[0m
  [1m[36mProductSet Load (5.7ms)[0m  [1m[34mSELECT  "product_sets".* FROM "product_sets" WHERE "product_sets"."deleted_at" IS NULL AND "product_sets"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStageProductSetValue Load (0.9ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1[0m  [["stage_product_set_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  Rendering estimates/edit.html.haml within layouts/application
  [1m[36mClient Load (0.6ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (4.1ms)
  [1m[36mClientFile Load (0.5ms)[0m  [1m[34mSELECT "client_files".* FROM "client_files" WHERE "client_files"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mAssetFile Load (0.4ms)[0m  [1m[34mSELECT  "asset_files".* FROM "asset_files" WHERE "asset_files"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendered estimates/_client_file_fields.html.haml (7.3ms)
  Rendered estimates/_technical_file_fields.html.haml (3.6ms)
  [1m[36mTechnicalFile Load (0.8ms)[0m  [1m[34mSELECT "technical_files".* FROM "technical_files" WHERE "technical_files"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mAssetFile Load (0.4ms)[0m  [1m[34mSELECT  "asset_files".* FROM "asset_files" WHERE "asset_files"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  Rendered estimates/_technical_file_fields.html.haml (7.0ms)
  Rendered estimates/_discount.html.haml (7.8ms)
  Rendered estimates/_stages.html.haml (19.9ms)
  Rendered estimates/_form.html.haml (119.0ms)
  Rendered estimates/edit.html.haml within layouts/application (123.0ms)
  Rendered layouts/_header.html.haml (10.9ms)
Completed 200 OK in 1935ms (Views: 1738.6ms | ActiveRecord: 55.8ms)


Started GET "/estimates/2/edit" for 127.0.0.1 at 2017-04-26 23:16:22 +0300
Processing by EstimatesController#edit as HTML
  Parameters: {"id"=>"2"}
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (0.7ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = 1[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.8ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (1.3ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (0.8ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.6ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mUnit Load (1.1ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  [1m[36mProductTemplateSet Load (0.7ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (0.7ms)[0m  [1m[34mSELECT  "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.7ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mStage Load (0.9ms)[0m  [1m[34mSELECT "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mStageProduct Load (0.7ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" IN (4, 5, 6)[0m
  [1m[36mStageProduct Load (0.6ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 4]]
  [1m[36mStageProductSet Load (0.8ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 4[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 1[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mStageProduct Load (2.5ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 5]]
  [1m[36mStageProductSet Load (0.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 5[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 2[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mStageProduct Load (0.8ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 6]]
  [1m[36mStageProductSet Load (0.8ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 6[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 3[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mStageProductSet Load (0.7ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = $1[0m  [["stage_product_id", 6]]
  [1m[36mStageProductSetValue Load (0.7ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = 2[0m
  [1m[36mProductSet Load (0.8ms)[0m  [1m[34mSELECT  "product_sets".* FROM "product_sets" WHERE "product_sets"."deleted_at" IS NULL AND "product_sets"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStageProductSetValue Load (1.0ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1[0m  [["stage_product_set_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  Rendering estimates/edit.html.haml within layouts/application
  [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (12.5ms)
  [1m[36mClientFile Load (0.7ms)[0m  [1m[34mSELECT "client_files".* FROM "client_files" WHERE "client_files"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mAssetFile Load (0.3ms)[0m  [1m[34mSELECT  "asset_files".* FROM "asset_files" WHERE "asset_files"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendered estimates/_client_file_fields.html.haml (23.0ms)
  Rendered estimates/_technical_file_fields.html.haml (8.2ms)
  [1m[36mTechnicalFile Load (0.5ms)[0m  [1m[34mSELECT "technical_files".* FROM "technical_files" WHERE "technical_files"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mAssetFile Load (0.4ms)[0m  [1m[34mSELECT  "asset_files".* FROM "asset_files" WHERE "asset_files"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  Rendered estimates/_technical_file_fields.html.haml (9.8ms)
  Rendered estimates/_discount.html.haml (11.6ms)
  Rendered estimates/_stages.html.haml (28.3ms)
  Rendered estimates/_form.html.haml (242.3ms)
  Rendered estimates/edit.html.haml within layouts/application (246.4ms)
  Rendered layouts/_header.html.haml (29.8ms)
Completed 200 OK in 1462ms (Views: 858.9ms | ActiveRecord: 123.4ms)


Started GET "/estimates/2/edit" for 127.0.0.1 at 2017-04-26 23:17:30 +0300
Processing by EstimatesController#edit as HTML
  Parameters: {"id"=>"2"}
  [1m[36mProduct Load (6.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (0.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (0.6ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = 1[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.6ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (1.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (1.1ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.9ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  [1m[36mProductTemplateSet Load (0.6ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (4.1ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (2.5ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUnit Load (3.8ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (3.0ms)[0m  [1m[34mSELECT  "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (1.1ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mStage Load (0.6ms)[0m  [1m[34mSELECT "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mStageProduct Load (0.6ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" IN (4, 5, 6)[0m
  [1m[36mStageProduct Load (0.6ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 4]]
  [1m[36mStageProductSet Load (2.2ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 4[0m
  [1m[36mProduct Load (1.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 1[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mStageProduct Load (5.3ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 5]]
  [1m[36mStageProductSet Load (0.5ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 5[0m
  [1m[36mProduct Load (3.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 2[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mStageProduct Load (0.8ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 6]]
  [1m[36mStageProductSet Load (0.8ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 6[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 3[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mStageProductSet Load (0.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = $1[0m  [["stage_product_id", 6]]
  [1m[36mStageProductSetValue Load (0.7ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = 2[0m
  [1m[36mProductSet Load (0.6ms)[0m  [1m[34mSELECT  "product_sets".* FROM "product_sets" WHERE "product_sets"."deleted_at" IS NULL AND "product_sets"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStageProductSetValue Load (3.6ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1[0m  [["stage_product_set_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  Rendering estimates/edit.html.haml within layouts/application
  [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (5.2ms)
  [1m[36mClientFile Load (0.7ms)[0m  [1m[34mSELECT "client_files".* FROM "client_files" WHERE "client_files"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mAssetFile Load (0.9ms)[0m  [1m[34mSELECT  "asset_files".* FROM "asset_files" WHERE "asset_files"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendered estimates/_client_file_fields.html.haml (15.1ms)
  Rendered estimates/_technical_file_fields.html.haml (5.0ms)
  [1m[36mTechnicalFile Load (0.6ms)[0m  [1m[34mSELECT "technical_files".* FROM "technical_files" WHERE "technical_files"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mAssetFile Load (1.1ms)[0m  [1m[34mSELECT  "asset_files".* FROM "asset_files" WHERE "asset_files"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  Rendered estimates/_technical_file_fields.html.haml (8.6ms)
  Rendered estimates/_discount.html.haml (11.7ms)
  Rendered estimates/_stages.html.haml (29.5ms)
  Rendered estimates/_form.html.haml (162.9ms)
  Rendered estimates/edit.html.haml within layouts/application (168.0ms)
  Rendered layouts/_header.html.haml (8.2ms)
Completed 200 OK in 2026ms (Views: 1809.0ms | ActiveRecord: 60.4ms)


Started GET "/estimates/2/edit" for 127.0.0.1 at 2017-04-26 23:17:53 +0300
Processing by EstimatesController#edit as HTML
  Parameters: {"id"=>"2"}
  [1m[36mProduct Load (2.9ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (2.9ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (0.6ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = 1[0m
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (1.4ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (0.9ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.7ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  [1m[36mProductTemplateSet Load (0.7ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.9ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (3.4ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (2.4ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (0.8ms)[0m  [1m[34mSELECT  "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.5ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mStage Load (0.7ms)[0m  [1m[34mSELECT "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mStageProduct Load (0.7ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" IN (4, 5, 6)[0m
  [1m[36mStageProduct Load (1.5ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 4]]
  [1m[36mStageProductSet Load (2.2ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 4[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 1[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mStageProduct Load (0.7ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 5]]
  [1m[36mStageProductSet Load (0.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 5[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 2[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mStageProduct Load (0.7ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 6]]
  [1m[36mStageProductSet Load (0.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 6[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 3[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mStageProductSet Load (0.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = $1[0m  [["stage_product_id", 6]]
  [1m[36mStageProductSetValue Load (4.1ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = 2[0m
  [1m[36mProductSet Load (0.8ms)[0m  [1m[34mSELECT  "product_sets".* FROM "product_sets" WHERE "product_sets"."deleted_at" IS NULL AND "product_sets"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStageProductSetValue Load (0.9ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1[0m  [["stage_product_set_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  Rendering estimates/edit.html.haml within layouts/application
  [1m[36mClient Load (2.4ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (4.1ms)
  [1m[36mClientFile Load (1.7ms)[0m  [1m[34mSELECT "client_files".* FROM "client_files" WHERE "client_files"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mAssetFile Load (0.8ms)[0m  [1m[34mSELECT  "asset_files".* FROM "asset_files" WHERE "asset_files"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendered estimates/_client_file_fields.html.haml (8.0ms)
  Rendered estimates/_technical_file_fields.html.haml (3.2ms)
  [1m[36mTechnicalFile Load (2.4ms)[0m  [1m[34mSELECT "technical_files".* FROM "technical_files" WHERE "technical_files"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mAssetFile Load (0.4ms)[0m  [1m[34mSELECT  "asset_files".* FROM "asset_files" WHERE "asset_files"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  Rendered estimates/_technical_file_fields.html.haml (7.0ms)
  Rendered estimates/_discount.html.haml (10.3ms)
  Rendered estimates/_stages.html.haml (18.1ms)
  Rendered estimates/_form.html.haml (110.7ms)
  Rendered estimates/edit.html.haml within layouts/application (113.9ms)
  Rendered layouts/_header.html.haml (8.2ms)
Completed 200 OK in 1785ms (Views: 1621.4ms | ActiveRecord: 51.1ms)


Started GET "/estimates/2/edit" for 127.0.0.1 at 2017-04-26 23:18:41 +0300
Processing by EstimatesController#edit as HTML
  Parameters: {"id"=>"2"}
  [1m[36mProduct Load (2.5ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (1.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (2.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = 1[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.8ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (1.8ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (0.9ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.6ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mConstructorObject Load (1.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mUnit Load (8.9ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  [1m[36mProductTemplateSet Load (0.6ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUnit Load (1.9ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (1.8ms)[0m  [1m[34mSELECT  "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.4ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mStage Load (0.6ms)[0m  [1m[34mSELECT "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mStageProduct Load (1.6ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" IN (4, 5, 6)[0m
  [1m[36mStageProduct Load (0.6ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 4]]
  [1m[36mStageProductSet Load (0.5ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 4[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 1[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mStageProduct Load (2.0ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 5]]
  [1m[36mStageProductSet Load (0.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 5[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 2[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mStageProduct Load (2.1ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 6]]
  [1m[36mStageProductSet Load (0.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 6[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 3[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mStageProductSet Load (1.5ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = $1[0m  [["stage_product_id", 6]]
  [1m[36mStageProductSetValue Load (0.6ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = 2[0m
  [1m[36mProductSet Load (1.3ms)[0m  [1m[34mSELECT  "product_sets".* FROM "product_sets" WHERE "product_sets"."deleted_at" IS NULL AND "product_sets"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStageProductSetValue Load (0.6ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1[0m  [["stage_product_set_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  Rendering estimates/edit.html.haml within layouts/application
  [1m[36mClient Load (2.5ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (2.9ms)
  [1m[36mClientFile Load (0.6ms)[0m  [1m[34mSELECT "client_files".* FROM "client_files" WHERE "client_files"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mAssetFile Load (1.5ms)[0m  [1m[34mSELECT  "asset_files".* FROM "asset_files" WHERE "asset_files"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendered estimates/_client_file_fields.html.haml (7.0ms)
  Rendered estimates/_technical_file_fields.html.haml (2.8ms)
  [1m[36mTechnicalFile Load (2.3ms)[0m  [1m[34mSELECT "technical_files".* FROM "technical_files" WHERE "technical_files"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mAssetFile Load (1.9ms)[0m  [1m[34mSELECT  "asset_files".* FROM "asset_files" WHERE "asset_files"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  Rendered estimates/_technical_file_fields.html.haml (7.1ms)
  Rendered estimates/_discount.html.haml (6.2ms)
  Rendered estimates/_stages.html.haml (15.9ms)
  Rendered estimates/_form.html.haml (100.3ms)
  Rendered estimates/edit.html.haml within layouts/application (103.2ms)
  Rendered layouts/_header.html.haml (7.4ms)
Completed 200 OK in 1685ms (Views: 1534.2ms | ActiveRecord: 56.6ms)


Started GET "/estimates/2/edit" for 127.0.0.1 at 2017-04-26 23:19:01 +0300
Processing by EstimatesController#edit as HTML
  Parameters: {"id"=>"2"}
  [1m[36mProduct Load (1.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (0.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (0.6ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = 1[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.6ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (0.8ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.6ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  [1m[36mProductTemplateSet Load (1.1ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (1.9ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (3.6ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (1.2ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (1.5ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (1.2ms)[0m  [1m[34mSELECT  "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.9ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mStage Load (0.7ms)[0m  [1m[34mSELECT "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mStageProduct Load (0.7ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" IN (4, 5, 6)[0m
  [1m[36mStageProduct Load (0.6ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 4]]
  [1m[36mStageProductSet Load (0.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 4[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 1[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mStageProduct Load (0.7ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 5]]
  [1m[36mStageProductSet Load (0.7ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 5[0m
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 2[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mStageProduct Load (0.7ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 6]]
  [1m[36mStageProductSet Load (1.3ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 6[0m
  [1m[36mProduct Load (1.1ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 3[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mStageProductSet Load (0.5ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = $1[0m  [["stage_product_id", 6]]
  [1m[36mStageProductSetValue Load (0.6ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = 2[0m
  [1m[36mProductSet Load (2.6ms)[0m  [1m[34mSELECT  "product_sets".* FROM "product_sets" WHERE "product_sets"."deleted_at" IS NULL AND "product_sets"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStageProductSetValue Load (0.7ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1[0m  [["stage_product_set_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  Rendering estimates/edit.html.haml within layouts/application
  [1m[36mClient Load (0.5ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (6.2ms)
  [1m[36mClientFile Load (0.6ms)[0m  [1m[34mSELECT "client_files".* FROM "client_files" WHERE "client_files"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mAssetFile Load (0.3ms)[0m  [1m[34mSELECT  "asset_files".* FROM "asset_files" WHERE "asset_files"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendered estimates/_client_file_fields.html.haml (9.2ms)
  Rendered estimates/_technical_file_fields.html.haml (3.8ms)
  [1m[36mTechnicalFile Load (0.5ms)[0m  [1m[34mSELECT "technical_files".* FROM "technical_files" WHERE "technical_files"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mAssetFile Load (0.3ms)[0m  [1m[34mSELECT  "asset_files".* FROM "asset_files" WHERE "asset_files"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  Rendered estimates/_technical_file_fields.html.haml (6.6ms)
  Rendered estimates/_discount.html.haml (7.7ms)
  Rendered estimates/_stages.html.haml (17.7ms)
  Rendered estimates/_form.html.haml (109.0ms)
  Rendered estimates/edit.html.haml within layouts/application (111.9ms)
  Rendered layouts/_header.html.haml (53.6ms)
Completed 200 OK in 1677ms (Views: 1513.5ms | ActiveRecord: 39.6ms)


Started GET "/estimates/2/edit" for 127.0.0.1 at 2017-04-26 23:19:44 +0300
Processing by EstimatesController#edit as HTML
  Parameters: {"id"=>"2"}
  [1m[36mProduct Load (2.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (3.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (4.8ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.9ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = 1[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.7ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (0.9ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.7ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mUnit Load (2.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  [1m[36mProductTemplateSet Load (0.6ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.5ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.5ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (1.1ms)[0m  [1m[34mSELECT  "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.5ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mStage Load (1.4ms)[0m  [1m[34mSELECT "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mStageProduct Load (0.7ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" IN (4, 5, 6)[0m
  [1m[36mStageProduct Load (0.7ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 4]]
  [1m[36mStageProductSet Load (1.2ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 4[0m
  [1m[36mProduct Load (2.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 1[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mStageProduct Load (0.6ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 5]]
  [1m[36mStageProductSet Load (0.7ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 5[0m
  [1m[36mProduct Load (1.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 2[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mStageProduct Load (0.7ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 6]]
  [1m[36mStageProductSet Load (0.5ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 6[0m
  [1m[36mProduct Load (1.2ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 3[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mStageProductSet Load (0.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = $1[0m  [["stage_product_id", 6]]
  [1m[36mStageProductSetValue Load (1.1ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = 2[0m
  [1m[36mProductSet Load (0.7ms)[0m  [1m[34mSELECT  "product_sets".* FROM "product_sets" WHERE "product_sets"."deleted_at" IS NULL AND "product_sets"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStageProductSetValue Load (0.6ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1[0m  [["stage_product_set_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  Rendering estimates/edit.html.haml within layouts/application
  [1m[36mClient Load (0.5ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (4.1ms)
  [1m[36mClientFile Load (0.8ms)[0m  [1m[34mSELECT "client_files".* FROM "client_files" WHERE "client_files"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mAssetFile Load (1.8ms)[0m  [1m[34mSELECT  "asset_files".* FROM "asset_files" WHERE "asset_files"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendered estimates/_client_file_fields.html.haml (8.8ms)
  Rendered estimates/_technical_file_fields.html.haml (4.2ms)
  [1m[36mTechnicalFile Load (0.7ms)[0m  [1m[34mSELECT "technical_files".* FROM "technical_files" WHERE "technical_files"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mAssetFile Load (0.7ms)[0m  [1m[34mSELECT  "asset_files".* FROM "asset_files" WHERE "asset_files"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  Rendered estimates/_technical_file_fields.html.haml (14.0ms)
  Rendered estimates/_discount.html.haml (18.5ms)
  Rendered estimates/_stages.html.haml (27.2ms)
  Rendered estimates/_form.html.haml (150.6ms)
  Rendered estimates/edit.html.haml within layouts/application (153.9ms)
  Rendered layouts/_header.html.haml (11.3ms)
Completed 200 OK in 1884ms (Views: 1709.3ms | ActiveRecord: 45.1ms)


Started GET "/estimates" for 127.0.0.1 at 2017-04-26 23:27:06 +0300
Processing by EstimatesController#index as HTML
  [1m[36mUser Load (4.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering estimates/index.html.haml within layouts/application
  [1m[36mEstimate Load (0.6ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL[0m
  Rendered estimates/_listing.html.haml (8.9ms)
  Rendered estimates/_listing.html.haml (1.5ms)
  Rendered estimates/index.html.haml within layouts/application (27.9ms)
  Rendered layouts/_header.html.haml (7.9ms)
Completed 200 OK in 880ms (Views: 867.8ms | ActiveRecord: 5.2ms)


Started GET "/estimates/new" for 127.0.0.1 at 2017-04-26 23:27:09 +0300
Processing by EstimatesController#new as HTML
  [1m[36mProduct Load (2.2ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (7.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (4.6ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = 1[0m
  [1m[36mProduct Load (2.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.9ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (1.0ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.8ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mUnit Load (0.9ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  [1m[36mProductTemplateSet Load (0.7ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.8ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.5ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (1.4ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", nil], ["LIMIT", 1]]
Completed 404 Not Found in 104ms (ActiveRecord: 31.0ms)


  
ActiveRecord::RecordNotFound (Couldn't find Expense with 'id'=):
  
app/controllers/estimates_controller.rb:19:in `new'
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/diagnostics.html.erb within rescues/layout
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_source.html.erb
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_source.html.erb (4.8ms)
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (2.5ms)
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_request_and_response.html.erb
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_request_and_response.html.erb (0.9ms)
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/diagnostics.html.erb within rescues/layout (31.2ms)
Started GET "/estimates/new" for 127.0.0.1 at 2017-04-26 23:28:07 +0300
Processing by EstimatesController#new as HTML
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (3.8ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.9ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = 1[0m
  [1m[36mProduct Load (1.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (1.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (1.5ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (0.9ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (1.4ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mUnit Load (1.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  [1m[36mProductTemplateSet Load (0.7ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (1.2ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.3ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", nil], ["LIMIT", 1]]
Completed 404 Not Found in 403ms (ActiveRecord: 75.2ms)


  
ActiveRecord::RecordNotFound (Couldn't find Expense with 'id'=):
  
app/controllers/estimates_controller.rb:19:in `new'
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/diagnostics.html.erb within rescues/layout
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_source.html.erb
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_source.html.erb (4.7ms)
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (2.0ms)
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_request_and_response.html.erb
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_request_and_response.html.erb (0.9ms)
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/diagnostics.html.erb within rescues/layout (28.9ms)
DEPRECATION WARNING: to_cleanup is deprecated and will be removed from Rails 5.1 (use ActiveSupport::Reloader.to_complete instead) (called from <top (required)> at /home/g1nc/Development/ruby/constructor/config/environment.rb:5)
Started GET "/estimates/new" for 127.0.0.1 at 2017-04-26 23:28:26 +0300
  [1m[36mActiveRecord::SchemaMigration Load (0.8ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
Processing by EstimatesController#new as HTML
  [1m[36mProduct Load (1.1ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (0.9ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.9ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = 1[0m
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (3.1ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.9ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (3.2ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.7ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.9ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  [1m[36mProductTemplateSet Load (0.7ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (1.2ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (3.2ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUnit Load (1.1ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.8ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering estimates/new.html.haml within layouts/application
  [1m[36mClient Load (1.0ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (1793.9ms)
  Rendered estimates/_technical_file_fields.html.haml (8.1ms)
  Rendered estimates/_discount.html.haml (8.6ms)
  Rendered estimates/_stages.html.haml (18.5ms)
  Rendered estimates/_form.html.haml (1954.3ms)
  Rendered estimates/new.html.haml within layouts/application (1963.1ms)
  Rendered layouts/_header.html.haml (26.8ms)
Completed 200 OK in 2988ms (Views: 2559.5ms | ActiveRecord: 91.5ms)


Started GET "/expenses" for 127.0.0.1 at 2017-04-26 23:28:58 +0300
Processing by ExpensesController#index as HTML
  [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering expenses/index.html.haml within layouts/application
  [1m[36mExpense Load (1.9ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" ORDER BY "expenses"."id" ASC[0m
  [1m[36mExpense Load (0.6ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses"[0m
  Rendered expenses/index.html.haml within layouts/application (14.2ms)
  Rendered layouts/_header.html.haml (10.8ms)
Completed 200 OK in 638ms (Views: 625.9ms | ActiveRecord: 3.6ms)


Started POST "/expenses" for 127.0.0.1 at 2017-04-26 23:29:02 +0300
Processing by ExpensesController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"oy3M1qvrcyQ35RFNunaPRHSmuWSFoiSWazR6qHjG6owvnM9f8TN5RRI1jb3H9I8EDztrh6fZ1PzRG0V3a9pInQ==", "values"=>{"1"=>"5", "2"=>"0", "3"=>"0", "4"=>"0", "5"=>"0"}}
  [1m[36mUser Load (2.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (1.8ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mAudited::Audit Load (6.2ms)[0m  [1m[34mSELECT  "audits".* FROM "audits" WHERE "audits"."auditable_id" = $1 AND "audits"."auditable_type" = $2 ORDER BY "audits"."version" DESC LIMIT $3[0m  [["auditable_id", 1], ["auditable_type", "Expense"], ["LIMIT", 1]]
  [1m[35mSQL (3.5ms)[0m  [1m[32mINSERT INTO "audits" ("auditable_id", "auditable_type", "user_id", "user_type", "action", "audited_changes", "version", "remote_address", "request_uuid", "created_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["auditable_id", 1], ["auditable_type", "Expense"], ["user_id", 1], ["user_type", "User"], ["action", "update"], ["audited_changes", "---\npercent:\n- !ruby/object:BigDecimal 18:0.0\n- !ruby/object:BigDecimal 18:0.5E1\n"], ["version", 1], ["remote_address", "127.0.0.1"], ["request_uuid", "780889df-1029-4cdf-9421-ce3588967650"], ["created_at", 2017-04-26 20:29:02 UTC]]
  [1m[35mSQL (0.6ms)[0m  [1m[33mUPDATE "expenses" SET "percent" = $1, "updated_at" = $2 WHERE "expenses"."id" = $3[0m  [["percent", #<BigDecimal:561d14a9c338,'0.5E1',9(18)>], ["updated_at", 2017-04-26 20:29:02 UTC], ["id", 1]]
  [1m[35m (3.7ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mExpense Load (0.9ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mExpense Load (0.5ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (2.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mExpense Load (1.1ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.6ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mExpense Load (0.6ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
Redirected to http://localhost:3000/expenses
Completed 302 Found in 86ms (ActiveRecord: 30.3ms)


Started GET "/expenses" for 127.0.0.1 at 2017-04-26 23:29:02 +0300
Processing by ExpensesController#index as HTML
  [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering expenses/index.html.haml within layouts/application
  [1m[36mExpense Load (1.1ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses" ORDER BY "expenses"."id" ASC[0m
  [1m[36mExpense Load (0.6ms)[0m  [1m[34mSELECT "expenses".* FROM "expenses"[0m
  Rendered expenses/index.html.haml within layouts/application (9.1ms)
  Rendered layouts/_header.html.haml (9.9ms)
Completed 200 OK in 592ms (Views: 585.3ms | ActiveRecord: 2.7ms)


Started GET "/estimates/new" for 127.0.0.1 at 2017-04-26 23:29:06 +0300
Processing by EstimatesController#new as HTML
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (2.2ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (12.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = 1[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.6ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (0.9ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (2.6ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.5ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mUnit Load (1.2ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  [1m[36mProductTemplateSet Load (0.6ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.5ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (1.8ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (2.4ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUnit Load (2.0ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (2.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (2.3ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering estimates/new.html.haml within layouts/application
  [1m[36mClient Load (0.6ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (8.7ms)
  Rendered estimates/_technical_file_fields.html.haml (3.9ms)
  Rendered estimates/_discount.html.haml (7.2ms)
  Rendered estimates/_stages.html.haml (24.8ms)
  Rendered estimates/_form.html.haml (87.6ms)
  Rendered estimates/new.html.haml within layouts/application (92.7ms)
  Rendered layouts/_header.html.haml (15.4ms)
Completed 200 OK in 813ms (Views: 693.9ms | ActiveRecord: 38.7ms)


Started GET "/estimates" for 127.0.0.1 at 2017-04-26 23:30:22 +0300
Processing by EstimatesController#index as HTML
  [1m[36mUser Load (1.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering estimates/index.html.haml within layouts/application
  [1m[36mEstimate Load (0.9ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL[0m
  Rendered estimates/_listing.html.haml (6.2ms)
  Rendered estimates/_listing.html.haml (1.0ms)
  Rendered estimates/index.html.haml within layouts/application (20.0ms)
  Rendered layouts/_header.html.haml (10.0ms)
Completed 200 OK in 610ms (Views: 602.3ms | ActiveRecord: 2.8ms)


Started GET "/estimates/1/edit" for 127.0.0.1 at 2017-04-26 23:30:24 +0300
Processing by EstimatesController#edit as HTML
  Parameters: {"id"=>"1"}
  [1m[36mProduct Load (1.3ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (3.2ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (7.1ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = 1[0m
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.6ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.5ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (1.1ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.6ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.8ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  [1m[36mProductTemplateSet Load (0.6ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.8ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (3.6ms)[0m  [1m[34mSELECT  "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.4ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStage Load (0.7ms)[0m  [1m[34mSELECT "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1[0m  [["estimate_id", 1]]
  [1m[36mStageProduct Load (0.7ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" IN (1, 2, 3)[0m
  [1m[36mStageProduct Load (0.7ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 1]]
  [1m[36mStageProductSet Load (0.7ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 1[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 1[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mStageProduct Load (0.5ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 2]]
  [1m[36mStageProductSet Load (0.5ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 2[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 2[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mStageProduct Load (0.6ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 3]]
  [1m[36mStageProductSet Load (0.5ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 3[0m
  [1m[36mProduct Load (0.9ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 3[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mStageProductSet Load (0.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = $1[0m  [["stage_product_id", 3]]
  [1m[36mStageProductSetValue Load (0.8ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = 1[0m
  [1m[36mProductSet Load (0.7ms)[0m  [1m[34mSELECT  "product_sets".* FROM "product_sets" WHERE "product_sets"."deleted_at" IS NULL AND "product_sets"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStageProductSetValue Load (1.6ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1[0m  [["stage_product_set_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  Rendering estimates/edit.html.haml within layouts/application
  [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (3.4ms)
  [1m[36mClientFile Load (1.0ms)[0m  [1m[34mSELECT "client_files".* FROM "client_files" WHERE "client_files"."estimate_id" = $1[0m  [["estimate_id", 1]]
  Rendered estimates/_technical_file_fields.html.haml (3.2ms)
  [1m[36mTechnicalFile Load (0.8ms)[0m  [1m[34mSELECT "technical_files".* FROM "technical_files" WHERE "technical_files"."estimate_id" = $1[0m  [["estimate_id", 1]]
  Rendered estimates/_discount.html.haml (8.2ms)
  Rendered estimates/_stages.html.haml (18.2ms)
  Rendered estimates/_form.html.haml (82.3ms)
  Rendered estimates/edit.html.haml within layouts/application (85.4ms)
  Rendered layouts/_header.html.haml (11.0ms)
Completed 200 OK in 1052ms (Views: 823.8ms | ActiveRecord: 60.3ms)


Started GET "/estimates/1/edit" for 127.0.0.1 at 2017-04-26 23:40:29 +0300
Processing by EstimatesController#edit as HTML
  Parameters: {"id"=>"1"}
  [1m[36mProduct Load (3.3ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (3.2ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (0.8ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = 1[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.7ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.9ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (0.9ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.6ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.8ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  [1m[36mProductTemplateSet Load (0.8ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUnit Load (1.5ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (0.8ms)[0m  [1m[34mSELECT  "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.5ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStage Load (0.7ms)[0m  [1m[34mSELECT "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1[0m  [["estimate_id", 1]]
  [1m[36mStageProduct Load (0.7ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" IN (1, 2, 3)[0m
  [1m[36mStageProduct Load (0.6ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 1]]
  [1m[36mStageProductSet Load (0.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 1[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 1[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mStageProduct Load (0.7ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 2]]
  [1m[36mStageProductSet Load (0.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 2[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 2[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mStageProduct Load (0.7ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 3]]
  [1m[36mStageProductSet Load (0.8ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 3[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 3[0m
  [1m[36mCACHE (0.1ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mStageProductSet Load (0.7ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = $1[0m  [["stage_product_id", 3]]
  [1m[36mStageProductSetValue Load (0.8ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = 1[0m
  [1m[36mProductSet Load (0.6ms)[0m  [1m[34mSELECT  "product_sets".* FROM "product_sets" WHERE "product_sets"."deleted_at" IS NULL AND "product_sets"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStageProductSetValue Load (0.6ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1[0m  [["stage_product_set_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  Rendering estimates/edit.html.haml within layouts/application
  [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (4.9ms)
  [1m[36mClientFile Load (0.8ms)[0m  [1m[34mSELECT "client_files".* FROM "client_files" WHERE "client_files"."estimate_id" = $1[0m  [["estimate_id", 1]]
  Rendered estimates/_technical_file_fields.html.haml (5.2ms)
  [1m[36mTechnicalFile Load (0.6ms)[0m  [1m[34mSELECT "technical_files".* FROM "technical_files" WHERE "technical_files"."estimate_id" = $1[0m  [["estimate_id", 1]]
  Rendered estimates/_discount.html.haml (17.9ms)
  Rendered estimates/_stages.html.haml (22.4ms)
  Rendered estimates/_form.html.haml (116.4ms)
  Rendered estimates/edit.html.haml within layouts/application (120.0ms)
  Rendered layouts/_header.html.haml (9.8ms)
Completed 200 OK in 1934ms (Views: 1774.2ms | ActiveRecord: 36.3ms)


Started GET "/estimates/1/edit" for 127.0.0.1 at 2017-04-26 23:46:28 +0300
Processing by EstimatesController#edit as HTML
  Parameters: {"id"=>"1"}
  [1m[36mProduct Load (1.2ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (4.4ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (1.5ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.5ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = 1[0m
  [1m[36mProduct Load (1.1ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (2.4ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.6ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (1.9ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (2.9ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (2.7ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (1.1ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  [1m[36mProductTemplateSet Load (0.7ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.8ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (1.4ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (0.7ms)[0m  [1m[34mSELECT  "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.3ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStage Load (0.6ms)[0m  [1m[34mSELECT "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1[0m  [["estimate_id", 1]]
  [1m[36mStageProduct Load (0.5ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" IN (1, 2, 3)[0m
  [1m[36mStageProduct Load (0.5ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 1]]
  [1m[36mStageProductSet Load (0.5ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 1[0m
  [1m[36mProduct Load (0.5ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 1[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mStageProduct Load (0.5ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 2]]
  [1m[36mStageProductSet Load (2.8ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 2[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 2[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mStageProduct Load (0.5ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 3]]
  [1m[36mStageProductSet Load (2.0ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 3[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 3[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mStageProductSet Load (0.5ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = $1[0m  [["stage_product_id", 3]]
  [1m[36mStageProductSetValue Load (0.7ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = 1[0m
  [1m[36mProductSet Load (0.7ms)[0m  [1m[34mSELECT  "product_sets".* FROM "product_sets" WHERE "product_sets"."deleted_at" IS NULL AND "product_sets"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStageProductSetValue Load (0.6ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1[0m  [["stage_product_set_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  Rendering estimates/edit.html.haml within layouts/application
  [1m[36mClient Load (1.5ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (3.7ms)
  [1m[36mClientFile Load (0.4ms)[0m  [1m[34mSELECT "client_files".* FROM "client_files" WHERE "client_files"."estimate_id" = $1[0m  [["estimate_id", 1]]
  Rendered estimates/_technical_file_fields.html.haml (4.0ms)
  [1m[36mTechnicalFile Load (0.6ms)[0m  [1m[34mSELECT "technical_files".* FROM "technical_files" WHERE "technical_files"."estimate_id" = $1[0m  [["estimate_id", 1]]
  Rendered estimates/_discount.html.haml (11.9ms)
  Rendered estimates/_stages.html.haml (24.8ms)
  Rendered estimates/_form.html.haml (127.9ms)
  Rendered estimates/edit.html.haml within layouts/application (132.8ms)
  Rendered layouts/_header.html.haml (9.4ms)
Completed 200 OK in 2074ms (Views: 1931.6ms | ActiveRecord: 44.8ms)


Started GET "/estimates/1/edit" for 127.0.0.1 at 2017-04-26 23:50:32 +0300
Processing by EstimatesController#edit as HTML
  Parameters: {"id"=>"1"}
  [1m[36mProduct Load (1.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (4.1ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (1.6ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.5ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = 1[0m
  [1m[36mProduct Load (1.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.7ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (0.8ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (1.8ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (2.4ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mConstructorObject Load (1.9ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  [1m[36mProductTemplateSet Load (1.5ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.9ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (1.8ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (1.8ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (1.6ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUnit Load (1.2ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (2.1ms)[0m  [1m[34mSELECT  "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (1.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.5ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStage Load (2.1ms)[0m  [1m[34mSELECT "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1[0m  [["estimate_id", 1]]
  [1m[36mStageProduct Load (1.1ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" IN (1, 2, 3)[0m
  [1m[36mStageProduct Load (6.4ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 1]]
  [1m[36mStageProductSet Load (0.5ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 1[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 1[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mStageProduct Load (2.0ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 2]]
  [1m[36mStageProductSet Load (0.5ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 2[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 2[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mStageProduct Load (2.4ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 3]]
  [1m[36mStageProductSet Load (2.3ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 3[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 3[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mStageProductSet Load (0.5ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = $1[0m  [["stage_product_id", 3]]
  [1m[36mStageProductSetValue Load (0.5ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = 1[0m
  [1m[36mProductSet Load (2.7ms)[0m  [1m[34mSELECT  "product_sets".* FROM "product_sets" WHERE "product_sets"."deleted_at" IS NULL AND "product_sets"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStageProductSetValue Load (0.7ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1[0m  [["stage_product_set_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  Rendering estimates/edit.html.haml within layouts/application
  [1m[36mClient Load (0.5ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (3.8ms)
  [1m[36mClientFile Load (0.9ms)[0m  [1m[34mSELECT "client_files".* FROM "client_files" WHERE "client_files"."estimate_id" = $1[0m  [["estimate_id", 1]]
  Rendered estimates/_technical_file_fields.html.haml (5.1ms)
  [1m[36mTechnicalFile Load (2.6ms)[0m  [1m[34mSELECT "technical_files".* FROM "technical_files" WHERE "technical_files"."estimate_id" = $1[0m  [["estimate_id", 1]]
  Rendered estimates/_discount.html.haml (9.4ms)
  Rendered estimates/_stages.html.haml (35.2ms)
  Rendered estimates/_form.html.haml (135.8ms)
  Rendered estimates/edit.html.haml within layouts/application (144.0ms)
  Rendered layouts/_header.html.haml (7.8ms)
Completed 200 OK in 2129ms (Views: 1942.8ms | ActiveRecord: 61.8ms)


Started GET "/estimates/1/edit" for 127.0.0.1 at 2017-04-26 23:50:46 +0300
Processing by EstimatesController#edit as HTML
  Parameters: {"id"=>"1"}
  [1m[36mProduct Load (1.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (2.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (0.7ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (1.1ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = 1[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.7ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (1.1ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (1.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (1.2ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.5ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  [1m[36mProductTemplateSet Load (0.6ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (1.0ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.5ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.5ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (1.1ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (1.0ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUnit Load (1.0ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (0.8ms)[0m  [1m[34mSELECT  "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.8ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStage Load (1.5ms)[0m  [1m[34mSELECT "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1[0m  [["estimate_id", 1]]
  [1m[36mStageProduct Load (0.5ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" IN (1, 2, 3)[0m
  [1m[36mStageProduct Load (3.4ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 1]]
  [1m[36mStageProductSet Load (1.2ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 1[0m
  [1m[36mProduct Load (1.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 1[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mStageProduct Load (0.5ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 2]]
  [1m[36mStageProductSet Load (0.4ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 2[0m
  [1m[36mProduct Load (1.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 2[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mStageProduct Load (0.5ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 3]]
  [1m[36mStageProductSet Load (0.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 3[0m
  [1m[36mProduct Load (1.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 3[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mStageProductSet Load (1.4ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = $1[0m  [["stage_product_id", 3]]
  [1m[36mStageProductSetValue Load (3.4ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = 1[0m
  [1m[36mProductSet Load (0.6ms)[0m  [1m[34mSELECT  "product_sets".* FROM "product_sets" WHERE "product_sets"."deleted_at" IS NULL AND "product_sets"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStageProductSetValue Load (0.6ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1[0m  [["stage_product_set_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  Rendering estimates/edit.html.haml within layouts/application
  [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (5.4ms)
  [1m[36mClientFile Load (0.5ms)[0m  [1m[34mSELECT "client_files".* FROM "client_files" WHERE "client_files"."estimate_id" = $1[0m  [["estimate_id", 1]]
  Rendered estimates/_technical_file_fields.html.haml (3.3ms)
  [1m[36mTechnicalFile Load (0.6ms)[0m  [1m[34mSELECT "technical_files".* FROM "technical_files" WHERE "technical_files"."estimate_id" = $1[0m  [["estimate_id", 1]]
  Rendered estimates/_discount.html.haml (7.4ms)
  Rendered estimates/_stages.html.haml (18.3ms)
  Rendered estimates/_form.html.haml (86.7ms)
  Rendered estimates/edit.html.haml within layouts/application (89.7ms)
  Rendered layouts/_header.html.haml (7.6ms)
Completed 200 OK in 1627ms (Views: 1487.2ms | ActiveRecord: 43.6ms)


Started GET "/estimates/1/edit" for 127.0.0.1 at 2017-04-26 23:53:46 +0300
Processing by EstimatesController#edit as HTML
  Parameters: {"id"=>"1"}
  [1m[36mProduct Load (1.4ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (0.6ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = 1[0m
  [1m[36mProduct Load (1.2ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (1.3ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (5.1ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.9ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (0.8ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.6ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.9ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mConstructorObject Load (0.9ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  [1m[36mProductTemplateSet Load (0.7ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.9ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.9ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (1.3ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (1.0ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (2.7ms)[0m  [1m[34mSELECT  "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.4ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStage Load (0.6ms)[0m  [1m[34mSELECT "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1[0m  [["estimate_id", 1]]
  [1m[36mStageProduct Load (1.9ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" IN (1, 2, 3)[0m
  [1m[36mStageProduct Load (0.6ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 1]]
  [1m[36mStageProductSet Load (0.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 1[0m
  [1m[36mProduct Load (1.2ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 1[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mStageProduct Load (0.9ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 2]]
  [1m[36mStageProductSet Load (0.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 2[0m
  [1m[36mProduct Load (1.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 2[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mStageProduct Load (1.0ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 3]]
  [1m[36mStageProductSet Load (0.7ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 3[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 3[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mStageProductSet Load (0.7ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = $1[0m  [["stage_product_id", 3]]
  [1m[36mStageProductSetValue Load (2.2ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = 1[0m
  [1m[36mProductSet Load (0.6ms)[0m  [1m[34mSELECT  "product_sets".* FROM "product_sets" WHERE "product_sets"."deleted_at" IS NULL AND "product_sets"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStageProductSetValue Load (4.6ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1[0m  [["stage_product_set_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  Rendering estimates/edit.html.haml within layouts/application
  [1m[36mClient Load (0.6ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (3.0ms)
  [1m[36mClientFile Load (1.0ms)[0m  [1m[34mSELECT "client_files".* FROM "client_files" WHERE "client_files"."estimate_id" = $1[0m  [["estimate_id", 1]]
  Rendered estimates/_technical_file_fields.html.haml (4.0ms)
  [1m[36mTechnicalFile Load (0.7ms)[0m  [1m[34mSELECT "technical_files".* FROM "technical_files" WHERE "technical_files"."estimate_id" = $1[0m  [["estimate_id", 1]]
  Rendered estimates/_discount.html.haml (6.7ms)
  Rendered estimates/_stages.html.haml (19.0ms)
  Rendered estimates/_form.html.haml (82.3ms)
  Rendered estimates/edit.html.haml within layouts/application (85.4ms)
  Rendered layouts/_header.html.haml (7.6ms)
Completed 200 OK in 1739ms (Views: 1590.7ms | ActiveRecord: 47.2ms)


Started PATCH "/estimates/1" for 127.0.0.1 at 2017-04-26 23:57:23 +0300
Processing by EstimatesController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"yybAOVqonxAcgYfumf7u80o1DAMAtcWcxC5ON+1zX0VHl8OwAHCVcTlRGx7kfO6zMaje4CLONfZ+AXHo/m/9VA==", "commit"=>"Сохранить", "estimate"=>{"price"=>"3056.9", "name"=>"Название", "client_id"=>"1", "area"=>"23", "first_floor_height"=>"124124.0", "second_floor_height_min"=>"0.0", "second_floor_height_max"=>"0.0", "third_floor_height_min"=>"0.0", "third_floor_height_max"=>"0.0", "discount_title"=>"Скидка", "discount_by_stages"=>{"0"=>"1", "1"=>"2", "2"=>"3"}}, "json_stages"=>"[{\"number\":1,\"text\":{\"name\":\"Первый этап\",\"summ\":\"Итого по первому этапу:\",\"summ_dis\":\"по первому этапу\",\"discount\":\"Итого по первому этапу со скидкой:\"},\"price\":2220,\"total_price\":2197.8,\"products\":[{\"id\":1,\"name\":\"Простой продукт 1 этап\",\"unit\":\"шт\",\"custom\":false,\"profit\":100,\"price\":10,\"quantity\":222,\"sets\":[]}]},{\"number\":2,\"text\":{\"name\":\"Второй этап\",\"summ\":\"Итого по двум этапам:\",\"summ_dis\":\"по второму этапу\",\"discount\":\"Итого по первому этапу со скидкой:\"},\"price\":550,\"total_price\":539,\"products\":[{\"id\":2,\"name\":\"Простой продукт 2 этап\",\"unit\":\"м3\",\"custom\":false,\"profit\":50,\"price\":50,\"quantity\":11,\"sets\":[]}]},{\"number\":3,\"text\":{\"name\":\"Третий этап\",\"summ\":\"Итого по трем этапам:\",\"summ_dis\":\"по третьему этапу\",\"discount\":\"Итого по первому этапу со скидкой:\"},\"price\":330,\"total_price\":320.1,\"products\":[{\"id\":3,\"name\":\"Конфигурируемый продукт 3 этап\",\"unit\":\"кг\",\"custom\":true,\"profit\":150,\"price\":330,\"quantity\":1,\"sets\":[{\"id\":1,\"name\":\"Сборка 1\",\"selected\":true,\"items\":[{\"id\":1,\"name\":\"Составляющая 1\",\"quantity\":11,\"value\":{\"id\":1,\"name\":\"Примитив 1\",\"unit\":\"лист\",\"price\":10}},{\"id\":2,\"name\":\"Составляющая 2\",\"quantity\":11,\"value\":{\"id\":2,\"name\":\"Примитив 2\",\"unit\":\"шт\",\"price\":20}}]}]}]}]", "data"=>"", "id"=>"1"}
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (0.7ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = 1[0m
  [1m[36mProduct Load (1.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.6ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (1.3ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (0.9ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (1.3ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  [1m[36mProductTemplateSet Load (1.1ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (1.4ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUnit Load (1.0ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (0.8ms)[0m  [1m[34mSELECT  "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Unpermitted parameters: second_floor_height_min, second_floor_height_max, third_floor_height_min, third_floor_height_max, discount_by_stages
  [1m[35m (1.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mClient Load (0.6ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAudited::Audit Load (1.7ms)[0m  [1m[34mSELECT  "audits".* FROM "audits" WHERE "audits"."auditable_id" = $1 AND "audits"."auditable_type" = $2 ORDER BY "audits"."version" DESC LIMIT $3[0m  [["auditable_id", 1], ["auditable_type", "Estimate"], ["LIMIT", 1]]
  [1m[35mSQL (4.0ms)[0m  [1m[32mINSERT INTO "audits" ("auditable_id", "auditable_type", "user_id", "user_type", "action", "audited_changes", "version", "remote_address", "request_uuid", "created_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["auditable_id", 1], ["auditable_type", "Estimate"], ["user_id", 1], ["user_type", "User"], ["action", "update"], ["audited_changes", "---\narea:\n- !ruby/object:BigDecimal 18:0.1E3\n- !ruby/object:BigDecimal 18:0.23E2\ndiscount_title:\n- ''\n- Скидка\n"], ["version", 8], ["remote_address", "127.0.0.1"], ["request_uuid", "0bb42328-2aa7-4bc4-97c9-db4546755b0c"], ["created_at", 2017-04-26 20:57:23 UTC]]
  [1m[35mSQL (1.7ms)[0m  [1m[33mUPDATE "estimates" SET "area" = $1, "discount_title" = $2, "updated_at" = $3 WHERE "estimates"."id" = $4[0m  [["area", #<BigDecimal:7f1f431e5d48,'0.23E2',9(18)>], ["discount_title", "Скидка"], ["updated_at", 2017-04-26 20:57:23 UTC], ["id", 1]]
  [1m[35m (2.6ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mStage Load (0.6ms)[0m  [1m[34mSELECT  "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1 AND "stages"."number" = $2 LIMIT $3[0m  [["estimate_id", 1], ["number", 1], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mStageProduct Load (1.0ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1 AND ("stage_products"."product_id" != 1)[0m  [["stage_id", 1]]
  [1m[36mStageProduct Load (1.1ms)[0m  [1m[34mSELECT  "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1 AND "stage_products"."product_id" = $2 LIMIT $3[0m  [["stage_id", 1], ["product_id", 1], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mStage Load (0.8ms)[0m  [1m[34mSELECT  "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1 AND "stages"."number" = $2 LIMIT $3[0m  [["estimate_id", 1], ["number", 2], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mStageProduct Load (0.6ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1 AND ("stage_products"."product_id" != 2)[0m  [["stage_id", 2]]
  [1m[36mStageProduct Load (0.6ms)[0m  [1m[34mSELECT  "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1 AND "stage_products"."product_id" = $2 LIMIT $3[0m  [["stage_id", 2], ["product_id", 2], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mStage Load (3.0ms)[0m  [1m[34mSELECT  "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1 AND "stages"."number" = $2 LIMIT $3[0m  [["estimate_id", 1], ["number", 3], ["LIMIT", 1]]
  [1m[35m (1.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mStageProduct Load (1.6ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1 AND ("stage_products"."product_id" != 3)[0m  [["stage_id", 3]]
  [1m[36mStageProduct Load (0.7ms)[0m  [1m[34mSELECT  "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1 AND "stage_products"."product_id" = $2 LIMIT $3[0m  [["stage_id", 3], ["product_id", 3], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mStageProductSet Load (1.0ms)[0m  [1m[34mSELECT  "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = $1 AND "stage_product_sets"."product_set_id" = $2 LIMIT $3[0m  [["stage_product_id", 3], ["product_set_id", 1], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mStageProductSetValue Load (0.7ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1 AND ("stage_product_set_values"."product_template_id" NOT IN (1, 2))[0m  [["stage_product_set_id", 1]]
  [1m[36mStageProductSetValue Load (0.8ms)[0m  [1m[34mSELECT  "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1 AND "stage_product_set_values"."product_template_id" = $2 LIMIT $3[0m  [["stage_product_set_id", 1], ["product_template_id", 1], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mStageProductSetValue Load (0.7ms)[0m  [1m[34mSELECT  "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1 AND "stage_product_set_values"."product_template_id" = $2 LIMIT $3[0m  [["stage_product_set_id", 1], ["product_template_id", 2], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mAudited::Audit Load (0.8ms)[0m  [1m[34mSELECT  "audits".* FROM "audits" WHERE "audits"."auditable_id" = $1 AND "audits"."auditable_type" = $2 ORDER BY "audits"."version" DESC LIMIT $3[0m  [["auditable_id", 1], ["auditable_type", "Estimate"], ["LIMIT", 1]]
  [1m[35mSQL (1.0ms)[0m  [1m[32mINSERT INTO "audits" ("auditable_id", "auditable_type", "user_id", "user_type", "action", "audited_changes", "version", "remote_address", "request_uuid", "created_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["auditable_id", 1], ["auditable_type", "Estimate"], ["user_id", 1], ["user_type", "User"], ["action", "update"], ["audited_changes", "---\nprice_by_area:\n- !ruby/object:BigDecimal 18:0.3057E2\n- !ruby/object:BigDecimal 36:0.13291E3\nprice_by_area_per_stage:\n- - !ruby/object:BigDecimal 18:0.222E2\n  - !ruby/object:BigDecimal 18:0.277E2\n  - !ruby/object:BigDecimal 18:0.31E2\n- - !ruby/object:BigDecimal 27:0.9652E2\n  - !ruby/object:BigDecimal 27:0.12043E3\n  - !ruby/object:BigDecimal 27:0.13478E3\nprice_by_area_per_stage_discounted:\n- - !ruby/object:BigDecimal 18:0.2198E2\n  - !ruby/object:BigDecimal 18:0.2759E2\n  - !ruby/object:BigDecimal 18:0.309E2\n- - !ruby/object:BigDecimal 36:0.9556E2\n  - !ruby/object:BigDecimal 27:0.11996E3\n  - !ruby/object:BigDecimal 36:0.13435E3\n"], ["version", 9], ["remote_address", "127.0.0.1"], ["request_uuid", "0bb42328-2aa7-4bc4-97c9-db4546755b0c"], ["created_at", 2017-04-26 20:57:23 UTC]]
  [1m[35mSQL (0.7ms)[0m  [1m[33mUPDATE "estimates" SET "price_by_area" = $1, "price_by_area_per_stage" = $2, "price_by_area_per_stage_discounted" = $3, "updated_at" = $4 WHERE "estimates"."id" = $5[0m  [["price_by_area", #<BigDecimal:7f1f41d653a0,'0.13291E3',18(45)>], ["price_by_area_per_stage", #<struct ActiveRecord::ConnectionAdapters::PostgreSQL::OID::Array::Data encoder=#<PG::TextEncoder::Array:0x00561d15d1e8f8 "decimal[]"  elements_type=nil needs quotation>, values=[#<BigDecimal:7f1f41da2c28,'0.9652E2',18(36)>, #<BigDecimal:7f1f41da0680,'0.12043E3',18(36)>, #<BigDecimal:7f1f41d91c70,'0.13478E3',18(36)>]>], ["price_by_area_per_stage_discounted", #<struct ActiveRecord::ConnectionAdapters::PostgreSQL::OID::Array::Data encoder=#<PG::TextEncoder::Array:0x00561d15d1e8f8 "decimal[]"  elements_type=nil needs quotation>, values=[#<BigDecimal:7f1f41da0bf8,'0.9556E2',18(45)>, #<BigDecimal:7f1f41d929e0,'0.11996E3',18(36)>, #<BigDecimal:7f1f41d87888,'0.13435E3',18(45)>]>], ["updated_at", 2017-04-26 20:57:23 UTC], ["id", 1]]
  [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
Redirected to http://localhost:3000/estimates
Completed 302 Found in 590ms (ActiveRecord: 128.4ms)


Started GET "/estimates" for 127.0.0.1 at 2017-04-26 23:57:23 +0300
Processing by EstimatesController#index as HTML
  [1m[36mUser Load (1.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering estimates/index.html.haml within layouts/application
  [1m[36mEstimate Load (2.6ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL[0m
  Rendered estimates/_listing.html.haml (3.1ms)
  Rendered estimates/_listing.html.haml (0.8ms)
  Rendered estimates/index.html.haml within layouts/application (25.0ms)
  Rendered layouts/_header.html.haml (32.3ms)
Completed 200 OK in 746ms (Views: 735.5ms | ActiveRecord: 4.5ms)


Started GET "/estimates/2/edit" for 127.0.0.1 at 2017-04-26 23:57:26 +0300
Processing by EstimatesController#edit as HTML
  Parameters: {"id"=>"2"}
  [1m[36mProduct Load (1.2ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (3.8ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (1.9ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.5ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = 1[0m
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (1.4ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.6ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (1.4ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (1.2ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (1.3ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (2.4ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.6ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (1.3ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mConstructorObject Load (0.5ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  [1m[36mProductTemplateSet Load (0.6ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (0.8ms)[0m  [1m[34mSELECT  "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.3ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStage Load (0.7ms)[0m  [1m[34mSELECT "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mStageProduct Load (0.8ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" IN (4, 5, 6)[0m
  [1m[36mStageProduct Load (0.5ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 4]]
  [1m[36mStageProductSet Load (0.5ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 4[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 1[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mStageProduct Load (0.8ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 5]]
  [1m[36mStageProductSet Load (0.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 5[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 2[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mStageProduct Load (0.7ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 6]]
  [1m[36mStageProductSet Load (0.4ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 6[0m
  [1m[36mProduct Load (1.1ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 3[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mStageProductSet Load (0.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = $1[0m  [["stage_product_id", 6]]
  [1m[36mStageProductSetValue Load (0.6ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = 2[0m
  [1m[36mProductSet Load (1.0ms)[0m  [1m[34mSELECT  "product_sets".* FROM "product_sets" WHERE "product_sets"."deleted_at" IS NULL AND "product_sets"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStageProductSetValue Load (0.6ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1[0m  [["stage_product_set_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  Rendering estimates/edit.html.haml within layouts/application
  [1m[36mClient Load (0.6ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (8.7ms)
  [1m[36mClientFile Load (1.1ms)[0m  [1m[34mSELECT "client_files".* FROM "client_files" WHERE "client_files"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mAssetFile Load (0.4ms)[0m  [1m[34mSELECT  "asset_files".* FROM "asset_files" WHERE "asset_files"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendered estimates/_client_file_fields.html.haml (19.1ms)
  Rendered estimates/_technical_file_fields.html.haml (8.6ms)
  [1m[36mTechnicalFile Load (0.6ms)[0m  [1m[34mSELECT "technical_files".* FROM "technical_files" WHERE "technical_files"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mAssetFile Load (0.5ms)[0m  [1m[34mSELECT  "asset_files".* FROM "asset_files" WHERE "asset_files"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  Rendered estimates/_technical_file_fields.html.haml (8.4ms)
  Rendered estimates/_discount.html.haml (7.8ms)
  Rendered estimates/_stages.html.haml (19.1ms)
  Rendered estimates/_form.html.haml (153.1ms)
  Rendered estimates/edit.html.haml within layouts/application (156.0ms)
  Rendered layouts/_header.html.haml (9.4ms)
Completed 200 OK in 815ms (Views: 656.4ms | ActiveRecord: 54.6ms)


Started GET "/estimates" for 127.0.0.1 at 2017-04-26 23:57:31 +0300
Processing by EstimatesController#index as HTML
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering estimates/index.html.haml within layouts/application
  [1m[36mEstimate Load (0.6ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL[0m
  Rendered estimates/_listing.html.haml (3.1ms)
  Rendered estimates/_listing.html.haml (1.0ms)
  Rendered estimates/index.html.haml within layouts/application (14.0ms)
  Rendered layouts/_header.html.haml (9.0ms)
Completed 200 OK in 541ms (Views: 497.8ms | ActiveRecord: 1.2ms)


Started GET "/estimates/1/edit" for 127.0.0.1 at 2017-04-26 23:57:33 +0300
Processing by EstimatesController#edit as HTML
  Parameters: {"id"=>"1"}
  [1m[36mProduct Load (1.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (3.3ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (0.6ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.5ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = 1[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (1.3ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (2.5ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.9ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (1.5ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (2.3ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (1.7ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (1.0ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mUnit Load (0.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  [1m[36mProductTemplateSet Load (0.7ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.9ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (1.0ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.9ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (0.5ms)[0m  [1m[34mSELECT  "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (2.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (2.8ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStage Load (0.7ms)[0m  [1m[34mSELECT "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1[0m  [["estimate_id", 1]]
  [1m[36mStageProduct Load (0.7ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" IN (1, 2, 3)[0m
  [1m[36mStageProduct Load (0.6ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 1]]
  [1m[36mStageProductSet Load (0.8ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 1[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 1[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mStageProduct Load (0.6ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 2]]
  [1m[36mStageProductSet Load (0.7ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 2[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 2[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mStageProduct Load (0.8ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 3]]
  [1m[36mStageProductSet Load (0.7ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 3[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 3[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mStageProductSet Load (0.8ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = $1[0m  [["stage_product_id", 3]]
  [1m[36mStageProductSetValue Load (0.8ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = 1[0m
  [1m[36mProductSet Load (0.7ms)[0m  [1m[34mSELECT  "product_sets".* FROM "product_sets" WHERE "product_sets"."deleted_at" IS NULL AND "product_sets"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStageProductSetValue Load (0.6ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1[0m  [["stage_product_set_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  Rendering estimates/edit.html.haml within layouts/application
  [1m[36mClient Load (0.6ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (3.7ms)
  [1m[36mClientFile Load (0.6ms)[0m  [1m[34mSELECT "client_files".* FROM "client_files" WHERE "client_files"."estimate_id" = $1[0m  [["estimate_id", 1]]
  Rendered estimates/_technical_file_fields.html.haml (3.4ms)
  [1m[36mTechnicalFile Load (0.9ms)[0m  [1m[34mSELECT "technical_files".* FROM "technical_files" WHERE "technical_files"."estimate_id" = $1[0m  [["estimate_id", 1]]
  Rendered estimates/_discount.html.haml (9.1ms)
  Rendered estimates/_stages.html.haml (24.0ms)
  Rendered estimates/_form.html.haml (99.5ms)
  Rendered estimates/edit.html.haml within layouts/application (102.8ms)
  Rendered layouts/_header.html.haml (12.5ms)
Completed 200 OK in 923ms (Views: 773.0ms | ActiveRecord: 43.2ms)


Started GET "/estimates/1/edit" for 127.0.0.1 at 2017-04-26 23:58:23 +0300
Processing by EstimatesController#edit as HTML
  Parameters: {"id"=>"1"}
  [1m[36mProduct Load (1.1ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (1.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = 1[0m
  [1m[36mProduct Load (2.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.9ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (0.8ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.6ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mUnit Load (2.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  [1m[36mProductTemplateSet Load (0.9ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (2.7ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (0.9ms)[0m  [1m[34mSELECT  "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.4ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStage Load (0.7ms)[0m  [1m[34mSELECT "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1[0m  [["estimate_id", 1]]
  [1m[36mStageProduct Load (0.7ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" IN (1, 2, 3)[0m
  [1m[36mStageProduct Load (1.7ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 1]]
  [1m[36mStageProductSet Load (0.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 1[0m
  [1m[36mProduct Load (1.4ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 1[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mStageProduct Load (0.7ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 2]]
  [1m[36mStageProductSet Load (0.7ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 2[0m
  [1m[36mProduct Load (2.4ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 2[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mStageProduct Load (0.6ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 3]]
  [1m[36mStageProductSet Load (1.1ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 3[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 3[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mStageProductSet Load (0.7ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = $1[0m  [["stage_product_id", 3]]
  [1m[36mStageProductSetValue Load (0.6ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = 1[0m
  [1m[36mProductSet Load (0.7ms)[0m  [1m[34mSELECT  "product_sets".* FROM "product_sets" WHERE "product_sets"."deleted_at" IS NULL AND "product_sets"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStageProductSetValue Load (0.7ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1[0m  [["stage_product_set_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  Rendering estimates/edit.html.haml within layouts/application
  [1m[36mClient Load (1.0ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (3.3ms)
  [1m[36mClientFile Load (0.6ms)[0m  [1m[34mSELECT "client_files".* FROM "client_files" WHERE "client_files"."estimate_id" = $1[0m  [["estimate_id", 1]]
  Rendered estimates/_technical_file_fields.html.haml (3.3ms)
  [1m[36mTechnicalFile Load (0.6ms)[0m  [1m[34mSELECT "technical_files".* FROM "technical_files" WHERE "technical_files"."estimate_id" = $1[0m  [["estimate_id", 1]]
  Rendered estimates/_discount.html.haml (7.7ms)
  Rendered estimates/_stages.html.haml (25.2ms)
  Rendered estimates/_form.html.haml (87.2ms)
  Rendered estimates/edit.html.haml within layouts/application (90.1ms)
  Rendered layouts/_header.html.haml (14.2ms)
Completed 200 OK in 768ms (Views: 611.0ms | ActiveRecord: 41.7ms)


Started GET "/estimates/1/edit" for 127.0.0.1 at 2017-04-27 00:00:14 +0300
Processing by EstimatesController#edit as HTML
  Parameters: {"id"=>"1"}
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (3.4ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (0.6ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = 1[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (1.1ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.5ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (0.8ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.6ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mConstructorObject Load (2.1ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  [1m[36mProductTemplateSet Load (1.7ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.5ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (1.8ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.9ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (0.8ms)[0m  [1m[34mSELECT  "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (1.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.4ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStage Load (0.6ms)[0m  [1m[34mSELECT "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1[0m  [["estimate_id", 1]]
  [1m[36mStageProduct Load (0.7ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" IN (1, 2, 3)[0m
  [1m[36mStageProduct Load (0.6ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 1]]
  [1m[36mStageProductSet Load (0.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 1[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 1[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mStageProduct Load (0.6ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 2]]
  [1m[36mStageProductSet Load (0.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 2[0m
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 2[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mStageProduct Load (0.8ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 3]]
  [1m[36mStageProductSet Load (1.7ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 3[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 3[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mStageProductSet Load (0.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = $1[0m  [["stage_product_id", 3]]
  [1m[36mStageProductSetValue Load (0.8ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = 1[0m
  [1m[36mProductSet Load (0.6ms)[0m  [1m[34mSELECT  "product_sets".* FROM "product_sets" WHERE "product_sets"."deleted_at" IS NULL AND "product_sets"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStageProductSetValue Load (0.8ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1[0m  [["stage_product_set_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  Rendering estimates/edit.html.haml within layouts/application
  [1m[36mClient Load (0.6ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (3.5ms)
  [1m[36mClientFile Load (0.7ms)[0m  [1m[34mSELECT "client_files".* FROM "client_files" WHERE "client_files"."estimate_id" = $1[0m  [["estimate_id", 1]]
  Rendered estimates/_technical_file_fields.html.haml (3.9ms)
  [1m[36mTechnicalFile Load (0.5ms)[0m  [1m[34mSELECT "technical_files".* FROM "technical_files" WHERE "technical_files"."estimate_id" = $1[0m  [["estimate_id", 1]]
  Rendered estimates/_discount.html.haml (8.5ms)
  Rendered estimates/_stages.html.haml (27.7ms)
  Rendered estimates/_form.html.haml (90.2ms)
  Rendered estimates/edit.html.haml within layouts/application (92.9ms)
  Rendered layouts/_header.html.haml (31.3ms)
Completed 200 OK in 1618ms (Views: 1487.4ms | ActiveRecord: 37.3ms)


Started GET "/estimates/1/edit" for 127.0.0.1 at 2017-04-27 00:00:27 +0300
Processing by EstimatesController#edit as HTML
  Parameters: {"id"=>"1"}
  [1m[36mProduct Load (1.2ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (0.7ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = 1[0m
  [1m[36mProduct Load (0.9ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (1.2ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.7ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (1.0ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.6ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (1.0ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  [1m[36mProductTemplateSet Load (0.7ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.9ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.8ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUnit Load (1.1ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (0.8ms)[0m  [1m[34mSELECT  "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (2.1ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStage Load (2.3ms)[0m  [1m[34mSELECT "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1[0m  [["estimate_id", 1]]
  [1m[36mStageProduct Load (0.6ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" IN (1, 2, 3)[0m
  [1m[36mStageProduct Load (0.6ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 1]]
  [1m[36mStageProductSet Load (0.9ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 1[0m
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 1[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mStageProduct Load (0.6ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 2]]
  [1m[36mStageProductSet Load (1.9ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 2[0m
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 2[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mStageProduct Load (0.6ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 3]]
  [1m[36mStageProductSet Load (0.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 3[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 3[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mStageProductSet Load (1.3ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = $1[0m  [["stage_product_id", 3]]
  [1m[36mStageProductSetValue Load (0.7ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = 1[0m
  [1m[36mProductSet Load (0.6ms)[0m  [1m[34mSELECT  "product_sets".* FROM "product_sets" WHERE "product_sets"."deleted_at" IS NULL AND "product_sets"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStageProductSetValue Load (0.6ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1[0m  [["stage_product_set_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.1ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  Rendering estimates/edit.html.haml within layouts/application
  [1m[36mClient Load (0.5ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (8.8ms)
  [1m[36mClientFile Load (0.5ms)[0m  [1m[34mSELECT "client_files".* FROM "client_files" WHERE "client_files"."estimate_id" = $1[0m  [["estimate_id", 1]]
  Rendered estimates/_technical_file_fields.html.haml (4.0ms)
  [1m[36mTechnicalFile Load (0.7ms)[0m  [1m[34mSELECT "technical_files".* FROM "technical_files" WHERE "technical_files"."estimate_id" = $1[0m  [["estimate_id", 1]]
  Rendered estimates/_discount.html.haml (13.5ms)
  Rendered estimates/_stages.html.haml (18.6ms)
  Rendered estimates/_form.html.haml (107.9ms)
  Rendered estimates/edit.html.haml within layouts/application (111.4ms)
  Rendered layouts/_header.html.haml (11.5ms)
Completed 200 OK in 729ms (Views: 585.1ms | ActiveRecord: 37.3ms)


Started GET "/estimates/1/edit" for 127.0.0.1 at 2017-04-27 00:01:43 +0300
Processing by EstimatesController#edit as HTML
  Parameters: {"id"=>"1"}
  [1m[36mProduct Load (1.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (2.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.5ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = 1[0m
  [1m[36mProduct Load (1.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.6ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (0.9ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.6ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mUnit Load (2.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  [1m[36mProductTemplateSet Load (0.8ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (1.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (0.8ms)[0m  [1m[34mSELECT  "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.4ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStage Load (0.7ms)[0m  [1m[34mSELECT "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1[0m  [["estimate_id", 1]]
  [1m[36mStageProduct Load (0.6ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" IN (1, 2, 3)[0m
  [1m[36mStageProduct Load (0.8ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 1]]
  [1m[36mStageProductSet Load (0.9ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 1[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 1[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mStageProduct Load (0.6ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 2]]
  [1m[36mStageProductSet Load (0.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 2[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 2[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mStageProduct Load (0.7ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 3]]
  [1m[36mStageProductSet Load (0.8ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 3[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 3[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mStageProductSet Load (0.7ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = $1[0m  [["stage_product_id", 3]]
  [1m[36mStageProductSetValue Load (0.7ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = 1[0m
  [1m[36mProductSet Load (0.6ms)[0m  [1m[34mSELECT  "product_sets".* FROM "product_sets" WHERE "product_sets"."deleted_at" IS NULL AND "product_sets"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStageProductSetValue Load (0.7ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1[0m  [["stage_product_set_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  Rendering estimates/edit.html.haml within layouts/application
  [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (2.9ms)
  [1m[36mClientFile Load (0.7ms)[0m  [1m[34mSELECT "client_files".* FROM "client_files" WHERE "client_files"."estimate_id" = $1[0m  [["estimate_id", 1]]
  Rendered estimates/_technical_file_fields.html.haml (2.9ms)
  [1m[36mTechnicalFile Load (0.6ms)[0m  [1m[34mSELECT "technical_files".* FROM "technical_files" WHERE "technical_files"."estimate_id" = $1[0m  [["estimate_id", 1]]
  Rendered estimates/_discount.html.haml (6.2ms)
  Rendered estimates/_stages.html.haml (15.0ms)
  Rendered estimates/_form.html.haml (66.0ms)
  Rendered estimates/edit.html.haml within layouts/application (68.7ms)
  Rendered layouts/_header.html.haml (8.3ms)
Completed 200 OK in 1631ms (Views: 1507.0ms | ActiveRecord: 33.7ms)


Started GET "/estimates" for 127.0.0.1 at 2017-04-27 00:02:15 +0300
Processing by EstimatesController#index as HTML
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering estimates/index.html.haml within layouts/application
  [1m[36mEstimate Load (1.8ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL[0m
  Rendered estimates/_listing.html.haml (3.7ms)
  Rendered estimates/_listing.html.haml (0.9ms)
  Rendered estimates/index.html.haml within layouts/application (19.9ms)
  Rendered layouts/_header.html.haml (22.5ms)
Completed 200 OK in 682ms (Views: 669.3ms | ActiveRecord: 2.6ms)


Started GET "/estimates" for 127.0.0.1 at 2017-04-27 00:03:13 +0300
Processing by EstimatesController#index as HTML
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Redirected to http://localhost:3000/clients
Completed 302 Found in 54ms (ActiveRecord: 9.0ms)


Started GET "/clients" for 127.0.0.1 at 2017-04-27 00:03:13 +0300
Processing by ClientsController#index as HTML
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering clients/index.html.haml within layouts/application
  [1m[36mUserClient Load (2.4ms)[0m  [1m[34mSELECT "user_clients".* FROM "user_clients" INNER JOIN "clients" ON "clients"."id" = "user_clients"."client_id" AND "clients"."deleted_at" IS NULL WHERE "clients"."archived" = $1 AND (user_id = 1 and owner = true)[0m  [["archived", false]]
  [1m[36mClient Load (0.6ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" IN (1, 2, 3)[0m
  [1m[36mEstimate Load (0.8ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" IN (1, 2, 3)[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 1]]
  Rendered clients/_listing.html.haml (16.4ms)
  [1m[35m (1.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 2]]
  Rendered clients/_listing.html.haml (4.3ms)
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 3]]
  Rendered clients/_listing.html.haml (4.5ms)
  Rendered clients/_table.html.haml (30.9ms)
  [1m[36mUserClient Load (1.0ms)[0m  [1m[34mSELECT "user_clients".* FROM "user_clients" INNER JOIN "clients" ON "clients"."id" = "user_clients"."client_id" AND "clients"."deleted_at" IS NULL WHERE "clients"."archived" = $1 AND (user_id = 1 and owner = false)[0m  [["archived", false]]
  Rendered clients/index.html.haml within layouts/application (134.6ms)
  Rendered layouts/_header.html.haml (59.0ms)
Completed 200 OK in 685ms (Views: 635.8ms | ActiveRecord: 21.4ms)


Started GET "/estimates?client_id=2" for 127.0.0.1 at 2017-04-27 00:03:16 +0300
Processing by EstimatesController#index as HTML
  Parameters: {"client_id"=>"2"}
  [1m[36mUser Load (1.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering estimates/index.html.haml within layouts/application
  [1m[36mEstimate Load (0.7ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 2]]
  Rendered estimates/index.html.haml within layouts/application (9.7ms)
  Rendered layouts/_header.html.haml (7.2ms)
Completed 200 OK in 468ms (Views: 456.9ms | ActiveRecord: 2.4ms)


Started GET "/clients" for 127.0.0.1 at 2017-04-27 00:03:20 +0300
Processing by ClientsController#index as HTML
  [1m[36mUser Load (1.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering clients/index.html.haml within layouts/application
  [1m[36mUserClient Load (4.0ms)[0m  [1m[34mSELECT "user_clients".* FROM "user_clients" INNER JOIN "clients" ON "clients"."id" = "user_clients"."client_id" AND "clients"."deleted_at" IS NULL WHERE "clients"."archived" = $1 AND (user_id = 1 and owner = true)[0m  [["archived", false]]
  [1m[36mClient Load (0.8ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" IN (1, 2, 3)[0m
  [1m[36mEstimate Load (0.7ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" IN (1, 2, 3)[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 1]]
  Rendered clients/_listing.html.haml (6.8ms)
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 2]]
  Rendered clients/_listing.html.haml (3.8ms)
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 3]]
  Rendered clients/_listing.html.haml (3.2ms)
  Rendered clients/_table.html.haml (18.0ms)
  [1m[36mUserClient Load (0.7ms)[0m  [1m[34mSELECT "user_clients".* FROM "user_clients" INNER JOIN "clients" ON "clients"."id" = "user_clients"."client_id" AND "clients"."deleted_at" IS NULL WHERE "clients"."archived" = $1 AND (user_id = 1 and owner = false)[0m  [["archived", false]]
  Rendered clients/index.html.haml within layouts/application (35.1ms)
  Rendered layouts/_header.html.haml (8.3ms)
Completed 200 OK in 563ms (Views: 547.5ms | ActiveRecord: 9.9ms)


Started GET "/estimates?client_id=1" for 127.0.0.1 at 2017-04-27 00:03:23 +0300
Processing by EstimatesController#index as HTML
  Parameters: {"client_id"=>"1"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering estimates/index.html.haml within layouts/application
  [1m[36mEstimate Load (0.7ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 1]]
  Rendered estimates/_listing.html.haml (5.4ms)
  Rendered estimates/_listing.html.haml (0.7ms)
  Rendered estimates/index.html.haml within layouts/application (19.7ms)
  Rendered layouts/_header.html.haml (8.3ms)
Completed 200 OK in 527ms (Views: 522.1ms | ActiveRecord: 1.3ms)


Started GET "/estimates?client_id=1" for 127.0.0.1 at 2017-04-27 00:05:16 +0300
Processing by EstimatesController#index as HTML
  Parameters: {"client_id"=>"1"}
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (0.7ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = 1[0m
  Rendering estimates/index.html.haml within layouts/application
  Rendered estimates/_listing.html.haml (2.9ms)
  Rendered estimates/_listing.html.haml (0.8ms)
  Rendered estimates/index.html.haml within layouts/application (11.5ms)
  Rendered layouts/_header.html.haml (48.3ms)
Completed 200 OK in 656ms (Views: 558.6ms | ActiveRecord: 20.7ms)


Started GET "/primitives" for 127.0.0.1 at 2017-04-27 00:05:27 +0300
Processing by PrimitivesController#index as HTML
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering primitives/index.html.haml within layouts/application
  [1m[36mCategory Load (1.2ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."product" = $1[0m  [["product", false]]
  [1m[35m (1.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL[0m
  [1m[36mCategory Load (0.9ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 1[0m
  [1m[36mPrimitive Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 1[0m
  [1m[36mCategory Load (5.6ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" = 1[0m
  [1m[36mUnit Load (0.4ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  Rendered primitives/_listing.html.haml (11.2ms)
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 2[0m
  [1m[36mPrimitive Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 2[0m
  [1m[36mCategory Load (1.2ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" = 2[0m
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 2[0m
  Rendered primitives/_listing.html.haml (3.3ms)
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 3[0m
  [1m[36mPrimitive Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 3[0m
  [1m[36mCategory Load (0.6ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" = 3[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  Rendered primitives/_listing.html.haml (5.7ms)
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 4[0m
  [1m[36mPrimitive Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 4[0m
  [1m[36mCategory Load (1.0ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" = 4[0m
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 5)[0m
  Rendered primitives/_listing.html.haml (3.6ms)
  Rendered primitives/_listing.html.haml (3.3ms)
  [1m[35m (1.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 5[0m
  [1m[36mPrimitive Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 5[0m
  [1m[36mCategory Load (0.6ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" = 5[0m
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (1, 5)[0m
  Rendered primitives/_listing.html.haml (3.5ms)
  Rendered primitives/_listing.html.haml (3.2ms)
  Rendered primitives/_listing.html.haml (3.0ms)
  [1m[35m (4.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 6[0m
  [1m[36mPrimitive Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 6[0m
  [1m[36mCategory Load (0.5ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" = 6[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 2[0m
  Rendered primitives/_listing.html.haml (4.1ms)
  Rendered primitives/_listing.html.haml (4.7ms)
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 7[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 8[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 9[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 10[0m
  [1m[35m (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 11[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 12[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 13[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 14[0m
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 15[0m
  Rendered primitives/index.html.haml within layouts/application (187.2ms)
  Rendered layouts/_header.html.haml (9.2ms)
Completed 200 OK in 650ms (Views: 595.4ms | ActiveRecord: 47.7ms)


Started GET "/clients" for 127.0.0.1 at 2017-04-27 00:05:34 +0300
Processing by ClientsController#index as HTML
  [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering clients/index.html.haml within layouts/application
  [1m[36mUserClient Load (1.4ms)[0m  [1m[34mSELECT "user_clients".* FROM "user_clients" INNER JOIN "clients" ON "clients"."id" = "user_clients"."client_id" AND "clients"."deleted_at" IS NULL WHERE "clients"."archived" = $1 AND (user_id = 1 and owner = true)[0m  [["archived", false]]
  [1m[36mClient Load (1.0ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" IN (1, 2, 3)[0m
  [1m[36mEstimate Load (0.8ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" IN (1, 2, 3)[0m
  [1m[35m (1.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 1]]
  Rendered clients/_listing.html.haml (9.8ms)
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 2]]
  Rendered clients/_listing.html.haml (4.2ms)
  [1m[35m (2.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 3]]
  Rendered clients/_listing.html.haml (5.6ms)
  Rendered clients/_table.html.haml (23.8ms)
  [1m[36mUserClient Load (0.8ms)[0m  [1m[34mSELECT "user_clients".* FROM "user_clients" INNER JOIN "clients" ON "clients"."id" = "user_clients"."client_id" AND "clients"."deleted_at" IS NULL WHERE "clients"."archived" = $1 AND (user_id = 1 and owner = false)[0m  [["archived", false]]
  Rendered clients/index.html.haml within layouts/application (101.1ms)
  Rendered layouts/_header.html.haml (9.1ms)
Completed 200 OK in 584ms (Views: 547.8ms | ActiveRecord: 13.0ms)


Started GET "/estimates?client_id=1" for 127.0.0.1 at 2017-04-27 00:05:37 +0300
Processing by EstimatesController#index as HTML
  Parameters: {"client_id"=>"1"}
  [1m[36mUser Load (2.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mClient Load (0.8ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (0.8ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = 1[0m
  Rendering estimates/index.html.haml within layouts/application
  Rendered estimates/_listing.html.haml (3.8ms)
  Rendered estimates/_listing.html.haml (1.0ms)
  Rendered estimates/index.html.haml within layouts/application (19.9ms)
  Rendered layouts/_header.html.haml (10.0ms)
Completed 200 OK in 519ms (Views: 507.1ms | ActiveRecord: 3.8ms)


Started GET "/estimates?client_id=1" for 127.0.0.1 at 2017-04-27 00:09:40 +0300
Processing by EstimatesController#index as HTML
  Parameters: {"client_id"=>"1"}
  [1m[36mUser Load (3.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mClient Load (0.9ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (1.1ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = 1[0m
  Rendering estimates/index.html.haml within layouts/application
  [1m[36mCategory Load (0.8ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."product" = $1[0m  [["product", true]]
  Rendered estimates/_listing.html.haml (410.9ms)
  Rendered estimates/index.html.haml within layouts/application (423.9ms)
Completed 500 Internal Server Error in 444ms (ActiveRecord: 5.8ms)


  
ActionView::Template::Error (undefined local variable or method `primitive' for #<#<Class:0x007f1f50ffc8e8>:0x00561d113e4f20>
Did you mean?  primitive_url):
     9:       %span.glyphicon.glyphicon-duplicate{ 'aria-hidden': true }
    10:     = link_to edit_estimate_path(estimate), title: 'Редактировать', class: 'btn btn-warning' do
    11:       %span.glyphicon.glyphicon-pencil
    12:     = link_to primitive_path(primitive), method: :delete, title: 'Удалить', class: 'btn btn-danger', data: {confirm: 'Are you sure?'} do
    13:       %span.glyphicon.glyphicon-trash
  
app/views/estimates/_listing.html.haml:12:in `_app_views_estimates__listing_html_haml__2507902463935483711_69886047804760'
app/views/estimates/index.html.haml:32:in `block in _app_views_estimates_index_html_haml___2437698545141170834_47341421874860'
app/views/estimates/index.html.haml:31:in `_app_views_estimates_index_html_haml___2437698545141170834_47341421874860'
app/controllers/application_controller.rb:8:in `render'
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/template_error.html.erb within rescues/layout
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_source.html.erb
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_source.html.erb (10.6ms)
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (2.4ms)
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_request_and_response.html.erb
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_request_and_response.html.erb (1.5ms)
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/template_error.html.erb within rescues/layout (40.8ms)
Started GET "/estimates?client_id=1" for 127.0.0.1 at 2017-04-27 00:09:50 +0300
Processing by EstimatesController#index as HTML
  Parameters: {"client_id"=>"1"}
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mClient Load (3.3ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (1.8ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = 1[0m
  Rendering estimates/index.html.haml within layouts/application
  [1m[36mCategory Load (0.7ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."product" = $1[0m  [["product", true]]
  Rendered estimates/_listing.html.haml (3.6ms)
  Rendered estimates/_listing.html.haml (1.2ms)
  Rendered estimates/index.html.haml within layouts/application (16.2ms)
  Rendered layouts/_header.html.haml (9.7ms)
Completed 200 OK in 589ms (Views: 574.8ms | ActiveRecord: 6.8ms)


Started GET "/estimates?client_id=1" for 127.0.0.1 at 2017-04-27 00:10:49 +0300
Processing by EstimatesController#index as HTML
  Parameters: {"client_id"=>"1"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (0.7ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = 1[0m
  Rendering estimates/index.html.haml within layouts/application
  [1m[36mCategory Load (1.5ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."product" = $1[0m  [["product", true]]
  Rendered estimates/_listing.html.haml (4.4ms)
  Rendered estimates/_listing.html.haml (2.1ms)
  Rendered estimates/index.html.haml within layouts/application (31.4ms)
  Rendered layouts/_header.html.haml (8.9ms)
Completed 200 OK in 609ms (Views: 594.9ms | ActiveRecord: 3.6ms)


Started GET "/estimates?client_id=1" for 127.0.0.1 at 2017-04-27 00:12:15 +0300
Processing by EstimatesController#index as HTML
  Parameters: {"client_id"=>"1"}
  [1m[36mUser Load (2.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mClient Load (1.7ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (1.2ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = 1[0m
  Rendering estimates/index.html.haml within layouts/application
  Rendered estimates/_listing.html.haml (3.3ms)
  Rendered estimates/_listing.html.haml (0.9ms)
  Rendered estimates/index.html.haml within layouts/application (13.4ms)
  Rendered layouts/_header.html.haml (11.6ms)
Completed 200 OK in 524ms (Views: 511.5ms | ActiveRecord: 5.4ms)


Started GET "/estimates/new?client_id=1" for 127.0.0.1 at 2017-04-27 00:12:29 +0300
Processing by EstimatesController#new as HTML
  Parameters: {"client_id"=>"1"}
  [1m[36mProduct Load (0.5ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (0.6ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.9ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = 1[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (1.2ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.6ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (0.9ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.6ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  [1m[36mProductTemplateSet Load (0.6ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.5ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.5ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUnit Load (1.3ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.5ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering estimates/new.html.haml within layouts/application
  [1m[36mClient Load (0.6ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (10.1ms)
  Rendered estimates/_technical_file_fields.html.haml (5.4ms)
  Rendered estimates/_discount.html.haml (7.4ms)
  Rendered estimates/_stages.html.haml (16.8ms)
  Rendered estimates/_form.html.haml (117.6ms)
  Rendered estimates/new.html.haml within layouts/application (121.7ms)
  Rendered layouts/_header.html.haml (10.1ms)
Completed 200 OK in 789ms (Views: 602.3ms | ActiveRecord: 54.2ms)


Started GET "/estimates" for 127.0.0.1 at 2017-04-27 00:12:31 +0300
Processing by EstimatesController#index as HTML
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Redirected to http://localhost:3000/clients
Completed 404 Not Found in 7ms (ActiveRecord: 0.6ms)


  
ActiveRecord::RecordNotFound (Couldn't find Client without an ID):
  
app/controllers/estimates_controller.rb:9:in `index'
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/diagnostics.html.erb within rescues/layout
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_source.html.erb
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_source.html.erb (7.6ms)
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (2.1ms)
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_request_and_response.html.erb
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_request_and_response.html.erb (0.9ms)
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/diagnostics.html.erb within rescues/layout (36.2ms)
Started GET "/estimates" for 127.0.0.1 at 2017-04-27 00:12:53 +0300
Processing by EstimatesController#index as HTML
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Redirected to http://localhost:3000/clients
Completed 404 Not Found in 36ms (ActiveRecord: 9.6ms)


  
ActiveRecord::RecordNotFound (Couldn't find Client without an ID):
  
app/controllers/estimates_controller.rb:9:in `index'
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/diagnostics.html.erb within rescues/layout
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_source.html.erb
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_source.html.erb (4.5ms)
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (3.0ms)
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_request_and_response.html.erb
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_request_and_response.html.erb (0.9ms)
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/diagnostics.html.erb within rescues/layout (36.1ms)
Started GET "/estimates" for 127.0.0.1 at 2017-04-27 00:13:04 +0300
Processing by EstimatesController#index as HTML
  [1m[36mUser Load (1.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Redirected to http://localhost:3000/clients
Completed 404 Not Found in 70495ms (ActiveRecord: 11.2ms)


  
ActiveRecord::RecordNotFound (Couldn't find Client without an ID):
  
app/controllers/estimates_controller.rb:10:in `index'
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/diagnostics.html.erb within rescues/layout
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_source.html.erb
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_source.html.erb (4.5ms)
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (2.0ms)
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_request_and_response.html.erb
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_request_and_response.html.erb (0.9ms)
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/diagnostics.html.erb within rescues/layout (30.3ms)
Started GET "/estimates" for 127.0.0.1 at 2017-04-27 00:14:46 +0300
Processing by EstimatesController#index as HTML
  [1m[36mUser Load (1.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Redirected to http://localhost:3000/clients
Completed 302 Found in 23ms (ActiveRecord: 9.3ms)


Started GET "/clients" for 127.0.0.1 at 2017-04-27 00:14:46 +0300
Processing by ClientsController#index as HTML
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering clients/index.html.haml within layouts/application
  [1m[36mUserClient Load (1.0ms)[0m  [1m[34mSELECT "user_clients".* FROM "user_clients" INNER JOIN "clients" ON "clients"."id" = "user_clients"."client_id" AND "clients"."deleted_at" IS NULL WHERE "clients"."archived" = $1 AND (user_id = 1 and owner = true)[0m  [["archived", false]]
  [1m[36mClient Load (1.6ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" IN (1, 2, 3)[0m
  [1m[36mEstimate Load (0.8ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" IN (1, 2, 3)[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 1]]
  Rendered clients/_listing.html.haml (7.5ms)
  [1m[35m (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 2]]
  Rendered clients/_listing.html.haml (4.4ms)
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 3]]
  Rendered clients/_listing.html.haml (3.9ms)
  Rendered clients/_table.html.haml (20.0ms)
  [1m[36mUserClient Load (1.2ms)[0m  [1m[34mSELECT "user_clients".* FROM "user_clients" INNER JOIN "clients" ON "clients"."id" = "user_clients"."client_id" AND "clients"."deleted_at" IS NULL WHERE "clients"."archived" = $1 AND (user_id = 1 and owner = false)[0m  [["archived", false]]
  Rendered clients/index.html.haml within layouts/application (105.8ms)
  Rendered layouts/_header.html.haml (51.6ms)
Completed 200 OK in 659ms (Views: 624.4ms | ActiveRecord: 20.6ms)


DEPRECATION WARNING: to_cleanup is deprecated and will be removed from Rails 5.1 (use ActiveSupport::Reloader.to_complete instead) (called from <top (required)> at /home/g1nc/Development/ruby/constructor/config/environment.rb:5)
Started GET "/clients" for 127.0.0.1 at 2017-04-27 00:15:00 +0300
  [1m[36mActiveRecord::SchemaMigration Load (1.0ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
Processing by ClientsController#index as HTML
  [1m[36mUser Load (1.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering clients/index.html.haml within layouts/application
  [1m[36mUserClient Load (1.3ms)[0m  [1m[34mSELECT "user_clients".* FROM "user_clients" INNER JOIN "clients" ON "clients"."id" = "user_clients"."client_id" AND "clients"."deleted_at" IS NULL WHERE "clients"."archived" = $1 AND (user_id = 1 and owner = true)[0m  [["archived", false]]
  [1m[36mClient Load (0.9ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" IN (1, 2, 3)[0m
  [1m[36mEstimate Load (2.1ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" IN (1, 2, 3)[0m
  [1m[35m (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 1]]
  Rendered clients/_listing.html.haml (22.3ms)
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 2]]
  Rendered clients/_listing.html.haml (6.8ms)
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 3]]
  Rendered clients/_listing.html.haml (3.9ms)
  Rendered clients/_table.html.haml (38.0ms)
  [1m[36mUserClient Load (1.0ms)[0m  [1m[34mSELECT "user_clients".* FROM "user_clients" INNER JOIN "clients" ON "clients"."id" = "user_clients"."client_id" AND "clients"."deleted_at" IS NULL WHERE "clients"."archived" = $1 AND (user_id = 1 and owner = false)[0m  [["archived", false]]
  Rendered clients/index.html.haml within layouts/application (183.7ms)
  Rendered layouts/_header.html.haml (72.2ms)
Completed 200 OK in 2689ms (Views: 2613.4ms | ActiveRecord: 33.5ms)


Started GET "/estimates?client_id=2" for 127.0.0.1 at 2017-04-27 00:15:06 +0300
Processing by EstimatesController#index as HTML
  Parameters: {"client_id"=>"2"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mClient Load (0.8ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mEstimate Load (1.0ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = 2[0m
  Rendering estimates/index.html.haml within layouts/application
  Rendered estimates/index.html.haml within layouts/application (11.7ms)
  Rendered layouts/_header.html.haml (13.3ms)
Completed 200 OK in 606ms (Views: 589.8ms | ActiveRecord: 2.4ms)


Started GET "/clients" for 127.0.0.1 at 2017-04-27 00:15:11 +0300
Processing by ClientsController#index as HTML
  [1m[36mUser Load (2.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering clients/index.html.haml within layouts/application
  [1m[36mUserClient Load (1.2ms)[0m  [1m[34mSELECT "user_clients".* FROM "user_clients" INNER JOIN "clients" ON "clients"."id" = "user_clients"."client_id" AND "clients"."deleted_at" IS NULL WHERE "clients"."archived" = $1 AND (user_id = 1 and owner = true)[0m  [["archived", false]]
  [1m[36mClient Load (0.6ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" IN (1, 2, 3)[0m
  [1m[36mEstimate Load (0.7ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" IN (1, 2, 3)[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 1]]
  Rendered clients/_listing.html.haml (10.6ms)
  [1m[35m (6.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 2]]
  Rendered clients/_listing.html.haml (10.4ms)
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 3]]
  Rendered clients/_listing.html.haml (6.4ms)
  Rendered clients/_table.html.haml (33.8ms)
  [1m[36mUserClient Load (1.0ms)[0m  [1m[34mSELECT "user_clients".* FROM "user_clients" INNER JOIN "clients" ON "clients"."id" = "user_clients"."client_id" AND "clients"."deleted_at" IS NULL WHERE "clients"."archived" = $1 AND (user_id = 1 and owner = false)[0m  [["archived", false]]
  Rendered clients/index.html.haml within layouts/application (57.9ms)
  Rendered layouts/_header.html.haml (9.1ms)
Completed 200 OK in 611ms (Views: 587.1ms | ActiveRecord: 13.6ms)


Started GET "/estimates?client_id=1" for 127.0.0.1 at 2017-04-27 00:15:13 +0300
Processing by EstimatesController#index as HTML
  Parameters: {"client_id"=>"1"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mClient Load (3.3ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (0.7ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = 1[0m
  Rendering estimates/index.html.haml within layouts/application
  Rendered estimates/_listing.html.haml (4.3ms)
  Rendered estimates/_listing.html.haml (1.8ms)
  Rendered estimates/index.html.haml within layouts/application (24.1ms)
  Rendered layouts/_header.html.haml (8.7ms)
Completed 200 OK in 579ms (Views: 565.4ms | ActiveRecord: 4.5ms)


Started GET "/clients" for 127.0.0.1 at 2017-04-27 00:15:52 +0300
Processing by ClientsController#index as HTML
  [1m[36mUser Load (1.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering clients/index.html.haml within layouts/application
  [1m[36mUserClient Load (0.8ms)[0m  [1m[34mSELECT "user_clients".* FROM "user_clients" INNER JOIN "clients" ON "clients"."id" = "user_clients"."client_id" AND "clients"."deleted_at" IS NULL WHERE "clients"."archived" = $1 AND (user_id = 1 and owner = true)[0m  [["archived", false]]
  [1m[36mClient Load (0.8ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" IN (1, 2, 3)[0m
  [1m[36mEstimate Load (0.7ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" IN (1, 2, 3)[0m
  [1m[35m (3.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 1]]
  Rendered clients/_listing.html.haml (11.2ms)
  [1m[35m (3.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 2]]
  Rendered clients/_listing.html.haml (7.2ms)
  [1m[35m (2.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 3]]
  Rendered clients/_listing.html.haml (5.8ms)
  Rendered clients/_table.html.haml (29.5ms)
  [1m[36mUserClient Load (0.8ms)[0m  [1m[34mSELECT "user_clients".* FROM "user_clients" INNER JOIN "clients" ON "clients"."id" = "user_clients"."client_id" AND "clients"."deleted_at" IS NULL WHERE "clients"."archived" = $1 AND (user_id = 1 and owner = false)[0m  [["archived", false]]
  Rendered clients/index.html.haml within layouts/application (77.4ms)
  Rendered layouts/_header.html.haml (13.4ms)
Completed 200 OK in 693ms (Views: 668.3ms | ActiveRecord: 13.9ms)


Started GET "/estimates?client_id=3" for 127.0.0.1 at 2017-04-27 00:15:54 +0300
Processing by EstimatesController#index as HTML
  Parameters: {"client_id"=>"3"}
  [1m[36mUser Load (2.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mClient Load (5.8ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mEstimate Load (0.8ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = 3[0m
  Rendering estimates/index.html.haml within layouts/application
  Rendered estimates/index.html.haml within layouts/application (9.2ms)
  Rendered layouts/_header.html.haml (16.0ms)
Completed 200 OK in 767ms (Views: 745.6ms | ActiveRecord: 9.6ms)


Started GET "/clients" for 127.0.0.1 at 2017-04-27 00:15:58 +0300
Processing by ClientsController#index as HTML
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering clients/index.html.haml within layouts/application
  [1m[36mUserClient Load (0.8ms)[0m  [1m[34mSELECT "user_clients".* FROM "user_clients" INNER JOIN "clients" ON "clients"."id" = "user_clients"."client_id" AND "clients"."deleted_at" IS NULL WHERE "clients"."archived" = $1 AND (user_id = 1 and owner = true)[0m  [["archived", false]]
  [1m[36mClient Load (0.6ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" IN (1, 2, 3)[0m
  [1m[36mEstimate Load (0.8ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" IN (1, 2, 3)[0m
  [1m[35m (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 1]]
  Rendered clients/_listing.html.haml (8.8ms)
  [1m[35m (2.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 2]]
  Rendered clients/_listing.html.haml (5.5ms)
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 3]]
  Rendered clients/_listing.html.haml (5.0ms)
  Rendered clients/_table.html.haml (49.0ms)
  [1m[36mUserClient Load (1.0ms)[0m  [1m[34mSELECT "user_clients".* FROM "user_clients" INNER JOIN "clients" ON "clients"."id" = "user_clients"."client_id" AND "clients"."deleted_at" IS NULL WHERE "clients"."archived" = $1 AND (user_id = 1 and owner = false)[0m  [["archived", false]]
  Rendered clients/index.html.haml within layouts/application (70.5ms)
  Rendered layouts/_header.html.haml (8.8ms)
Completed 200 OK in 632ms (Views: 618.8ms | ActiveRecord: 7.6ms)


Started GET "/estimates?client_id=1" for 127.0.0.1 at 2017-04-27 00:16:00 +0300
Processing by EstimatesController#index as HTML
  Parameters: {"client_id"=>"1"}
  [1m[36mUser Load (2.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mClient Load (0.8ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (1.0ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = 1[0m
  Rendering estimates/index.html.haml within layouts/application
  Rendered estimates/_listing.html.haml (4.2ms)
  Rendered estimates/_listing.html.haml (2.6ms)
  Rendered estimates/index.html.haml within layouts/application (19.0ms)
  Rendered layouts/_header.html.haml (9.1ms)
Completed 200 OK in 544ms (Views: 528.8ms | ActiveRecord: 4.2ms)


Started GET "/products?utf8=%E2%9C%93&name=%D1%82%D0%B5%D1%81%D1%82" for 127.0.0.1 at 2017-04-27 00:17:02 +0300
Processing by ProductsController#index as HTML
  Parameters: {"utf8"=>"✓", "name"=>"тест"}
  [1m[36mUser Load (2.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering products/index.html.haml within layouts/application
  [1m[36mCategory Load (1.0ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."product" = $1[0m  [["product", true]]
  [1m[36mProduct Load (3.2ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND (lower(name) like '%тест%')[0m
  Rendered products/index.html.haml within layouts/application (32.6ms)
  Rendered layouts/_header.html.haml (9.3ms)
Completed 200 OK in 697ms (Views: 592.7ms | ActiveRecord: 17.9ms)


Started GET "/products?utf8=%E2%9C%93&name=&category=" for 127.0.0.1 at 2017-04-27 00:17:13 +0300
Processing by ProductsController#index as HTML
  Parameters: {"utf8"=>"✓", "name"=>"", "category"=>""}
  [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering products/index.html.haml within layouts/application
  [1m[36mCategory Load (2.6ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."product" = $1[0m  [["product", true]]
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL[0m
  [1m[36mCategory Load (0.7ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" IN (9, 12, 10)[0m
  [1m[36mUnit Load (1.8ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (1, 3, 5)[0m
  [1m[36mCategory Load (0.7ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 1[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 2[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 3[0m
  [1m[35m (3.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 4[0m
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 5[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 6[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 7[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 8[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 9[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 9[0m
  [1m[36mCategory Load (0.7ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" = 9[0m
  [1m[36mUnit Load (1.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  Rendered products/_listing.html.haml (4.3ms)
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 10[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 10[0m
  [1m[36mCategory Load (0.6ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" = 10[0m
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  Rendered products/_listing.html.haml (1.1ms)
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 11[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 12[0m
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 12[0m
  [1m[36mCategory Load (2.7ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" = 12[0m
  [1m[36mUnit Load (2.8ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  Rendered products/_listing.html.haml (0.9ms)
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 13[0m
  [1m[35m (1.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 14[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 15[0m
  Rendered products/index.html.haml within layouts/application (113.4ms)
  Rendered layouts/_header.html.haml (21.5ms)
Completed 200 OK in 808ms (Views: 765.7ms | ActiveRecord: 37.4ms)


Started GET "/clients" for 127.0.0.1 at 2017-04-27 00:17:43 +0300
Processing by ClientsController#index as HTML
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering clients/index.html.haml within layouts/application
  [1m[36mUserClient Load (1.0ms)[0m  [1m[34mSELECT "user_clients".* FROM "user_clients" INNER JOIN "clients" ON "clients"."id" = "user_clients"."client_id" AND "clients"."deleted_at" IS NULL WHERE "clients"."archived" = $1 AND (user_id = 1 and owner = true)[0m  [["archived", false]]
  [1m[36mClient Load (1.8ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" IN (1, 2, 3)[0m
  [1m[36mEstimate Load (0.7ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" IN (1, 2, 3)[0m
  [1m[35m (1.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 1]]
  Rendered clients/_listing.html.haml (12.3ms)
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 2]]
  Rendered clients/_listing.html.haml (7.6ms)
  [1m[35m (3.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 3]]
  Rendered clients/_listing.html.haml (6.6ms)
  Rendered clients/_table.html.haml (31.8ms)
  [1m[36mUserClient Load (0.9ms)[0m  [1m[34mSELECT "user_clients".* FROM "user_clients" INNER JOIN "clients" ON "clients"."id" = "user_clients"."client_id" AND "clients"."deleted_at" IS NULL WHERE "clients"."archived" = $1 AND (user_id = 1 and owner = false)[0m  [["archived", false]]
  Rendered clients/index.html.haml within layouts/application (215.3ms)
  Rendered layouts/_header.html.haml (9.6ms)
Completed 200 OK in 816ms (Views: 777.8ms | ActiveRecord: 22.7ms)


Started GET "/estimates?client_id=1" for 127.0.0.1 at 2017-04-27 00:17:45 +0300
Processing by EstimatesController#index as HTML
  Parameters: {"client_id"=>"1"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (0.7ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = 1[0m
  Rendering estimates/index.html.haml within layouts/application
  Rendered estimates/_listing.html.haml (3.7ms)
  Rendered estimates/_listing.html.haml (1.1ms)
  Rendered estimates/index.html.haml within layouts/application (15.4ms)
  Rendered layouts/_header.html.haml (10.3ms)
Completed 200 OK in 595ms (Views: 576.5ms | ActiveRecord: 1.9ms)


Started GET "/estimates?utf8=%E2%9C%93&name=%D1%82%D0%B5%D1%81%D1%82" for 127.0.0.1 at 2017-04-27 00:17:51 +0300
Processing by EstimatesController#index as HTML
  Parameters: {"utf8"=>"✓", "name"=>"тест"}
  [1m[36mUser Load (2.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Redirected to http://localhost:3000/clients
Completed 302 Found in 9ms (ActiveRecord: 2.3ms)


Started GET "/clients" for 127.0.0.1 at 2017-04-27 00:17:51 +0300
Processing by ClientsController#index as HTML
  [1m[36mUser Load (1.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering clients/index.html.haml within layouts/application
  [1m[36mUserClient Load (0.9ms)[0m  [1m[34mSELECT "user_clients".* FROM "user_clients" INNER JOIN "clients" ON "clients"."id" = "user_clients"."client_id" AND "clients"."deleted_at" IS NULL WHERE "clients"."archived" = $1 AND (user_id = 1 and owner = true)[0m  [["archived", false]]
  [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" IN (1, 2, 3)[0m
  [1m[36mEstimate Load (0.8ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" IN (1, 2, 3)[0m
  [1m[35m (4.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 1]]
  Rendered clients/_listing.html.haml (13.9ms)
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 2]]
  Rendered clients/_listing.html.haml (4.6ms)
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 3]]
  Rendered clients/_listing.html.haml (6.4ms)
  Rendered clients/_table.html.haml (30.4ms)
  [1m[36mUserClient Load (0.9ms)[0m  [1m[34mSELECT "user_clients".* FROM "user_clients" INNER JOIN "clients" ON "clients"."id" = "user_clients"."client_id" AND "clients"."deleted_at" IS NULL WHERE "clients"."archived" = $1 AND (user_id = 1 and owner = false)[0m  [["archived", false]]
  Rendered clients/index.html.haml within layouts/application (53.4ms)
  Rendered layouts/_header.html.haml (9.4ms)
Completed 200 OK in 639ms (Views: 620.7ms | ActiveRecord: 11.3ms)


Started GET "/clients" for 127.0.0.1 at 2017-04-27 00:18:49 +0300
Processing by ClientsController#index as HTML
  [1m[36mUser Load (2.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering clients/index.html.haml within layouts/application
  [1m[36mUserClient Load (4.7ms)[0m  [1m[34mSELECT "user_clients".* FROM "user_clients" INNER JOIN "clients" ON "clients"."id" = "user_clients"."client_id" AND "clients"."deleted_at" IS NULL WHERE "clients"."archived" = $1 AND (user_id = 1 and owner = true)[0m  [["archived", false]]
  [1m[36mClient Load (1.0ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" IN (1, 2, 3)[0m
  [1m[36mEstimate Load (0.9ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" IN (1, 2, 3)[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 1]]
  Rendered clients/_listing.html.haml (8.5ms)
  [1m[35m (4.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 2]]
  Rendered clients/_listing.html.haml (8.2ms)
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 3]]
  Rendered clients/_listing.html.haml (4.9ms)
  Rendered clients/_table.html.haml (26.7ms)
  [1m[36mUserClient Load (0.8ms)[0m  [1m[34mSELECT "user_clients".* FROM "user_clients" INNER JOIN "clients" ON "clients"."id" = "user_clients"."client_id" AND "clients"."deleted_at" IS NULL WHERE "clients"."archived" = $1 AND (user_id = 1 and owner = false)[0m  [["archived", false]]
  Rendered clients/index.html.haml within layouts/application (58.7ms)
  Rendered layouts/_header.html.haml (15.3ms)
Completed 200 OK in 747ms (Views: 726.9ms | ActiveRecord: 15.5ms)


Started GET "/estimates?client_id=1" for 127.0.0.1 at 2017-04-27 00:18:55 +0300
Processing by EstimatesController#index as HTML
  Parameters: {"client_id"=>"1"}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mClient Load (5.3ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (0.8ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = 1[0m
  Rendering estimates/index.html.haml within layouts/application
  Rendered estimates/_listing.html.haml (6.5ms)
  Rendered estimates/_listing.html.haml (1.5ms)
  Rendered estimates/index.html.haml within layouts/application (31.1ms)
  Rendered layouts/_header.html.haml (8.9ms)
Completed 200 OK in 659ms (Views: 638.6ms | ActiveRecord: 6.8ms)


Started GET "/estimates?utf8=%E2%9C%93&client_id=1&name=%D1%82%D0%B5%D1%81%D1%82" for 127.0.0.1 at 2017-04-27 00:19:02 +0300
Processing by EstimatesController#index as HTML
  Parameters: {"utf8"=>"✓", "client_id"=>"1", "name"=>"тест"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mClient Load (0.6ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (4.4ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = 1[0m
  Rendering estimates/index.html.haml within layouts/application
  [1m[36mEstimate Load (1.1ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1 AND (lower(name) like '%тест%')[0m  [["client_id", 1]]
  Rendered estimates/_listing.html.haml (3.7ms)
  Rendered estimates/index.html.haml within layouts/application (17.0ms)
  Rendered layouts/_header.html.haml (9.6ms)
Completed 200 OK in 565ms (Views: 549.1ms | ActiveRecord: 6.6ms)


Started GET "/estimates?utf8=%E2%9C%93&client_id=1&name=%D0%BD%D0%B0%D0%B7" for 127.0.0.1 at 2017-04-27 00:19:19 +0300
Processing by EstimatesController#index as HTML
  Parameters: {"utf8"=>"✓", "client_id"=>"1", "name"=>"наз"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mClient Load (0.6ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (0.7ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = 1[0m
  Rendering estimates/index.html.haml within layouts/application
  [1m[36mEstimate Load (1.2ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1 AND (lower(name) like '%наз%')[0m  [["client_id", 1]]
  Rendered estimates/_listing.html.haml (3.5ms)
  Rendered estimates/index.html.haml within layouts/application (23.9ms)
  Rendered layouts/_header.html.haml (30.7ms)
Completed 200 OK in 608ms (Views: 589.8ms | ActiveRecord: 3.0ms)


Started GET "/clients" for 127.0.0.1 at 2017-04-27 00:20:12 +0300
Processing by ClientsController#index as HTML
  [1m[36mUser Load (1.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering clients/index.html.haml within layouts/application
  [1m[36mUserClient Load (0.8ms)[0m  [1m[34mSELECT "user_clients".* FROM "user_clients" INNER JOIN "clients" ON "clients"."id" = "user_clients"."client_id" AND "clients"."deleted_at" IS NULL WHERE "clients"."archived" = $1 AND (user_id = 1 and owner = true)[0m  [["archived", false]]
  [1m[36mClient Load (4.9ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" IN (1, 2, 3)[0m
  [1m[36mEstimate Load (1.4ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" IN (1, 2, 3)[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 1]]
  Rendered clients/_listing.html.haml (14.4ms)
  [1m[35m (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 2]]
  Rendered clients/_listing.html.haml (5.0ms)
  [1m[35m (1.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 3]]
  Rendered clients/_listing.html.haml (5.5ms)
  Rendered clients/_table.html.haml (29.6ms)
  [1m[36mUserClient Load (1.3ms)[0m  [1m[34mSELECT "user_clients".* FROM "user_clients" INNER JOIN "clients" ON "clients"."id" = "user_clients"."client_id" AND "clients"."deleted_at" IS NULL WHERE "clients"."archived" = $1 AND (user_id = 1 and owner = false)[0m  [["archived", false]]
  Rendered clients/index.html.haml within layouts/application (177.5ms)
  Rendered layouts/_header.html.haml (76.7ms)
Completed 200 OK in 1073ms (Views: 1005.5ms | ActiveRecord: 29.9ms)


Started GET "/estimates?client_id=1" for 127.0.0.1 at 2017-04-27 00:20:15 +0300
Processing by EstimatesController#index as HTML
  Parameters: {"client_id"=>"1"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mClient Load (0.8ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (0.7ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = 1[0m
  Rendering estimates/index.html.haml within layouts/application
  Rendered estimates/_listing.html.haml (5.6ms)
  Rendered estimates/_listing.html.haml (1.1ms)
  Rendered estimates/index.html.haml within layouts/application (20.5ms)
  Rendered layouts/_header.html.haml (10.8ms)
Completed 200 OK in 589ms (Views: 568.3ms | ActiveRecord: 2.2ms)


Started GET "/clients" for 127.0.0.1 at 2017-04-27 00:20:18 +0300
Processing by ClientsController#index as HTML
  [1m[36mUser Load (2.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering clients/index.html.haml within layouts/application
  [1m[36mUserClient Load (3.4ms)[0m  [1m[34mSELECT "user_clients".* FROM "user_clients" INNER JOIN "clients" ON "clients"."id" = "user_clients"."client_id" AND "clients"."deleted_at" IS NULL WHERE "clients"."archived" = $1 AND (user_id = 1 and owner = true)[0m  [["archived", false]]
  [1m[36mClient Load (1.7ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" IN (1, 2, 3)[0m
  [1m[36mEstimate Load (3.5ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" IN (1, 2, 3)[0m
  [1m[35m (3.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 1]]
  Rendered clients/_listing.html.haml (10.1ms)
  [1m[35m (4.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 2]]
  Rendered clients/_listing.html.haml (8.3ms)
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 3]]
  Rendered clients/_listing.html.haml (7.1ms)
  Rendered clients/_table.html.haml (33.4ms)
  [1m[36mUserClient Load (3.0ms)[0m  [1m[34mSELECT "user_clients".* FROM "user_clients" INNER JOIN "clients" ON "clients"."id" = "user_clients"."client_id" AND "clients"."deleted_at" IS NULL WHERE "clients"."archived" = $1 AND (user_id = 1 and owner = false)[0m  [["archived", false]]
  Rendered clients/index.html.haml within layouts/application (60.6ms)
  Rendered layouts/_header.html.haml (12.2ms)
Completed 200 OK in 602ms (Views: 575.2ms | ActiveRecord: 22.8ms)


Started GET "/estimates?client_id=1" for 127.0.0.1 at 2017-04-27 00:20:20 +0300
Processing by EstimatesController#index as HTML
  Parameters: {"client_id"=>"1"}
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mClient Load (0.8ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (2.7ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = 1[0m
  Rendering estimates/index.html.haml within layouts/application
  Rendered estimates/_listing.html.haml (3.7ms)
  Rendered estimates/_listing.html.haml (1.0ms)
  Rendered estimates/index.html.haml within layouts/application (17.3ms)
  Rendered layouts/_header.html.haml (10.8ms)
Completed 200 OK in 547ms (Views: 533.3ms | ActiveRecord: 4.4ms)


Started GET "/clients" for 127.0.0.1 at 2017-04-27 00:20:30 +0300
Processing by ClientsController#index as HTML
  [1m[36mUser Load (3.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering clients/index.html.haml within layouts/application
  [1m[36mUserClient Load (3.4ms)[0m  [1m[34mSELECT "user_clients".* FROM "user_clients" INNER JOIN "clients" ON "clients"."id" = "user_clients"."client_id" AND "clients"."deleted_at" IS NULL WHERE "clients"."archived" = $1 AND (user_id = 1 and owner = true)[0m  [["archived", false]]
  [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" IN (1, 2, 3)[0m
  [1m[36mEstimate Load (0.7ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" IN (1, 2, 3)[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 1]]
  Rendered clients/_listing.html.haml (10.8ms)
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 2]]
  Rendered clients/_listing.html.haml (4.3ms)
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 3]]
  Rendered clients/_listing.html.haml (4.4ms)
  Rendered clients/_table.html.haml (27.3ms)
  [1m[36mUserClient Load (0.8ms)[0m  [1m[34mSELECT "user_clients".* FROM "user_clients" INNER JOIN "clients" ON "clients"."id" = "user_clients"."client_id" AND "clients"."deleted_at" IS NULL WHERE "clients"."archived" = $1 AND (user_id = 1 and owner = false)[0m  [["archived", false]]
  Rendered clients/index.html.haml within layouts/application (50.1ms)
  Rendered layouts/_header.html.haml (13.7ms)
Completed 200 OK in 880ms (Views: 863.2ms | ActiveRecord: 11.5ms)


Started GET "/estimates?client_id=1" for 127.0.0.1 at 2017-04-27 00:20:32 +0300
Processing by EstimatesController#index as HTML
  Parameters: {"client_id"=>"1"}
  [1m[36mUser Load (1.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mClient Load (5.0ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (1.2ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = 1[0m
  Rendering estimates/index.html.haml within layouts/application
  Rendered estimates/_listing.html.haml (4.8ms)
  Rendered estimates/_listing.html.haml (1.0ms)
  Rendered estimates/index.html.haml within layouts/application (17.9ms)
  Rendered layouts/_header.html.haml (19.8ms)
Completed 200 OK in 671ms (Views: 653.7ms | ActiveRecord: 7.8ms)


Started GET "/estimates?client_id=1" for 127.0.0.1 at 2017-04-27 00:32:34 +0300
Processing by EstimatesController#index as HTML
  Parameters: {"client_id"=>"1"}
  [1m[36mUser Load (1.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mClient Load (2.8ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (1.9ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = 1[0m
  Rendering estimates/index.html.haml within layouts/application
  Rendered estimates/_listing.html.haml (4.6ms)
  Rendered estimates/_listing.html.haml (1.0ms)
  [1m[36mClient Load (0.6ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  Rendered estimates/index.html.haml within layouts/application (25.1ms)
  Rendered layouts/_header.html.haml (9.2ms)
Completed 200 OK in 595ms (Views: 578.0ms | ActiveRecord: 6.8ms)


Started GET "/estimates?client_id=1" for 127.0.0.1 at 2017-04-27 00:33:09 +0300
Processing by EstimatesController#index as HTML
  Parameters: {"client_id"=>"1"}
  [1m[36mUser Load (4.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mClient Load (1.0ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (0.7ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = 1[0m
  Rendering estimates/index.html.haml within layouts/application
  Rendered estimates/_listing.html.haml (3.7ms)
  Rendered estimates/_listing.html.haml (1.1ms)
  [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  Rendered estimates/index.html.haml within layouts/application (17.0ms)
  Rendered layouts/_header.html.haml (20.6ms)
Completed 200 OK in 727ms (Views: 709.8ms | ActiveRecord: 6.4ms)


Started GET "/estimates?client_id=1" for 127.0.0.1 at 2017-04-27 00:35:40 +0300
Processing by EstimatesController#index as HTML
  Parameters: {"client_id"=>"1"}
  [1m[36mUser Load (1.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mClient Load (1.6ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (1.7ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = 1[0m
  Rendering estimates/index.html.haml within layouts/application
  Rendered estimates/_listing.html.haml (7.6ms)
  Rendered estimates/_listing.html.haml (1.9ms)
  [1m[36mClient Load (0.8ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  [1m[36mCACHE (1.1ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  Rendered estimates/index.html.haml within layouts/application (39.7ms)
  Rendered layouts/_header.html.haml (13.3ms)
Completed 200 OK in 709ms (Views: 688.9ms | ActiveRecord: 6.7ms)


Started GET "/estimates?client_id=1" for 127.0.0.1 at 2017-04-27 00:36:05 +0300
Processing by EstimatesController#index as HTML
  Parameters: {"client_id"=>"1"}
  [1m[36mUser Load (1.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mClient Load (2.4ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (0.9ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = 1[0m
  Rendering estimates/index.html.haml within layouts/application
  Rendered estimates/_listing.html.haml (6.7ms)
  Rendered estimates/_listing.html.haml (1.3ms)
  [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  Rendered estimates/index.html.haml within layouts/application (34.6ms)
  Rendered layouts/_header.html.haml (10.4ms)
Completed 200 OK in 590ms (Views: 575.5ms | ActiveRecord: 5.4ms)


Started GET "/estimates?client_id=1" for 127.0.0.1 at 2017-04-27 00:36:54 +0300
Processing by EstimatesController#index as HTML
  Parameters: {"client_id"=>"1"}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mClient Load (1.8ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (0.8ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = 1[0m
  Rendering estimates/index.html.haml within layouts/application
  Rendered estimates/_listing.html.haml (4.3ms)
  Rendered estimates/_listing.html.haml (1.4ms)
  [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  Rendered estimates/index.html.haml within layouts/application (30.8ms)
  Rendered layouts/_header.html.haml (10.9ms)
Completed 200 OK in 620ms (Views: 606.4ms | ActiveRecord: 4.0ms)


Started GET "/estimates?client_id=1" for 127.0.0.1 at 2017-04-27 00:37:45 +0300
Processing by EstimatesController#index as HTML
  Parameters: {"client_id"=>"1"}
  [1m[36mUser Load (3.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mClient Load (3.5ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (4.0ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = 1[0m
  Rendering estimates/index.html.haml within layouts/application
  Rendered estimates/_listing.html.haml (4.5ms)
  Rendered estimates/_listing.html.haml (1.4ms)
  [1m[36mClient Load (0.6ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  Rendered estimates/index.html.haml within layouts/application (21.4ms)
  Rendered layouts/_header.html.haml (10.0ms)
Completed 200 OK in 640ms (Views: 615.3ms | ActiveRecord: 11.6ms)


Started GET "/estimates?client_id=1" for 127.0.0.1 at 2017-04-27 00:44:48 +0300
Processing by EstimatesController#index as HTML
  Parameters: {"client_id"=>"1"}
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mClient Load (0.6ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (0.9ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = 1[0m
  Rendering estimates/index.html.haml within layouts/application
  Rendered estimates/_listing.html.haml (4.8ms)
  Rendered estimates/_listing.html.haml (1.0ms)
  [1m[36mClient Load (0.6ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  Rendered estimates/index.html.haml within layouts/application (23.4ms)
  Rendered layouts/_header.html.haml (12.4ms)
Completed 200 OK in 1754ms (Views: 1743.8ms | ActiveRecord: 3.0ms)


Started GET "/estimates/2/edit" for 127.0.0.1 at 2017-04-27 00:44:53 +0300
Processing by EstimatesController#edit as HTML
  Parameters: {"id"=>"2"}
  [1m[36mProduct Load (2.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (0.4ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (0.7ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = 1[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.5ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (2.9ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (1.5ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.8ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (3.3ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mConstructorObject Load (0.5ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mUnit Load (1.2ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  [1m[36mProductTemplateSet Load (0.9ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (1.1ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUnit Load (0.5ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (0.7ms)[0m  [1m[34mSELECT  "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.4ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStage Load (0.8ms)[0m  [1m[34mSELECT "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mStageProduct Load (1.3ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" IN (4, 5, 6)[0m
  [1m[36mStageProduct Load (0.7ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 4]]
  [1m[36mStageProductSet Load (0.8ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 4[0m
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 1[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mStageProduct Load (0.7ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 5]]
  [1m[36mStageProductSet Load (0.7ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 5[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 2[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mStageProduct Load (0.5ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 6]]
  [1m[36mStageProductSet Load (0.5ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 6[0m
  [1m[36mProduct Load (0.9ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 3[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mStageProductSet Load (0.8ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = $1[0m  [["stage_product_id", 6]]
  [1m[36mStageProductSetValue Load (0.8ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = 2[0m
  [1m[36mProductSet Load (0.7ms)[0m  [1m[34mSELECT  "product_sets".* FROM "product_sets" WHERE "product_sets"."deleted_at" IS NULL AND "product_sets"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStageProductSetValue Load (0.5ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1[0m  [["stage_product_set_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  Rendering estimates/edit.html.haml within layouts/application
  [1m[36mClient Load (0.8ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (14.6ms)
  [1m[36mClientFile Load (0.7ms)[0m  [1m[34mSELECT "client_files".* FROM "client_files" WHERE "client_files"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mAssetFile Load (0.5ms)[0m  [1m[34mSELECT  "asset_files".* FROM "asset_files" WHERE "asset_files"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendered estimates/_client_file_fields.html.haml (24.4ms)
  Rendered estimates/_technical_file_fields.html.haml (6.6ms)
  [1m[36mTechnicalFile Load (0.7ms)[0m  [1m[34mSELECT "technical_files".* FROM "technical_files" WHERE "technical_files"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mAssetFile Load (1.8ms)[0m  [1m[34mSELECT  "asset_files".* FROM "asset_files" WHERE "asset_files"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  Rendered estimates/_technical_file_fields.html.haml (9.0ms)
  Rendered estimates/_discount.html.haml (7.8ms)
  Rendered estimates/_stages.html.haml (22.6ms)
  Rendered estimates/_form.html.haml (201.7ms)
  Rendered estimates/edit.html.haml within layouts/application (204.9ms)
  Rendered layouts/_header.html.haml (8.1ms)
Completed 200 OK in 1112ms (Views: 707.8ms | ActiveRecord: 110.2ms)


Started GET "/estimates/2/edit" for 127.0.0.1 at 2017-04-27 00:45:04 +0300
Processing by EstimatesController#edit as HTML
  Parameters: {"id"=>"2"}
  [1m[36mProduct Load (5.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (1.3ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (0.7ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = 1[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.8ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.9ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (0.8ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (2.4ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  [1m[36mProductTemplateSet Load (3.1ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (1.0ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (2.0ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (1.2ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (0.9ms)[0m  [1m[34mSELECT  "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.6ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStage Load (0.7ms)[0m  [1m[34mSELECT "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mStageProduct Load (0.7ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" IN (4, 5, 6)[0m
  [1m[36mStageProduct Load (2.9ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 4]]
  [1m[36mStageProductSet Load (1.1ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 4[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 1[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mStageProduct Load (0.6ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 5]]
  [1m[36mStageProductSet Load (0.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 5[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 2[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mStageProduct Load (0.6ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 6]]
  [1m[36mStageProductSet Load (1.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 6[0m
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 3[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mStageProductSet Load (0.8ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = $1[0m  [["stage_product_id", 6]]
  [1m[36mStageProductSetValue Load (1.0ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = 2[0m
  [1m[36mProductSet Load (2.0ms)[0m  [1m[34mSELECT  "product_sets".* FROM "product_sets" WHERE "product_sets"."deleted_at" IS NULL AND "product_sets"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStageProductSetValue Load (1.1ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1[0m  [["stage_product_set_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  Rendering estimates/edit.html.haml within layouts/application
  [1m[36mClient Load (0.6ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (3.4ms)
  [1m[36mClientFile Load (0.6ms)[0m  [1m[34mSELECT "client_files".* FROM "client_files" WHERE "client_files"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mAssetFile Load (0.5ms)[0m  [1m[34mSELECT  "asset_files".* FROM "asset_files" WHERE "asset_files"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendered estimates/_client_file_fields.html.haml (6.5ms)
  Rendered estimates/_technical_file_fields.html.haml (3.9ms)
  [1m[36mTechnicalFile Load (0.7ms)[0m  [1m[34mSELECT "technical_files".* FROM "technical_files" WHERE "technical_files"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mAssetFile Load (0.5ms)[0m  [1m[34mSELECT  "asset_files".* FROM "asset_files" WHERE "asset_files"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  Rendered estimates/_technical_file_fields.html.haml (7.0ms)
  Rendered estimates/_discount.html.haml (8.3ms)
  Rendered estimates/_stages.html.haml (18.9ms)
  Rendered estimates/_form.html.haml (102.0ms)
  Rendered estimates/edit.html.haml within layouts/application (105.2ms)
  Rendered layouts/_header.html.haml (9.7ms)
Completed 200 OK in 1744ms (Views: 1587.0ms | ActiveRecord: 48.4ms)


Started GET "/estimates/2/edit" for 127.0.0.1 at 2017-04-27 00:52:21 +0300
Processing by EstimatesController#edit as HTML
  Parameters: {"id"=>"2"}
  [1m[36mProduct Load (0.9ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (3.3ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = 1[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (1.6ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (0.8ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.8ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  [1m[36mProductTemplateSet Load (0.8ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (1.6ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (0.8ms)[0m  [1m[34mSELECT  "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.6ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStage Load (0.7ms)[0m  [1m[34mSELECT "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mStageProduct Load (0.9ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" IN (4, 5, 6)[0m
  [1m[36mStageProduct Load (0.8ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 4]]
  [1m[36mStageProductSet Load (0.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 4[0m
  [1m[36mProduct Load (3.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 1[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mStageProduct Load (1.5ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 5]]
  [1m[36mStageProductSet Load (2.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 5[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 2[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mStageProduct Load (0.6ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 6]]
  [1m[36mStageProductSet Load (0.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 6[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 3[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mStageProductSet Load (0.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = $1[0m  [["stage_product_id", 6]]
  [1m[36mStageProductSetValue Load (1.0ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = 2[0m
  [1m[36mProductSet Load (0.7ms)[0m  [1m[34mSELECT  "product_sets".* FROM "product_sets" WHERE "product_sets"."deleted_at" IS NULL AND "product_sets"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStageProductSetValue Load (1.0ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1[0m  [["stage_product_set_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  Rendering estimates/edit.html.haml within layouts/application
  [1m[36mClient Load (0.8ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (3.7ms)
  [1m[36mClientFile Load (0.6ms)[0m  [1m[34mSELECT "client_files".* FROM "client_files" WHERE "client_files"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mAssetFile Load (0.5ms)[0m  [1m[34mSELECT  "asset_files".* FROM "asset_files" WHERE "asset_files"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendered estimates/_client_file_fields.html.haml (7.9ms)
  Rendered estimates/_technical_file_fields.html.haml (3.3ms)
  [1m[36mTechnicalFile Load (0.6ms)[0m  [1m[34mSELECT "technical_files".* FROM "technical_files" WHERE "technical_files"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mAssetFile Load (0.5ms)[0m  [1m[34mSELECT  "asset_files".* FROM "asset_files" WHERE "asset_files"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  Rendered estimates/_technical_file_fields.html.haml (7.3ms)
  Rendered estimates/_discount.html.haml (28.9ms)
  Rendered estimates/_stages.html.haml (15.0ms)
  Rendered estimates/_form.html.haml (125.0ms)
  Rendered estimates/edit.html.haml within layouts/application (128.2ms)
  Rendered layouts/_header.html.haml (32.8ms)
Completed 200 OK in 1743ms (Views: 1606.5ms | ActiveRecord: 41.5ms)


Started GET "/estimates/2/edit" for 127.0.0.1 at 2017-04-27 00:53:21 +0300
Processing by EstimatesController#edit as HTML
  Parameters: {"id"=>"2"}
  [1m[36mProduct Load (1.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (1.2ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (0.9ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = 1[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.5ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.9ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (0.9ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.6ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mConstructorObject Load (0.9ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  [1m[36mProductTemplateSet Load (0.7ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.9ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (2.0ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (1.4ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (4.5ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (0.9ms)[0m  [1m[34mSELECT  "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.5ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStage Load (0.8ms)[0m  [1m[34mSELECT "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mStageProduct Load (0.7ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" IN (4, 5, 6)[0m
  [1m[36mStageProduct Load (0.8ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 4]]
  [1m[36mStageProductSet Load (0.7ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 4[0m
  [1m[36mProduct Load (0.9ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 1[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mStageProduct Load (0.6ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 5]]
  [1m[36mStageProductSet Load (0.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 5[0m
  [1m[36mProduct Load (1.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 2[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mStageProduct Load (0.6ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 6]]
  [1m[36mStageProductSet Load (0.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 6[0m
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 3[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mStageProductSet Load (5.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = $1[0m  [["stage_product_id", 6]]
  [1m[36mStageProductSetValue Load (1.7ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = 2[0m
  [1m[36mProductSet Load (0.8ms)[0m  [1m[34mSELECT  "product_sets".* FROM "product_sets" WHERE "product_sets"."deleted_at" IS NULL AND "product_sets"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStageProductSetValue Load (0.7ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1[0m  [["stage_product_set_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  Rendering estimates/edit.html.haml within layouts/application
  [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (5.7ms)
  [1m[36mClientFile Load (0.6ms)[0m  [1m[34mSELECT "client_files".* FROM "client_files" WHERE "client_files"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mAssetFile Load (0.5ms)[0m  [1m[34mSELECT  "asset_files".* FROM "asset_files" WHERE "asset_files"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendered estimates/_client_file_fields.html.haml (6.0ms)
  Rendered estimates/_technical_file_fields.html.haml (3.4ms)
  [1m[36mTechnicalFile Load (0.7ms)[0m  [1m[34mSELECT "technical_files".* FROM "technical_files" WHERE "technical_files"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mAssetFile Load (0.4ms)[0m  [1m[34mSELECT  "asset_files".* FROM "asset_files" WHERE "asset_files"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  Rendered estimates/_technical_file_fields.html.haml (6.3ms)
  Rendered estimates/_discount.html.haml (10.1ms)
  Rendered estimates/_stages.html.haml (23.5ms)
  Rendered estimates/_form.html.haml (112.3ms)
  Rendered estimates/edit.html.haml within layouts/application (117.2ms)
  Rendered layouts/_header.html.haml (8.1ms)
Completed 200 OK in 1789ms (Views: 1640.8ms | ActiveRecord: 44.6ms)


Started GET "/estimates/2/edit" for 127.0.0.1 at 2017-04-27 00:54:28 +0300
Processing by EstimatesController#edit as HTML
  Parameters: {"id"=>"2"}
  [1m[36mProduct Load (1.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (1.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (3.5ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (1.3ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = 1[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (1.2ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (2.5ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (1.2ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (3.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (1.3ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (1.2ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.9ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  [1m[36mProductTemplateSet Load (0.8ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (1.0ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (1.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (1.8ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (1.9ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUnit Load (0.9ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (1.4ms)[0m  [1m[34mSELECT  "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.4ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStage Load (0.5ms)[0m  [1m[34mSELECT "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mStageProduct Load (0.5ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" IN (4, 5, 6)[0m
  [1m[36mStageProduct Load (0.6ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 4]]
  [1m[36mStageProductSet Load (0.5ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 4[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 1[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mStageProduct Load (0.6ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 5]]
  [1m[36mStageProductSet Load (0.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 5[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 2[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mStageProduct Load (0.7ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 6]]
  [1m[36mStageProductSet Load (0.7ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 6[0m
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 3[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mStageProductSet Load (0.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = $1[0m  [["stage_product_id", 6]]
  [1m[36mStageProductSetValue Load (0.6ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = 2[0m
  [1m[36mProductSet Load (0.6ms)[0m  [1m[34mSELECT  "product_sets".* FROM "product_sets" WHERE "product_sets"."deleted_at" IS NULL AND "product_sets"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStageProductSetValue Load (0.7ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1[0m  [["stage_product_set_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  Rendering estimates/edit.html.haml within layouts/application
  [1m[36mClient Load (0.5ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (2.9ms)
  [1m[36mClientFile Load (0.5ms)[0m  [1m[34mSELECT "client_files".* FROM "client_files" WHERE "client_files"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mAssetFile Load (0.4ms)[0m  [1m[34mSELECT  "asset_files".* FROM "asset_files" WHERE "asset_files"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendered estimates/_client_file_fields.html.haml (5.0ms)
  Rendered estimates/_technical_file_fields.html.haml (3.8ms)
  [1m[36mTechnicalFile Load (0.5ms)[0m  [1m[34mSELECT "technical_files".* FROM "technical_files" WHERE "technical_files"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mAssetFile Load (0.4ms)[0m  [1m[34mSELECT  "asset_files".* FROM "asset_files" WHERE "asset_files"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  Rendered estimates/_technical_file_fields.html.haml (5.4ms)
  Rendered estimates/_discount.html.haml (5.7ms)
  Rendered estimates/_stages.html.haml (14.4ms)
  Rendered estimates/_form.html.haml (81.2ms)
  Rendered estimates/edit.html.haml within layouts/application (84.4ms)
  Rendered layouts/_header.html.haml (10.4ms)
Completed 200 OK in 1608ms (Views: 1459.4ms | ActiveRecord: 44.6ms)


Started GET "/estimates/2/edit" for 127.0.0.1 at 2017-04-27 00:55:29 +0300
Processing by EstimatesController#edit as HTML
  Parameters: {"id"=>"2"}
  [1m[36mProduct Load (0.9ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (0.7ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = 1[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (1.4ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (1.3ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (0.9ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.9ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  [1m[36mProductTemplateSet Load (0.7ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (1.1ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (2.6ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUnit Load (1.1ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (0.8ms)[0m  [1m[34mSELECT  "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.5ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStage Load (0.7ms)[0m  [1m[34mSELECT "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mStageProduct Load (0.6ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" IN (4, 5, 6)[0m
  [1m[36mStageProduct Load (0.8ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 4]]
  [1m[36mStageProductSet Load (0.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 4[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 1[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mStageProduct Load (4.6ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 5]]
  [1m[36mStageProductSet Load (0.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 5[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 2[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mStageProduct Load (1.0ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 6]]
  [1m[36mStageProductSet Load (0.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 6[0m
  [1m[36mProduct Load (1.1ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 3[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mStageProductSet Load (0.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = $1[0m  [["stage_product_id", 6]]
  [1m[36mStageProductSetValue Load (0.6ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = 2[0m
  [1m[36mProductSet Load (0.6ms)[0m  [1m[34mSELECT  "product_sets".* FROM "product_sets" WHERE "product_sets"."deleted_at" IS NULL AND "product_sets"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStageProductSetValue Load (1.9ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1[0m  [["stage_product_set_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  Rendering estimates/edit.html.haml within layouts/application
  [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (4.9ms)
  [1m[36mClientFile Load (0.7ms)[0m  [1m[34mSELECT "client_files".* FROM "client_files" WHERE "client_files"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mAssetFile Load (0.5ms)[0m  [1m[34mSELECT  "asset_files".* FROM "asset_files" WHERE "asset_files"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendered estimates/_client_file_fields.html.haml (8.3ms)
  Rendered estimates/_technical_file_fields.html.haml (5.3ms)
  [1m[36mTechnicalFile Load (2.8ms)[0m  [1m[34mSELECT "technical_files".* FROM "technical_files" WHERE "technical_files"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mAssetFile Load (0.4ms)[0m  [1m[34mSELECT  "asset_files".* FROM "asset_files" WHERE "asset_files"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  Rendered estimates/_technical_file_fields.html.haml (8.2ms)
  Rendered estimates/_discount.html.haml (10.7ms)
  Rendered estimates/_stages.html.haml (31.0ms)
  Rendered estimates/_form.html.haml (159.2ms)
  Rendered estimates/edit.html.haml within layouts/application (163.7ms)
  Rendered layouts/_header.html.haml (9.9ms)
Completed 200 OK in 1905ms (Views: 1745.9ms | ActiveRecord: 43.1ms)


Started GET "/estimates/2/edit" for 127.0.0.1 at 2017-04-27 00:56:54 +0300
Processing by EstimatesController#edit as HTML
  Parameters: {"id"=>"2"}
  [1m[36mProduct Load (1.1ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (0.6ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = 1[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.9ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.7ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (0.9ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.7ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.8ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  [1m[36mProductTemplateSet Load (0.7ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.8ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (2.1ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (0.7ms)[0m  [1m[34mSELECT  "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.6ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStage Load (0.7ms)[0m  [1m[34mSELECT "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mStageProduct Load (2.1ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" IN (4, 5, 6)[0m
  [1m[36mStageProduct Load (1.4ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 4]]
  [1m[36mStageProductSet Load (1.0ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 4[0m
  [1m[36mProduct Load (2.3ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 1[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mStageProduct Load (2.5ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 5]]
  [1m[36mStageProductSet Load (0.8ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 5[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 2[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mStageProduct Load (0.6ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 6]]
  [1m[36mStageProductSet Load (2.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 6[0m
  [1m[36mProduct Load (1.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 3[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mStageProductSet Load (2.3ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = $1[0m  [["stage_product_id", 6]]
  [1m[36mStageProductSetValue Load (0.6ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = 2[0m
  [1m[36mProductSet Load (0.6ms)[0m  [1m[34mSELECT  "product_sets".* FROM "product_sets" WHERE "product_sets"."deleted_at" IS NULL AND "product_sets"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStageProductSetValue Load (0.8ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1[0m  [["stage_product_set_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mCACHE (1.8ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  Rendering estimates/edit.html.haml within layouts/application
  [1m[36mClient Load (0.6ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (5.3ms)
  [1m[36mClientFile Load (3.1ms)[0m  [1m[34mSELECT "client_files".* FROM "client_files" WHERE "client_files"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mAssetFile Load (0.8ms)[0m  [1m[34mSELECT  "asset_files".* FROM "asset_files" WHERE "asset_files"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendered estimates/_client_file_fields.html.haml (8.4ms)
  Rendered estimates/_technical_file_fields.html.haml (5.1ms)
  [1m[36mTechnicalFile Load (0.5ms)[0m  [1m[34mSELECT "technical_files".* FROM "technical_files" WHERE "technical_files"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mAssetFile Load (2.5ms)[0m  [1m[34mSELECT  "asset_files".* FROM "asset_files" WHERE "asset_files"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  Rendered estimates/_technical_file_fields.html.haml (11.7ms)
  Rendered estimates/_discount.html.haml (9.1ms)
  Rendered estimates/_stages.html.haml (18.8ms)
  Rendered estimates/_form.html.haml (130.2ms)
  Rendered estimates/edit.html.haml within layouts/application (165.5ms)
  Rendered layouts/_header.html.haml (35.0ms)
Completed 200 OK in 1996ms (Views: 1839.2ms | ActiveRecord: 49.6ms)


Started GET "/estimates/2/edit" for 127.0.0.1 at 2017-04-27 00:59:08 +0300
Processing by EstimatesController#edit as HTML
  Parameters: {"id"=>"2"}
  [1m[36mProduct Load (1.1ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (1.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (0.8ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = 1[0m
  [1m[36mProduct Load (0.9ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (2.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.7ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (1.5ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (1.3ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (0.8ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.8ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (5.1ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  [1m[36mProductTemplateSet Load (1.5ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (3.4ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (1.1ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (1.2ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (4.7ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (1.9ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUnit Load (4.7ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (0.7ms)[0m  [1m[34mSELECT  "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.4ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStage Load (0.8ms)[0m  [1m[34mSELECT "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mStageProduct Load (0.6ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" IN (4, 5, 6)[0m
  [1m[36mStageProduct Load (0.7ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 4]]
  [1m[36mStageProductSet Load (0.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 4[0m
  [1m[36mProduct Load (3.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 1[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mStageProduct Load (0.7ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 5]]
  [1m[36mStageProductSet Load (0.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 5[0m
  [1m[36mProduct Load (0.5ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 2[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mStageProduct Load (0.5ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 6]]
  [1m[36mStageProductSet Load (0.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 6[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 3[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mStageProductSet Load (0.7ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = $1[0m  [["stage_product_id", 6]]
  [1m[36mStageProductSetValue Load (1.0ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = 2[0m
  [1m[36mProductSet Load (0.5ms)[0m  [1m[34mSELECT  "product_sets".* FROM "product_sets" WHERE "product_sets"."deleted_at" IS NULL AND "product_sets"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStageProductSetValue Load (1.2ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1[0m  [["stage_product_set_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  Rendering estimates/edit.html.haml within layouts/application
  [1m[36mClient Load (0.5ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (5.7ms)
  [1m[36mClientFile Load (0.6ms)[0m  [1m[34mSELECT "client_files".* FROM "client_files" WHERE "client_files"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mAssetFile Load (0.3ms)[0m  [1m[34mSELECT  "asset_files".* FROM "asset_files" WHERE "asset_files"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendered estimates/_client_file_fields.html.haml (8.1ms)
  Rendered estimates/_technical_file_fields.html.haml (2.8ms)
  [1m[36mTechnicalFile Load (0.7ms)[0m  [1m[34mSELECT "technical_files".* FROM "technical_files" WHERE "technical_files"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mAssetFile Load (1.5ms)[0m  [1m[34mSELECT  "asset_files".* FROM "asset_files" WHERE "asset_files"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  Rendered estimates/_technical_file_fields.html.haml (7.9ms)
  Rendered estimates/_discount.html.haml (11.3ms)
  Rendered estimates/_stages.html.haml (16.2ms)
  Rendered estimates/_form.html.haml (101.5ms)
  Rendered estimates/edit.html.haml within layouts/application (105.1ms)
  Rendered layouts/_header.html.haml (8.8ms)
Completed 200 OK in 1818ms (Views: 1671.1ms | ActiveRecord: 56.6ms)


Started GET "/estimates/2/edit" for 127.0.0.1 at 2017-04-27 01:01:06 +0300
Processing by EstimatesController#edit as HTML
  Parameters: {"id"=>"2"}
  [1m[36mProduct Load (3.4ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (2.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (0.5ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = 1[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (2.3ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (1.2ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (2.3ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.5ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (1.8ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  [1m[36mProductTemplateSet Load (0.7ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.5ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.5ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.5ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (4.1ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (0.7ms)[0m  [1m[34mSELECT  "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.3ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStage Load (3.6ms)[0m  [1m[34mSELECT "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mStageProduct Load (1.2ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" IN (4, 5, 6)[0m
  [1m[36mStageProduct Load (1.2ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 4]]
  [1m[36mStageProductSet Load (0.5ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 4[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 1[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mStageProduct Load (0.9ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 5]]
  [1m[36mStageProductSet Load (0.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 5[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 2[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mStageProduct Load (0.6ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 6]]
  [1m[36mStageProductSet Load (0.5ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 6[0m
  [1m[36mProduct Load (1.1ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 3[0m
  [1m[36mCACHE (0.1ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mStageProductSet Load (0.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = $1[0m  [["stage_product_id", 6]]
  [1m[36mStageProductSetValue Load (0.7ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = 2[0m
  [1m[36mProductSet Load (0.7ms)[0m  [1m[34mSELECT  "product_sets".* FROM "product_sets" WHERE "product_sets"."deleted_at" IS NULL AND "product_sets"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStageProductSetValue Load (0.6ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1[0m  [["stage_product_set_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  Rendering estimates/edit.html.haml within layouts/application
  [1m[36mClient Load (0.5ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (3.7ms)
  [1m[36mClientFile Load (0.6ms)[0m  [1m[34mSELECT "client_files".* FROM "client_files" WHERE "client_files"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mAssetFile Load (0.7ms)[0m  [1m[34mSELECT  "asset_files".* FROM "asset_files" WHERE "asset_files"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendered estimates/_client_file_fields.html.haml (6.0ms)
  Rendered estimates/_technical_file_fields.html.haml (3.3ms)
  [1m[36mTechnicalFile Load (0.8ms)[0m  [1m[34mSELECT "technical_files".* FROM "technical_files" WHERE "technical_files"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mAssetFile Load (0.5ms)[0m  [1m[34mSELECT  "asset_files".* FROM "asset_files" WHERE "asset_files"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  Rendered estimates/_technical_file_fields.html.haml (6.0ms)
  Rendered estimates/_discount.html.haml (14.2ms)
  Rendered estimates/_stages.html.haml (28.7ms)
  Rendered estimates/_form.html.haml (128.1ms)
  Rendered estimates/edit.html.haml within layouts/application (134.4ms)
  Rendered layouts/_header.html.haml (9.7ms)
Completed 200 OK in 1993ms (Views: 1845.1ms | ActiveRecord: 44.3ms)


Started GET "/estimates/2/edit" for 127.0.0.1 at 2017-04-27 01:01:41 +0300
Processing by EstimatesController#edit as HTML
  Parameters: {"id"=>"2"}
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (1.2ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (6.4ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = 1[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (2.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (1.3ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (1.9ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (3.5ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.6ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mConstructorObject Load (0.9ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  [1m[36mProductTemplateSet Load (0.6ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.5ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.5ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUnit Load (2.8ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (0.7ms)[0m  [1m[34mSELECT  "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.3ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStage Load (0.6ms)[0m  [1m[34mSELECT "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mStageProduct Load (0.5ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" IN (4, 5, 6)[0m
  [1m[36mStageProduct Load (0.5ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 4]]
  [1m[36mStageProductSet Load (0.7ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 4[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 1[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mStageProduct Load (0.6ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 5]]
  [1m[36mStageProductSet Load (0.5ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 5[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 2[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mStageProduct Load (0.5ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 6]]
  [1m[36mStageProductSet Load (0.5ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 6[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 3[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mStageProductSet Load (0.7ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = $1[0m  [["stage_product_id", 6]]
  [1m[36mStageProductSetValue Load (0.5ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = 2[0m
  [1m[36mProductSet Load (0.5ms)[0m  [1m[34mSELECT  "product_sets".* FROM "product_sets" WHERE "product_sets"."deleted_at" IS NULL AND "product_sets"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStageProductSetValue Load (0.6ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1[0m  [["stage_product_set_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  Rendering estimates/edit.html.haml within layouts/application
  [1m[36mClient Load (0.5ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (3.3ms)
  [1m[36mClientFile Load (0.5ms)[0m  [1m[34mSELECT "client_files".* FROM "client_files" WHERE "client_files"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mAssetFile Load (0.3ms)[0m  [1m[34mSELECT  "asset_files".* FROM "asset_files" WHERE "asset_files"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendered estimates/_client_file_fields.html.haml (5.8ms)
  Rendered estimates/_technical_file_fields.html.haml (3.3ms)
  [1m[36mTechnicalFile Load (0.7ms)[0m  [1m[34mSELECT "technical_files".* FROM "technical_files" WHERE "technical_files"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mAssetFile Load (0.7ms)[0m  [1m[34mSELECT  "asset_files".* FROM "asset_files" WHERE "asset_files"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  Rendered estimates/_technical_file_fields.html.haml (6.3ms)
  Rendered estimates/_discount.html.haml (9.1ms)
  Rendered estimates/_stages.html.haml (16.7ms)
  Rendered estimates/_form.html.haml (112.4ms)
  Rendered estimates/edit.html.haml within layouts/application (115.7ms)
  Rendered layouts/_header.html.haml (16.8ms)
Completed 200 OK in 1787ms (Views: 1644.5ms | ActiveRecord: 41.5ms)


Started GET "/estimates/2/edit" for 127.0.0.1 at 2017-04-27 01:07:23 +0300
Processing by EstimatesController#edit as HTML
  Parameters: {"id"=>"2"}
  [1m[36mProduct Load (0.5ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (1.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (0.7ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = 1[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.7ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (0.8ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.6ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.5ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mConstructorObject Load (1.9ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  [1m[36mProductTemplateSet Load (0.7ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (1.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.9ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (0.8ms)[0m  [1m[34mSELECT  "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUser Load (1.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.3ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStage Load (0.9ms)[0m  [1m[34mSELECT "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mStageProduct Load (0.6ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" IN (4, 5, 6)[0m
  [1m[36mStageProduct Load (0.5ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 4]]
  [1m[36mStageProductSet Load (0.4ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 4[0m
  [1m[36mProduct Load (2.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 1[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mStageProduct Load (0.8ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 5]]
  [1m[36mStageProductSet Load (0.5ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 5[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 2[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mStageProduct Load (0.5ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 6]]
  [1m[36mStageProductSet Load (0.5ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 6[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 3[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mStageProductSet Load (0.9ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = $1[0m  [["stage_product_id", 6]]
  [1m[36mStageProductSetValue Load (3.9ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = 2[0m
  [1m[36mProductSet Load (0.7ms)[0m  [1m[34mSELECT  "product_sets".* FROM "product_sets" WHERE "product_sets"."deleted_at" IS NULL AND "product_sets"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStageProductSetValue Load (0.6ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1[0m  [["stage_product_set_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  Rendering estimates/edit.html.haml within layouts/application
  [1m[36mClient Load (0.6ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (13.7ms)
  [1m[36mClientFile Load (0.7ms)[0m  [1m[34mSELECT "client_files".* FROM "client_files" WHERE "client_files"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mAssetFile Load (2.6ms)[0m  [1m[34mSELECT  "asset_files".* FROM "asset_files" WHERE "asset_files"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendered estimates/_client_file_fields.html.haml (22.3ms)
  Rendered estimates/_technical_file_fields.html.haml (5.7ms)
  [1m[36mTechnicalFile Load (0.7ms)[0m  [1m[34mSELECT "technical_files".* FROM "technical_files" WHERE "technical_files"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mAssetFile Load (0.5ms)[0m  [1m[34mSELECT  "asset_files".* FROM "asset_files" WHERE "asset_files"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  Rendered estimates/_technical_file_fields.html.haml (7.1ms)
  Rendered estimates/_discount.html.haml (30.7ms)
  Rendered estimates/_stages.html.haml (13.5ms)
  Rendered estimates/_form.html.haml (209.1ms)
  Rendered estimates/edit.html.haml within layouts/application (212.2ms)
  Rendered layouts/_header.html.haml (23.6ms)
Completed 200 OK in 2075ms (Views: 1536.7ms | ActiveRecord: 140.7ms)


Started GET "/estimates/2/edit" for 127.0.0.1 at 2017-04-27 01:08:39 +0300
Processing by EstimatesController#edit as HTML
  Parameters: {"id"=>"2"}
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (1.8ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (3.3ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = 1[0m
  [1m[36mProduct Load (1.1ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.6ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (1.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (0.8ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.7ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  [1m[36mProductTemplateSet Load (0.7ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.9ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (0.8ms)[0m  [1m[34mSELECT  "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.4ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStage Load (0.6ms)[0m  [1m[34mSELECT "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mStageProduct Load (0.7ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" IN (4, 5, 6)[0m
  [1m[36mStageProduct Load (0.7ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 4]]
  [1m[36mStageProductSet Load (0.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 4[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 1[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mStageProduct Load (0.6ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 5]]
  [1m[36mStageProductSet Load (0.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 5[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 2[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mStageProduct Load (0.6ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 6]]
  [1m[36mStageProductSet Load (0.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 6[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 3[0m
  [1m[36mCACHE (0.1ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mStageProductSet Load (4.0ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = $1[0m  [["stage_product_id", 6]]
  [1m[36mStageProductSetValue Load (0.8ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = 2[0m
  [1m[36mProductSet Load (1.5ms)[0m  [1m[34mSELECT  "product_sets".* FROM "product_sets" WHERE "product_sets"."deleted_at" IS NULL AND "product_sets"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStageProductSetValue Load (0.7ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1[0m  [["stage_product_set_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  Rendering estimates/edit.html.haml within layouts/application
  [1m[36mClient Load (3.5ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (3.1ms)
  [1m[36mClientFile Load (0.6ms)[0m  [1m[34mSELECT "client_files".* FROM "client_files" WHERE "client_files"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mAssetFile Load (1.9ms)[0m  [1m[34mSELECT  "asset_files".* FROM "asset_files" WHERE "asset_files"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendered estimates/_client_file_fields.html.haml (6.9ms)
  Rendered estimates/_technical_file_fields.html.haml (2.7ms)
  [1m[36mTechnicalFile Load (0.7ms)[0m  [1m[34mSELECT "technical_files".* FROM "technical_files" WHERE "technical_files"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mAssetFile Load (2.5ms)[0m  [1m[34mSELECT  "asset_files".* FROM "asset_files" WHERE "asset_files"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  Rendered estimates/_technical_file_fields.html.haml (7.4ms)
  Rendered estimates/_discount.html.haml (6.8ms)
  Rendered estimates/_stages.html.haml (17.7ms)
  Rendered estimates/_form.html.haml (91.8ms)
  Rendered estimates/edit.html.haml within layouts/application (96.7ms)
  Rendered layouts/_header.html.haml (20.7ms)
Completed 200 OK in 1696ms (Views: 1547.0ms | ActiveRecord: 45.5ms)


Started GET "/estimates/2/edit" for 127.0.0.1 at 2017-04-27 01:10:17 +0300
Processing by EstimatesController#edit as HTML
  Parameters: {"id"=>"2"}
  [1m[36mProduct Load (0.9ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (0.6ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = 1[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (2.7ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (1.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (1.3ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (1.5ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.7ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mConstructorObject Load (1.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  [1m[36mProductTemplateSet Load (0.7ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.8ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.9ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (3.9ms)[0m  [1m[34mSELECT  "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.4ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStage Load (0.6ms)[0m  [1m[34mSELECT "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mStageProduct Load (1.9ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" IN (4, 5, 6)[0m
  [1m[36mStageProduct Load (1.0ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 4]]
  [1m[36mStageProductSet Load (0.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 4[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 1[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mStageProduct Load (0.7ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 5]]
  [1m[36mStageProductSet Load (2.3ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 5[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 2[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mStageProduct Load (0.6ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 6]]
  [1m[36mStageProductSet Load (0.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 6[0m
  [1m[36mProduct Load (1.9ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 3[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mStageProductSet Load (0.7ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = $1[0m  [["stage_product_id", 6]]
  [1m[36mStageProductSetValue Load (0.7ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = 2[0m
  [1m[36mProductSet Load (0.9ms)[0m  [1m[34mSELECT  "product_sets".* FROM "product_sets" WHERE "product_sets"."deleted_at" IS NULL AND "product_sets"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStageProductSetValue Load (0.7ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1[0m  [["stage_product_set_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  Rendering estimates/edit.html.haml within layouts/application
  [1m[36mClient Load (0.5ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (3.2ms)
  [1m[36mClientFile Load (0.8ms)[0m  [1m[34mSELECT "client_files".* FROM "client_files" WHERE "client_files"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mAssetFile Load (0.4ms)[0m  [1m[34mSELECT  "asset_files".* FROM "asset_files" WHERE "asset_files"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendered estimates/_client_file_fields.html.haml (9.0ms)
  Rendered estimates/_technical_file_fields.html.haml (3.7ms)
  [1m[36mTechnicalFile Load (2.5ms)[0m  [1m[34mSELECT "technical_files".* FROM "technical_files" WHERE "technical_files"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mAssetFile Load (0.3ms)[0m  [1m[34mSELECT  "asset_files".* FROM "asset_files" WHERE "asset_files"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  Rendered estimates/_technical_file_fields.html.haml (5.6ms)
  Rendered estimates/_discount.html.haml (7.2ms)
  Rendered estimates/_stages.html.haml (18.4ms)
  Rendered estimates/_form.html.haml (96.3ms)
  Rendered estimates/edit.html.haml within layouts/application (100.7ms)
  Rendered layouts/_header.html.haml (10.5ms)
Completed 200 OK in 1850ms (Views: 1705.2ms | ActiveRecord: 44.4ms)


Started GET "/estimates" for 127.0.0.1 at 2017-04-27 01:10:29 +0300
Processing by EstimatesController#index as HTML
  [1m[36mUser Load (1.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Redirected to http://localhost:3000/clients
Completed 302 Found in 5ms (ActiveRecord: 1.7ms)


Started GET "/clients" for 127.0.0.1 at 2017-04-27 01:10:29 +0300
Processing by ClientsController#index as HTML
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering clients/index.html.haml within layouts/application
  [1m[36mUserClient Load (1.1ms)[0m  [1m[34mSELECT "user_clients".* FROM "user_clients" INNER JOIN "clients" ON "clients"."id" = "user_clients"."client_id" AND "clients"."deleted_at" IS NULL WHERE "clients"."archived" = $1 AND (user_id = 1 and owner = true)[0m  [["archived", false]]
  [1m[36mClient Load (0.6ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" IN (1, 2, 3)[0m
  [1m[36mEstimate Load (1.1ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" IN (1, 2, 3)[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 1]]
  Rendered clients/_listing.html.haml (6.7ms)
  [1m[35m (1.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 2]]
  Rendered clients/_listing.html.haml (4.2ms)
  [1m[35m (3.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 3]]
  Rendered clients/_listing.html.haml (6.1ms)
  Rendered clients/_table.html.haml (22.1ms)
  [1m[36mUserClient Load (1.1ms)[0m  [1m[34mSELECT "user_clients".* FROM "user_clients" INNER JOIN "clients" ON "clients"."id" = "user_clients"."client_id" AND "clients"."deleted_at" IS NULL WHERE "clients"."archived" = $1 AND (user_id = 1 and owner = false)[0m  [["archived", false]]
  Rendered clients/index.html.haml within layouts/application (56.9ms)
  Rendered layouts/_header.html.haml (8.9ms)
Completed 200 OK in 535ms (Views: 509.1ms | ActiveRecord: 14.3ms)


Started GET "/estimates?client_id=1" for 127.0.0.1 at 2017-04-27 01:10:31 +0300
Processing by EstimatesController#index as HTML
  Parameters: {"client_id"=>"1"}
  [1m[36mUser Load (1.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mClient Load (1.3ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (2.8ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = 1[0m
  Rendering estimates/index.html.haml within layouts/application
  Rendered estimates/_listing.html.haml (3.3ms)
  Rendered estimates/_listing.html.haml (1.7ms)
  [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  Rendered estimates/index.html.haml within layouts/application (19.4ms)
  Rendered layouts/_header.html.haml (8.5ms)
Completed 200 OK in 526ms (Views: 511.4ms | ActiveRecord: 6.5ms)


Started GET "/estimates/new?client_id=1" for 127.0.0.1 at 2017-04-27 01:10:46 +0300
Processing by EstimatesController#new as HTML
  Parameters: {"client_id"=>"1"}
  [1m[36mProduct Load (1.1ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (1.9ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (1.2ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (1.1ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = 1[0m
  [1m[36mProduct Load (3.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.5ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (1.4ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (1.0ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (1.2ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (1.5ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mUnit Load (1.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  [1m[36mProductTemplateSet Load (1.6ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (1.1ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (1.2ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (1.4ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (1.0ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUnit Load (0.9ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mClient Load (1.1ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.7ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering estimates/new.html.haml within layouts/application
  [1m[36mClient Load (0.6ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (4.7ms)
  Rendered estimates/_technical_file_fields.html.haml (9.7ms)
  Rendered estimates/_discount.html.haml (12.6ms)
  Rendered estimates/_stages.html.haml (27.4ms)
  Rendered estimates/_form.html.haml (118.1ms)
  Rendered estimates/new.html.haml within layouts/application (120.8ms)
  Rendered layouts/_header.html.haml (8.6ms)
Completed 200 OK in 704ms (Views: 631.1ms | ActiveRecord: 29.5ms)


Started GET "/estimates/new?client_id=1" for 127.0.0.1 at 2017-04-27 01:12:17 +0300
Processing by EstimatesController#new as HTML
  Parameters: {"client_id"=>"1"}
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (0.9ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (3.1ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = 1[0m
  [1m[36mProduct Load (1.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (3.2ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (1.2ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (1.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (1.6ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.7ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  [1m[36mProductTemplateSet Load (0.8ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (1.4ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (2.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (1.1ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (4.9ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (2.0ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUnit Load (1.0ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (2.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mClient Load (0.8ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (2.9ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering estimates/new.html.haml within layouts/application
  [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (5.2ms)
  Rendered estimates/_technical_file_fields.html.haml (3.8ms)
  Rendered estimates/_discount.html.haml (13.4ms)
  Rendered estimates/_stages.html.haml (20.3ms)
  Rendered estimates/_form.html.haml (91.1ms)
  Rendered estimates/new.html.haml within layouts/application (95.8ms)
  Rendered layouts/_header.html.haml (12.2ms)
Completed 200 OK in 744ms (Views: 641.6ms | ActiveRecord: 39.0ms)


Started GET "/estimates/new?client_id=1" for 127.0.0.1 at 2017-04-27 01:13:29 +0300
Processing by EstimatesController#new as HTML
  Parameters: {"client_id"=>"1"}
  [1m[36mProduct Load (1.4ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (1.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (0.7ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = 1[0m
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (1.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (1.7ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.5ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.9ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (2.8ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.7ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  [1m[36mProductTemplateSet Load (0.8ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (1.0ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUnit Load (2.0ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.6ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering estimates/new.html.haml within layouts/application
  [1m[36mClient Load (0.6ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (4.2ms)
  Rendered estimates/_technical_file_fields.html.haml (21.7ms)
  Rendered estimates/_discount.html.haml (7.8ms)
  Rendered estimates/_stages.html.haml (19.1ms)
  Rendered estimates/_form.html.haml (104.3ms)
  Rendered estimates/new.html.haml within layouts/application (107.9ms)
  Rendered layouts/_header.html.haml (9.0ms)
Completed 200 OK in 686ms (Views: 586.7ms | ActiveRecord: 24.4ms)


Started GET "/estimates" for 127.0.0.1 at 2017-04-27 01:14:02 +0300
Processing by EstimatesController#index as HTML
  [1m[36mUser Load (5.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Redirected to http://localhost:3000/clients
Completed 302 Found in 8ms (ActiveRecord: 5.3ms)


Started GET "/clients" for 127.0.0.1 at 2017-04-27 01:14:02 +0300
Processing by ClientsController#index as HTML
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering clients/index.html.haml within layouts/application
  [1m[36mUserClient Load (3.7ms)[0m  [1m[34mSELECT "user_clients".* FROM "user_clients" INNER JOIN "clients" ON "clients"."id" = "user_clients"."client_id" AND "clients"."deleted_at" IS NULL WHERE "clients"."archived" = $1 AND (user_id = 1 and owner = true)[0m  [["archived", false]]
  [1m[36mClient Load (0.6ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" IN (1, 2, 3)[0m
  [1m[36mEstimate Load (0.9ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" IN (1, 2, 3)[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 1]]
  Rendered clients/_listing.html.haml (8.9ms)
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 2]]
  Rendered clients/_listing.html.haml (3.7ms)
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 3]]
  Rendered clients/_listing.html.haml (3.8ms)
  Rendered clients/_table.html.haml (21.4ms)
  [1m[36mUserClient Load (0.7ms)[0m  [1m[34mSELECT "user_clients".* FROM "user_clients" INNER JOIN "clients" ON "clients"."id" = "user_clients"."client_id" AND "clients"."deleted_at" IS NULL WHERE "clients"."archived" = $1 AND (user_id = 1 and owner = false)[0m  [["archived", false]]
  Rendered clients/index.html.haml within layouts/application (40.5ms)
  Rendered layouts/_header.html.haml (11.6ms)
Completed 200 OK in 612ms (Views: 599.7ms | ActiveRecord: 8.5ms)


Started GET "/composites" for 127.0.0.1 at 2017-04-27 01:20:46 +0300
Processing by CompositesController#index as HTML
  [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering composites/index.html.haml within layouts/application
  [1m[36mCategory Load (0.6ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."product" = $1[0m  [["product", false]]
  [1m[36mComposite Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Composite') AND "constructor_objects"."deleted_at" IS NULL[0m
  [1m[36mCategory Load (0.8ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" IN (1, 2)[0m
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (1, 3)[0m
  Rendered composites/_listing.html.haml (5.7ms)
  Rendered composites/_listing.html.haml (1.8ms)
  Rendered composites/index.html.haml within layouts/application (51.8ms)
  Rendered layouts/_header.html.haml (9.4ms)
Completed 200 OK in 549ms (Views: 530.9ms | ActiveRecord: 8.2ms)


Started GET "/primitives" for 127.0.0.1 at 2017-04-27 01:20:49 +0300
Processing by PrimitivesController#index as HTML
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering primitives/index.html.haml within layouts/application
  [1m[36mCategory Load (0.6ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."product" = $1[0m  [["product", false]]
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL[0m
  [1m[36mCategory Load (1.0ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL[0m
  [1m[35m (2.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 1[0m
  [1m[36mPrimitive Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 1[0m
  [1m[36mCategory Load (1.3ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" = 1[0m
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  Rendered primitives/_listing.html.haml (17.4ms)
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 2[0m
  [1m[36mPrimitive Load (2.4ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 2[0m
  [1m[36mCategory Load (0.6ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" = 2[0m
  [1m[36mUnit Load (2.3ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 2[0m
  Rendered primitives/_listing.html.haml (3.3ms)
  [1m[35m (1.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 3[0m
  [1m[36mPrimitive Load (2.4ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 3[0m
  [1m[36mCategory Load (0.5ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" = 3[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  Rendered primitives/_listing.html.haml (5.5ms)
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 4[0m
  [1m[36mPrimitive Load (1.4ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 4[0m
  [1m[36mCategory Load (2.7ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" = 4[0m
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 5)[0m
  Rendered primitives/_listing.html.haml (3.5ms)
  Rendered primitives/_listing.html.haml (3.3ms)
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 5[0m
  [1m[36mPrimitive Load (0.9ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 5[0m
  [1m[36mCategory Load (0.8ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" = 5[0m
  [1m[36mUnit Load (0.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (1, 5)[0m
  Rendered primitives/_listing.html.haml (5.0ms)
  Rendered primitives/_listing.html.haml (4.0ms)
  Rendered primitives/_listing.html.haml (4.1ms)
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 6[0m
  [1m[36mPrimitive Load (0.5ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 6[0m
  [1m[36mCategory Load (3.3ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" = 6[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 2[0m
  Rendered primitives/_listing.html.haml (3.7ms)
  Rendered primitives/_listing.html.haml (3.8ms)
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 7[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 8[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 9[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 10[0m
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 11[0m
  [1m[35m (5.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 12[0m
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 13[0m
  [1m[35m (1.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 14[0m
  [1m[35m (1.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 15[0m
  Rendered primitives/index.html.haml within layouts/application (158.0ms)
  Rendered layouts/_header.html.haml (8.9ms)
Completed 200 OK in 679ms (Views: 629.6ms | ActiveRecord: 42.1ms)


Started GET "/composites" for 127.0.0.1 at 2017-04-27 01:20:57 +0300
Processing by CompositesController#index as HTML
  [1m[36mUser Load (2.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering composites/index.html.haml within layouts/application
  [1m[36mCategory Load (0.6ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."product" = $1[0m  [["product", false]]
  [1m[36mComposite Load (1.4ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Composite') AND "constructor_objects"."deleted_at" IS NULL[0m
  [1m[36mCategory Load (2.2ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" IN (1, 2)[0m
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (1, 3)[0m
  Rendered composites/_listing.html.haml (4.7ms)
  Rendered composites/_listing.html.haml (0.6ms)
  Rendered composites/index.html.haml within layouts/application (26.3ms)
  Rendered layouts/_header.html.haml (12.1ms)
Completed 200 OK in 514ms (Views: 496.7ms | ActiveRecord: 7.4ms)


DEPRECATION WARNING: to_cleanup is deprecated and will be removed from Rails 5.1 (use ActiveSupport::Reloader.to_complete instead) (called from <top (required)> at /home/g1nc/Development/ruby/constructor/config/environment.rb:5)
DEPRECATION WARNING: to_cleanup is deprecated and will be removed from Rails 5.1 (use ActiveSupport::Reloader.to_complete instead) (called from <top (required)> at /home/g1nc/Development/ruby/constructor/config/environment.rb:5)
  [1m[35m (2.9ms)[0m  [1m[34mSELECT pg_try_advisory_lock(6572146483646705745);[0m
  [1m[36mActiveRecord::SchemaMigration Load (1.3ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
Migrating to AddWithoutWorkPriceToConstructorObject (20170426222257)
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (65.0ms)[0m  [1m[35mALTER TABLE "constructor_objects" ADD "price_without_work" decimal DEFAULT 0[0m
  [1m[35m (30.6ms)[0m  [1m[35mALTER TABLE "products" ADD "price_without_work" decimal DEFAULT 0[0m
  [1m[35m (24.0ms)[0m  [1m[35mALTER TABLE "stage_products" ADD "with_work" boolean DEFAULT 't'[0m
  [1m[35m (18.9ms)[0m  [1m[35mALTER TABLE "stage_products" ADD "price_without_work" decimal DEFAULT 0[0m
  [1m[35mSQL (1.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20170426222257"]]
  [1m[35m (5.9ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (3.9ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", :environment], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (1.8ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT pg_advisory_unlock(6572146483646705745)[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.5ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
DEPRECATION WARNING: to_cleanup is deprecated and will be removed from Rails 5.1 (use ActiveSupport::Reloader.to_complete instead) (called from <top (required)> at /home/g1nc/Development/ruby/constructor/config/environment.rb:5)
Started GET "/composites" for 127.0.0.1 at 2017-04-27 03:20:07 +0300
  [1m[36mActiveRecord::SchemaMigration Load (1.1ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
Processing by CompositesController#index as HTML
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Started GET "/composites" for 127.0.0.1 at 2017-04-27 03:20:07 +0300
  Rendering composites/index.html.haml within layouts/application
Processing by CompositesController#index as HTML
  [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mCategory Load (6.4ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."product" = $1[0m  [["product", false]]
  Rendering composites/index.html.haml within layouts/application
  [1m[36mComposite Load (2.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Composite') AND "constructor_objects"."deleted_at" IS NULL[0m
  [1m[36mCategory Load (2.2ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."product" = $1[0m  [["product", false]]
  [1m[36mComposite Load (23.5ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Composite') AND "constructor_objects"."deleted_at" IS NULL[0m
  [1m[36mCategory Load (2.2ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" IN (2, 1)[0m
  [1m[36mCategory Load (3.9ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" IN (2, 1)[0m
  [1m[36mUnit Load (0.9ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (3, 1)[0m
  Rendered composites/_listing.html.haml (4.3ms)
  [1m[36mUnit Load (5.4ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (3, 1)[0m
  Rendered composites/_listing.html.haml (0.8ms)
  Rendered composites/_listing.html.haml (0.8ms)
  Rendered composites/index.html.haml within layouts/application (147.8ms)
  Rendered composites/_listing.html.haml (1.0ms)
  Rendered composites/index.html.haml within layouts/application (119.6ms)
  Rendered layouts/_header.html.haml (21.7ms)
Completed 200 OK in 4395ms (Views: 4332.9ms | ActiveRecord: 56.5ms)


  Rendered layouts/_header.html.haml (4.8ms)
Completed 200 OK in 4625ms (Views: 4433.0ms | ActiveRecord: 31.5ms)


Started GET "/composites/new" for 127.0.0.1 at 2017-04-27 03:21:24 +0300
Processing by CompositesController#new as HTML
  [1m[36mUser Load (1.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering composites/new.html.haml within layouts/application
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL[0m
  [1m[36mCategory Load (0.8ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."product" = $1[0m  [["product", false]]
  Rendered composites/_composition_fields.html.haml (9.1ms)
  Rendered composites/_form.html.haml (114.5ms)
  Rendered composites/new.html.haml within layouts/application (122.7ms)
  Rendered layouts/_header.html.haml (16.7ms)
Completed 200 OK in 814ms (Views: 797.1ms | ActiveRecord: 8.1ms)


Started GET "/constructor_objects/autocomplete_constructor_object_name?term=Ghb" for 127.0.0.1 at 2017-04-27 03:21:35 +0300
Processing by ConstructorObjectsController#autocomplete_constructor_object_name as JSON
  Parameters: {"term"=>"Ghb"}
  [1m[36mConstructorObject Load (3.0ms)[0m  [1m[34mSELECT  constructor_objects.id, constructor_objects.name FROM "constructor_objects" WHERE (LOWER(constructor_objects.name) ILIKE 'ghb%') ORDER BY constructor_objects.name ASC LIMIT $1[0m  [["LIMIT", 10]]
Completed 200 OK in 10ms (Views: 0.2ms | ActiveRecord: 3.0ms)


Started GET "/constructor_objects/autocomplete_constructor_object_name?term=%D0%9F%D1%80%D0%B8" for 127.0.0.1 at 2017-04-27 03:21:37 +0300
Processing by ConstructorObjectsController#autocomplete_constructor_object_name as JSON
  Parameters: {"term"=>"При"}
  [1m[36mConstructorObject Load (2.5ms)[0m  [1m[34mSELECT  constructor_objects.id, constructor_objects.name FROM "constructor_objects" WHERE (LOWER(constructor_objects.name) ILIKE 'при%') ORDER BY constructor_objects.name ASC LIMIT $1[0m  [["LIMIT", 10]]
Completed 200 OK in 7ms (Views: 0.9ms | ActiveRecord: 2.5ms)


Started GET "/constructor_objects/info?id=1" for 127.0.0.1 at 2017-04-27 03:21:40 +0300
Processing by ConstructorObjectsController#info as JSON
  Parameters: {"id"=>"1"}
  [1m[36mConstructorObject Load (0.9ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
Completed 200 OK in 20ms (Views: 0.2ms | ActiveRecord: 1.7ms)


Started POST "/composites" for 127.0.0.1 at 2017-04-27 03:21:42 +0300
Processing by CompositesController#create as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"pLFQ0itKvw2RnrsczFwGYSFkwVQ0IF3yhtRF8Br51VwoAFNbcZK1bLROJ+yx3gYhWvkTtxZbrZg8+3ovCeV3TQ==", "commit"=>"Сохранить", "composite"=>{"name"=>"123", "unit_id"=>"1", "category_id"=>"1", "divisibility"=>"0", "compositions_attributes"=>{"1493252500193"=>{"children_id"=>"1", "value"=>"12", "_destroy"=>"false"}}}, "search_id"=>"1", "search"=>""}
  [1m[36mUser Load (1.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mConstructorObject Load (3.2ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (2.4ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" INNER JOIN "compositions" ON "constructor_objects"."id" = "compositions"."children_id" WHERE "compositions"."parent_id" = $1[0m  [["parent_id", 1]]
  [1m[36mConstructorObject Load (0.5ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" INNER JOIN "compositions" ON "constructor_objects"."id" = "compositions"."parent_id" WHERE "compositions"."children_id" = $1[0m  [["children_id", 1]]
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" INNER JOIN "compositions" ON "constructor_objects"."id" = "compositions"."parent_id" WHERE "compositions"."children_id" = $1[0m  [["children_id", 11]]
  [1m[35mSQL (3.2ms)[0m  [1m[32mINSERT INTO "constructor_objects" ("name", "unit_id", "category_id", "date", "created_at", "updated_at", "type") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["name", "123"], ["unit_id", 1], ["category_id", 1], ["date", 2017-04-27 00:21:42 UTC], ["created_at", 2017-04-27 00:21:42 UTC], ["updated_at", 2017-04-27 00:21:42 UTC], ["type", "Composite"]]
  [1m[35mSQL (2.1ms)[0m  [1m[32mINSERT INTO "compositions" ("parent_id", "children_id", "value") VALUES ($1, $2, $3) RETURNING "id"[0m  [["parent_id", 13], ["children_id", 1], ["value", 12]]
  [1m[36mAudited::Audit Load (2.9ms)[0m  [1m[34mSELECT  "audits".* FROM "audits" WHERE "audits"."auditable_id" = $1 AND "audits"."auditable_type" = $2 ORDER BY "audits"."version" DESC LIMIT $3[0m  [["auditable_id", 13], ["auditable_type", "ConstructorObject"], ["LIMIT", 1]]
  [1m[35mSQL (1.5ms)[0m  [1m[32mINSERT INTO "audits" ("auditable_id", "auditable_type", "user_id", "user_type", "action", "audited_changes", "version", "remote_address", "request_uuid", "created_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["auditable_id", 13], ["auditable_type", "ConstructorObject"], ["user_id", 1], ["user_type", "User"], ["action", "create"], ["audited_changes", "---\nname: '123'\nunit_id: 1\ncategory_id: 1\ndate: !ruby/object:ActiveSupport::TimeWithZone\n  utc: 2017-04-27 00:21:42.479386792 Z\n  zone: !ruby/object:ActiveSupport::TimeZone\n    name: Etc/UTC\n  time: 2017-04-27 00:21:42.479386792 Z\ndivisibility: false\ndeleted_at: \nprice_without_work: !ruby/object:BigDecimal 18:0.0\n"], ["version", 1], ["remote_address", "127.0.0.1"], ["request_uuid", "abbdb55a-c4cd-4d38-9e9f-db532fc235a1"], ["created_at", 2017-04-27 00:21:42 UTC]]
  [1m[35m (1.5ms)[0m  [1m[35mCOMMIT[0m
[ActiveJob] Enqueued PriceUpdateJob (Job ID: d6d2d5a3-0f34-4ac7-8a32-40f83ed3e22e) to Sidekiq(update_price) with arguments: #<GlobalID:0x00562b04f9b408 @uri=#<URI::GID gid://constructor/Composite/13>>
Redirected to http://localhost:3000/composites
Completed 302 Found in 217ms (ActiveRecord: 26.4ms)


Started GET "/composites" for 127.0.0.1 at 2017-04-27 03:21:42 +0300
Processing by CompositesController#index as HTML
  [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering composites/index.html.haml within layouts/application
  [1m[36mCategory Load (0.7ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."product" = $1[0m  [["product", false]]
  [1m[36mComposite Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Composite') AND "constructor_objects"."deleted_at" IS NULL[0m
  [1m[36mCategory Load (2.6ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" IN (2, 1)[0m
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (3, 1)[0m
  Rendered composites/_listing.html.haml (4.6ms)
  Rendered composites/_listing.html.haml (1.1ms)
  Rendered composites/_listing.html.haml (0.7ms)
  Rendered composites/index.html.haml within layouts/application (63.6ms)
  Rendered layouts/_header.html.haml (10.4ms)
Completed 200 OK in 854ms (Views: 841.4ms | ActiveRecord: 6.0ms)


DEPRECATION WARNING: to_cleanup is deprecated and will be removed from Rails 5.1 (use ActiveSupport::Reloader.to_complete instead) (called from <top (required)> at /home/g1nc/Development/ruby/constructor/config/environment.rb:5)
Started GET "/primitives" for 127.0.0.1 at 2017-04-27 03:28:34 +0300
Processing by PrimitivesController#index as HTML
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering primitives/index.html.haml within layouts/application
  [1m[36mCategory Load (2.0ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."product" = $1[0m  [["product", false]]
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL[0m
  [1m[36mCategory Load (0.6ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL[0m
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 1[0m
  [1m[36mPrimitive Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 1[0m
  [1m[36mCategory Load (2.6ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" = 1[0m
  [1m[36mUnit Load (1.4ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  Rendered primitives/_listing.html.haml (10.5ms)
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 2[0m
  [1m[36mPrimitive Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 2[0m
  [1m[36mCategory Load (1.6ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" = 2[0m
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 2[0m
  Rendered primitives/_listing.html.haml (4.6ms)
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 3[0m
  [1m[36mPrimitive Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 3[0m
  [1m[36mCategory Load (0.6ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" = 3[0m
  [1m[36mCACHE (0.1ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  Rendered primitives/_listing.html.haml (8.0ms)
  [1m[35m (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 4[0m
  [1m[36mPrimitive Load (0.8ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 4[0m
  [1m[36mCategory Load (1.7ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" = 4[0m
  [1m[36mUnit Load (1.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 5)[0m
  Rendered primitives/_listing.html.haml (4.5ms)
  Rendered primitives/_listing.html.haml (4.7ms)
  [1m[35m (1.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 5[0m
  [1m[36mPrimitive Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 5[0m
  [1m[36mCategory Load (1.1ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" = 5[0m
  [1m[36mUnit Load (1.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (1, 5)[0m
  Rendered primitives/_listing.html.haml (4.5ms)
  Rendered primitives/_listing.html.haml (4.2ms)
  Rendered primitives/_listing.html.haml (4.2ms)
  [1m[35m (1.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 6[0m
  [1m[36mPrimitive Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 6[0m
  [1m[36mCategory Load (3.0ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" = 6[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 2[0m
  Rendered primitives/_listing.html.haml (3.5ms)
  Rendered primitives/_listing.html.haml (3.6ms)
  [1m[35m (1.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 7[0m
  [1m[35m (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 8[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 9[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 10[0m
  [1m[35m (1.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 11[0m
  [1m[35m (1.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 12[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 13[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 14[0m
  [1m[35m (1.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 15[0m
  Rendered primitives/index.html.haml within layouts/application (212.5ms)
  Rendered layouts/_header.html.haml (11.7ms)
Completed 200 OK in 993ms (Views: 839.8ms | ActiveRecord: 38.9ms)


Started GET "/composites" for 127.0.0.1 at 2017-04-27 03:29:32 +0300
Processing by CompositesController#index as HTML
  [1m[36mUser Load (5.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering composites/index.html.haml within layouts/application
  [1m[36mCategory Load (6.7ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."product" = $1[0m  [["product", false]]
  [1m[36mComposite Load (3.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Composite') AND "constructor_objects"."deleted_at" IS NULL[0m
  [1m[36mCategory Load (1.4ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" IN (2, 1)[0m
  [1m[36mUnit Load (3.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (3, 1)[0m
  Rendered composites/_listing.html.haml (3.4ms)
  Rendered composites/_listing.html.haml (0.7ms)
  Rendered composites/_listing.html.haml (0.5ms)
  Rendered composites/index.html.haml within layouts/application (46.5ms)
  Rendered layouts/_header.html.haml (9.0ms)
Completed 200 OK in 641ms (Views: 606.4ms | ActiveRecord: 24.4ms)


Started DELETE "/composites/13" for 127.0.0.1 at 2017-04-27 03:29:35 +0300
Processing by CompositesController#destroy as HTML
  Parameters: {"authenticity_token"=>"ofVB65Ucf8+9vPJ3Kb1+Wja3jtv97NsrCDQZTs5lyKUtREJiz8R1rphsbodUP34aTSpcON+XK0GyGyaR3XlqtA==", "id"=>"13"}
  [1m[36mComposite Load (6.6ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Composite') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 13], ["LIMIT", 1]]
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mAudited::Audit Load (1.2ms)[0m  [1m[34mSELECT  "audits".* FROM "audits" WHERE "audits"."auditable_id" = $1 AND "audits"."auditable_type" = $2 ORDER BY "audits"."version" DESC LIMIT $3[0m  [["auditable_id", 13], ["auditable_type", "ConstructorObject"], ["LIMIT", 1]]
  [1m[35mSQL (1.0ms)[0m  [1m[32mINSERT INTO "audits" ("auditable_id", "auditable_type", "user_id", "user_type", "action", "audited_changes", "version", "remote_address", "request_uuid", "created_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["auditable_id", 13], ["auditable_type", "ConstructorObject"], ["user_id", 1], ["user_type", "User"], ["action", "destroy"], ["audited_changes", "---\nname: '123'\nunit_id: 1\ncategory_id: 1\ndate: !ruby/object:ActiveSupport::TimeWithZone\n  utc: 2017-04-27 00:21:42.479386000 Z\n  zone: !ruby/object:ActiveSupport::TimeZone\n    name: Etc/UTC\n  time: 2017-04-27 00:21:42.479386000 Z\ndivisibility: false\ndeleted_at: \nprice_without_work: !ruby/object:BigDecimal 18:0.0\n"], ["version", 2], ["remote_address", "127.0.0.1"], ["request_uuid", "b73802af-a78a-460a-912f-e7b647002667"], ["created_at", 2017-04-27 00:29:35 UTC]]
  [1m[35mSQL (0.9ms)[0m  [1m[33mUPDATE "constructor_objects" SET "deleted_at" = '2017-04-27 00:29:35.941524', "updated_at" = '2017-04-27 00:29:35.941618' WHERE "constructor_objects"."type" IN ('Composite') AND "constructor_objects"."id" = $1[0m  [["id", 13]]
  [1m[35m (3.7ms)[0m  [1m[35mCOMMIT[0m
Redirected to http://localhost:3000/composites
Completed 302 Found in 50ms (ActiveRecord: 14.7ms)


Started GET "/composites" for 127.0.0.1 at 2017-04-27 03:29:35 +0300
Processing by CompositesController#index as HTML
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering composites/index.html.haml within layouts/application
  [1m[36mCategory Load (0.8ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."product" = $1[0m  [["product", false]]
  [1m[36mComposite Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Composite') AND "constructor_objects"."deleted_at" IS NULL[0m
  [1m[36mCategory Load (0.8ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" IN (2, 1)[0m
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (3, 1)[0m
  Rendered composites/_listing.html.haml (3.7ms)
  Rendered composites/_listing.html.haml (1.0ms)
  Rendered composites/index.html.haml within layouts/application (25.8ms)
  Rendered layouts/_header.html.haml (10.7ms)
Completed 200 OK in 827ms (Views: 813.3ms | ActiveRecord: 3.8ms)


DEPRECATION WARNING: to_cleanup is deprecated and will be removed from Rails 5.1 (use ActiveSupport::Reloader.to_complete instead) (called from <top (required)> at /home/g1nc/Development/ruby/constructor/config/environment.rb:5)
  [1m[36mComposite Load (1.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Composite') AND "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 13], ["LIMIT", 1]]
[ActiveJob] [PriceUpdateJob] [d6d2d5a3-0f34-4ac7-8a32-40f83ed3e22e] Performing PriceUpdateJob from Sidekiq(update_price) with arguments: #<GlobalID:0x0055737af99000 @uri=#<URI::GID gid://constructor/Composite/13>>
[ActiveJob] [PriceUpdateJob] [d6d2d5a3-0f34-4ac7-8a32-40f83ed3e22e]   [1m[36mComposition Load (1.0ms)[0m  [1m[34mSELECT "compositions".* FROM "compositions" WHERE "compositions"."deleted_at" IS NULL AND "compositions"."parent_id" = $1[0m  [["parent_id", 13]]
[ActiveJob] [PriceUpdateJob] [d6d2d5a3-0f34-4ac7-8a32-40f83ed3e22e]   [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
[ActiveJob] [PriceUpdateJob] [d6d2d5a3-0f34-4ac7-8a32-40f83ed3e22e]   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
[ActiveJob] [PriceUpdateJob] [d6d2d5a3-0f34-4ac7-8a32-40f83ed3e22e]   [1m[36mAudited::Audit Load (3.5ms)[0m  [1m[34mSELECT  "audits".* FROM "audits" WHERE "audits"."auditable_id" = $1 AND "audits"."auditable_type" = $2 ORDER BY "audits"."version" DESC LIMIT $3[0m  [["auditable_id", 13], ["auditable_type", "ConstructorObject"], ["LIMIT", 1]]
[ActiveJob] [PriceUpdateJob] [d6d2d5a3-0f34-4ac7-8a32-40f83ed3e22e]   [1m[35mSQL (1.0ms)[0m  [1m[32mINSERT INTO "audits" ("auditable_id", "auditable_type", "action", "audited_changes", "version", "request_uuid", "created_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["auditable_id", 13], ["auditable_type", "ConstructorObject"], ["action", "update"], ["audited_changes", "---\nprice_without_work:\n- !ruby/object:BigDecimal 18:0.0\n- !ruby/object:BigDecimal 18:0.12E3\n"], ["version", 3], ["request_uuid", "666d3678-c8e6-40c6-b8a0-de90c08b9d5a"], ["created_at", 2017-04-27 00:29:55 UTC]]
[ActiveJob] [PriceUpdateJob] [d6d2d5a3-0f34-4ac7-8a32-40f83ed3e22e]   [1m[35mSQL (0.8ms)[0m  [1m[33mUPDATE "constructor_objects" SET "price" = $1, "price_without_work" = $2, "updated_at" = $3 WHERE "constructor_objects"."id" = $4[0m  [["price", #<BigDecimal:55737b5e3208,'0.12E3',9(18)>], ["price_without_work", #<BigDecimal:55737b5e2fb0,'0.12E3',9(18)>], ["updated_at", 2017-04-27 00:29:55 UTC], ["id", 13]]
[ActiveJob] [PriceUpdateJob] [d6d2d5a3-0f34-4ac7-8a32-40f83ed3e22e]   [1m[35m (2.6ms)[0m  [1m[35mCOMMIT[0m
[ActiveJob] [PriceUpdateJob] [d6d2d5a3-0f34-4ac7-8a32-40f83ed3e22e]   [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" INNER JOIN "compositions" ON "constructor_objects"."id" = "compositions"."parent_id" WHERE "compositions"."children_id" = $1[0m  [["children_id", 13]]
[ActiveJob] [PriceUpdateJob] [d6d2d5a3-0f34-4ac7-8a32-40f83ed3e22e] Performed PriceUpdateJob from Sidekiq(update_price) in 172.92ms
Started GET "/composites/new" for 127.0.0.1 at 2017-04-27 03:29:58 +0300
Processing by CompositesController#new as HTML
  [1m[36mUser Load (1.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering composites/new.html.haml within layouts/application
  [1m[36mUnit Load (3.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL[0m
  [1m[36mCategory Load (0.9ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."product" = $1[0m  [["product", false]]
  Rendered composites/_composition_fields.html.haml (7.7ms)
  Rendered composites/_form.html.haml (68.4ms)
  Rendered composites/new.html.haml within layouts/application (75.5ms)
  Rendered layouts/_header.html.haml (13.6ms)
Completed 200 OK in 810ms (Views: 787.6ms | ActiveRecord: 9.7ms)


Started GET "/constructor_objects/autocomplete_constructor_object_name?term=%D0%9F%D1%80" for 127.0.0.1 at 2017-04-27 03:30:13 +0300
Processing by ConstructorObjectsController#autocomplete_constructor_object_name as JSON
  Parameters: {"term"=>"Пр"}
  [1m[36mConstructorObject Load (1.7ms)[0m  [1m[34mSELECT  constructor_objects.id, constructor_objects.name FROM "constructor_objects" WHERE (LOWER(constructor_objects.name) ILIKE 'пр%') ORDER BY constructor_objects.name ASC LIMIT $1[0m  [["LIMIT", 10]]
Completed 200 OK in 6ms (Views: 0.8ms | ActiveRecord: 1.7ms)


Started GET "/constructor_objects/info?id=6" for 127.0.0.1 at 2017-04-27 03:30:15 +0300
Processing by ConstructorObjectsController#info as JSON
  Parameters: {"id"=>"6"}
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mUnit Load (2.7ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
Completed 200 OK in 13ms (Views: 0.2ms | ActiveRecord: 3.5ms)


Started POST "/composites" for 127.0.0.1 at 2017-04-27 03:30:18 +0300
Processing by CompositesController#create as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"1C8kcbGLF54eFWJAAuUUAgIKK9SOcdPTsPWLl0gxsX9Ynif461Md/zvF/rB/ZxRCeZf5N6wKI7kK2rRIWy0Tbg==", "commit"=>"Сохранить", "composite"=>{"name"=>"Объект 3", "unit_id"=>"2", "category_id"=>"3", "divisibility"=>"0", "compositions_attributes"=>{"1493253015513"=>{"children_id"=>"6", "value"=>"10", "_destroy"=>"false"}}}, "search_id"=>"6", "search"=>""}
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mConstructorObject Load (1.2ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" INNER JOIN "compositions" ON "constructor_objects"."id" = "compositions"."children_id" WHERE "compositions"."parent_id" = $1[0m  [["parent_id", 6]]
  [1m[36mConstructorObject Load (0.5ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" INNER JOIN "compositions" ON "constructor_objects"."id" = "compositions"."parent_id" WHERE "compositions"."children_id" = $1[0m  [["children_id", 6]]
  [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "constructor_objects" ("name", "unit_id", "category_id", "date", "created_at", "updated_at", "type") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["name", "Объект 3"], ["unit_id", 2], ["category_id", 3], ["date", 2017-04-27 00:30:18 UTC], ["created_at", 2017-04-27 00:30:18 UTC], ["updated_at", 2017-04-27 00:30:18 UTC], ["type", "Composite"]]
  [1m[35mSQL (1.1ms)[0m  [1m[32mINSERT INTO "compositions" ("parent_id", "children_id", "value") VALUES ($1, $2, $3) RETURNING "id"[0m  [["parent_id", 14], ["children_id", 6], ["value", 10]]
  [1m[36mAudited::Audit Load (1.2ms)[0m  [1m[34mSELECT  "audits".* FROM "audits" WHERE "audits"."auditable_id" = $1 AND "audits"."auditable_type" = $2 ORDER BY "audits"."version" DESC LIMIT $3[0m  [["auditable_id", 14], ["auditable_type", "ConstructorObject"], ["LIMIT", 1]]
  [1m[35mSQL (1.5ms)[0m  [1m[32mINSERT INTO "audits" ("auditable_id", "auditable_type", "user_id", "user_type", "action", "audited_changes", "version", "remote_address", "request_uuid", "created_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["auditable_id", 14], ["auditable_type", "ConstructorObject"], ["user_id", 1], ["user_type", "User"], ["action", "create"], ["audited_changes", "---\nname: Объект 3\nunit_id: 2\ncategory_id: 3\ndate: !ruby/object:ActiveSupport::TimeWithZone\n  utc: 2017-04-27 00:30:18.233926348 Z\n  zone: !ruby/object:ActiveSupport::TimeZone\n    name: Etc/UTC\n  time: 2017-04-27 00:30:18.233926348 Z\ndivisibility: false\ndeleted_at: \nprice_without_work: !ruby/object:BigDecimal 18:0.0\n"], ["version", 1], ["remote_address", "127.0.0.1"], ["request_uuid", "867babcc-6bd0-4a0f-8dd4-9934a843e1c9"], ["created_at", 2017-04-27 00:30:18 UTC]]
  [1m[35m (16.0ms)[0m  [1m[35mCOMMIT[0m
[ActiveJob] Enqueued PriceUpdateJob (Job ID: 4c36b6c2-3c9e-4dec-8969-10a8bbfa7221) to Sidekiq(update_price) with arguments: #<GlobalID:0x00562b08ce4cd8 @uri=#<URI::GID gid://constructor/Composite/14>>
Redirected to http://localhost:3000/composites
Completed 302 Found in 101ms (ActiveRecord: 23.8ms)


  [1m[36mComposite Load (0.5ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Composite') AND "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 14], ["LIMIT", 1]]
[ActiveJob] [PriceUpdateJob] [4c36b6c2-3c9e-4dec-8969-10a8bbfa7221] Performing PriceUpdateJob from Sidekiq(update_price) with arguments: #<GlobalID:0x0055737bf2caa8 @uri=#<URI::GID gid://constructor/Composite/14>>
[ActiveJob] [PriceUpdateJob] [4c36b6c2-3c9e-4dec-8969-10a8bbfa7221]   [1m[36mComposition Load (1.3ms)[0m  [1m[34mSELECT "compositions".* FROM "compositions" WHERE "compositions"."deleted_at" IS NULL AND "compositions"."parent_id" = $1[0m  [["parent_id", 14]]
[ActiveJob] [PriceUpdateJob] [4c36b6c2-3c9e-4dec-8969-10a8bbfa7221]   [1m[36mConstructorObject Load (2.6ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
[ActiveJob] [PriceUpdateJob] [4c36b6c2-3c9e-4dec-8969-10a8bbfa7221]   [1m[35m (1.2ms)[0m  [1m[35mBEGIN[0m
[ActiveJob] [PriceUpdateJob] [4c36b6c2-3c9e-4dec-8969-10a8bbfa7221]   [1m[36mAudited::Audit Load (1.9ms)[0m  [1m[34mSELECT  "audits".* FROM "audits" WHERE "audits"."auditable_id" = $1 AND "audits"."auditable_type" = $2 ORDER BY "audits"."version" DESC LIMIT $3[0m  [["auditable_id", 14], ["auditable_type", "ConstructorObject"], ["LIMIT", 1]]
[ActiveJob] [PriceUpdateJob] [4c36b6c2-3c9e-4dec-8969-10a8bbfa7221]   [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "audits" ("auditable_id", "auditable_type", "action", "audited_changes", "version", "request_uuid", "created_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["auditable_id", 14], ["auditable_type", "ConstructorObject"], ["action", "update"], ["audited_changes", "---\nprice_without_work:\n- !ruby/object:BigDecimal 18:0.0\n- !ruby/object:BigDecimal 18:0.6E3\n"], ["version", 2], ["request_uuid", "8233f572-2218-480e-a6ab-881ef01be25b"], ["created_at", 2017-04-27 00:30:18 UTC]]
Started GET "/composites" for 127.0.0.1 at 2017-04-27 03:30:18 +0300
Processing by CompositesController#index as HTML
[ActiveJob] [PriceUpdateJob] [4c36b6c2-3c9e-4dec-8969-10a8bbfa7221]   [1m[35mSQL (4.4ms)[0m  [1m[33mUPDATE "constructor_objects" SET "price" = $1, "price_without_work" = $2, "updated_at" = $3 WHERE "constructor_objects"."id" = $4[0m  [["price", #<BigDecimal:7fe88c0c3ba0,'0.6E3',9(18)>], ["price_without_work", #<BigDecimal:7fe88c0c3ad8,'0.6E3',9(18)>], ["updated_at", 2017-04-27 00:30:18 UTC], ["id", 14]]
[ActiveJob] [PriceUpdateJob] [4c36b6c2-3c9e-4dec-8969-10a8bbfa7221]   [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
[ActiveJob] [PriceUpdateJob] [4c36b6c2-3c9e-4dec-8969-10a8bbfa7221]   [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" INNER JOIN "compositions" ON "constructor_objects"."id" = "compositions"."parent_id" WHERE "compositions"."children_id" = $1[0m  [["children_id", 14]]
[ActiveJob] [PriceUpdateJob] [4c36b6c2-3c9e-4dec-8969-10a8bbfa7221] Performed PriceUpdateJob from Sidekiq(update_price) in 42.59ms
  [1m[36mUser Load (15.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering composites/index.html.haml within layouts/application
  [1m[36mCategory Load (0.6ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."product" = $1[0m  [["product", false]]
  [1m[36mComposite Load (0.9ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Composite') AND "constructor_objects"."deleted_at" IS NULL[0m
  [1m[36mCategory Load (0.6ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" IN (2, 1, 3)[0m
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (3, 1, 2)[0m
  Rendered composites/_listing.html.haml (3.6ms)
  Rendered composites/_listing.html.haml (0.7ms)
  Rendered composites/_listing.html.haml (0.6ms)
  Rendered composites/index.html.haml within layouts/application (25.7ms)
  Rendered layouts/_header.html.haml (10.6ms)
Completed 200 OK in 618ms (Views: 592.9ms | ActiveRecord: 18.1ms)


Started GET "/composites/14/edit" for 127.0.0.1 at 2017-04-27 03:30:22 +0300
Processing by CompositesController#edit as HTML
  Parameters: {"id"=>"14"}
  [1m[36mComposite Load (3.5ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Composite') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 14], ["LIMIT", 1]]
  [1m[36mUser Load (2.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering composites/edit.html.haml within layouts/application
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL[0m
  [1m[36mCategory Load (0.6ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."product" = $1[0m  [["product", false]]
  Rendered composites/_composition_fields.html.haml (10.0ms)
  [1m[36mComposition Load (0.6ms)[0m  [1m[34mSELECT "compositions".* FROM "compositions" WHERE "compositions"."deleted_at" IS NULL AND "compositions"."parent_id" = $1[0m  [["parent_id", 14]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mUnit Load (0.5ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  Rendered composites/_composition_fields.html.haml (11.6ms)
  Rendered composites/_form.html.haml (66.6ms)
  Rendered composites/edit.html.haml within layouts/application (73.3ms)
  Rendered layouts/_header.html.haml (23.3ms)
Completed 200 OK in 825ms (Views: 804.9ms | ActiveRecord: 9.1ms)


  [1m[36mComposite Load (1.3ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Composite') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 14], ["LIMIT", 1]]
Started PATCH "/composites/14" for 127.0.0.1 at 2017-04-27 03:31:37 +0300
Processing by CompositesController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"FrBF5IVKI23UfVW1+1+7H3dkbJ9fROsb+zXN4gxLFXuaAUZt35IpDPGtyUWG3btfDPm+fH0/G3FBGvI9H1e3ag==", "commit"=>"Сохранить", "composite"=>{"name"=>"Объект 3", "unit_id"=>"2", "category_id"=>"3", "divisibility"=>"0", "compositions_attributes"=>{"0"=>{"children_id"=>"6", "value"=>"10", "_destroy"=>"1", "id"=>"4"}}}, "search_id"=>"", "search"=>"", "id"=>"14"}
  [1m[36mComposite Load (0.8ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Composite') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 14], ["LIMIT", 1]]
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mComposition Load (0.9ms)[0m  [1m[34mSELECT "compositions".* FROM "compositions" WHERE "compositions"."deleted_at" IS NULL AND "compositions"."parent_id" = $1 AND "compositions"."id" = 4[0m  [["parent_id", 14]]
  [1m[35mSQL (0.8ms)[0m  [1m[33mUPDATE "compositions" SET "deleted_at" = '2017-04-27 00:31:38.150639' WHERE "compositions"."id" = $1[0m  [["id", 4]]
  [1m[35m (1.6ms)[0m  [1m[35mCOMMIT[0m
[ActiveJob] Enqueued PriceUpdateJob (Job ID: b3785914-d2df-4ae8-b0be-82e8976de055) to Sidekiq(update_price) with arguments: #<GlobalID:0x007f22e8eb61a0 @uri=#<URI::GID gid://constructor/Composite/14>>
Redirected to http://localhost:3000/composites
Completed 302 Found in 193ms (ActiveRecord: 26.9ms)


Started GET "/composites" for 127.0.0.1 at 2017-04-27 03:31:38 +0300
Processing by CompositesController#index as HTML
  [1m[36mUser Load (1.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering composites/index.html.haml within layouts/application
  [1m[36mCategory Load (0.7ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."product" = $1[0m  [["product", false]]
  [1m[36mComposite Load (6.4ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Composite') AND "constructor_objects"."deleted_at" IS NULL[0m
  [1m[36mCategory Load (5.7ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" IN (2, 1, 3)[0m
  [1m[36mUnit Load (0.9ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (3, 1, 2)[0m
  [1m[36mComposite Load (0.6ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Composite') AND "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 14], ["LIMIT", 1]]
[ActiveJob] [PriceUpdateJob] [b3785914-d2df-4ae8-b0be-82e8976de055] Performing PriceUpdateJob from Sidekiq(update_price) with arguments: #<GlobalID:0x007fe88c7522a0 @uri=#<URI::GID gid://constructor/Composite/14>>
  Rendered composites/_listing.html.haml (9.5ms)
  Rendered composites/_listing.html.haml (0.7ms)
  Rendered composites/_listing.html.haml (0.7ms)
  Rendered composites/index.html.haml within layouts/application (93.6ms)
[ActiveJob] [PriceUpdateJob] [b3785914-d2df-4ae8-b0be-82e8976de055]   [1m[36mComposition Load (0.5ms)[0m  [1m[34mSELECT "compositions".* FROM "compositions" WHERE "compositions"."deleted_at" IS NULL AND "compositions"."parent_id" = $1[0m  [["parent_id", 14]]
[ActiveJob] [PriceUpdateJob] [b3785914-d2df-4ae8-b0be-82e8976de055]   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
[ActiveJob] [PriceUpdateJob] [b3785914-d2df-4ae8-b0be-82e8976de055]   [1m[36mAudited::Audit Load (1.3ms)[0m  [1m[34mSELECT  "audits".* FROM "audits" WHERE "audits"."auditable_id" = $1 AND "audits"."auditable_type" = $2 ORDER BY "audits"."version" DESC LIMIT $3[0m  [["auditable_id", 14], ["auditable_type", "ConstructorObject"], ["LIMIT", 1]]
[ActiveJob] [PriceUpdateJob] [b3785914-d2df-4ae8-b0be-82e8976de055]   [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "audits" ("auditable_id", "auditable_type", "action", "audited_changes", "version", "request_uuid", "created_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["auditable_id", 14], ["auditable_type", "ConstructorObject"], ["action", "update"], ["audited_changes", "---\nprice_without_work:\n- !ruby/object:BigDecimal 18:0.6E3\n- !ruby/object:BigDecimal 18:0.0\n"], ["version", 3], ["request_uuid", "7569e54d-2128-4321-a248-49c60b3e5074"], ["created_at", 2017-04-27 00:31:38 UTC]]
[ActiveJob] [PriceUpdateJob] [b3785914-d2df-4ae8-b0be-82e8976de055]   [1m[35mSQL (0.6ms)[0m  [1m[33mUPDATE "constructor_objects" SET "price" = $1, "price_without_work" = $2, "updated_at" = $3 WHERE "constructor_objects"."id" = $4[0m  [["price", #<BigDecimal:55737946c318,'0.0',9(27)>], ["price_without_work", #<BigDecimal:7fe88c7d3ee0,'0.0',9(27)>], ["updated_at", 2017-04-27 00:31:38 UTC], ["id", 14]]
[ActiveJob] [PriceUpdateJob] [b3785914-d2df-4ae8-b0be-82e8976de055]   [1m[35m (7.7ms)[0m  [1m[35mCOMMIT[0m
[ActiveJob] [PriceUpdateJob] [b3785914-d2df-4ae8-b0be-82e8976de055]   [1m[36mConstructorObject Load (1.1ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" INNER JOIN "compositions" ON "constructor_objects"."id" = "compositions"."parent_id" WHERE "compositions"."children_id" = $1[0m  [["children_id", 14]]
[ActiveJob] [PriceUpdateJob] [b3785914-d2df-4ae8-b0be-82e8976de055] Performed PriceUpdateJob from Sidekiq(update_price) in 59.22ms
  Rendered layouts/_header.html.haml (18.3ms)
Completed 200 OK in 723ms (Views: 687.7ms | ActiveRecord: 27.7ms)


Started GET "/composites" for 127.0.0.1 at 2017-04-27 03:31:51 +0300
Processing by CompositesController#index as HTML
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering composites/index.html.haml within layouts/application
  [1m[36mCategory Load (0.8ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."product" = $1[0m  [["product", false]]
  [1m[36mComposite Load (0.8ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Composite') AND "constructor_objects"."deleted_at" IS NULL[0m
  [1m[36mCategory Load (0.7ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" IN (2, 1, 3)[0m
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (3, 1, 2)[0m
  Rendered composites/_listing.html.haml (4.0ms)
  Rendered composites/_listing.html.haml (0.7ms)
  Rendered composites/_listing.html.haml (0.8ms)
  Rendered composites/index.html.haml within layouts/application (25.7ms)
  Rendered layouts/_header.html.haml (8.2ms)
Completed 200 OK in 637ms (Views: 627.2ms | ActiveRecord: 3.6ms)


Started GET "/composites/14/edit" for 127.0.0.1 at 2017-04-27 03:31:55 +0300
Processing by CompositesController#edit as HTML
  Parameters: {"id"=>"14"}
  [1m[36mComposite Load (1.3ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Composite') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 14], ["LIMIT", 1]]
  [1m[36mUser Load (1.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering composites/edit.html.haml within layouts/application
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL[0m
  [1m[36mCategory Load (2.3ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."product" = $1[0m  [["product", false]]
  Rendered composites/_composition_fields.html.haml (10.2ms)
  [1m[36mComposition Load (2.1ms)[0m  [1m[34mSELECT "compositions".* FROM "compositions" WHERE "compositions"."deleted_at" IS NULL AND "compositions"."parent_id" = $1[0m  [["parent_id", 14]]
  Rendered composites/_form.html.haml (44.6ms)
  Rendered composites/edit.html.haml within layouts/application (48.5ms)
  Rendered layouts/_header.html.haml (8.9ms)
Completed 200 OK in 624ms (Views: 610.1ms | ActiveRecord: 8.1ms)


Started GET "/constructor_objects/autocomplete_constructor_object_name?term=Ghb" for 127.0.0.1 at 2017-04-27 03:32:13 +0300
Processing by ConstructorObjectsController#autocomplete_constructor_object_name as JSON
  Parameters: {"term"=>"Ghb"}
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT  constructor_objects.id, constructor_objects.name FROM "constructor_objects" WHERE (LOWER(constructor_objects.name) ILIKE 'ghb%') ORDER BY constructor_objects.name ASC LIMIT $1[0m  [["LIMIT", 10]]
Completed 200 OK in 29ms (Views: 0.2ms | ActiveRecord: 5.8ms)


Started GET "/constructor_objects/autocomplete_constructor_object_name?term=%D0%9F%D1%80" for 127.0.0.1 at 2017-04-27 03:32:14 +0300
Processing by ConstructorObjectsController#autocomplete_constructor_object_name as JSON
  Parameters: {"term"=>"Пр"}
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT  constructor_objects.id, constructor_objects.name FROM "constructor_objects" WHERE (LOWER(constructor_objects.name) ILIKE 'пр%') ORDER BY constructor_objects.name ASC LIMIT $1[0m  [["LIMIT", 10]]
Completed 200 OK in 14ms (Views: 0.5ms | ActiveRecord: 0.8ms)


Started GET "/constructor_objects/autocomplete_constructor_object_name?term=%D0%9F%D1%80%D0%B8" for 127.0.0.1 at 2017-04-27 03:32:15 +0300
Processing by ConstructorObjectsController#autocomplete_constructor_object_name as JSON
  Parameters: {"term"=>"При"}
  [1m[36mConstructorObject Load (1.6ms)[0m  [1m[34mSELECT  constructor_objects.id, constructor_objects.name FROM "constructor_objects" WHERE (LOWER(constructor_objects.name) ILIKE 'при%') ORDER BY constructor_objects.name ASC LIMIT $1[0m  [["LIMIT", 10]]
Completed 200 OK in 6ms (Views: 0.8ms | ActiveRecord: 1.6ms)


Started GET "/constructor_objects/info?id=6" for 127.0.0.1 at 2017-04-27 03:32:18 +0300
Processing by ConstructorObjectsController#info as JSON
  Parameters: {"id"=>"6"}
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
Completed 200 OK in 41ms (Views: 0.3ms | ActiveRecord: 1.4ms)


Started PATCH "/composites/14" for 127.0.0.1 at 2017-04-27 03:32:20 +0300
Processing by CompositesController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"1df/D7BAtsKCtGCzn5pvr6dzLrjMlEPTGKtipz9pJE9ZZvyG6pi8o6dk/EPiGG/v3O78W+7vs7mihF14LHWGXg==", "commit"=>"Сохранить", "composite"=>{"name"=>"Объект 3", "unit_id"=>"2", "category_id"=>"3", "divisibility"=>"0", "compositions_attributes"=>{"1493253138207"=>{"children_id"=>"6", "value"=>"10", "_destroy"=>"false"}}}, "search_id"=>"6", "search"=>"", "id"=>"14"}
  [1m[36mComposite Load (0.8ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Composite') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 14], ["LIMIT", 1]]
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (10.9ms)[0m  [1m[35mBEGIN[0m
  [1m[36mConstructorObject Load (1.1ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.4ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" INNER JOIN "compositions" ON "constructor_objects"."id" = "compositions"."children_id" WHERE "compositions"."parent_id" = $1[0m  [["parent_id", 6]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" INNER JOIN "compositions" ON "constructor_objects"."id" = "compositions"."parent_id" WHERE "compositions"."children_id" = $1[0m  [["children_id", 6]]
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" INNER JOIN "compositions" ON "constructor_objects"."id" = "compositions"."parent_id" WHERE "compositions"."children_id" = $1[0m  [["children_id", 14]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 14], ["LIMIT", 1]]
  [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "compositions" ("parent_id", "children_id", "value") VALUES ($1, $2, $3) RETURNING "id"[0m  [["parent_id", 14], ["children_id", 6], ["value", 10]]
  [1m[35m (4.3ms)[0m  [1m[35mCOMMIT[0m
[ActiveJob] Enqueued PriceUpdateJob (Job ID: a7e2ac6f-65dc-4456-907a-5488fab28d9a) to Sidekiq(update_price) with arguments: #<GlobalID:0x007f22df194138 @uri=#<URI::GID gid://constructor/Composite/14>>
Redirected to http://localhost:3000/composites
Completed 302 Found in 181ms (ActiveRecord: 29.9ms)


Started GET "/composites" for 127.0.0.1 at 2017-04-27 03:32:20 +0300
Processing by CompositesController#index as HTML
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering composites/index.html.haml within layouts/application
  [1m[36mCategory Load (3.4ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."product" = $1[0m  [["product", false]]
  [1m[36mComposite Load (4.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Composite') AND "constructor_objects"."deleted_at" IS NULL[0m
  [1m[36mCategory Load (0.6ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" IN (2, 1, 3)[0m
  [1m[36mUnit Load (4.3ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (3, 1, 2)[0m
  Rendered composites/_listing.html.haml (6.0ms)
  Rendered composites/_listing.html.haml (0.8ms)
  Rendered composites/_listing.html.haml (0.7ms)
  Rendered composites/index.html.haml within layouts/application (80.7ms)
  [1m[36mComposite Load (1.0ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Composite') AND "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 14], ["LIMIT", 1]]
[ActiveJob] [PriceUpdateJob] [a7e2ac6f-65dc-4456-907a-5488fab28d9a] Performing PriceUpdateJob from Sidekiq(update_price) with arguments: #<GlobalID:0x007fe88012ccb0 @uri=#<URI::GID gid://constructor/Composite/14>>
  Rendered layouts/_header.html.haml (16.5ms)
Completed 200 OK in 841ms (Views: 818.1ms | ActiveRecord: 13.7ms)


[ActiveJob] [PriceUpdateJob] [a7e2ac6f-65dc-4456-907a-5488fab28d9a]   [1m[36mComposition Load (654.9ms)[0m  [1m[34mSELECT "compositions".* FROM "compositions" WHERE "compositions"."deleted_at" IS NULL AND "compositions"."parent_id" = $1[0m  [["parent_id", 14]]
[ActiveJob] [PriceUpdateJob] [a7e2ac6f-65dc-4456-907a-5488fab28d9a]   [1m[36mConstructorObject Load (78.3ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
[ActiveJob] [PriceUpdateJob] [a7e2ac6f-65dc-4456-907a-5488fab28d9a]   [1m[35m (4.7ms)[0m  [1m[35mBEGIN[0m
[ActiveJob] [PriceUpdateJob] [a7e2ac6f-65dc-4456-907a-5488fab28d9a]   [1m[36mAudited::Audit Load (1.9ms)[0m  [1m[34mSELECT  "audits".* FROM "audits" WHERE "audits"."auditable_id" = $1 AND "audits"."auditable_type" = $2 ORDER BY "audits"."version" DESC LIMIT $3[0m  [["auditable_id", 14], ["auditable_type", "ConstructorObject"], ["LIMIT", 1]]
[ActiveJob] [PriceUpdateJob] [a7e2ac6f-65dc-4456-907a-5488fab28d9a]   [1m[35mSQL (3.1ms)[0m  [1m[32mINSERT INTO "audits" ("auditable_id", "auditable_type", "action", "audited_changes", "version", "request_uuid", "created_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["auditable_id", 14], ["auditable_type", "ConstructorObject"], ["action", "update"], ["audited_changes", "---\nprice_without_work:\n- !ruby/object:BigDecimal 18:0.0\n- !ruby/object:BigDecimal 18:0.6E3\n"], ["version", 4], ["request_uuid", "4de3275e-3874-43f5-8ea3-122eb67f0dee"], ["created_at", 2017-04-27 00:34:58 UTC]]
[ActiveJob] [PriceUpdateJob] [a7e2ac6f-65dc-4456-907a-5488fab28d9a]   [1m[35mSQL (0.6ms)[0m  [1m[33mUPDATE "constructor_objects" SET "price" = $1, "price_without_work" = $2, "updated_at" = $3 WHERE "constructor_objects"."id" = $4[0m  [["price", #<BigDecimal:557378c884a8,'0.6E3',9(18)>], ["price_without_work", #<BigDecimal:557378c87eb8,'0.6E3',9(18)>], ["updated_at", 2017-04-27 00:34:58 UTC], ["id", 14]]
[ActiveJob] [PriceUpdateJob] [a7e2ac6f-65dc-4456-907a-5488fab28d9a]   [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
[ActiveJob] [PriceUpdateJob] [a7e2ac6f-65dc-4456-907a-5488fab28d9a]   [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" INNER JOIN "compositions" ON "constructor_objects"."id" = "compositions"."parent_id" WHERE "compositions"."children_id" = $1[0m  [["children_id", 14]]
[ActiveJob] [PriceUpdateJob] [a7e2ac6f-65dc-4456-907a-5488fab28d9a] Performed PriceUpdateJob from Sidekiq(update_price) in 157660.29ms
Started GET "/composites" for 127.0.0.1 at 2017-04-27 03:35:09 +0300
Processing by CompositesController#index as HTML
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering composites/index.html.haml within layouts/application
  [1m[36mCategory Load (0.6ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."product" = $1[0m  [["product", false]]
  [1m[36mComposite Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Composite') AND "constructor_objects"."deleted_at" IS NULL[0m
  [1m[36mCategory Load (0.6ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" IN (2, 1, 3)[0m
  [1m[36mUnit Load (1.8ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (3, 1, 2)[0m
  Rendered composites/_listing.html.haml (4.3ms)
  Rendered composites/_listing.html.haml (1.1ms)
  Rendered composites/_listing.html.haml (0.8ms)
  Rendered composites/index.html.haml within layouts/application (79.0ms)
  Rendered layouts/_header.html.haml (15.4ms)
Completed 200 OK in 797ms (Views: 682.5ms | ActiveRecord: 22.8ms)


Started GET "/composites" for 127.0.0.1 at 2017-04-27 03:35:19 +0300
Processing by CompositesController#index as HTML
  [1m[36mUser Load (2.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering composites/index.html.haml within layouts/application
  [1m[36mCategory Load (0.6ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."product" = $1[0m  [["product", false]]
  [1m[36mComposite Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Composite') AND "constructor_objects"."deleted_at" IS NULL[0m
  [1m[36mCategory Load (0.8ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" IN (2, 1, 3)[0m
  [1m[36mUnit Load (2.4ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (3, 1, 2)[0m
  Rendered composites/_listing.html.haml (5.7ms)
  Rendered composites/_listing.html.haml (0.7ms)
  Rendered composites/_listing.html.haml (0.6ms)
  Rendered composites/index.html.haml within layouts/application (59.5ms)
  Rendered layouts/_header.html.haml (11.6ms)
Completed 200 OK in 783ms (Views: 697.8ms | ActiveRecord: 6.7ms)


Started GET "/composites/14/edit" for 127.0.0.1 at 2017-04-27 03:35:21 +0300
Processing by CompositesController#edit as HTML
  Parameters: {"id"=>"14"}
  [1m[36mComposite Load (1.4ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Composite') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 14], ["LIMIT", 1]]
  [1m[36mUser Load (1.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering composites/edit.html.haml within layouts/application
  [1m[36mUnit Load (1.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL[0m
  [1m[36mCategory Load (2.4ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."product" = $1[0m  [["product", false]]
  Rendered composites/_composition_fields.html.haml (4.9ms)
  [1m[36mComposition Load (0.6ms)[0m  [1m[34mSELECT "compositions".* FROM "compositions" WHERE "compositions"."deleted_at" IS NULL AND "compositions"."parent_id" = $1[0m  [["parent_id", 14]]
  [1m[36mConstructorObject Load (11.0ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mUnit Load (0.5ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  Rendered composites/_composition_fields.html.haml (34.2ms)
  Rendered composites/_form.html.haml (106.2ms)
  Rendered composites/edit.html.haml within layouts/application (112.8ms)
  Rendered layouts/_header.html.haml (8.6ms)
Completed 200 OK in 759ms (Views: 722.5ms | ActiveRecord: 25.4ms)


Started PATCH "/composites/14" for 127.0.0.1 at 2017-04-27 03:35:26 +0300
Processing by CompositesController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"Gk7zZ+aLzCkajn6eUp8p5MWXN+p7zEOhWPtr5m6JwaiW//DuvFPGSD9e4m4vHSmkvgrlCVm3s8vi1FQ5fZVjuQ==", "commit"=>"Сохранить", "composite"=>{"name"=>"Объект 3", "unit_id"=>"2", "category_id"=>"3", "divisibility"=>"0", "compositions_attributes"=>{"0"=>{"children_id"=>"6", "value"=>"5", "_destroy"=>"false", "id"=>"5"}}}, "search_id"=>"", "search"=>"", "id"=>"14"}
  [1m[36mComposite Load (3.5ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Composite') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 14], ["LIMIT", 1]]
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mComposition Load (0.9ms)[0m  [1m[34mSELECT "compositions".* FROM "compositions" WHERE "compositions"."deleted_at" IS NULL AND "compositions"."parent_id" = $1 AND "compositions"."id" = 5[0m  [["parent_id", 14]]
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" INNER JOIN "compositions" ON "constructor_objects"."id" = "compositions"."children_id" WHERE "compositions"."parent_id" = $1[0m  [["parent_id", 6]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" INNER JOIN "compositions" ON "constructor_objects"."id" = "compositions"."parent_id" WHERE "compositions"."children_id" = $1[0m  [["children_id", 6]]
  [1m[36mConstructorObject Load (2.8ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" INNER JOIN "compositions" ON "constructor_objects"."id" = "compositions"."parent_id" WHERE "compositions"."children_id" = $1[0m  [["children_id", 14]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" INNER JOIN "compositions" ON "constructor_objects"."id" = "compositions"."parent_id" WHERE "compositions"."children_id" = $1[0m  [["children_id", 14]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 14], ["LIMIT", 1]]
  [1m[35mSQL (0.5ms)[0m  [1m[33mUPDATE "compositions" SET "value" = $1 WHERE "compositions"."id" = $2[0m  [["value", 5], ["id", 5]]
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
[ActiveJob] Enqueued PriceUpdateJob (Job ID: b3cc1bbb-ed8c-4e5a-aa61-2e91fcbbf1ad) to Sidekiq(update_price) with arguments: #<GlobalID:0x007f22dd508a28 @uri=#<URI::GID gid://constructor/Composite/14>>
Redirected to http://localhost:3000/composites
Completed 302 Found in 78ms (ActiveRecord: 12.9ms)


Started GET "/composites" for 127.0.0.1 at 2017-04-27 03:35:26 +0300
Processing by CompositesController#index as HTML
  [1m[36mUser Load (2.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering composites/index.html.haml within layouts/application
  [1m[36mCategory Load (2.3ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."product" = $1[0m  [["product", false]]
  [1m[36mComposite Load (1.8ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Composite') AND "constructor_objects"."deleted_at" IS NULL[0m
  [1m[36mCategory Load (0.8ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" IN (2, 1, 3)[0m
  [1m[36mUnit Load (1.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (3, 1, 2)[0m
  Rendered composites/_listing.html.haml (7.7ms)
  Rendered composites/_listing.html.haml (0.7ms)
  Rendered composites/_listing.html.haml (0.8ms)
  Rendered composites/index.html.haml within layouts/application (42.3ms)
  [1m[36mComposite Load (3.5ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Composite') AND "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 14], ["LIMIT", 1]]
[ActiveJob] [PriceUpdateJob] [b3cc1bbb-ed8c-4e5a-aa61-2e91fcbbf1ad] Performing PriceUpdateJob from Sidekiq(update_price) with arguments: #<GlobalID:0x007fe8b12db210 @uri=#<URI::GID gid://constructor/Composite/14>>
[ActiveJob] [PriceUpdateJob] [b3cc1bbb-ed8c-4e5a-aa61-2e91fcbbf1ad]   [1m[36mComposition Load (1.0ms)[0m  [1m[34mSELECT "compositions".* FROM "compositions" WHERE "compositions"."deleted_at" IS NULL AND "compositions"."parent_id" = $1[0m  [["parent_id", 14]]
[ActiveJob] [PriceUpdateJob] [b3cc1bbb-ed8c-4e5a-aa61-2e91fcbbf1ad]   [1m[36mConstructorObject Load (1.6ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
[ActiveJob] [PriceUpdateJob] [b3cc1bbb-ed8c-4e5a-aa61-2e91fcbbf1ad]   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
[ActiveJob] [PriceUpdateJob] [b3cc1bbb-ed8c-4e5a-aa61-2e91fcbbf1ad]   [1m[36mAudited::Audit Load (0.8ms)[0m  [1m[34mSELECT  "audits".* FROM "audits" WHERE "audits"."auditable_id" = $1 AND "audits"."auditable_type" = $2 ORDER BY "audits"."version" DESC LIMIT $3[0m  [["auditable_id", 14], ["auditable_type", "ConstructorObject"], ["LIMIT", 1]]
[ActiveJob] [PriceUpdateJob] [b3cc1bbb-ed8c-4e5a-aa61-2e91fcbbf1ad]   [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "audits" ("auditable_id", "auditable_type", "action", "audited_changes", "version", "request_uuid", "created_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["auditable_id", 14], ["auditable_type", "ConstructorObject"], ["action", "update"], ["audited_changes", "---\nprice_without_work:\n- !ruby/object:BigDecimal 18:0.6E3\n- !ruby/object:BigDecimal 18:0.0\n"], ["version", 5], ["request_uuid", "34337a85-3fb3-486d-893c-fa543bc66f01"], ["created_at", 2017-04-27 00:35:26 UTC]]
[ActiveJob] [PriceUpdateJob] [b3cc1bbb-ed8c-4e5a-aa61-2e91fcbbf1ad]   [1m[35mSQL (0.5ms)[0m  [1m[33mUPDATE "constructor_objects" SET "price" = $1, "price_without_work" = $2, "updated_at" = $3 WHERE "constructor_objects"."id" = $4[0m  [["price", #<BigDecimal:7fe8b110b6d8,'0.3E3',9(18)>], ["price_without_work", #<BigDecimal:7fe8b110b598,'0.0',9(27)>], ["updated_at", 2017-04-27 00:35:26 UTC], ["id", 14]]
[ActiveJob] [PriceUpdateJob] [b3cc1bbb-ed8c-4e5a-aa61-2e91fcbbf1ad]   [1m[35m (1.5ms)[0m  [1m[35mCOMMIT[0m
[ActiveJob] [PriceUpdateJob] [b3cc1bbb-ed8c-4e5a-aa61-2e91fcbbf1ad]   [1m[36mConstructorObject Load (0.5ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" INNER JOIN "compositions" ON "constructor_objects"."id" = "compositions"."parent_id" WHERE "compositions"."children_id" = $1[0m  [["children_id", 14]]
[ActiveJob] [PriceUpdateJob] [b3cc1bbb-ed8c-4e5a-aa61-2e91fcbbf1ad] Performed PriceUpdateJob from Sidekiq(update_price) in 77.39ms
  Rendered layouts/_header.html.haml (17.7ms)
Completed 200 OK in 677ms (Views: 664.1ms | ActiveRecord: 8.9ms)


Started GET "/composites" for 127.0.0.1 at 2017-04-27 03:35:31 +0300
Processing by CompositesController#index as HTML
  [1m[36mUser Load (4.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering composites/index.html.haml within layouts/application
  [1m[36mCategory Load (2.4ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."product" = $1[0m  [["product", false]]
  [1m[36mComposite Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Composite') AND "constructor_objects"."deleted_at" IS NULL[0m
  [1m[36mCategory Load (0.7ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" IN (2, 1, 3)[0m
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (3, 1, 2)[0m
  Rendered composites/_listing.html.haml (3.3ms)
  Rendered composites/_listing.html.haml (0.7ms)
  Rendered composites/_listing.html.haml (0.8ms)
  Rendered composites/index.html.haml within layouts/application (35.9ms)
  Rendered layouts/_header.html.haml (9.9ms)
Completed 200 OK in 672ms (Views: 658.2ms | ActiveRecord: 8.4ms)


  [1m[36mComposite Load (1.6ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Composite') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 14], ["LIMIT", 1]]
Started GET "/products" for 127.0.0.1 at 2017-04-27 03:36:38 +0300
Processing by ProductsController#index as HTML
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering products/index.html.haml within layouts/application
  [1m[36mCategory Load (1.1ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."product" = $1[0m  [["product", true]]
  [1m[36mProduct Load (8.9ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL[0m
  [1m[36mCategory Load (0.7ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" IN (9, 12, 10)[0m
  [1m[36mUnit Load (1.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (1, 3, 5)[0m
  [1m[36mCategory Load (0.7ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL[0m
  [1m[35m (1.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 1[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 2[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 3[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 4[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 5[0m
  [1m[35m (1.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 6[0m
  [1m[35m (1.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 7[0m
  [1m[35m (2.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 8[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 9[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 9[0m
  [1m[36mCategory Load (0.9ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" = 9[0m
  [1m[36mUnit Load (1.2ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  Rendered products/_listing.html.haml (11.3ms)
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 10[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 10[0m
  [1m[36mCategory Load (2.6ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" = 10[0m
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  Rendered products/_listing.html.haml (1.3ms)
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 11[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 12[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 12[0m
  [1m[36mCategory Load (0.7ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" = 12[0m
  [1m[36mUnit Load (0.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  Rendered products/_listing.html.haml (1.0ms)
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 13[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 14[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 15[0m
  Rendered products/index.html.haml within layouts/application (124.8ms)
  Rendered layouts/_header.html.haml (11.1ms)
Completed 200 OK in 735ms (Views: 685.6ms | ActiveRecord: 37.9ms)


Started GET "/products/1/edit" for 127.0.0.1 at 2017-04-27 03:36:43 +0300
Processing by ProductsController#edit as HTML
  Parameters: {"id"=>"1"}
  [1m[36mProduct Load (2.1ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (3.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mProductComposition Load (3.1ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (1.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = 1[0m
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  Rendering products/edit.html.haml within layouts/application
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL[0m
  [1m[36mCategory Load (0.7ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."product" = $1[0m  [["product", true]]
  Rendered products/_custom_product_false.haml (7.4ms)
  Rendered products/_custom_product_templates.haml (14.2ms)
  Rendered products/_custom_product_sets.haml (9.3ms)
  Rendered products/_custom_product_true.haml (29.1ms)
  Rendered products/_form.html.haml (74.0ms)
  Rendered products/edit.html.haml within layouts/application (79.6ms)
  Rendered layouts/_header.html.haml (11.0ms)
Completed 200 OK in 675ms (Views: 609.4ms | ActiveRecord: 15.1ms)


Started GET "/products" for 127.0.0.1 at 2017-04-27 03:36:46 +0300
Processing by ProductsController#index as HTML
  [1m[36mUser Load (3.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering products/index.html.haml within layouts/application
  [1m[36mCategory Load (0.8ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."product" = $1[0m  [["product", true]]
  [1m[36mProduct Load (1.2ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL[0m
  [1m[36mCategory Load (2.2ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" IN (9, 12, 10)[0m
  [1m[36mUnit Load (1.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (1, 3, 5)[0m
  [1m[36mCategory Load (0.6ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 1[0m
  [1m[35m (2.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 2[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 3[0m
  [1m[35m (1.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 4[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 5[0m
  [1m[35m (1.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 6[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 7[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 8[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 9[0m
  [1m[36mProduct Load (0.5ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 9[0m
  [1m[36mCategory Load (0.6ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" = 9[0m
  [1m[36mUnit Load (2.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  Rendered products/_listing.html.haml (3.0ms)
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 10[0m
  [1m[36mProduct Load (3.4ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 10[0m
  [1m[36mCategory Load (0.6ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" = 10[0m
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  Rendered products/_listing.html.haml (2.6ms)
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 11[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 12[0m
  [1m[36mProduct Load (0.5ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 12[0m
  [1m[36mCategory Load (2.8ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" = 12[0m
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  Rendered products/_listing.html.haml (0.9ms)
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 13[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 14[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 15[0m
  Rendered products/index.html.haml within layouts/application (96.5ms)
  Rendered layouts/_header.html.haml (10.3ms)
Completed 200 OK in 721ms (Views: 679.4ms | ActiveRecord: 33.8ms)


Started GET "/products/new" for 127.0.0.1 at 2017-04-27 03:36:47 +0300
Processing by ProductsController#new as HTML
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering products/new.html.haml within layouts/application
  [1m[36mUnit Load (0.9ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL[0m
  [1m[36mCategory Load (4.5ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."product" = $1[0m  [["product", true]]
  Rendered products/_custom_product_false.haml (3.8ms)
  Rendered products/_custom_product_templates.haml (7.3ms)
  Rendered products/_custom_product_sets.haml (10.3ms)
  Rendered products/_custom_product_true.haml (21.7ms)
  Rendered products/_form.html.haml (76.2ms)
  Rendered products/new.html.haml within layouts/application (79.7ms)
  Rendered layouts/_header.html.haml (10.8ms)
Completed 200 OK in 676ms (Views: 663.7ms | ActiveRecord: 6.2ms)


Started GET "/constructor_objects/autocomplete_constructor_object_name?term=Gh" for 127.0.0.1 at 2017-04-27 03:37:06 +0300
Processing by ConstructorObjectsController#autocomplete_constructor_object_name as JSON
  Parameters: {"term"=>"Gh"}
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT  constructor_objects.id, constructor_objects.name FROM "constructor_objects" WHERE (LOWER(constructor_objects.name) ILIKE 'gh%') ORDER BY constructor_objects.name ASC LIMIT $1[0m  [["LIMIT", 10]]
Completed 200 OK in 10ms (Views: 0.3ms | ActiveRecord: 0.8ms)


Started GET "/constructor_objects/autocomplete_constructor_object_name?term=%D0%9F%D1%80%D0%B8" for 127.0.0.1 at 2017-04-27 03:37:10 +0300
Processing by ConstructorObjectsController#autocomplete_constructor_object_name as JSON
  Parameters: {"term"=>"При"}
  [1m[36mConstructorObject Load (1.5ms)[0m  [1m[34mSELECT  constructor_objects.id, constructor_objects.name FROM "constructor_objects" WHERE (LOWER(constructor_objects.name) ILIKE 'при%') ORDER BY constructor_objects.name ASC LIMIT $1[0m  [["LIMIT", 10]]
Completed 200 OK in 7ms (Views: 0.6ms | ActiveRecord: 1.5ms)


Started POST "/constructor_objects/info" for 127.0.0.1 at 2017-04-27 03:37:14 +0300
Processing by ConstructorObjectsController#info as HTML
  Parameters: {"id"=>"6", "constructor_object"=>{"id"=>"6"}}
  [1m[36mConstructorObject Load (3.0ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mUnit Load (1.3ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
Completed 200 OK in 20ms (Views: 0.3ms | ActiveRecord: 4.3ms)


Started GET "/constructor_objects/autocomplete_constructor_object_name?term=%D0%9F%D1%80%D0%B8%D0%BC%D0%B8" for 127.0.0.1 at 2017-04-27 03:37:20 +0300
Processing by ConstructorObjectsController#autocomplete_constructor_object_name as JSON
  Parameters: {"term"=>"Прими"}
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  constructor_objects.id, constructor_objects.name FROM "constructor_objects" WHERE (LOWER(constructor_objects.name) ILIKE 'прими%') ORDER BY constructor_objects.name ASC LIMIT $1[0m  [["LIMIT", 10]]
Completed 200 OK in 5ms (Views: 0.6ms | ActiveRecord: 0.7ms)


Started POST "/constructor_objects/info" for 127.0.0.1 at 2017-04-27 03:37:22 +0300
Processing by ConstructorObjectsController#info as HTML
  Parameters: {"id"=>"2", "constructor_object"=>{"id"=>"2"}}
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 9ms (Views: 0.2ms | ActiveRecord: 1.2ms)


  [1m[36mProduct Load (2.6ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."deleted_at" IS NULL ORDER BY "products"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
DEPRECATION WARNING: to_cleanup is deprecated and will be removed from Rails 5.1 (use ActiveSupport::Reloader.to_complete instead) (called from <top (required)> at /home/g1nc/Development/ruby/constructor/config/environment.rb:5)
  [1m[36mActiveRecord::SchemaMigration Load (1.4ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (1.1ms)[0m  [1m[34mSELECT pg_try_advisory_lock(6572146483646705745);[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.7ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
Migrating to AddWithoutWorkPriceToConstructorObject (20170426222257)
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (5.7ms)[0m  [1m[35mALTER TABLE "stage_products" DROP "price_without_work"[0m
  [1m[35m (0.8ms)[0m  [1m[35mALTER TABLE "stage_products" DROP "with_work"[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "products" DROP "price_without_work"[0m
  [1m[35m (1.0ms)[0m  [1m[35mALTER TABLE "constructor_objects" DROP "price_without_work"[0m
  [1m[35mSQL (1.4ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = $1[0m  [["version", "20170426222257"]]
  [1m[35m (2.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT pg_advisory_unlock(6572146483646705745)[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.4ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
DEPRECATION WARNING: to_cleanup is deprecated and will be removed from Rails 5.1 (use ActiveSupport::Reloader.to_complete instead) (called from <top (required)> at /home/g1nc/Development/ruby/constructor/config/environment.rb:5)
  [1m[35m (0.8ms)[0m  [1m[34mSELECT pg_try_advisory_lock(6572146483646705745);[0m
  [1m[36mActiveRecord::SchemaMigration Load (1.4ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
Migrating to AddWithoutWorkPriceToConstructorObject (20170426222257)
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (34.9ms)[0m  [1m[35mALTER TABLE "constructor_objects" ADD "price_without_work" decimal DEFAULT 0[0m
  [1m[35m (18.4ms)[0m  [1m[35mALTER TABLE "stage_products" ADD "with_work" boolean DEFAULT 't'[0m
  [1m[35m (19.6ms)[0m  [1m[35mALTER TABLE "stage_products" ADD "price_without_work" decimal DEFAULT 0[0m
  [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20170426222257"]]
  [1m[35m (7.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (1.3ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", :environment], ["LIMIT", 1]]
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (1.9ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT pg_advisory_unlock(6572146483646705745)[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.7ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
DEPRECATION WARNING: to_cleanup is deprecated and will be removed from Rails 5.1 (use ActiveSupport::Reloader.to_complete instead) (called from <top (required)> at /home/g1nc/Development/ruby/constructor/config/environment.rb:5)
Started GET "/products" for 127.0.0.1 at 2017-04-27 03:45:34 +0300
  [1m[36mActiveRecord::SchemaMigration Load (0.9ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
Processing by ProductsController#index as HTML
  [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering products/index.html.haml within layouts/application
  [1m[36mCategory Load (0.8ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."product" = $1[0m  [["product", true]]
  [1m[36mProduct Load (2.1ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL[0m
  [1m[36mCategory Load (1.0ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" IN (9, 12, 10)[0m
  [1m[36mUnit Load (0.9ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (1, 3, 5)[0m
  [1m[36mCategory Load (1.2ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL[0m
  [1m[35m (1.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 1[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 2[0m
  [1m[35m (1.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 3[0m
  [1m[35m (2.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 4[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 5[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 6[0m
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 7[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 8[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 9[0m
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 9[0m
  [1m[36mCategory Load (0.7ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" = 9[0m
  [1m[36mUnit Load (1.3ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  Rendered products/_listing.html.haml (4.8ms)
  [1m[35m (2.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 10[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 10[0m
  [1m[36mCategory Load (0.6ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" = 10[0m
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  Rendered products/_listing.html.haml (0.9ms)
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 11[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 12[0m
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 12[0m
  [1m[36mCategory Load (0.7ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" = 12[0m
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  Rendered products/_listing.html.haml (0.7ms)
  [1m[35m (4.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 13[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 14[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 15[0m
  Rendered products/index.html.haml within layouts/application (182.5ms)
  Rendered layouts/_header.html.haml (11.7ms)
Completed 200 OK in 2258ms (Views: 2088.2ms | ActiveRecord: 58.8ms)


Started GET "/clients" for 127.0.0.1 at 2017-04-27 03:46:03 +0300
Processing by ClientsController#index as HTML
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering clients/index.html.haml within layouts/application
  [1m[36mUserClient Load (2.4ms)[0m  [1m[34mSELECT "user_clients".* FROM "user_clients" INNER JOIN "clients" ON "clients"."id" = "user_clients"."client_id" AND "clients"."deleted_at" IS NULL WHERE "clients"."archived" = $1 AND (user_id = 1 and owner = true)[0m  [["archived", false]]
  [1m[36mClient Load (0.9ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" IN (1, 2, 3)[0m
  [1m[36mEstimate Load (1.4ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" IN (1, 2, 3)[0m
  [1m[35m (1.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 1]]
  Rendered clients/_listing.html.haml (15.1ms)
  [1m[35m (3.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 2]]
  Rendered clients/_listing.html.haml (7.7ms)
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 3]]
  Rendered clients/_listing.html.haml (4.4ms)
  Rendered clients/_table.html.haml (35.0ms)
  [1m[36mUserClient Load (0.8ms)[0m  [1m[34mSELECT "user_clients".* FROM "user_clients" INNER JOIN "clients" ON "clients"."id" = "user_clients"."client_id" AND "clients"."deleted_at" IS NULL WHERE "clients"."archived" = $1 AND (user_id = 1 and owner = false)[0m  [["archived", false]]
  Rendered clients/index.html.haml within layouts/application (197.9ms)
  Rendered layouts/_header.html.haml (70.7ms)
Completed 200 OK in 985ms (Views: 883.6ms | ActiveRecord: 38.2ms)


Started GET "/estimates?client_id=1" for 127.0.0.1 at 2017-04-27 03:46:05 +0300
Processing by EstimatesController#index as HTML
  Parameters: {"client_id"=>"1"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mClient Load (0.6ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (1.2ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = 1[0m
  Rendering estimates/index.html.haml within layouts/application
  Rendered estimates/_listing.html.haml (6.6ms)
  Rendered estimates/_listing.html.haml (0.9ms)
  [1m[36mClient Load (0.6ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  Rendered estimates/index.html.haml within layouts/application (26.7ms)
  Rendered layouts/_header.html.haml (10.9ms)
Completed 200 OK in 664ms (Views: 637.7ms | ActiveRecord: 3.1ms)


Started DELETE "/primitives/1" for 127.0.0.1 at 2017-04-27 03:46:09 +0300
Processing by PrimitivesController#destroy as HTML
  Parameters: {"authenticity_token"=>"1rG8I0/z27dcaqI9ri2tS31deRMyJSmKqQZ/eR6RMQlaAL+qFSvR1nm6Ps3Tr60LBsCr8BBe2eATKUCmDY2TGA==", "id"=>"1"}
  [1m[36mPrimitive Load (1.4ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mAudited::Audit Load (1.2ms)[0m  [1m[34mSELECT  "audits".* FROM "audits" WHERE "audits"."auditable_id" = $1 AND "audits"."auditable_type" = $2 ORDER BY "audits"."version" DESC LIMIT $3[0m  [["auditable_id", 1], ["auditable_type", "ConstructorObject"], ["LIMIT", 1]]
  [1m[35mSQL (1.0ms)[0m  [1m[32mINSERT INTO "audits" ("auditable_id", "auditable_type", "user_id", "user_type", "action", "audited_changes", "version", "remote_address", "request_uuid", "created_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["auditable_id", 1], ["auditable_type", "ConstructorObject"], ["user_id", 1], ["user_type", "User"], ["action", "destroy"], ["audited_changes", "---\nname: Примитив 1\nunit_id: 6\ncategory_id: 3\nprice: !ruby/object:BigDecimal 18:0.1E2\ndate: !ruby/object:ActiveSupport::TimeWithZone\n  utc: 2017-04-26 00:00:00.000000000 Z\n  zone: !ruby/object:ActiveSupport::TimeZone\n    name: Etc/UTC\n  time: 2017-04-26 00:00:00.000000000 Z\ndivisibility: false\ndeleted_at: \nprice_without_work: !ruby/object:BigDecimal 18:0.0\n"], ["version", 1], ["remote_address", "127.0.0.1"], ["request_uuid", "2a5ab093-aee6-46a1-85d8-771cb22f3e19"], ["created_at", 2017-04-27 00:46:09 UTC]]
  [1m[35mSQL (1.0ms)[0m  [1m[33mUPDATE "constructor_objects" SET "deleted_at" = '2017-04-27 00:46:09.747439', "updated_at" = '2017-04-27 00:46:09.748525' WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."id" = $1[0m  [["id", 1]]
  [1m[35m (2.6ms)[0m  [1m[35mCOMMIT[0m
Redirected to http://localhost:3000/primitives
Completed 302 Found in 102ms (ActiveRecord: 16.6ms)


Started GET "/primitives" for 127.0.0.1 at 2017-04-27 03:46:09 +0300
Processing by PrimitivesController#index as HTML
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering primitives/index.html.haml within layouts/application
  [1m[36mCategory Load (0.8ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."product" = $1[0m  [["product", false]]
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL[0m
  [1m[36mCategory Load (0.9ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 1[0m
  [1m[36mPrimitive Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 1[0m
  [1m[36mCategory Load (1.1ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" = 1[0m
  [1m[36mUnit Load (2.1ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  Rendered primitives/_listing.html.haml (37.5ms)
  [1m[35m (3.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 2[0m
  [1m[36mPrimitive Load (1.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 2[0m
  [1m[36mCategory Load (1.3ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" = 2[0m
  [1m[36mUnit Load (1.4ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 2[0m
  Rendered primitives/_listing.html.haml (4.5ms)
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 3[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 4[0m
  [1m[36mPrimitive Load (2.1ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 4[0m
  [1m[36mCategory Load (1.3ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" = 4[0m
  [1m[36mUnit Load (1.8ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 5)[0m
  Rendered primitives/_listing.html.haml (4.0ms)
  Rendered primitives/_listing.html.haml (3.8ms)
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 5[0m
  [1m[36mPrimitive Load (0.8ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 5[0m
  [1m[36mCategory Load (0.7ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" = 5[0m
  [1m[36mUnit Load (3.2ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (1, 5)[0m
  Rendered primitives/_listing.html.haml (4.2ms)
  Rendered primitives/_listing.html.haml (3.8ms)
  Rendered primitives/_listing.html.haml (4.8ms)
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 6[0m
  [1m[36mPrimitive Load (0.8ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 6[0m
  [1m[36mCategory Load (0.7ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" = 6[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 2[0m
  Rendered primitives/_listing.html.haml (4.3ms)
  Rendered primitives/_listing.html.haml (3.9ms)
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 7[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 8[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 9[0m
  [1m[35m (3.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 10[0m
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 11[0m
  [1m[35m (1.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 12[0m
  [1m[35m (1.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 13[0m
  [1m[35m (2.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 14[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 15[0m
  Rendered primitives/index.html.haml within layouts/application (220.2ms)
  Rendered layouts/_header.html.haml (9.7ms)
Completed 200 OK in 858ms (Views: 805.8ms | ActiveRecord: 47.4ms)


Started GET "/clients" for 127.0.0.1 at 2017-04-27 03:47:04 +0300
Processing by ClientsController#index as HTML
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering clients/index.html.haml within layouts/application
  [1m[36mUserClient Load (0.8ms)[0m  [1m[34mSELECT "user_clients".* FROM "user_clients" INNER JOIN "clients" ON "clients"."id" = "user_clients"."client_id" AND "clients"."deleted_at" IS NULL WHERE "clients"."archived" = $1 AND (user_id = 1 and owner = true)[0m  [["archived", false]]
  [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" IN (1, 2, 3)[0m
  [1m[36mEstimate Load (0.8ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" IN (1, 2, 3)[0m
  [1m[35m (6.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 1]]
  Rendered clients/_listing.html.haml (18.3ms)
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 2]]
  Rendered clients/_listing.html.haml (5.7ms)
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 3]]
  Rendered clients/_listing.html.haml (4.0ms)
  Rendered clients/_table.html.haml (33.1ms)
  [1m[36mUserClient Load (0.8ms)[0m  [1m[34mSELECT "user_clients".* FROM "user_clients" INNER JOIN "clients" ON "clients"."id" = "user_clients"."client_id" AND "clients"."deleted_at" IS NULL WHERE "clients"."archived" = $1 AND (user_id = 1 and owner = false)[0m  [["archived", false]]
  Rendered clients/index.html.haml within layouts/application (122.0ms)
  Rendered layouts/_header.html.haml (83.5ms)
Completed 200 OK in 961ms (Views: 895.1ms | ActiveRecord: 29.4ms)


Started GET "/estimates?client_id=1" for 127.0.0.1 at 2017-04-27 03:47:06 +0300
Processing by EstimatesController#index as HTML
  Parameters: {"client_id"=>"1"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mClient Load (1.0ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (2.0ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = 1[0m
  Rendering estimates/index.html.haml within layouts/application
  Rendered estimates/_listing.html.haml (7.0ms)
  Rendered estimates/_listing.html.haml (1.2ms)
  [1m[36mClient Load (0.6ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  Rendered estimates/index.html.haml within layouts/application (59.4ms)
  Rendered layouts/_header.html.haml (10.1ms)
Completed 200 OK in 812ms (Views: 788.7ms | ActiveRecord: 4.3ms)


Started GET "/estimates?client_id=1" for 127.0.0.1 at 2017-04-27 03:47:38 +0300
Processing by EstimatesController#index as HTML
  Parameters: {"client_id"=>"1"}
  [1m[36mUser Load (3.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mClient Load (0.9ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (0.9ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = 1[0m
  Rendering estimates/index.html.haml within layouts/application
  Rendered estimates/_listing.html.haml (5.2ms)
  Rendered estimates/_listing.html.haml (2.3ms)
  [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  Rendered estimates/index.html.haml within layouts/application (25.3ms)
  Rendered layouts/_header.html.haml (14.0ms)
Completed 200 OK in 666ms (Views: 650.3ms | ActiveRecord: 6.2ms)


Started DELETE "/estimates/1" for 127.0.0.1 at 2017-04-27 03:47:42 +0300
Processing by EstimatesController#destroy as HTML
  Parameters: {"authenticity_token"=>"1TCU3Mf/XW85BliWa3iZnaJnAy80HEWnWDqmqKMlGHBZgZdVnSdXDhzWxGYW+pnd2frRzBZntc3iFZl3sDm6YQ==", "id"=>"1"}
  [1m[36mEstimate Load (2.6ms)[0m  [1m[34mSELECT  "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (2.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mAudited::Audit Load (0.9ms)[0m  [1m[34mSELECT  "audits".* FROM "audits" WHERE "audits"."auditable_id" = $1 AND "audits"."auditable_type" = $2 ORDER BY "audits"."version" DESC LIMIT $3[0m  [["auditable_id", 1], ["auditable_type", "Estimate"], ["LIMIT", 1]]
  [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "audits" ("auditable_id", "auditable_type", "user_id", "user_type", "action", "audited_changes", "version", "remote_address", "request_uuid", "created_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["auditable_id", 1], ["auditable_type", "Estimate"], ["user_id", 1], ["user_type", "User"], ["action", "destroy"], ["audited_changes", "---\nname: Название\nclient_id: 1\nfloors: !ruby/object:BigDecimal 18:0.1E1\nfirst_floor_height: !ruby/object:BigDecimal 18:0.124124E6\nsecond_floor_height_min: !ruby/object:BigDecimal 18:0.0\nsecond_floor_height_max: !ruby/object:BigDecimal 18:0.0\nthird_floor_height_min: !ruby/object:BigDecimal 18:0.0\nthird_floor_height_max: !ruby/object:BigDecimal 18:0.0\nprice: !ruby/object:BigDecimal 18:0.30569E4\narea: !ruby/object:BigDecimal 18:0.23E2\nprice_by_area: !ruby/object:BigDecimal 18:0.13291E3\nprice_by_stage:\n- !ruby/object:BigDecimal 18:0.222E4\n- !ruby/object:BigDecimal 18:0.55E3\n- !ruby/object:BigDecimal 18:0.33E3\nprice_by_stage_aggregated:\n- !ruby/object:BigDecimal 18:0.222E4\n- !ruby/object:BigDecimal 18:0.277E4\n- !ruby/object:BigDecimal 18:0.31E4\nprice_by_area_per_stage:\n- !ruby/object:BigDecimal 18:0.9652E2\n- !ruby/object:BigDecimal 18:0.12043E3\n- !ruby/object:BigDecimal 18:0.13478E3\ndiscount_title: Скидка\ndiscount_by_stages:\n- !ruby/object:BigDecimal 18:0.1E1\n- !ruby/object:BigDecimal 18:0.2E1\n- !ruby/object:BigDecimal 18:0.3E1\ndiscount_amount:\n- !ruby/object:BigDecimal 18:0.222E2\n- !ruby/object:BigDecimal 18:0.11E2\n- !ruby/object:BigDecimal 18:0.99E1\nprice_by_stage_aggregated_discounted:\n- !ruby/object:BigDecimal 18:0.21978E4\n- !ruby/object:BigDecimal 18:0.2759E4\n- !ruby/object:BigDecimal 18:0.30901E4\nprice_by_area_per_stage_discounted:\n- !ruby/object:BigDecimal 18:0.9556E2\n- !ruby/object:BigDecimal 18:0.11996E3\n- !ruby/object:BigDecimal 18:0.13435E3\nsigned: false\ndeleted_at: \nsigning_date: \nuser_id: \n"], ["version", 10], ["remote_address", "127.0.0.1"], ["request_uuid", "8ba0ad73-dcc3-43ba-847e-f0dc76636f86"], ["created_at", 2017-04-27 00:47:42 UTC]]
  [1m[35mSQL (0.8ms)[0m  [1m[33mUPDATE "estimates" SET "deleted_at" = '2017-04-27 00:47:42.613744', "updated_at" = '2017-04-27 00:47:42.613820' WHERE "estimates"."id" = $1[0m  [["id", 1]]
  [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
Redirected to http://localhost:3000/estimates?client_id=1
Completed 302 Found in 85ms (ActiveRecord: 9.2ms)


Started GET "/estimates?client_id=1" for 127.0.0.1 at 2017-04-27 03:47:42 +0300
Processing by EstimatesController#index as HTML
  Parameters: {"client_id"=>"1"}
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (0.8ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = 1[0m
  Rendering estimates/index.html.haml within layouts/application
  Rendered estimates/_listing.html.haml (5.3ms)
  [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  Rendered estimates/index.html.haml within layouts/application (25.2ms)
  Rendered layouts/_header.html.haml (12.9ms)
Completed 200 OK in 596ms (Views: 584.5ms | ActiveRecord: 3.0ms)


Started GET "/estimates/2/edit" for 127.0.0.1 at 2017-04-27 03:47:45 +0300
Processing by EstimatesController#edit as HTML
  Parameters: {"id"=>"2"}
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (0.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (3.3ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (3.9ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = 1[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = 1[0m
  [1m[36mProduct Load (0.5ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (1.4ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (1.4ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (3.4ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (3.2ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (4.0ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (1.7ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mUnit Load (1.3ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  [1m[36mProductTemplateSet Load (0.8ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.8ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.9ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUnit Load (1.5ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (0.8ms)[0m  [1m[34mSELECT  "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUser Load (1.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (2.1ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStage Load (2.4ms)[0m  [1m[34mSELECT "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mStageProduct Load (0.9ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" IN (4, 5, 6)[0m
  [1m[36mStageProduct Load (0.6ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 4]]
  [1m[36mStageProductSet Load (2.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 4[0m
  [1m[36mProduct Load (0.9ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 1[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mStageProduct Load (1.8ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 5]]
  [1m[36mStageProductSet Load (0.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 5[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 2[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mStageProduct Load (3.4ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 6]]
  [1m[36mStageProductSet Load (1.2ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 6[0m
  [1m[36mProduct Load (1.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 3[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mStageProductSet Load (0.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = $1[0m  [["stage_product_id", 6]]
  [1m[36mStageProductSetValue Load (2.2ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = 2[0m
  [1m[36mProductSet Load (0.6ms)[0m  [1m[34mSELECT  "product_sets".* FROM "product_sets" WHERE "product_sets"."deleted_at" IS NULL AND "product_sets"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStageProductSetValue Load (0.5ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1[0m  [["stage_product_set_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  Rendering estimates/edit.html.haml within layouts/application
  [1m[36mClient Load (1.3ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (12.9ms)
  [1m[36mClientFile Load (2.1ms)[0m  [1m[34mSELECT "client_files".* FROM "client_files" WHERE "client_files"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mAssetFile Load (1.0ms)[0m  [1m[34mSELECT  "asset_files".* FROM "asset_files" WHERE "asset_files"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendered estimates/_client_file_fields.html.haml (21.1ms)
  Rendered estimates/_technical_file_fields.html.haml (8.6ms)
  [1m[36mTechnicalFile Load (1.6ms)[0m  [1m[34mSELECT "technical_files".* FROM "technical_files" WHERE "technical_files"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mAssetFile Load (0.7ms)[0m  [1m[34mSELECT  "asset_files".* FROM "asset_files" WHERE "asset_files"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  Rendered estimates/_technical_file_fields.html.haml (9.1ms)
  Rendered estimates/_discount.html.haml (11.0ms)
  Rendered estimates/_stages.html.haml (16.7ms)
  Rendered estimates/_form.html.haml (185.0ms)
  Rendered estimates/edit.html.haml within layouts/application (189.6ms)
  Rendered layouts/_header.html.haml (11.9ms)
Completed 200 OK in 1193ms (Views: 678.5ms | ActiveRecord: 137.2ms)


Started GET "/estimates" for 127.0.0.1 at 2017-04-27 03:49:49 +0300
Processing by EstimatesController#index as HTML
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Redirected to http://localhost:3000/clients
Completed 302 Found in 31ms (ActiveRecord: 9.3ms)


Started GET "/clients" for 127.0.0.1 at 2017-04-27 03:49:49 +0300
Processing by ClientsController#index as HTML
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering clients/index.html.haml within layouts/application
  [1m[36mUserClient Load (0.9ms)[0m  [1m[34mSELECT "user_clients".* FROM "user_clients" INNER JOIN "clients" ON "clients"."id" = "user_clients"."client_id" AND "clients"."deleted_at" IS NULL WHERE "clients"."archived" = $1 AND (user_id = 1 and owner = true)[0m  [["archived", false]]
  [1m[36mClient Load (0.6ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" IN (1, 2, 3)[0m
  [1m[36mEstimate Load (3.9ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" IN (1, 2, 3)[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 1]]
  Rendered clients/_listing.html.haml (9.9ms)
  [1m[35m (1.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 2]]
  Rendered clients/_listing.html.haml (6.8ms)
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 3]]
  Rendered clients/_listing.html.haml (3.6ms)
  Rendered clients/_table.html.haml (26.1ms)
  [1m[36mUserClient Load (2.6ms)[0m  [1m[34mSELECT "user_clients".* FROM "user_clients" INNER JOIN "clients" ON "clients"."id" = "user_clients"."client_id" AND "clients"."deleted_at" IS NULL WHERE "clients"."archived" = $1 AND (user_id = 1 and owner = false)[0m  [["archived", false]]
  Rendered clients/index.html.haml within layouts/application (120.3ms)
  Rendered layouts/_header.html.haml (95.7ms)
Completed 200 OK in 999ms (Views: 947.8ms | ActiveRecord: 31.0ms)


Started GET "/estimates?client_id=1" for 127.0.0.1 at 2017-04-27 03:49:52 +0300
Processing by EstimatesController#index as HTML
  Parameters: {"client_id"=>"1"}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (0.8ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = 1[0m
  Rendering estimates/index.html.haml within layouts/application
  Rendered estimates/_listing.html.haml (6.9ms)
  [1m[36mClient Load (2.5ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  Rendered estimates/index.html.haml within layouts/application (31.8ms)
  Rendered layouts/_header.html.haml (14.5ms)
Completed 200 OK in 686ms (Views: 658.7ms | ActiveRecord: 4.6ms)


Started GET "/estimates/new?client_id=1" for 127.0.0.1 at 2017-04-27 03:49:55 +0300
Processing by EstimatesController#new as HTML
  Parameters: {"client_id"=>"1"}
  [1m[36mProduct Load (3.4ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (0.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (0.6ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = 1[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = 1[0m
  [1m[36mProduct Load (1.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (1.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.7ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (1.9ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (1.2ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (0.8ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (1.3ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (1.2ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mConstructorObject Load (1.3ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mUnit Load (1.2ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  [1m[36mProductTemplateSet Load (0.7ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (2.7ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.5ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering estimates/new.html.haml within layouts/application
  [1m[36mClient Load (0.8ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (8.1ms)
  Rendered estimates/_technical_file_fields.html.haml (6.4ms)
  Rendered estimates/_discount.html.haml (9.3ms)
  Rendered estimates/_stages.html.haml (19.6ms)
  Rendered estimates/_form.html.haml (128.5ms)
  Rendered estimates/new.html.haml within layouts/application (132.0ms)
  Rendered layouts/_header.html.haml (9.7ms)
Completed 200 OK in 970ms (Views: 691.6ms | ActiveRecord: 73.7ms)


Started GET "/estimates" for 127.0.0.1 at 2017-04-27 03:49:58 +0300
Processing by EstimatesController#index as HTML
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Redirected to http://localhost:3000/clients
Completed 302 Found in 4ms (ActiveRecord: 0.6ms)


Started GET "/clients" for 127.0.0.1 at 2017-04-27 03:49:58 +0300
Processing by ClientsController#index as HTML
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering clients/index.html.haml within layouts/application
  [1m[36mUserClient Load (8.3ms)[0m  [1m[34mSELECT "user_clients".* FROM "user_clients" INNER JOIN "clients" ON "clients"."id" = "user_clients"."client_id" AND "clients"."deleted_at" IS NULL WHERE "clients"."archived" = $1 AND (user_id = 1 and owner = true)[0m  [["archived", false]]
  [1m[36mClient Load (0.6ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" IN (1, 2, 3)[0m
  [1m[36mEstimate Load (0.7ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" IN (1, 2, 3)[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 1]]
  Rendered clients/_listing.html.haml (10.6ms)
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 2]]
  Rendered clients/_listing.html.haml (6.8ms)
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 3]]
  Rendered clients/_listing.html.haml (8.7ms)
  Rendered clients/_table.html.haml (31.0ms)
  [1m[36mUserClient Load (1.0ms)[0m  [1m[34mSELECT "user_clients".* FROM "user_clients" INNER JOIN "clients" ON "clients"."id" = "user_clients"."client_id" AND "clients"."deleted_at" IS NULL WHERE "clients"."archived" = $1 AND (user_id = 1 and owner = false)[0m  [["archived", false]]
  Rendered clients/index.html.haml within layouts/application (60.2ms)
  Rendered layouts/_header.html.haml (11.6ms)
Completed 200 OK in 691ms (Views: 673.4ms | ActiveRecord: 13.0ms)


Started GET "/estimates/new?client_id=1" for 127.0.0.1 at 2017-04-27 03:50:29 +0300
Processing by EstimatesController#new as HTML
  Parameters: {"client_id"=>"1"}
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (0.7ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = 1[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = 1[0m
  [1m[36mProduct Load (0.9ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.7ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (1.8ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (0.8ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.7ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  [1m[36mProductTemplateSet Load (0.7ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.9ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUnit Load (1.1ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.9ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering estimates/new.html.haml within layouts/application
  [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (5.2ms)
  Rendered estimates/_technical_file_fields.html.haml (3.0ms)
  Rendered estimates/_discount.html.haml (6.5ms)
  Rendered estimates/_stages.html.haml (16.7ms)
  Rendered estimates/_form.html.haml (71.5ms)
  Rendered estimates/new.html.haml within layouts/application (74.7ms)
  Rendered layouts/_header.html.haml (11.2ms)
Completed 200 OK in 982ms (Views: 870.4ms | ActiveRecord: 20.2ms)


Started GET "/estimates/new?client_id=1" for 127.0.0.1 at 2017-04-27 03:51:30 +0300
Processing by EstimatesController#new as HTML
  Parameters: {"client_id"=>"1"}
  [1m[36mProduct Load (6.1ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (2.3ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (6.4ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (2.3ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = 1[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = 1[0m
  [1m[36mProduct Load (1.2ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (1.9ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (2.2ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (1.4ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (1.4ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (3.4ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (3.0ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (1.1ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mUnit Load (1.9ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  [1m[36mProductTemplateSet Load (1.8ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (4.3ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (2.6ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (4.4ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.9ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.9ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.7ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering estimates/new.html.haml within layouts/application
  [1m[36mClient Load (1.5ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (4.1ms)
  Rendered estimates/_technical_file_fields.html.haml (3.7ms)
  Rendered estimates/_discount.html.haml (7.7ms)
  Rendered estimates/_stages.html.haml (23.4ms)
  Rendered estimates/_form.html.haml (87.6ms)
  Rendered estimates/new.html.haml within layouts/application (91.7ms)
  Rendered layouts/_header.html.haml (8.2ms)
Completed 200 OK in 2014ms (Views: 1879.3ms | ActiveRecord: 55.1ms)


Started GET "/products" for 127.0.0.1 at 2017-04-27 03:51:57 +0300
Processing by ProductsController#index as HTML
  [1m[36mUser Load (2.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering products/index.html.haml within layouts/application
  [1m[36mCategory Load (0.7ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."product" = $1[0m  [["product", true]]
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL[0m
  [1m[36mCategory Load (1.0ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" IN (9, 12, 10)[0m
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (1, 3, 5)[0m
  [1m[36mCategory Load (0.6ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 1[0m
  [1m[35m (1.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 2[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 3[0m
  [1m[35m (1.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 4[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 5[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 6[0m
  [1m[35m (1.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 7[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 8[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 9[0m
  [1m[36mProduct Load (0.5ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 9[0m
  [1m[36mCategory Load (0.6ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" = 9[0m
  [1m[36mUnit Load (1.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  Rendered products/_listing.html.haml (39.1ms)
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 10[0m
  [1m[36mProduct Load (3.5ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 10[0m
  [1m[36mCategory Load (0.6ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" = 10[0m
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  Rendered products/_listing.html.haml (0.8ms)
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 11[0m
  [1m[35m (1.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 12[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 12[0m
  [1m[36mCategory Load (0.6ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" = 12[0m
  [1m[36mUnit Load (1.2ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  Rendered products/_listing.html.haml (0.8ms)
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 13[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 14[0m
  [1m[35m (2.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 15[0m
  Rendered products/index.html.haml within layouts/application (130.1ms)
  Rendered layouts/_header.html.haml (13.5ms)
Completed 200 OK in 844ms (Views: 796.1ms | ActiveRecord: 36.2ms)


Started GET "/products/1/edit" for 127.0.0.1 at 2017-04-27 03:52:00 +0300
Processing by ProductsController#edit as HTML
  Parameters: {"id"=>"1"}
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (5.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mProductComposition Load (4.2ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (1.1ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = 1[0m
  [1m[36mUnit Load (2.2ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  Rendering products/edit.html.haml within layouts/application
  [1m[36mUnit Load (0.9ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL[0m
  [1m[36mCategory Load (0.8ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."product" = $1[0m  [["product", true]]
  Rendered products/_custom_product_false.haml (4.9ms)
  Rendered products/_custom_product_templates.haml (10.1ms)
  Rendered products/_custom_product_sets.haml (10.3ms)
  Rendered products/_custom_product_true.haml (25.8ms)
  Rendered products/_form.html.haml (86.5ms)
  Rendered products/edit.html.haml within layouts/application (91.9ms)
  Rendered layouts/_header.html.haml (10.4ms)
Completed 200 OK in 734ms (Views: 695.4ms | ActiveRecord: 15.5ms)


Started GET "/constructor_objects/autocomplete_constructor_object_name?term=Ghb" for 127.0.0.1 at 2017-04-27 03:52:05 +0300
Processing by ConstructorObjectsController#autocomplete_constructor_object_name as JSON
  Parameters: {"term"=>"Ghb"}
  [1m[36mConstructorObject Load (2.1ms)[0m  [1m[34mSELECT  constructor_objects.id, constructor_objects.name FROM "constructor_objects" WHERE (LOWER(constructor_objects.name) ILIKE 'ghb%') ORDER BY constructor_objects.name ASC LIMIT $1[0m  [["LIMIT", 10]]
Completed 200 OK in 5ms (Views: 0.3ms | ActiveRecord: 2.1ms)


Started GET "/constructor_objects/autocomplete_constructor_object_name?term=%D0%9F%D1%80%D0%B8%D0%BC%D0%B8" for 127.0.0.1 at 2017-04-27 03:52:07 +0300
Processing by ConstructorObjectsController#autocomplete_constructor_object_name as JSON
  Parameters: {"term"=>"Прими"}
  [1m[36mConstructorObject Load (2.0ms)[0m  [1m[34mSELECT  constructor_objects.id, constructor_objects.name FROM "constructor_objects" WHERE (LOWER(constructor_objects.name) ILIKE 'прими%') ORDER BY constructor_objects.name ASC LIMIT $1[0m  [["LIMIT", 10]]
Completed 200 OK in 9ms (Views: 2.9ms | ActiveRecord: 2.0ms)


Started POST "/constructor_objects/info" for 127.0.0.1 at 2017-04-27 03:52:11 +0300
Processing by ConstructorObjectsController#info as HTML
  Parameters: {"id"=>"6", "constructor_object"=>{"id"=>"6"}}
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
Completed 200 OK in 10ms (Views: 0.2ms | ActiveRecord: 1.2ms)


Started PATCH "/products/1" for 127.0.0.1 at 2017-04-27 03:52:14 +0300
Processing by ProductsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"IXp22GDDy0dEnOHCsi7YksgOpaUk3ZjPyBcZQ5rs0uety3VROhvBJmFMfTLPrNjSs5N3RgamaKVyOCacifBw9g==", "commit"=>"Сохранить", "product"=>{"name"=>"Простой продукт 1 этап", "description"=>"", "hint"=>"", "unit_id"=>"1", "category_id"=>"9", "stage"=>"1", "profit"=>"100.0", "display_components"=>"0", "custom"=>"0"}, "product_compositions"=>"[{\"id\":1,\"name\":\"Примитив 1\",\"unit\":\"лист\",\"quantity\":10,\"$$hashKey\":\"object:23\"},{\"id\":\"6\",\"name\":\"Примитив 6\",\"quantity\":\"5\",\"unit\":\"лист\",\"$$hashKey\":\"object:27\"}]", "product_templates"=>"[]", "product_sets"=>"[]", "autocomplete_composition_id"=>"6", "search"=>"Примитив 6", "template_name"=>"", "set_name"=>"", "id"=>"1"}
  [1m[36mProduct Load (1.6ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Unpermitted parameter: display_components
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mProductComposition Load (2.6ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1 AND ("product_compositions"."id" NOT IN (1, 6))[0m  [["product_id", 1]]
  [1m[36mProductComposition Load (1.4ms)[0m  [1m[34mSELECT  "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1 AND "product_compositions"."constructor_object_id" = $2 LIMIT $3[0m  [["product_id", 1], ["constructor_object_id", 1], ["LIMIT", 1]]
  [1m[35m (1.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mConstructorObject Load (2.1ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.6ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mProductComposition Load (0.8ms)[0m  [1m[34mSELECT  "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1 AND "product_compositions"."constructor_object_id" = $2 LIMIT $3[0m  [["product_id", 1], ["constructor_object_id", 6], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[35mSQL (2.4ms)[0m  [1m[32mINSERT INTO "product_compositions" ("product_id", "constructor_object_id", "value") VALUES ($1, $2, $3) RETURNING "id"[0m  [["product_id", 1], ["constructor_object_id", 6], ["value", 5]]
  [1m[35m (1.6ms)[0m  [1m[35mCOMMIT[0m
Redirected to http://localhost:3000/products
Completed 302 Found in 46ms (ActiveRecord: 16.7ms)


Started GET "/products" for 127.0.0.1 at 2017-04-27 03:52:14 +0300
Processing by ProductsController#index as HTML
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering products/index.html.haml within layouts/application
  [1m[36mCategory Load (0.6ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."product" = $1[0m  [["product", true]]
  [1m[36mProduct Load (2.1ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL[0m
  [1m[36mCategory Load (0.6ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" IN (9, 12, 10)[0m
  [1m[36mUnit Load (3.1ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (1, 3, 5)[0m
  [1m[36mCategory Load (0.6ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 1[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 2[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 3[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 4[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 5[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 6[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 7[0m
  [1m[35m (1.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 8[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 9[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 9[0m
  [1m[36mCategory Load (0.7ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" = 9[0m
  [1m[36mUnit Load (1.3ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  Rendered products/_listing.html.haml (3.6ms)
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 10[0m
  [1m[36mProduct Load (2.9ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 10[0m
  [1m[36mCategory Load (0.6ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" = 10[0m
  [1m[36mUnit Load (0.9ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  Rendered products/_listing.html.haml (0.7ms)
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 11[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 12[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 12[0m
  [1m[36mCategory Load (1.0ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" = 12[0m
  [1m[36mUnit Load (1.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  Rendered products/_listing.html.haml (1.0ms)
  [1m[35m (1.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 13[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 14[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 15[0m
  Rendered products/index.html.haml within layouts/application (128.3ms)
  Rendered layouts/_header.html.haml (13.0ms)
Completed 200 OK in 854ms (Views: 820.6ms | ActiveRecord: 27.9ms)


Started GET "/estimates/new" for 127.0.0.1 at 2017-04-27 03:52:19 +0300
Processing by EstimatesController#new as HTML
  [1m[36mProduct Load (2.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (0.5ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mProduct Load (9.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (2.4ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.5ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (1.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (2.8ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (1.3ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (3.7ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mUnit Load (1.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  [1m[36mProductTemplateSet Load (0.8ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (1.1ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (2.2ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUnit Load (0.9ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.8ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering estimates/new.html.haml within layouts/application
  [1m[36mClient Load (0.6ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (3.9ms)
  Rendered estimates/_technical_file_fields.html.haml (3.4ms)
  Rendered estimates/_discount.html.haml (7.9ms)
  Rendered estimates/_stages.html.haml (22.6ms)
  Rendered estimates/_form.html.haml (88.1ms)
  Rendered estimates/new.html.haml within layouts/application (92.2ms)
  Rendered layouts/_header.html.haml (10.9ms)
Completed 200 OK in 844ms (Views: 722.5ms | ActiveRecord: 38.3ms)


Started GET "/estimates/new" for 127.0.0.1 at 2017-04-27 03:52:57 +0300
Processing by EstimatesController#new as HTML
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (1.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (0.7ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mProduct Load (3.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (2.1ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.7ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.5ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (0.8ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.7ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mConstructorObject Load (0.9ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  [1m[36mProductTemplateSet Load (0.8ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.5ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUnit Load (1.0ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (2.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.6ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering estimates/new.html.haml within layouts/application
  [1m[36mClient Load (2.0ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (37.2ms)
  Rendered estimates/_technical_file_fields.html.haml (3.5ms)
  Rendered estimates/_discount.html.haml (7.3ms)
  Rendered estimates/_stages.html.haml (20.9ms)
  Rendered estimates/_form.html.haml (128.7ms)
  Rendered estimates/new.html.haml within layouts/application (132.7ms)
  Rendered layouts/_header.html.haml (10.5ms)
Completed 200 OK in 1692ms (Views: 1603.7ms | ActiveRecord: 25.6ms)


Started GET "/estimates/new" for 127.0.0.1 at 2017-04-27 03:53:47 +0300
Processing by EstimatesController#new as HTML
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (0.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (0.6ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.5ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mCACHE (0.1ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (1.0ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.6ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  [1m[36mProductTemplateSet Load (3.8ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.5ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.3ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering estimates/new.html.haml within layouts/application
  [1m[36mClient Load (0.6ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (7.5ms)
  Rendered estimates/_technical_file_fields.html.haml (9.3ms)
  Rendered estimates/_discount.html.haml (8.1ms)
  Rendered estimates/_stages.html.haml (22.7ms)
  Rendered estimates/_form.html.haml (141.0ms)
  Rendered estimates/new.html.haml within layouts/application (144.9ms)
  Rendered layouts/_header.html.haml (26.2ms)
Completed 200 OK in 1408ms (Views: 1017.3ms | ActiveRecord: 79.8ms)


Started GET "/products" for 127.0.0.1 at 2017-04-27 03:54:20 +0300
Processing by ProductsController#index as HTML
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering products/index.html.haml within layouts/application
  [1m[36mCategory Load (2.0ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."product" = $1[0m  [["product", true]]
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL[0m
  [1m[36mCategory Load (0.9ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" IN (9, 12, 10)[0m
  [1m[36mUnit Load (3.2ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (1, 3, 5)[0m
  [1m[36mCategory Load (0.6ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL[0m
  [1m[35m (5.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 1[0m
  [1m[35m (1.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 2[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 3[0m
  [1m[35m (1.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 4[0m
  [1m[35m (1.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 5[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 6[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 7[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 8[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 9[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 9[0m
  [1m[36mCategory Load (0.7ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" = 9[0m
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  Rendered products/_listing.html.haml (4.2ms)
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 10[0m
  [1m[36mProduct Load (1.5ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 10[0m
  [1m[36mCategory Load (0.6ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" = 10[0m
  [1m[36mUnit Load (1.4ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  Rendered products/_listing.html.haml (0.9ms)
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 11[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 12[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 12[0m
  [1m[36mCategory Load (1.1ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" = 12[0m
  [1m[36mUnit Load (1.2ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  Rendered products/_listing.html.haml (0.8ms)
  [1m[35m (1.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 13[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 14[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 15[0m
  Rendered products/index.html.haml within layouts/application (111.6ms)
  Rendered layouts/_header.html.haml (13.7ms)
Completed 200 OK in 900ms (Views: 856.2ms | ActiveRecord: 38.2ms)


Started GET "/products/1/edit" for 127.0.0.1 at 2017-04-27 03:54:26 +0300
Processing by ProductsController#edit as HTML
  Parameters: {"id"=>"1"}
  [1m[36mProduct Load (1.8ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mProductComposition Load (0.7ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (1.1ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mUnit Load (1.9ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  Rendering products/edit.html.haml within layouts/application
  [1m[36mUnit Load (0.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL[0m
  [1m[36mCategory Load (0.9ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."product" = $1[0m  [["product", true]]
  Rendered products/_custom_product_false.haml (3.3ms)
  Rendered products/_custom_product_templates.haml (7.6ms)
  Rendered products/_custom_product_sets.haml (9.5ms)
  Rendered products/_custom_product_true.haml (20.4ms)
  Rendered products/_form.html.haml (53.3ms)
  Rendered products/edit.html.haml within layouts/application (56.8ms)
  Rendered layouts/_header.html.haml (12.2ms)
Completed 200 OK in 716ms (Views: 681.6ms | ActiveRecord: 7.7ms)


Started GET "/primitives" for 127.0.0.1 at 2017-04-27 03:54:46 +0300
Processing by PrimitivesController#index as HTML
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering primitives/index.html.haml within layouts/application
  [1m[36mCategory Load (0.7ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."product" = $1[0m  [["product", false]]
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL[0m
  [1m[36mCategory Load (0.7ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL[0m
  [1m[35m (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 1[0m
  [1m[36mPrimitive Load (1.1ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 1[0m
  [1m[36mCategory Load (0.5ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" = 1[0m
  [1m[36mUnit Load (2.9ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  Rendered primitives/_listing.html.haml (12.5ms)
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 2[0m
  [1m[36mPrimitive Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 2[0m
  [1m[36mCategory Load (0.5ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" = 2[0m
  [1m[36mUnit Load (0.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 2[0m
  Rendered primitives/_listing.html.haml (8.5ms)
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 3[0m
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 4[0m
  [1m[36mPrimitive Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 4[0m
  [1m[36mCategory Load (0.7ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" = 4[0m
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 5)[0m
  Rendered primitives/_listing.html.haml (5.1ms)
  Rendered primitives/_listing.html.haml (6.1ms)
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 5[0m
  [1m[36mPrimitive Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 5[0m
  [1m[36mCategory Load (2.5ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" = 5[0m
  [1m[36mUnit Load (2.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (1, 5)[0m
  Rendered primitives/_listing.html.haml (4.4ms)
  Rendered primitives/_listing.html.haml (34.5ms)
  Rendered primitives/_listing.html.haml (3.6ms)
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 6[0m
  [1m[36mPrimitive Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 6[0m
  [1m[36mCategory Load (0.6ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" = 6[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 2[0m
  Rendered primitives/_listing.html.haml (6.0ms)
  Rendered primitives/_listing.html.haml (7.9ms)
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 7[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 8[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 9[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 10[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 11[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 12[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 13[0m
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 14[0m
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 15[0m
  Rendered primitives/index.html.haml within layouts/application (205.1ms)
  Rendered layouts/_header.html.haml (15.5ms)
Completed 200 OK in 891ms (Views: 852.4ms | ActiveRecord: 27.2ms)


Started GET "/products/1/edit" for 127.0.0.1 at 2017-04-27 03:55:11 +0300
Processing by ProductsController#edit as HTML
  Parameters: {"id"=>"1"}
  [1m[36mProduct Load (2.7ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mProductComposition Load (0.6ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mUnit Load (1.7ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  Rendering products/edit.html.haml within layouts/application
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL[0m
  [1m[36mCategory Load (0.9ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."product" = $1[0m  [["product", true]]
  Rendered products/_custom_product_false.haml (7.2ms)
  Rendered products/_custom_product_templates.haml (22.9ms)
  Rendered products/_custom_product_sets.haml (44.0ms)
  Rendered products/_custom_product_true.haml (71.5ms)
  Rendered products/_form.html.haml (126.3ms)
  Rendered products/edit.html.haml within layouts/application (130.2ms)
  Rendered layouts/_header.html.haml (13.5ms)
Completed 200 OK in 859ms (Views: 827.9ms | ActiveRecord: 8.0ms)


Started PATCH "/products/1" for 127.0.0.1 at 2017-04-27 03:55:18 +0300
Processing by ProductsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"ys0owqQ0LuNKshEWGFyy1ekPeFKmWl24s6zhUYxUsU9GfCtL/uwkgm9ijeZl3rKVkpKqsYQhrdIJg96On0gTXg==", "commit"=>"Сохранить", "product"=>{"name"=>"Простой продукт 1 этап", "description"=>"", "hint"=>"", "unit_id"=>"1", "category_id"=>"9", "stage"=>"1", "profit"=>"100.0", "display_components"=>"0", "custom"=>"0"}, "product_compositions"=>"[{\"id\":1,\"name\":\"Примитив 1\",\"unit\":\"лист\",\"quantity\":10},{\"id\":6,\"name\":\"Примитив 6\",\"unit\":\"лист\",\"quantity\":5}]", "product_templates"=>"[]", "product_sets"=>"[]", "autocomplete_composition_id"=>"", "search"=>"", "template_name"=>"", "set_name"=>"", "id"=>"1"}
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Unpermitted parameter: display_components
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mProductComposition Load (1.9ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1 AND ("product_compositions"."id" NOT IN (1, 6))[0m  [["product_id", 1]]
  [1m[35m (0.6ms)[0m  [1m[35mBEGIN[0m
  [1m[35mSQL (0.6ms)[0m  [1m[33mUPDATE "product_compositions" SET "deleted_at" = '2017-04-27 00:55:18.459515' WHERE "product_compositions"."id" = $1[0m  [["id", 4]]
  [1m[35m (3.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mProductComposition Load (0.6ms)[0m  [1m[34mSELECT  "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1 AND "product_compositions"."constructor_object_id" = $2 LIMIT $3[0m  [["product_id", 1], ["constructor_object_id", 1], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mConstructorObject Load (0.5ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mProductComposition Load (2.6ms)[0m  [1m[34mSELECT  "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1 AND "product_compositions"."constructor_object_id" = $2 LIMIT $3[0m  [["product_id", 1], ["constructor_object_id", 6], ["LIMIT", 1]]
  [1m[35m (2.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mConstructorObject Load (0.9ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[35mSQL (2.4ms)[0m  [1m[32mINSERT INTO "product_compositions" ("product_id", "constructor_object_id", "value") VALUES ($1, $2, $3) RETURNING "id"[0m  [["product_id", 1], ["constructor_object_id", 6], ["value", 5]]
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
Redirected to http://localhost:3000/products
Completed 302 Found in 63ms (ActiveRecord: 20.7ms)


Started GET "/products" for 127.0.0.1 at 2017-04-27 03:55:18 +0300
Processing by ProductsController#index as HTML
  [1m[36mUser Load (2.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering products/index.html.haml within layouts/application
  [1m[36mCategory Load (0.7ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."product" = $1[0m  [["product", true]]
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL[0m
  [1m[36mCategory Load (0.7ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" IN (9, 12, 10)[0m
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (1, 3, 5)[0m
  [1m[36mCategory Load (2.8ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL[0m
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 1[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 2[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 3[0m
  [1m[35m (1.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 4[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 5[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 6[0m
  [1m[35m (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 7[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 8[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 9[0m
  [1m[36mProduct Load (3.5ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 9[0m
  [1m[36mCategory Load (1.0ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" = 9[0m
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  Rendered products/_listing.html.haml (4.3ms)
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 10[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 10[0m
  [1m[36mCategory Load (0.7ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" = 10[0m
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  Rendered products/_listing.html.haml (0.9ms)
  [1m[35m (4.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 11[0m
  [1m[35m (1.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 12[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 12[0m
  [1m[36mCategory Load (0.7ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" = 12[0m
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  Rendered products/_listing.html.haml (0.9ms)
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 13[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 14[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 15[0m
  Rendered products/index.html.haml within layouts/application (133.6ms)
  Rendered layouts/_header.html.haml (10.1ms)
Completed 200 OK in 731ms (Views: 693.6ms | ActiveRecord: 32.2ms)


Started GET "/estimates/new" for 127.0.0.1 at 2017-04-27 03:56:11 +0300
Processing by EstimatesController#new as HTML
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (1.3ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (0.9ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.1ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
Started GET "/estimates/new" for 127.0.0.1 at 2017-04-27 03:57:55 +0300
Completed 500 Internal Server Error in 104051ms (ActiveRecord: 23.4ms)


  
SystemExit (exit):
  
app/models/product.rb:142:in `block in price_without_work'
app/models/product.rb:139:in `price_without_work'
app/models/product.rb:31:in `block in map_for_estimate'
app/models/product.rb:22:in `map_for_estimate'
app/controllers/estimates_controller.rb:137:in `get_products'
DEPRECATION WARNING: to_cleanup is deprecated and will be removed from Rails 5.1 (use ActiveSupport::Reloader.to_complete instead) (called from <top (required)> at /home/g1nc/Development/ruby/constructor/config/environment.rb:5)
Started GET "/estimates/new" for 127.0.0.1 at 2017-04-27 03:58:07 +0300
  [1m[36mActiveRecord::SchemaMigration Load (0.8ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
Processing by EstimatesController#new as HTML
  [1m[36mProduct Load (1.2ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (1.1ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (1.4ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mProduct Load (1.3ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (1.1ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (2.4ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.9ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (1.9ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (2.9ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (2.6ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  [1m[36mProductTemplateSet Load (0.9ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (2.1ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (1.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.9ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering estimates/new.html.haml within layouts/application
  [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (1918.3ms)
  Rendered estimates/_technical_file_fields.html.haml (5.5ms)
  Rendered estimates/_discount.html.haml (8.7ms)
  Rendered estimates/_stages.html.haml (18.4ms)
  Rendered estimates/_form.html.haml (2076.4ms)
  Rendered estimates/new.html.haml within layouts/application (2094.4ms)
  Rendered layouts/_header.html.haml (25.3ms)
Completed 200 OK in 3175ms (Views: 2703.0ms | ActiveRecord: 90.9ms)


Started GET "/estimates/new" for 127.0.0.1 at 2017-04-27 04:06:54 +0300
Processing by EstimatesController#new as HTML
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (2.1ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (1.6ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (1.3ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mProduct Load (4.1ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (1.1ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.7ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (1.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (1.0ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.6ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (1.1ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  [1m[36mProductTemplateSet Load (1.0ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.5ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUnit Load (1.1ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.8ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering estimates/new.html.haml within layouts/application
  [1m[36mClient Load (0.6ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (4.1ms)
  Rendered estimates/_technical_file_fields.html.haml (3.5ms)
  Rendered estimates/_discount.html.haml (12.5ms)
  Rendered estimates/_stages.html.haml (24.0ms)
  Rendered estimates/_form.html.haml (115.8ms)
  Rendered estimates/new.html.haml within layouts/application (119.2ms)
Completed 500 Internal Server Error in 1203ms (ActiveRecord: 25.8ms)


  
ActionView::Template::Error (SyntaxError: [stdin]:126:57: unexpected :):
     5:     %title Конструктор сметы - Арт СИП Строй
     6:     = csrf_meta_tags
     7:     = stylesheet_link_tag    'application', media: 'all', 'data-turbolinks-track': 'reload'
     8:     = javascript_include_tag 'application', 'data-turbolinks-track': 'reload'
     9: 
    10:   %body
    11:     = render 'layouts/header'
  
app/views/layouts/application.html.haml:8:in `_app_views_layouts_application_html_haml__1006556645182813273_69964319661260'
app/controllers/application_controller.rb:8:in `render'
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/template_error.html.erb within rescues/layout
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_source.html.erb
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_source.html.erb (9.7ms)
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (3.1ms)
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_request_and_response.html.erb
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_request_and_response.html.erb (1.2ms)
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/template_error.html.erb within rescues/layout (40.3ms)
Started GET "/estimates/new" for 127.0.0.1 at 2017-04-27 04:07:51 +0300
Processing by EstimatesController#new as HTML
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (1.2ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.7ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (0.9ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.6ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (1.0ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mConstructorObject Load (1.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mUnit Load (1.2ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  [1m[36mProductTemplateSet Load (0.9ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.8ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (3.2ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.6ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering estimates/new.html.haml within layouts/application
  [1m[36mClient Load (0.6ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (4.3ms)
  Rendered estimates/_technical_file_fields.html.haml (4.2ms)
  Rendered estimates/_discount.html.haml (6.9ms)
  Rendered estimates/_stages.html.haml (16.4ms)
  Rendered estimates/_form.html.haml (103.4ms)
  Rendered estimates/new.html.haml within layouts/application (106.4ms)
  Rendered layouts/_header.html.haml (18.6ms)
Completed 200 OK in 1637ms (Views: 1530.1ms | ActiveRecord: 22.5ms)


Started GET "/estimates/new" for 127.0.0.1 at 2017-04-27 04:08:35 +0300
Processing by EstimatesController#new as HTML
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (0.9ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (0.8ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.6ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.5ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (1.5ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.9ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.8ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  [1m[36mProductTemplateSet Load (0.7ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.5ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (2.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.5ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering estimates/new.html.haml within layouts/application
  [1m[36mClient Load (0.5ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (3.2ms)
  Rendered estimates/_technical_file_fields.html.haml (3.3ms)
  Rendered estimates/_discount.html.haml (6.8ms)
  Rendered estimates/_stages.html.haml (16.1ms)
  Rendered estimates/_form.html.haml (96.8ms)
  Rendered estimates/new.html.haml within layouts/application (100.0ms)
  Rendered layouts/_header.html.haml (41.2ms)
Completed 200 OK in 1696ms (Views: 1570.5ms | ActiveRecord: 18.9ms)


Started GET "/estimates/new" for 127.0.0.1 at 2017-04-27 04:09:34 +0300
Processing by EstimatesController#new as HTML
  [1m[36mProduct Load (3.2ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (4.4ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.9ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mProduct Load (1.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (1.8ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.7ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (2.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (1.5ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (2.4ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (1.0ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.7ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (1.5ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mConstructorObject Load (1.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  [1m[36mProductTemplateSet Load (0.7ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUnit Load (1.5ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (1.7ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering estimates/new.html.haml within layouts/application
  [1m[36mClient Load (0.8ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (4.4ms)
  Rendered estimates/_technical_file_fields.html.haml (3.2ms)
  Rendered estimates/_discount.html.haml (9.6ms)
  Rendered estimates/_stages.html.haml (20.6ms)
  Rendered estimates/_form.html.haml (90.2ms)
  Rendered estimates/new.html.haml within layouts/application (94.6ms)
  Rendered layouts/_header.html.haml (10.0ms)
Completed 200 OK in 1921ms (Views: 1808.4ms | ActiveRecord: 33.2ms)


Started GET "/estimates/new" for 127.0.0.1 at 2017-04-27 04:09:55 +0300
Processing by EstimatesController#new as HTML
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (0.7ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.9ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.7ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (2.8ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (0.9ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.7ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  [1m[36mProductTemplateSet Load (2.4ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (3.3ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (2.6ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.5ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering estimates/new.html.haml within layouts/application
  [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (4.5ms)
  Rendered estimates/_technical_file_fields.html.haml (3.5ms)
  Rendered estimates/_discount.html.haml (6.7ms)
  Rendered estimates/_stages.html.haml (16.5ms)
  Rendered estimates/_form.html.haml (79.5ms)
  Rendered estimates/new.html.haml within layouts/application (82.5ms)
  Rendered layouts/_header.html.haml (12.9ms)
Completed 200 OK in 1661ms (Views: 1559.1ms | ActiveRecord: 25.9ms)


Started GET "/estimates/new" for 127.0.0.1 at 2017-04-27 04:10:30 +0300
Processing by EstimatesController#new as HTML
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (0.6ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.9ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (1.2ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (0.9ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (1.1ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (1.0ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  [1m[36mProductTemplateSet Load (3.7ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.5ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.5ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.5ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.5ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUnit Load (0.5ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.5ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering estimates/new.html.haml within layouts/application
  [1m[36mClient Load (0.5ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (8.3ms)
  Rendered estimates/_technical_file_fields.html.haml (6.8ms)
  Rendered estimates/_discount.html.haml (7.3ms)
  Rendered estimates/_stages.html.haml (43.3ms)
  Rendered estimates/_form.html.haml (170.4ms)
  Rendered estimates/new.html.haml within layouts/application (173.4ms)
  Rendered layouts/_header.html.haml (28.3ms)
Completed 200 OK in 1348ms (Views: 926.1ms | ActiveRecord: 87.9ms)


Started GET "/estimates/new" for 127.0.0.1 at 2017-04-27 04:10:43 +0300
Processing by EstimatesController#new as HTML
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (0.9ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (1.4ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mProduct Load (4.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.8ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (2.6ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.7ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mConstructorObject Load (2.8ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  [1m[36mProductTemplateSet Load (0.7ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (1.2ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (1.3ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.5ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering estimates/new.html.haml within layouts/application
  [1m[36mClient Load (0.6ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (3.5ms)
  Rendered estimates/_technical_file_fields.html.haml (3.6ms)
  Rendered estimates/_discount.html.haml (8.9ms)
  Rendered estimates/_stages.html.haml (23.0ms)
  Rendered estimates/_form.html.haml (89.3ms)
  Rendered estimates/new.html.haml within layouts/application (96.2ms)
  Rendered layouts/_header.html.haml (9.9ms)
Completed 200 OK in 816ms (Views: 704.5ms | ActiveRecord: 27.6ms)


Started GET "/estimates/new" for 127.0.0.1 at 2017-04-27 04:10:59 +0300
Processing by EstimatesController#new as HTML
  [1m[36mProduct Load (1.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (1.2ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (3.1ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.5ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.6ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (0.9ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.7ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  [1m[36mProductTemplateSet Load (0.9ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (2.4ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.8ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUnit Load (2.2ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.5ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering estimates/new.html.haml within layouts/application
  [1m[36mClient Load (2.6ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (3.6ms)
  Rendered estimates/_technical_file_fields.html.haml (3.8ms)
  Rendered estimates/_discount.html.haml (6.7ms)
  Rendered estimates/_stages.html.haml (25.3ms)
  Rendered estimates/_form.html.haml (89.8ms)
  Rendered estimates/new.html.haml within layouts/application (93.6ms)
  Rendered layouts/_header.html.haml (17.9ms)
Completed 200 OK in 787ms (Views: 684.7ms | ActiveRecord: 26.1ms)


Started GET "/estimates/new" for 127.0.0.1 at 2017-04-27 04:11:25 +0300
Processing by EstimatesController#new as HTML
  [1m[36mProduct Load (1.9ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (1.3ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (0.6ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (2.2ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (2.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (2.9ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (1.0ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.8ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mConstructorObject Load (0.9ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mUnit Load (4.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  [1m[36mProductTemplateSet Load (0.7ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.8ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (1.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.5ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering estimates/new.html.haml within layouts/application
  [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (3.1ms)
  Rendered estimates/_technical_file_fields.html.haml (4.0ms)
  Rendered estimates/_discount.html.haml (6.4ms)
  Rendered estimates/_stages.html.haml (15.3ms)
  Rendered estimates/_form.html.haml (76.9ms)
  Rendered estimates/new.html.haml within layouts/application (82.8ms)
  Rendered layouts/_header.html.haml (18.6ms)
Completed 200 OK in 1644ms (Views: 1539.0ms | ActiveRecord: 29.6ms)


Started GET "/estimates/new" for 127.0.0.1 at 2017-04-27 04:12:49 +0300
Processing by EstimatesController#new as HTML
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (0.8ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (1.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.7ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (1.8ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (1.4ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (2.4ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (1.0ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (1.1ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mConstructorObject Load (1.1ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mUnit Load (1.2ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  [1m[36mProductTemplateSet Load (4.2ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.8ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (5.8ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (3.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.5ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering estimates/new.html.haml within layouts/application
  [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (4.5ms)
  Rendered estimates/_technical_file_fields.html.haml (4.5ms)
  Rendered estimates/_discount.html.haml (9.1ms)
  Rendered estimates/_stages.html.haml (21.7ms)
  Rendered estimates/_form.html.haml (115.5ms)
  Rendered estimates/new.html.haml within layouts/application (121.9ms)
  Rendered layouts/_header.html.haml (8.0ms)
Completed 200 OK in 1991ms (Views: 1851.1ms | ActiveRecord: 34.9ms)


Started GET "/estimates/new" for 127.0.0.1 at 2017-04-27 04:13:39 +0300
Processing by EstimatesController#new as HTML
  [1m[36mProduct Load (1.2ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (1.1ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (1.3ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (1.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mProduct Load (1.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.9ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.9ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (4.9ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.6ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (1.1ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mUnit Load (0.9ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  [1m[36mProductTemplateSet Load (0.9ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.5ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (1.2ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.7ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering estimates/new.html.haml within layouts/application
  [1m[36mClient Load (0.9ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (4.5ms)
  Rendered estimates/_technical_file_fields.html.haml (5.5ms)
  Rendered estimates/_discount.html.haml (8.6ms)
  Rendered estimates/_stages.html.haml (17.5ms)
  Rendered estimates/_form.html.haml (82.8ms)
  Rendered estimates/new.html.haml within layouts/application (87.0ms)
  Rendered layouts/_header.html.haml (10.5ms)
Completed 200 OK in 1714ms (Views: 1596.8ms | ActiveRecord: 26.8ms)


Started GET "/estimates/new" for 127.0.0.1 at 2017-04-27 04:14:16 +0300
Processing by EstimatesController#new as HTML
  [1m[36mProduct Load (1.1ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (0.8ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (1.2ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (1.8ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.9ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (2.5ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.9ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.8ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  [1m[36mProductTemplateSet Load (0.8ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (1.0ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.8ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (4.8ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.7ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering estimates/new.html.haml within layouts/application
  [1m[36mClient Load (1.0ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (3.2ms)
  Rendered estimates/_technical_file_fields.html.haml (3.3ms)
  Rendered estimates/_discount.html.haml (7.0ms)
  Rendered estimates/_stages.html.haml (16.1ms)
  Rendered estimates/_form.html.haml (78.9ms)
  Rendered estimates/new.html.haml within layouts/application (84.6ms)
  Rendered layouts/_header.html.haml (8.2ms)
Completed 200 OK in 642ms (Views: 545.1ms | ActiveRecord: 28.0ms)


Started GET "/estimates/new" for 127.0.0.1 at 2017-04-27 04:15:14 +0300
Processing by EstimatesController#new as HTML
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (0.6ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.6ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (0.8ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.5ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mUnit Load (0.9ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  [1m[36mProductTemplateSet Load (0.8ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (1.0ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.9ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.6ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering estimates/new.html.haml within layouts/application
  [1m[36mClient Load (0.6ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (3.0ms)
  Rendered estimates/_technical_file_fields.html.haml (3.1ms)
  Rendered estimates/_discount.html.haml (5.9ms)
  Rendered estimates/_stages.html.haml (16.4ms)
  Rendered estimates/_form.html.haml (65.9ms)
  Rendered estimates/new.html.haml within layouts/application (68.8ms)
  Rendered layouts/_header.html.haml (35.1ms)
Completed 200 OK in 780ms (Views: 695.6ms | ActiveRecord: 17.4ms)


Started GET "/estimates/new" for 127.0.0.1 at 2017-04-27 04:16:14 +0300
Processing by EstimatesController#new as HTML
  [1m[36mProduct Load (1.2ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (1.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (0.8ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (3.1ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mProduct Load (0.5ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.7ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (2.2ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (1.7ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.8ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.8ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mConstructorObject Load (4.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  [1m[36mProductTemplateSet Load (0.8ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (1.5ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.7ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering estimates/new.html.haml within layouts/application
  [1m[36mClient Load (1.0ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (4.9ms)
  Rendered estimates/_technical_file_fields.html.haml (4.5ms)
  Rendered estimates/_discount.html.haml (8.9ms)
  Rendered estimates/_stages.html.haml (26.2ms)
  Rendered estimates/_form.html.haml (99.1ms)
  Rendered estimates/new.html.haml within layouts/application (103.7ms)
  Rendered layouts/_header.html.haml (7.6ms)
Completed 200 OK in 1867ms (Views: 1750.1ms | ActiveRecord: 29.4ms)


Started GET "/estimates/new" for 127.0.0.1 at 2017-04-27 04:16:42 +0300
Processing by EstimatesController#new as HTML
  [1m[36mProduct Load (1.5ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (1.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (1.1ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (1.3ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mProduct Load (3.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.9ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (1.6ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (2.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (2.3ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.6ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.9ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  [1m[36mProductTemplateSet Load (0.8ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.8ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (1.3ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (1.1ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.8ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUnit Load (2.3ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.8ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering estimates/new.html.haml within layouts/application
  [1m[36mClient Load (0.9ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (4.0ms)
  Rendered estimates/_technical_file_fields.html.haml (2.7ms)
  Rendered estimates/_discount.html.haml (5.6ms)
  Rendered estimates/_stages.html.haml (14.0ms)
  Rendered estimates/_form.html.haml (66.1ms)
  Rendered estimates/new.html.haml within layouts/application (73.7ms)
  Rendered layouts/_header.html.haml (8.1ms)
Completed 200 OK in 1589ms (Views: 1490.2ms | ActiveRecord: 31.6ms)


Started GET "/products" for 127.0.0.1 at 2017-04-27 04:17:35 +0300
Processing by ProductsController#index as HTML
  [1m[36mUser Load (3.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering products/index.html.haml within layouts/application
  [1m[36mCategory Load (0.9ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."product" = $1[0m  [["product", true]]
  [1m[36mProduct Load (2.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL[0m
  [1m[36mCategory Load (2.5ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" IN (9, 12, 10)[0m
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (1, 3, 5)[0m
  [1m[36mCategory Load (1.0ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL[0m
  [1m[35m (1.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 1[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 2[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 3[0m
  [1m[35m (1.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 4[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 5[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 6[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 7[0m
  [1m[35m (3.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 8[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 9[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 9[0m
  [1m[36mCategory Load (0.6ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" = 9[0m
  [1m[36mUnit Load (0.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  Rendered products/_listing.html.haml (3.4ms)
  [1m[35m (2.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 10[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 10[0m
  [1m[36mCategory Load (0.6ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" = 10[0m
  [1m[36mUnit Load (0.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  Rendered products/_listing.html.haml (0.6ms)
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 11[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 12[0m
  [1m[36mProduct Load (1.3ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 12[0m
  [1m[36mCategory Load (0.5ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" = 12[0m
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  Rendered products/_listing.html.haml (0.6ms)
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 13[0m
  [1m[35m (1.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 14[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 15[0m
  Rendered products/index.html.haml within layouts/application (95.7ms)
  Rendered layouts/_header.html.haml (20.6ms)
Completed 200 OK in 726ms (Views: 677.4ms | ActiveRecord: 41.9ms)


Started GET "/products/3/edit" for 127.0.0.1 at 2017-04-27 04:17:43 +0300
Processing by ProductsController#edit as HTML
  Parameters: {"id"=>"3"}
  [1m[36mProduct Load (1.0ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Load (4.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.9ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" INNER JOIN "product_template_sets" ON "product_templates"."id" = "product_template_sets"."product_template_id" WHERE "product_templates"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductSet Load (0.8ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.6ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  [1m[36mProductTemplateSet Load (0.9ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (1.0ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering products/edit.html.haml within layouts/application
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL[0m
  [1m[36mCategory Load (2.9ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."product" = $1[0m  [["product", true]]
  Rendered products/_custom_product_false.haml (4.6ms)
  Rendered products/_custom_product_templates.haml (15.0ms)
  Rendered products/_custom_product_sets.haml (12.4ms)
  Rendered products/_custom_product_true.haml (32.8ms)
  Rendered products/_form.html.haml (91.8ms)
  Rendered products/edit.html.haml within layouts/application (100.7ms)
  Rendered layouts/_header.html.haml (11.5ms)
Completed 200 OK in 764ms (Views: 675.5ms | ActiveRecord: 19.4ms)


Started GET "/constructor_objects/autocomplete_constructor_object_name?term=%D0%9F%D1%80%D0%B8%D0%BC%D0%B8%D1%82%D0%B8%D0%B2+6" for 127.0.0.1 at 2017-04-27 04:17:50 +0300
Processing by ConstructorObjectsController#autocomplete_constructor_object_name as JSON
  Parameters: {"term"=>"Примитив 6"}
  [1m[36mConstructorObject Load (2.9ms)[0m  [1m[34mSELECT  constructor_objects.id, constructor_objects.name FROM "constructor_objects" WHERE (LOWER(constructor_objects.name) ILIKE 'примитив 6%') ORDER BY constructor_objects.name ASC LIMIT $1[0m  [["LIMIT", 10]]
Completed 200 OK in 6ms (Views: 0.3ms | ActiveRecord: 2.9ms)


Started PATCH "/products/3" for 127.0.0.1 at 2017-04-27 04:17:53 +0300
Processing by ProductsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"PAaB4fzO/WKS8h/KOaxePqgv2EXIJ6pBZwzgxgtsTPywt4Jophb3A7cigzpELl5+07IKpupcWivdI98ZGHDu7Q==", "commit"=>"Сохранить", "product"=>{"name"=>"Конфигурируемый продукт 3 этап", "description"=>"", "hint"=>"", "unit_id"=>"5", "category_id"=>"10", "stage"=>"3", "profit"=>"150.0", "display_components"=>"0", "custom"=>"1"}, "product_compositions"=>"[]", "product_templates"=>"[{\"id\":1,\"name\":\"Составляющая 1\"},{\"id\":2,\"name\":\"Составляющая 2\"}]", "product_sets"=>"[{\"id\":1,\"name\":\"Сборка 1\",\"items\":[{\"id\":1,\"name\":\"Составляющая 1\",\"value\":{\"id\":1,\"name\":\"Примитив 1\",\"unit\":\"лист\",\"price\":\"10.0\"},\"$$hashKey\":\"object:40\"},{\"id\":2,\"name\":\"Составляющая 2\",\"value\":{\"id\":2,\"name\":\"Примитив 6\",\"unit\":\"шт\",\"price\":\"20.0\"},\"$$hashKey\":\"object:41\"}],\"$$hashKey\":\"object:34\"}]", "autocomplete_composition_id"=>"", "search"=>"Примитив 6", "template_name"=>"Составляющая 2", "set_name"=>"Сборка 1", "search_id"=>"6", "id"=>"3"}
  [1m[36mProduct Load (2.2ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Load (2.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Unpermitted parameter: display_components
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mProductSet Load (0.6ms)[0m  [1m[34mSELECT  "product_sets".* FROM "product_sets" WHERE "product_sets"."deleted_at" IS NULL AND "product_sets"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mProductTemplateSet Load (1.4ms)[0m  [1m[34mSELECT  "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1 AND "product_template_sets"."product_template_id" = 1 AND "product_template_sets"."product_set_id" = 1 LIMIT $2[0m  [["product_id", 3], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (1.0ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mProductTemplate Load (0.8ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mProductTemplateSet Load (0.7ms)[0m  [1m[34mSELECT  "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1 AND "product_template_sets"."product_template_id" = 2 AND "product_template_sets"."product_set_id" = 1 LIMIT $2[0m  [["product_id", 3], ["LIMIT", 1]]
  [1m[35m (0.8ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mProductTemplateSet Load (0.7ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1 AND ("product_template_sets"."id" NOT IN (1, 2))[0m  [["product_id", 3]]
Redirected to http://localhost:3000/products
Completed 302 Found in 53ms (ActiveRecord: 15.5ms)


Started GET "/products" for 127.0.0.1 at 2017-04-27 04:17:53 +0300
Processing by ProductsController#index as HTML
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering products/index.html.haml within layouts/application
  [1m[36mCategory Load (2.6ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."product" = $1[0m  [["product", true]]
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL[0m
  [1m[36mCategory Load (0.7ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" IN (9, 12, 10)[0m
  [1m[36mUnit Load (2.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (1, 3, 5)[0m
  [1m[36mCategory Load (0.7ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL[0m
  [1m[35m (1.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 1[0m
  [1m[35m (1.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 2[0m
  [1m[35m (1.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 3[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 4[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 5[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 6[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 7[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 8[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 9[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 9[0m
  [1m[36mCategory Load (0.6ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" = 9[0m
  [1m[36mUnit Load (0.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  Rendered products/_listing.html.haml (3.1ms)
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 10[0m
  [1m[36mProduct Load (0.5ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 10[0m
  [1m[36mCategory Load (0.5ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" = 10[0m
  [1m[36mUnit Load (0.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  Rendered products/_listing.html.haml (0.8ms)
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 11[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 12[0m
  [1m[36mProduct Load (0.5ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 12[0m
  [1m[36mCategory Load (0.5ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" = 12[0m
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  Rendered products/_listing.html.haml (0.8ms)
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 13[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 14[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 15[0m
  Rendered products/index.html.haml within layouts/application (70.2ms)
  Rendered layouts/_header.html.haml (8.8ms)
Completed 200 OK in 704ms (Views: 675.3ms | ActiveRecord: 22.9ms)


Started GET "/products/3/edit" for 127.0.0.1 at 2017-04-27 04:17:59 +0300
Processing by ProductsController#edit as HTML
  Parameters: {"id"=>"3"}
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.8ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" INNER JOIN "product_template_sets" ON "product_templates"."id" = "product_template_sets"."product_template_id" WHERE "product_templates"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductSet Load (0.8ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.6ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  [1m[36mProductTemplateSet Load (0.7ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering products/edit.html.haml within layouts/application
  [1m[36mUnit Load (0.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL[0m
  [1m[36mCategory Load (1.2ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."product" = $1[0m  [["product", true]]
  Rendered products/_custom_product_false.haml (3.4ms)
  Rendered products/_custom_product_templates.haml (6.7ms)
  Rendered products/_custom_product_sets.haml (9.5ms)
  Rendered products/_custom_product_true.haml (19.8ms)
  Rendered products/_form.html.haml (59.3ms)
  Rendered products/edit.html.haml within layouts/application (62.3ms)
  Rendered layouts/_header.html.haml (7.6ms)
Completed 200 OK in 697ms (Views: 624.4ms | ActiveRecord: 11.4ms)


Started GET "/constructor_objects/autocomplete_constructor_object_name?term=%D0%9F%D1%80%D0%B8%D0%BC%D0%B8%D1%82%D0%B8%D0%B2+6" for 127.0.0.1 at 2017-04-27 04:18:06 +0300
Processing by ConstructorObjectsController#autocomplete_constructor_object_name as JSON
  Parameters: {"term"=>"Примитив 6"}
  [1m[36mConstructorObject Load (2.5ms)[0m  [1m[34mSELECT  constructor_objects.id, constructor_objects.name FROM "constructor_objects" WHERE (LOWER(constructor_objects.name) ILIKE 'примитив 6%') ORDER BY constructor_objects.name ASC LIMIT $1[0m  [["LIMIT", 10]]
Completed 200 OK in 7ms (Views: 0.3ms | ActiveRecord: 2.5ms)


Started GET "/constructor_objects/autocomplete_constructor_object_name?term=%D0%9F%D1%80%D0%B8" for 127.0.0.1 at 2017-04-27 04:18:24 +0300
Processing by ConstructorObjectsController#autocomplete_constructor_object_name as JSON
  Parameters: {"term"=>"При"}
  [1m[36mConstructorObject Load (1.7ms)[0m  [1m[34mSELECT  constructor_objects.id, constructor_objects.name FROM "constructor_objects" WHERE (LOWER(constructor_objects.name) ILIKE 'при%') ORDER BY constructor_objects.name ASC LIMIT $1[0m  [["LIMIT", 10]]
Completed 200 OK in 5ms (Views: 0.5ms | ActiveRecord: 1.7ms)


Started GET "/constructor_objects/autocomplete_constructor_object_name?term=%D0%9F%D1%80%D0%B8%D0%BC%D0%B8%D1%82%D0%B8" for 127.0.0.1 at 2017-04-27 04:18:25 +0300
Processing by ConstructorObjectsController#autocomplete_constructor_object_name as JSON
  Parameters: {"term"=>"Примити"}
  [1m[36mConstructorObject Load (1.1ms)[0m  [1m[34mSELECT  constructor_objects.id, constructor_objects.name FROM "constructor_objects" WHERE (LOWER(constructor_objects.name) ILIKE 'примити%') ORDER BY constructor_objects.name ASC LIMIT $1[0m  [["LIMIT", 10]]
Completed 200 OK in 8ms (Views: 0.6ms | ActiveRecord: 1.1ms)


Started GET "/constructor_objects/autocomplete_constructor_object_name?term=%D0%9F%D1%80%D0%B8%D0%BC%D0%B8%D1%82%D0%B8%D0%B2" for 127.0.0.1 at 2017-04-27 04:18:25 +0300
Processing by ConstructorObjectsController#autocomplete_constructor_object_name as JSON
  Parameters: {"term"=>"Примитив"}
  [1m[36mConstructorObject Load (1.3ms)[0m  [1m[34mSELECT  constructor_objects.id, constructor_objects.name FROM "constructor_objects" WHERE (LOWER(constructor_objects.name) ILIKE 'примитив%') ORDER BY constructor_objects.name ASC LIMIT $1[0m  [["LIMIT", 10]]
Completed 200 OK in 4ms (Views: 0.6ms | ActiveRecord: 1.3ms)


Started GET "/constructor_objects/autocomplete_constructor_object_name?term=%D0%9F%D1%80%D0%B8%D0%BC%D0%B8%D1%82%D0%B8%D0%B2" for 127.0.0.1 at 2017-04-27 04:18:28 +0300
Processing by ConstructorObjectsController#autocomplete_constructor_object_name as JSON
  Parameters: {"term"=>"Примитив"}
  [1m[36mConstructorObject Load (1.0ms)[0m  [1m[34mSELECT  constructor_objects.id, constructor_objects.name FROM "constructor_objects" WHERE (LOWER(constructor_objects.name) ILIKE 'примитив%') ORDER BY constructor_objects.name ASC LIMIT $1[0m  [["LIMIT", 10]]
Completed 200 OK in 3ms (Views: 0.4ms | ActiveRecord: 1.0ms)


Started PATCH "/products/3" for 127.0.0.1 at 2017-04-27 04:18:49 +0300
Processing by ProductsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"nLWYshsvQJmGetD1mCwHm7YDrkpFpfvWKTwm5WcSUbUQBJs7QfdK+KOqTAXlrgfbzZ58qWfeC7yTExk6dA7zpA==", "commit"=>"Сохранить", "product"=>{"name"=>"Конфигурируемый продукт 3 этап", "description"=>"", "hint"=>"", "unit_id"=>"5", "category_id"=>"10", "stage"=>"3", "profit"=>"150.0", "display_components"=>"0", "custom"=>"1"}, "product_compositions"=>"[]", "product_templates"=>"[{\"id\":1,\"name\":\"Составляющая 1\"},{\"id\":2,\"name\":\"Составляющая 2\"}]", "product_sets"=>"[{\"id\":1493255912976,\"name\":\"Сборка 1\",\"items\":[{\"id\":1,\"name\":\"Составляющая 1\",\"value\":{\"name\":\"Примитив 1\",\"id\":\"1\"}},{\"id\":2,\"name\":\"Составляющая 2\",\"value\":{\"name\":\"Примитив 6\",\"id\":\"6\"}}]}]", "autocomplete_composition_id"=>"", "search"=>"Примитив 6", "template_name"=>"Составляющая 2", "set_name"=>"Сборка 1", "search_id"=>"", "id"=>"3"}
  [1m[36mProduct Load (1.9ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Load (4.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Unpermitted parameter: display_components
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (3.9ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mProductSet Load (0.7ms)[0m  [1m[34mSELECT  "product_sets".* FROM "product_sets" WHERE "product_sets"."deleted_at" IS NULL AND "product_sets"."name" = $1 LIMIT $2[0m  [["name", "Сборка 1"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mProductTemplateSet Load (1.1ms)[0m  [1m[34mSELECT  "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1 AND "product_template_sets"."product_template_id" = 1 AND "product_template_sets"."product_set_id" = 1 LIMIT $2[0m  [["product_id", 3], ["LIMIT", 1]]
  [1m[35m (0.6ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mProductTemplateSet Load (0.7ms)[0m  [1m[34mSELECT  "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1 AND "product_template_sets"."product_template_id" = 2 AND "product_template_sets"."product_set_id" = 1 LIMIT $2[0m  [["product_id", 3], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[35mSQL (2.6ms)[0m  [1m[33mUPDATE "product_template_sets" SET "constructor_object_id" = $1 WHERE "product_template_sets"."id" = $2[0m  [["constructor_object_id", 6], ["id", 2]]
  [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mProductTemplateSet Load (1.4ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1 AND ("product_template_sets"."id" NOT IN (1, 2))[0m  [["product_id", 3]]
Redirected to http://localhost:3000/products
Completed 302 Found in 62ms (ActiveRecord: 23.1ms)


Started GET "/products" for 127.0.0.1 at 2017-04-27 04:18:49 +0300
Processing by ProductsController#index as HTML
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering products/index.html.haml within layouts/application
  [1m[36mCategory Load (1.0ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."product" = $1[0m  [["product", true]]
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL[0m
  [1m[36mCategory Load (0.6ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" IN (9, 12, 10)[0m
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (1, 3, 5)[0m
  [1m[36mCategory Load (1.5ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL[0m
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 1[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 2[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 3[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 4[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 5[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 6[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 7[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 8[0m
  [1m[35m (2.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 9[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 9[0m
  [1m[36mCategory Load (0.4ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" = 9[0m
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  Rendered products/_listing.html.haml (2.4ms)
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 10[0m
  [1m[36mProduct Load (1.2ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 10[0m
  [1m[36mCategory Load (0.9ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" = 10[0m
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  Rendered products/_listing.html.haml (0.7ms)
  [1m[35m (1.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 11[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 12[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 12[0m
  [1m[36mCategory Load (0.7ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" = 12[0m
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  Rendered products/_listing.html.haml (0.8ms)
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 13[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 14[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."category_id" = 15[0m
  Rendered products/index.html.haml within layouts/application (70.5ms)
  Rendered layouts/_header.html.haml (9.9ms)
Completed 200 OK in 598ms (Views: 570.4ms | ActiveRecord: 23.9ms)


Started GET "/products/3/edit" for 127.0.0.1 at 2017-04-27 04:18:55 +0300
Processing by ProductsController#edit as HTML
  Parameters: {"id"=>"3"}
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Load (1.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" INNER JOIN "product_template_sets" ON "product_templates"."id" = "product_template_sets"."product_template_id" WHERE "product_templates"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductSet Load (0.7ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.5ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.5ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mUnit Load (0.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  [1m[36mProductTemplateSet Load (0.6ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.5ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.5ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  Rendering products/edit.html.haml within layouts/application
  [1m[36mUnit Load (0.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL[0m
  [1m[36mCategory Load (0.9ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."product" = $1[0m  [["product", true]]
  Rendered products/_custom_product_false.haml (6.1ms)
  Rendered products/_custom_product_templates.haml (13.7ms)
  Rendered products/_custom_product_sets.haml (8.1ms)
  Rendered products/_custom_product_true.haml (29.5ms)
  Rendered products/_form.html.haml (71.5ms)
  Rendered products/edit.html.haml within layouts/application (74.2ms)
  Rendered layouts/_header.html.haml (8.2ms)
Completed 200 OK in 662ms (Views: 616.2ms | ActiveRecord: 10.5ms)


Started GET "/estimates/new" for 127.0.0.1 at 2017-04-27 04:19:02 +0300
Processing by EstimatesController#new as HTML
  [1m[36mProduct Load (2.4ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (1.8ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mProduct Load (5.4ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.6ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (1.3ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (0.8ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (8.0ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (1.2ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mUnit Load (2.1ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  [1m[36mProductTemplateSet Load (1.8ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (1.4ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (2.1ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (1.0ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (2.1ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.5ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering estimates/new.html.haml within layouts/application
  [1m[36mClient Load (0.6ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (4.1ms)
  Rendered estimates/_technical_file_fields.html.haml (4.0ms)
  Rendered estimates/_discount.html.haml (7.5ms)
  Rendered estimates/_stages.html.haml (24.2ms)
  Rendered estimates/_form.html.haml (92.7ms)
  Rendered estimates/new.html.haml within layouts/application (96.1ms)
  Rendered layouts/_header.html.haml (11.7ms)
Completed 200 OK in 675ms (Views: 569.1ms | ActiveRecord: 38.3ms)


Started GET "/estimates/new" for 127.0.0.1 at 2017-04-27 04:20:24 +0300
Processing by EstimatesController#new as HTML
  [1m[36mProduct Load (1.1ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (1.2ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (0.7ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.9ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.7ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (4.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (0.9ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (2.3ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  [1m[36mProductTemplateSet Load (0.7ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (1.0ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (5.3ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (4.1ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (2.0ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering estimates/new.html.haml within layouts/application
  [1m[36mClient Load (0.6ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (3.3ms)
  Rendered estimates/_technical_file_fields.html.haml (3.0ms)
  Rendered estimates/_discount.html.haml (6.5ms)
  Rendered estimates/_stages.html.haml (28.6ms)
  Rendered estimates/_form.html.haml (88.8ms)
  Rendered estimates/new.html.haml within layouts/application (91.9ms)
  Rendered layouts/_header.html.haml (8.3ms)
Completed 200 OK in 2400ms (Views: 2296.8ms | ActiveRecord: 32.6ms)


Started GET "/estimates/new" for 127.0.0.1 at 2017-04-27 04:20:49 +0300
Processing by EstimatesController#new as HTML
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (1.3ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (0.7ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (1.3ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (1.2ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.6ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (1.1ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.7ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  [1m[36mProductTemplateSet Load (0.7ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (1.1ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (4.0ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.6ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering estimates/new.html.haml within layouts/application
  [1m[36mClient Load (0.6ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (3.3ms)
  Rendered estimates/_technical_file_fields.html.haml (3.3ms)
  Rendered estimates/_discount.html.haml (5.8ms)
  Rendered estimates/_stages.html.haml (15.4ms)
  Rendered estimates/_form.html.haml (68.8ms)
  Rendered estimates/new.html.haml within layouts/application (72.2ms)
  Rendered layouts/_header.html.haml (8.1ms)
Completed 200 OK in 1545ms (Views: 1459.9ms | ActiveRecord: 21.5ms)


Started GET "/estimates/new" for 127.0.0.1 at 2017-04-27 04:21:25 +0300
Processing by EstimatesController#new as HTML
  [1m[36mProduct Load (4.9ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (0.6ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (4.8ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.5ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (1.8ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (1.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (1.1ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (2.9ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.8ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mUnit Load (3.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  [1m[36mProductTemplateSet Load (0.6ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (2.0ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.5ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mUser Load (1.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.5ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering estimates/new.html.haml within layouts/application
  [1m[36mClient Load (0.6ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (3.0ms)
  Rendered estimates/_technical_file_fields.html.haml (2.8ms)
  Rendered estimates/_discount.html.haml (5.7ms)
  Rendered estimates/_stages.html.haml (15.7ms)
  Rendered estimates/_form.html.haml (72.9ms)
  Rendered estimates/new.html.haml within layouts/application (78.5ms)
  Rendered layouts/_header.html.haml (10.4ms)
Completed 200 OK in 1654ms (Views: 1574.2ms | ActiveRecord: 32.4ms)


Started GET "/estimates/new" for 127.0.0.1 at 2017-04-27 04:23:40 +0300
Processing by EstimatesController#new as HTML
  [1m[36mProduct Load (1.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (0.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (1.2ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (1.8ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.6ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (1.5ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (1.9ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (1.0ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (1.0ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mUnit Load (4.3ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  [1m[36mProductTemplateSet Load (0.9ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.5ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (1.8ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (1.8ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mUser Load (1.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (1.9ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering estimates/new.html.haml within layouts/application
  [1m[36mClient Load (1.2ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (7.3ms)
  Rendered estimates/_technical_file_fields.html.haml (4.3ms)
  Rendered estimates/_discount.html.haml (5.5ms)
  Rendered estimates/_stages.html.haml (30.3ms)
  Rendered estimates/_form.html.haml (146.2ms)
  Rendered estimates/new.html.haml within layouts/application (149.6ms)
  Rendered layouts/_header.html.haml (29.6ms)
Completed 200 OK in 1096ms (Views: 806.4ms | ActiveRecord: 28.4ms)


Started GET "/estimates/new" for 127.0.0.1 at 2017-04-27 04:24:40 +0300
Processing by EstimatesController#new as HTML
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (1.3ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (1.2ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (1.1ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mProduct Load (2.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.6ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (1.2ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (1.1ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.6ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  [1m[36mProductTemplateSet Load (0.9ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.8ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (1.9ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.9ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (1.9ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (1.6ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering estimates/new.html.haml within layouts/application
  [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (5.4ms)
  Rendered estimates/_technical_file_fields.html.haml (3.3ms)
  Rendered estimates/_discount.html.haml (5.9ms)
  Rendered estimates/_stages.html.haml (15.2ms)
  Rendered estimates/_form.html.haml (77.5ms)
  Rendered estimates/new.html.haml within layouts/application (81.9ms)
  Rendered layouts/_header.html.haml (8.0ms)
Completed 200 OK in 668ms (Views: 576.6ms | ActiveRecord: 23.9ms)


Started GET "/estimates/new" for 127.0.0.1 at 2017-04-27 04:25:19 +0300
Processing by EstimatesController#new as HTML
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (3.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (0.6ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mProduct Load (2.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.9ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (0.9ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.6ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mUnit Load (1.4ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  [1m[36mProductTemplateSet Load (0.7ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (3.6ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (2.7ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering estimates/new.html.haml within layouts/application
  [1m[36mClient Load (1.7ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (5.3ms)
  Rendered estimates/_technical_file_fields.html.haml (4.3ms)
  Rendered estimates/_discount.html.haml (10.7ms)
  Rendered estimates/_stages.html.haml (25.1ms)
  Rendered estimates/_form.html.haml (93.5ms)
  Rendered estimates/new.html.haml within layouts/application (96.5ms)
  Rendered layouts/_header.html.haml (12.0ms)
Completed 200 OK in 707ms (Views: 618.3ms | ActiveRecord: 27.3ms)


Started GET "/estimates/new" for 127.0.0.1 at 2017-04-27 04:27:47 +0300
Processing by EstimatesController#new as HTML
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (1.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (1.8ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (1.3ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (1.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.5ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.9ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (1.0ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.7ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (1.3ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mUnit Load (3.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  [1m[36mProductTemplateSet Load (3.8ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.9ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.4ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering estimates/new.html.haml within layouts/application
  [1m[36mClient Load (0.6ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (8.2ms)
  Rendered estimates/_technical_file_fields.html.haml (5.6ms)
  Rendered estimates/_discount.html.haml (6.4ms)
  Rendered estimates/_stages.html.haml (25.4ms)
  Rendered estimates/_form.html.haml (123.4ms)
  Rendered estimates/new.html.haml within layouts/application (126.3ms)
  Rendered layouts/_header.html.haml (23.9ms)
Completed 200 OK in 1794ms (Views: 1518.2ms | ActiveRecord: 25.2ms)


Started GET "/estimates" for 127.0.0.1 at 2017-04-27 04:29:01 +0300
Processing by EstimatesController#index as HTML
  [1m[36mUser Load (5.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Redirected to http://localhost:3000/clients
Completed 302 Found in 9ms (ActiveRecord: 5.1ms)


Started GET "/clients" for 127.0.0.1 at 2017-04-27 04:29:01 +0300
Processing by ClientsController#index as HTML
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering clients/index.html.haml within layouts/application
  [1m[36mUserClient Load (2.0ms)[0m  [1m[34mSELECT "user_clients".* FROM "user_clients" INNER JOIN "clients" ON "clients"."id" = "user_clients"."client_id" AND "clients"."deleted_at" IS NULL WHERE "clients"."archived" = $1 AND (user_id = 1 and owner = true)[0m  [["archived", false]]
  [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" IN (1, 2, 3)[0m
  [1m[36mEstimate Load (3.0ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" IN (1, 2, 3)[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 1]]
  Rendered clients/_listing.html.haml (13.8ms)
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 2]]
  Rendered clients/_listing.html.haml (4.1ms)
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 3]]
  Rendered clients/_listing.html.haml (3.5ms)
  Rendered clients/_table.html.haml (26.3ms)
  [1m[36mUserClient Load (0.8ms)[0m  [1m[34mSELECT "user_clients".* FROM "user_clients" INNER JOIN "clients" ON "clients"."id" = "user_clients"."client_id" AND "clients"."deleted_at" IS NULL WHERE "clients"."archived" = $1 AND (user_id = 1 and owner = false)[0m  [["archived", false]]
  Rendered clients/index.html.haml within layouts/application (86.4ms)
  Rendered layouts/_header.html.haml (10.7ms)
Completed 200 OK in 726ms (Views: 695.3ms | ActiveRecord: 22.2ms)


Started GET "/clients/1/edit" for 127.0.0.1 at 2017-04-27 04:29:04 +0300
Processing by ClientsController#edit as HTML
  Parameters: {"id"=>"1"}
  [1m[36mClient Load (1.3ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (1.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUserClient Exists (1.2ms)[0m  [1m[34mSELECT  1 AS one FROM "user_clients" WHERE "user_clients"."user_id" = 1 AND "user_clients"."client_id" = 1 LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mUserClient Load (1.1ms)[0m  [1m[34mSELECT "user_clients".* FROM "user_clients" WHERE "user_clients"."client_id" = 1 AND ("user_clients"."user_id" != 1)[0m
  Rendering clients/edit.html.haml within layouts/application
  [1m[36mUserClient Load (0.7ms)[0m  [1m[34mSELECT  "user_clients".* FROM "user_clients" WHERE "user_clients"."user_id" = 1 AND "user_clients"."client_id" = 1 LIMIT $1[0m  [["LIMIT", 1]]
  Rendered clients/_form.html.haml (20.8ms)
  Rendered clients/edit.html.haml within layouts/application (24.7ms)
  Rendered layouts/_header.html.haml (43.1ms)
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE ("users"."id" != $1)[0m  [["id", 1]]
Completed 200 OK in 607ms (Views: 584.3ms | ActiveRecord: 6.3ms)


Started GET "/clients" for 127.0.0.1 at 2017-04-27 04:29:07 +0300
Processing by ClientsController#index as HTML
  [1m[36mUser Load (6.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering clients/index.html.haml within layouts/application
  [1m[36mUserClient Load (3.5ms)[0m  [1m[34mSELECT "user_clients".* FROM "user_clients" INNER JOIN "clients" ON "clients"."id" = "user_clients"."client_id" AND "clients"."deleted_at" IS NULL WHERE "clients"."archived" = $1 AND (user_id = 1 and owner = true)[0m  [["archived", false]]
  [1m[36mClient Load (2.1ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" IN (1, 2, 3)[0m
  [1m[36mEstimate Load (1.1ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" IN (1, 2, 3)[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 1]]
  Rendered clients/_listing.html.haml (7.0ms)
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 2]]
  Rendered clients/_listing.html.haml (5.4ms)
  [1m[35m (2.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 3]]
  Rendered clients/_listing.html.haml (8.6ms)
  Rendered clients/_table.html.haml (28.5ms)
  [1m[36mUserClient Load (0.8ms)[0m  [1m[34mSELECT "user_clients".* FROM "user_clients" INNER JOIN "clients" ON "clients"."id" = "user_clients"."client_id" AND "clients"."deleted_at" IS NULL WHERE "clients"."archived" = $1 AND (user_id = 1 and owner = false)[0m  [["archived", false]]
  Rendered clients/index.html.haml within layouts/application (54.2ms)
  Rendered layouts/_header.html.haml (11.1ms)
Completed 200 OK in 532ms (Views: 505.6ms | ActiveRecord: 17.8ms)


Started GET "/estimates?client_id=1" for 127.0.0.1 at 2017-04-27 04:29:08 +0300
Processing by EstimatesController#index as HTML
  Parameters: {"client_id"=>"1"}
  [1m[36mUser Load (2.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mClient Load (2.2ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (1.0ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = 1[0m
  Rendering estimates/index.html.haml within layouts/application
  Rendered estimates/_listing.html.haml (8.2ms)
  [1m[36mClient Load (1.2ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  Rendered estimates/index.html.haml within layouts/application (22.9ms)
  Rendered layouts/_header.html.haml (9.0ms)
Completed 200 OK in 582ms (Views: 566.4ms | ActiveRecord: 6.8ms)


Started GET "/estimates/2/edit" for 127.0.0.1 at 2017-04-27 04:29:11 +0300
Processing by EstimatesController#edit as HTML
  Parameters: {"id"=>"2"}
  [1m[36mProduct Load (1.4ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (4.3ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (0.6ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (1.8ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mProduct Load (1.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (1.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.7ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.9ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (1.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (0.8ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (1.6ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (1.2ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mUnit Load (1.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  [1m[36mProductTemplateSet Load (2.3ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (2.0ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (1.3ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (2.0ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mEstimate Load (1.9ms)[0m  [1m[34mSELECT  "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.5ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStage Load (0.8ms)[0m  [1m[34mSELECT "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mStageProduct Load (1.1ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" IN (4, 5, 6)[0m
  [1m[36mStageProduct Load (2.2ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 4]]
  [1m[36mStageProductSet Load (1.2ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 4[0m
  [1m[36mProduct Load (12.5ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 1[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mStageProduct Load (0.7ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 5]]
  [1m[36mStageProductSet Load (1.1ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 5[0m
  [1m[36mProduct Load (1.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 2[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mStageProduct Load (2.4ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 6]]
  [1m[36mStageProductSet Load (0.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 6[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 3[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mStageProductSet Load (0.7ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = $1[0m  [["stage_product_id", 6]]
  [1m[36mStageProductSetValue Load (1.1ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = 2[0m
  [1m[36mProductSet Load (0.5ms)[0m  [1m[34mSELECT  "product_sets".* FROM "product_sets" WHERE "product_sets"."deleted_at" IS NULL AND "product_sets"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStageProductSetValue Load (0.5ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1[0m  [["stage_product_set_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 2)[0m
  [1m[36mUnit Load (1.1ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 1)[0m
  Rendering estimates/edit.html.haml within layouts/application
  [1m[36mClient Load (0.9ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (8.0ms)
  [1m[36mClientFile Load (1.4ms)[0m  [1m[34mSELECT "client_files".* FROM "client_files" WHERE "client_files"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mAssetFile Load (0.5ms)[0m  [1m[34mSELECT  "asset_files".* FROM "asset_files" WHERE "asset_files"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendered estimates/_client_file_fields.html.haml (19.3ms)
  Rendered estimates/_technical_file_fields.html.haml (3.3ms)
  [1m[36mTechnicalFile Load (0.8ms)[0m  [1m[34mSELECT "technical_files".* FROM "technical_files" WHERE "technical_files"."estimate_id" = $1[0m  [["estimate_id", 2]]
  [1m[36mAssetFile Load (0.6ms)[0m  [1m[34mSELECT  "asset_files".* FROM "asset_files" WHERE "asset_files"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  Rendered estimates/_technical_file_fields.html.haml (6.4ms)
  Rendered estimates/_discount.html.haml (6.0ms)
  Rendered estimates/_stages.html.haml (30.6ms)
  Rendered estimates/_form.html.haml (135.7ms)
  Rendered estimates/edit.html.haml within layouts/application (139.9ms)
  Rendered layouts/_header.html.haml (10.7ms)
Completed 200 OK in 941ms (Views: 653.8ms | ActiveRecord: 89.7ms)


Started GET "/estimates" for 127.0.0.1 at 2017-04-27 04:29:28 +0300
Processing by EstimatesController#index as HTML
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Redirected to http://localhost:3000/clients
Completed 302 Found in 5ms (ActiveRecord: 1.0ms)


Started GET "/clients" for 127.0.0.1 at 2017-04-27 04:29:28 +0300
Processing by ClientsController#index as HTML
  [1m[36mUser Load (6.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering clients/index.html.haml within layouts/application
  [1m[36mUserClient Load (0.9ms)[0m  [1m[34mSELECT "user_clients".* FROM "user_clients" INNER JOIN "clients" ON "clients"."id" = "user_clients"."client_id" AND "clients"."deleted_at" IS NULL WHERE "clients"."archived" = $1 AND (user_id = 1 and owner = true)[0m  [["archived", false]]
  [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" IN (1, 2, 3)[0m
  [1m[36mEstimate Load (1.1ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" IN (1, 2, 3)[0m
  [1m[35m (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 1]]
  Rendered clients/_listing.html.haml (7.8ms)
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 2]]
  Rendered clients/_listing.html.haml (3.8ms)
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 3]]
  Rendered clients/_listing.html.haml (4.9ms)
  Rendered clients/_table.html.haml (25.8ms)
  [1m[36mUserClient Load (0.9ms)[0m  [1m[34mSELECT "user_clients".* FROM "user_clients" INNER JOIN "clients" ON "clients"."id" = "user_clients"."client_id" AND "clients"."deleted_at" IS NULL WHERE "clients"."archived" = $1 AND (user_id = 1 and owner = false)[0m  [["archived", false]]
  Rendered clients/index.html.haml within layouts/application (43.9ms)
  Rendered layouts/_header.html.haml (51.0ms)
Completed 200 OK in 648ms (Views: 630.5ms | ActiveRecord: 12.4ms)


Started GET "/clients/1/edit" for 127.0.0.1 at 2017-04-27 04:29:33 +0300
Processing by ClientsController#edit as HTML
  Parameters: {"id"=>"1"}
  [1m[36mClient Load (5.6ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (2.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUserClient Exists (1.0ms)[0m  [1m[34mSELECT  1 AS one FROM "user_clients" WHERE "user_clients"."user_id" = 1 AND "user_clients"."client_id" = 1 LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mUserClient Load (1.0ms)[0m  [1m[34mSELECT "user_clients".* FROM "user_clients" WHERE "user_clients"."client_id" = 1 AND ("user_clients"."user_id" != 1)[0m
  Rendering clients/edit.html.haml within layouts/application
  [1m[36mUserClient Load (4.7ms)[0m  [1m[34mSELECT  "user_clients".* FROM "user_clients" WHERE "user_clients"."user_id" = 1 AND "user_clients"."client_id" = 1 LIMIT $1[0m  [["LIMIT", 1]]
  Rendered clients/_form.html.haml (22.1ms)
  Rendered clients/edit.html.haml within layouts/application (27.0ms)
  Rendered layouts/_header.html.haml (9.4ms)
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE ("users"."id" != $1)[0m  [["id", 1]]
Completed 200 OK in 515ms (Views: 492.3ms | ActiveRecord: 15.3ms)


Started GET "/clients" for 127.0.0.1 at 2017-04-27 04:29:35 +0300
Processing by ClientsController#index as HTML
  [1m[36mUser Load (1.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering clients/index.html.haml within layouts/application
  [1m[36mUserClient Load (1.0ms)[0m  [1m[34mSELECT "user_clients".* FROM "user_clients" INNER JOIN "clients" ON "clients"."id" = "user_clients"."client_id" AND "clients"."deleted_at" IS NULL WHERE "clients"."archived" = $1 AND (user_id = 1 and owner = true)[0m  [["archived", false]]
  [1m[36mClient Load (4.6ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" IN (1, 2, 3)[0m
  [1m[36mEstimate Load (0.6ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" IN (1, 2, 3)[0m
  [1m[35m (1.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 1]]
  Rendered clients/_listing.html.haml (8.6ms)
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 2]]
  Rendered clients/_listing.html.haml (6.5ms)
  [1m[35m (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 3]]
  Rendered clients/_listing.html.haml (4.0ms)
  Rendered clients/_table.html.haml (23.3ms)
  [1m[36mUserClient Load (2.4ms)[0m  [1m[34mSELECT "user_clients".* FROM "user_clients" INNER JOIN "clients" ON "clients"."id" = "user_clients"."client_id" AND "clients"."deleted_at" IS NULL WHERE "clients"."archived" = $1 AND (user_id = 1 and owner = false)[0m  [["archived", false]]
  Rendered clients/index.html.haml within layouts/application (44.8ms)
  Rendered layouts/_header.html.haml (8.1ms)
Completed 200 OK in 609ms (Views: 588.3ms | ActiveRecord: 12.8ms)


Started GET "/estimates?client_id=1" for 127.0.0.1 at 2017-04-27 04:29:36 +0300
Processing by EstimatesController#index as HTML
  Parameters: {"client_id"=>"1"}
  [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mClient Load (3.7ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (1.1ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = 1[0m
  Rendering estimates/index.html.haml within layouts/application
  Rendered estimates/_listing.html.haml (4.3ms)
  [1m[36mClient Load (1.0ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  Rendered estimates/index.html.haml within layouts/application (24.0ms)
  Rendered layouts/_header.html.haml (11.2ms)
Completed 200 OK in 617ms (Views: 598.3ms | ActiveRecord: 6.9ms)


Started GET "/estimates/new?client_id=1" for 127.0.0.1 at 2017-04-27 04:29:42 +0300
Processing by EstimatesController#new as HTML
  Parameters: {"client_id"=>"1"}
  [1m[36mProduct Load (2.2ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (3.3ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (1.5ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (1.4ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mProduct Load (2.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (9.2ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (1.2ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (1.9ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (0.8ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.6ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (2.9ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  [1m[36mProductTemplateSet Load (2.5ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.8ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (1.0ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mUser Load (3.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mClient Load (0.6ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.5ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering estimates/new.html.haml within layouts/application
  [1m[36mClient Load (0.6ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (2.8ms)
  Rendered estimates/_technical_file_fields.html.haml (2.9ms)
  Rendered estimates/_discount.html.haml (8.0ms)
  Rendered estimates/_stages.html.haml (20.8ms)
  Rendered estimates/_form.html.haml (76.8ms)
  Rendered estimates/new.html.haml within layouts/application (80.1ms)
  Rendered layouts/_header.html.haml (8.4ms)
Completed 200 OK in 663ms (Views: 568.0ms | ActiveRecord: 40.0ms)


Started GET "/estimates?client_id=1" for 127.0.0.1 at 2017-04-27 04:35:37 +0300
Processing by EstimatesController#index as HTML
  Parameters: {"client_id"=>"1"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mClient Load (0.5ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 500 Internal Server Error in 40ms (ActiveRecord: 1.1ms)


  
SyntaxError (/home/g1nc/Development/ruby/constructor/app/models/estimate.rb:171: syntax error, unexpected tIDENTIFIER, expecting '}'
              work_primitive: item.constructor_object.work_primitive?
                            ^
/home/g1nc/Development/ruby/constructor/app/models/estimate.rb:172: syntax error, unexpected '}', expecting keyword_end
            },
             ^
/home/g1nc/Development/ruby/constructor/app/models/estimate.rb:226: syntax error, unexpected end-of-input, expecting '}'):
  
app/models/estimate.rb:171: syntax error, unexpected tIDENTIFIER, expecting '}'
app/models/estimate.rb:172: syntax error, unexpected '}', expecting keyword_end
app/models/estimate.rb:226: syntax error, unexpected end-of-input, expecting '}'
app/controllers/estimates_controller.rb:9:in `index'
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/diagnostics.html.erb within rescues/layout
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_source.html.erb
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_source.html.erb (11.9ms)
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (3.5ms)
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_request_and_response.html.erb
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_request_and_response.html.erb (1.2ms)
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/diagnostics.html.erb within rescues/layout (52.6ms)
Started GET "/estimates?client_id=1" for 127.0.0.1 at 2017-04-27 04:35:45 +0300
Processing by EstimatesController#index as HTML
  Parameters: {"client_id"=>"1"}
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (0.9ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = 1[0m
  Rendering estimates/index.html.haml within layouts/application
  Rendered estimates/_listing.html.haml (4.2ms)
  [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  Rendered estimates/index.html.haml within layouts/application (17.2ms)
  Rendered layouts/_header.html.haml (46.9ms)
Completed 200 OK in 1571ms (Views: 1497.8ms | ActiveRecord: 3.3ms)


Started DELETE "/estimates/2" for 127.0.0.1 at 2017-04-27 04:35:50 +0300
Processing by EstimatesController#destroy as HTML
  Parameters: {"authenticity_token"=>"isd3vdrCwh9cdxQ/iF67vBnDGEBukvmLpM/SEwlFnpEGdnQ0gBrIfnmniM/13Lv8Yl7Ko0zpCeEe4O3MGlk8gA==", "id"=>"2"}
  [1m[36mEstimate Load (0.9ms)[0m  [1m[34mSELECT  "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[36mAudited::Audit Load (2.3ms)[0m  [1m[34mSELECT  "audits".* FROM "audits" WHERE "audits"."auditable_id" = $1 AND "audits"."auditable_type" = $2 ORDER BY "audits"."version" DESC LIMIT $3[0m  [["auditable_id", 2], ["auditable_type", "Estimate"], ["LIMIT", 1]]
  [1m[35mSQL (1.9ms)[0m  [1m[32mINSERT INTO "audits" ("auditable_id", "auditable_type", "user_id", "user_type", "action", "audited_changes", "version", "remote_address", "request_uuid", "created_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["auditable_id", 2], ["auditable_type", "Estimate"], ["user_id", 1], ["user_type", "User"], ["action", "destroy"], ["audited_changes", "---\nname: Тестовая смета\nclient_id: 1\nfloors: !ruby/object:BigDecimal 18:0.1E1\nfirst_floor_height: !ruby/object:BigDecimal 18:0.18E4\nsecond_floor_height_min: !ruby/object:BigDecimal 18:0.0\nsecond_floor_height_max: !ruby/object:BigDecimal 18:0.0\nthird_floor_height_min: !ruby/object:BigDecimal 18:0.0\nthird_floor_height_max: !ruby/object:BigDecimal 18:0.0\nprice: !ruby/object:BigDecimal 18:0.20594E4\narea: !ruby/object:BigDecimal 18:0.1E3\nprice_by_area: !ruby/object:BigDecimal 18:0.2059E2\nprice_by_stage:\n- !ruby/object:BigDecimal 18:0.11E3\n- !ruby/object:BigDecimal 18:0.105E4\n- !ruby/object:BigDecimal 18:0.95E3\nprice_by_stage_aggregated:\n- !ruby/object:BigDecimal 18:0.11E3\n- !ruby/object:BigDecimal 18:0.116E4\n- !ruby/object:BigDecimal 18:0.211E4\nprice_by_area_per_stage:\n- !ruby/object:BigDecimal 18:0.11E1\n- !ruby/object:BigDecimal 18:0.116E2\n- !ruby/object:BigDecimal 18:0.211E2\ndiscount_title: Скидка\ndiscount_by_stages:\n- !ruby/object:BigDecimal 18:0.1E1\n- !ruby/object:BigDecimal 18:0.2E1\n- !ruby/object:BigDecimal 18:0.3E1\ndiscount_amount:\n- !ruby/object:BigDecimal 18:0.11E1\n- !ruby/object:BigDecimal 18:0.21E2\n- !ruby/object:BigDecimal 18:0.285E2\nprice_by_stage_aggregated_discounted:\n- !ruby/object:BigDecimal 18:0.1089E3\n- !ruby/object:BigDecimal 18:0.1139E4\n- !ruby/object:BigDecimal 18:0.20815E4\nprice_by_area_per_stage_discounted:\n- !ruby/object:BigDecimal 18:0.109E1\n- !ruby/object:BigDecimal 18:0.1139E2\n- !ruby/object:BigDecimal 18:0.2082E2\nsigned: false\ndeleted_at: \nsigning_date: \nuser_id: \n"], ["version", 3], ["remote_address", "127.0.0.1"], ["request_uuid", "bd3d485c-5fed-45e9-b54f-cdddd63a216b"], ["created_at", 2017-04-27 01:35:50 UTC]]
  [1m[35mSQL (4.3ms)[0m  [1m[33mUPDATE "estimates" SET "deleted_at" = '2017-04-27 01:35:50.760128', "updated_at" = '2017-04-27 01:35:50.760210' WHERE "estimates"."id" = $1[0m  [["id", 2]]
  [1m[35m (1.5ms)[0m  [1m[35mCOMMIT[0m
Redirected to http://localhost:3000/estimates?client_id=1
Completed 302 Found in 171ms (ActiveRecord: 16.8ms)


Started GET "/estimates?client_id=1" for 127.0.0.1 at 2017-04-27 04:35:50 +0300
Processing by EstimatesController#index as HTML
  Parameters: {"client_id"=>"1"}
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (0.7ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = 1[0m
  Rendering estimates/index.html.haml within layouts/application
  Rendered estimates/index.html.haml within layouts/application (17.3ms)
  Rendered layouts/_header.html.haml (17.4ms)
Completed 200 OK in 742ms (Views: 731.7ms | ActiveRecord: 2.3ms)


Started GET "/estimates/new?client_id=1" for 127.0.0.1 at 2017-04-27 04:35:52 +0300
Processing by EstimatesController#new as HTML
  Parameters: {"client_id"=>"1"}
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (1.1ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (1.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (1.2ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (1.2ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (2.2ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (0.9ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.6ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.5ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mUnit Load (3.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  [1m[36mProductTemplateSet Load (0.6ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mClient Load (0.6ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.4ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering estimates/new.html.haml within layouts/application
  [1m[36mClient Load (2.6ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (11.0ms)
  Rendered estimates/_technical_file_fields.html.haml (8.1ms)
  Rendered estimates/_discount.html.haml (11.6ms)
  Rendered estimates/_stages.html.haml (32.0ms)
  Rendered estimates/_form.html.haml (158.0ms)
  Rendered estimates/new.html.haml within layouts/application (161.1ms)
  Rendered layouts/_header.html.haml (14.3ms)
Completed 200 OK in 1056ms (Views: 758.9ms | ActiveRecord: 72.7ms)


Started POST "/estimates" for 127.0.0.1 at 2017-04-27 04:36:58 +0300
Processing by EstimatesController#create as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"IRB5vWeE56fozqg+UH1A4xwegU/f91liqYHGEbtEBjetoXo0PVztxs0eNM4t/0CjZ4NTrP2MqQgTrvnOqFikJg==", "commit"=>"Сохранить", "estimate"=>{"price"=>"568.22744", "name"=>"Тестовая смета", "client_id"=>"1", "area"=>"100", "first_floor_height"=>"1800", "second_floor_height_min"=>"0.0", "second_floor_height_max"=>"0.0", "third_floor_height_min"=>"0.0", "third_floor_height_max"=>"0.0", "discount_title"=>"Скидка", "discount_by_stages"=>{"0"=>"1", "1"=>"2", "2"=>"3"}}, "json_stages"=>"[{\"number\":1,\"text\":{\"name\":\"Первый этап\",\"summ\":\"Итого по первому этапу:\",\"summ_dis\":\"по первому этапу\",\"discount\":\"Итого по первому этапу со скидкой:\"},\"products\":[{\"id\":1,\"name\":\"Простой продукт 1 этап\",\"unit\":\"шт\",\"custom\":false,\"sets\":[],\"profit\":\"100.0\",\"price_with_work\":\"70.0\",\"price_without_work\":\"10.0\",\"$$hashKey\":\"object:21\",\"quantity\":\"1\",\"with_work\":false,\"price\":\"10.0510\"}],\"price\":10.051,\"total_price\":9.95049,\"aggregated_price\":10.051,\"$$hashKey\":\"object:4\"},{\"number\":2,\"text\":{\"name\":\"Второй этап\",\"summ\":\"Итого по двум этапам:\",\"summ_dis\":\"по второму этапу\",\"discount\":\"Итого по двум этапам со скидкой:\"},\"products\":[{\"id\":2,\"name\":\"Простой продукт 2 этап\",\"unit\":\"м3\",\"custom\":false,\"sets\":[],\"profit\":\"50.0\",\"price_with_work\":\"50.0\",\"price_without_work\":\"50.0\",\"$$hashKey\":\"object:27\",\"quantity\":\"1\",\"with_work\":true,\"price\":\"50.0275\"}],\"price\":50.0275,\"total_price\":49.02695000000001,\"aggregated_price\":60.078500000000005,\"$$hashKey\":\"object:5\"},{\"number\":3,\"text\":{\"name\":\"Третий этап\",\"summ\":\"Итого по трем этапам:\",\"summ_dis\":\"по третьему этапу\",\"discount\":\"Итого по трем этапам со скидкой:\"},\"products\":[{\"id\":3,\"name\":\"Конфигурируемый продукт 3 этап\",\"unit\":\"кг\",\"custom\":true,\"sets\":[{\"id\":1,\"name\":\"Сборка 1\",\"items\":[{\"id\":1,\"name\":\"Составляющая 1\",\"value\":{\"id\":1,\"name\":\"Примитив 1\",\"unit\":\"лист\",\"price\":\"10.0\",\"work_primitive\":false},\"$$hashKey\":\"object:36\",\"quantity\":\"1\"},{\"id\":2,\"name\":\"Составляющая 2\",\"value\":{\"id\":6,\"name\":\"Примитив 6\",\"unit\":\"лист\",\"price\":\"60.0\",\"work_primitive\":true},\"$$hashKey\":\"object:37\",\"quantity\":\"1\"}],\"$$hashKey\":\"object:33\",\"selected\":true}],\"profit\":\"150.0\",\"price_with_work\":70,\"price_without_work\":10,\"$$hashKey\":\"object:31\",\"quantity\":1,\"with_work\":false,\"price\":525}],\"price\":525,\"total_price\":509.25,\"aggregated_price\":585.0785,\"$$hashKey\":\"object:6\"}]", "data"=>""}
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (0.6ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (1.8ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.8ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (1.2ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.6ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (2.9ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  [1m[36mProductTemplateSet Load (0.8ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.8ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Unpermitted parameters: second_floor_height_min, second_floor_height_max, third_floor_height_min, third_floor_height_max, discount_by_stages
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mClient Load (0.8ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35mSQL (1.7ms)[0m  [1m[32mINSERT INTO "estimates" ("name", "client_id", "first_floor_height", "price", "area", "discount_title", "discount_by_stages", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9) RETURNING "id"[0m  [["name", "Тестовая смета"], ["client_id", 1], ["first_floor_height", #<BigDecimal:7f438b43df48,'0.18E4',9(18)>], ["price", #<BigDecimal:7f438b43e2e0,'0.56822744E3',18(18)>], ["area", #<BigDecimal:7f438b43e178,'0.1E3',9(18)>], ["discount_title", "Скидка"], ["discount_by_stages", #<struct ActiveRecord::ConnectionAdapters::PostgreSQL::OID::Array::Data encoder=#<PG::TextEncoder::Array:0x0055cdd81852a8 "decimal[]"  elements_type=nil needs quotation>, values=["1", "2", "3"]>], ["created_at", 2017-04-27 01:36:58 UTC], ["updated_at", 2017-04-27 01:36:58 UTC]]
  [1m[36mAudited::Audit Load (1.4ms)[0m  [1m[34mSELECT  "audits".* FROM "audits" WHERE "audits"."auditable_id" = $1 AND "audits"."auditable_type" = $2 ORDER BY "audits"."version" DESC LIMIT $3[0m  [["auditable_id", 3], ["auditable_type", "Estimate"], ["LIMIT", 1]]
  [1m[35mSQL (1.1ms)[0m  [1m[32mINSERT INTO "audits" ("auditable_id", "auditable_type", "user_id", "user_type", "action", "audited_changes", "version", "remote_address", "request_uuid", "created_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["auditable_id", 3], ["auditable_type", "Estimate"], ["user_id", 1], ["user_type", "User"], ["action", "create"], ["audited_changes", "---\nname: Тестовая смета\nclient_id: 1\nfloors: \nfirst_floor_height: !ruby/object:BigDecimal 18:0.18E4\nsecond_floor_height_min: !ruby/object:BigDecimal 18:0.0\nsecond_floor_height_max: !ruby/object:BigDecimal 18:0.0\nthird_floor_height_min: !ruby/object:BigDecimal 18:0.0\nthird_floor_height_max: !ruby/object:BigDecimal 18:0.0\nprice: !ruby/object:BigDecimal 18:0.56822744E3\narea: !ruby/object:BigDecimal 18:0.1E3\nprice_by_area: \nprice_by_stage:\n- !ruby/object:BigDecimal 18:0.0\n- !ruby/object:BigDecimal 18:0.0\n- !ruby/object:BigDecimal 18:0.0\nprice_by_stage_aggregated:\n- !ruby/object:BigDecimal 18:0.0\n- !ruby/object:BigDecimal 18:0.0\n- !ruby/object:BigDecimal 18:0.0\nprice_by_area_per_stage:\n- !ruby/object:BigDecimal 18:0.0\n- !ruby/object:BigDecimal 18:0.0\n- !ruby/object:BigDecimal 18:0.0\ndiscount_title: Скидка\ndiscount_by_stages:\n- '1'\n- '2'\n- '3'\ndiscount_amount:\n- !ruby/object:BigDecimal 18:0.0\n- !ruby/object:BigDecimal 18:0.0\n- !ruby/object:BigDecimal 18:0.0\nprice_by_stage_aggregated_discounted:\n- !ruby/object:BigDecimal 18:0.0\n- !ruby/object:BigDecimal 18:0.0\n- !ruby/object:BigDecimal 18:0.0\nprice_by_area_per_stage_discounted:\n- !ruby/object:BigDecimal 18:0.0\n- !ruby/object:BigDecimal 18:0.0\n- !ruby/object:BigDecimal 18:0.0\nsigned: false\ndeleted_at: \nsigning_date: \nuser_id: \n"], ["version", 1], ["remote_address", "127.0.0.1"], ["request_uuid", "85eeee68-cfa4-4829-993f-47b5d1445ee6"], ["created_at", 2017-04-27 01:36:58 UTC]]
  [1m[35m (2.7ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mStage Load (1.6ms)[0m  [1m[34mSELECT  "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1 AND "stages"."number" = $2 LIMIT $3[0m  [["estimate_id", 3], ["number", 1], ["LIMIT", 1]]
  [1m[35m (0.6ms)[0m  [1m[35mBEGIN[0m
  [1m[35mSQL (1.5ms)[0m  [1m[32mINSERT INTO "stages" ("estimate_id", "number", "price", "total_price", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["estimate_id", 3], ["number", 1], ["price", #<BigDecimal:7f438af0e6f8,'0.10051E2',18(36)>], ["total_price", #<BigDecimal:7f438af0e518,'0.995E1',18(36)>], ["created_at", 2017-04-27 01:36:58 UTC], ["updated_at", 2017-04-27 01:36:58 UTC]]
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mStageProduct Load (0.9ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1 AND ("stage_products"."product_id" != 1)[0m  [["stage_id", 7]]
  [1m[36mStageProduct Load (0.6ms)[0m  [1m[34mSELECT  "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1 AND "stage_products"."product_id" = $2 LIMIT $3[0m  [["stage_id", 7], ["product_id", 1], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
Completed 500 Internal Server Error in 239ms (ActiveRecord: 45.1ms)


  
ActiveModel::UnknownAttributeError (unknown attribute 'price_with_work' for StageProduct.):
  
app/models/estimate.rb:73:in `block (2 levels) in update_json_values'
app/models/estimate.rb:71:in `each'
app/models/estimate.rb:71:in `block in update_json_values'
app/models/estimate.rb:59:in `each'
app/models/estimate.rb:59:in `update_json_values'
app/controllers/estimates_controller.rb:45:in `create'
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/diagnostics.html.erb within rescues/layout
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_source.html.erb
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_source.html.erb (6.0ms)
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (3.7ms)
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_request_and_response.html.erb
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_request_and_response.html.erb (4.5ms)
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/diagnostics.html.erb within rescues/layout (37.6ms)
DEPRECATION WARNING: to_cleanup is deprecated and will be removed from Rails 5.1 (use ActiveSupport::Reloader.to_complete instead) (called from <top (required)> at /home/g1nc/Development/ruby/constructor/config/environment.rb:5)
  [1m[36mActiveRecord::SchemaMigration Load (1.0ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT pg_try_advisory_lock(6572146483646705745);[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.6ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
Migrating to AddWithoutWorkPriceToConstructorObject (20170426222257)
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (2.2ms)[0m  [1m[35mALTER TABLE "stage_products" DROP "price_without_work"[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "stage_products" DROP "with_work"[0m
  [1m[35m (1.4ms)[0m  [1m[35mALTER TABLE "constructor_objects" DROP "price_without_work"[0m
  [1m[35mSQL (2.6ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = $1[0m  [["version", "20170426222257"]]
  [1m[35m (4.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (3.4ms)[0m  [1m[34mSELECT pg_advisory_unlock(6572146483646705745)[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.4ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
DEPRECATION WARNING: to_cleanup is deprecated and will be removed from Rails 5.1 (use ActiveSupport::Reloader.to_complete instead) (called from <top (required)> at /home/g1nc/Development/ruby/constructor/config/environment.rb:5)
  [1m[35m (0.5ms)[0m  [1m[34mSELECT pg_try_advisory_lock(6572146483646705745);[0m
  [1m[36mActiveRecord::SchemaMigration Load (1.0ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
Migrating to AddWithoutWorkPriceToConstructorObject (20170426222257)
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (32.9ms)[0m  [1m[35mALTER TABLE "constructor_objects" ADD "price_without_work" decimal DEFAULT 0[0m
  [1m[35m (19.1ms)[0m  [1m[35mALTER TABLE "stage_products" ADD "with_work" boolean DEFAULT 't'[0m
  [1m[35m (20.9ms)[0m  [1m[35mALTER TABLE "stage_products" ADD "price_without_work" decimal DEFAULT 0[0m
  [1m[35m (1.2ms)[0m  [1m[35mALTER TABLE "stage_products" RENAME COLUMN "price" TO "price_with_work"[0m
  [1m[35mSQL (2.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20170426222257"]]
  [1m[35m (4.6ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.7ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", :environment], ["LIMIT", 1]]
  [1m[35m (1.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_advisory_unlock(6572146483646705745)[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.6ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
DEPRECATION WARNING: to_cleanup is deprecated and will be removed from Rails 5.1 (use ActiveSupport::Reloader.to_complete instead) (called from <top (required)> at /home/g1nc/Development/ruby/constructor/config/environment.rb:5)
Started GET "/estimates" for 127.0.0.1 at 2017-04-27 04:40:10 +0300
  [1m[36mActiveRecord::SchemaMigration Load (0.9ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
Processing by EstimatesController#index as HTML
  [1m[36mUser Load (1.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Redirected to http://localhost:3000/clients
Completed 302 Found in 54ms (ActiveRecord: 7.4ms)


Started GET "/clients" for 127.0.0.1 at 2017-04-27 04:40:10 +0300
Processing by ClientsController#index as HTML
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering clients/index.html.haml within layouts/application
  [1m[36mUserClient Load (2.9ms)[0m  [1m[34mSELECT "user_clients".* FROM "user_clients" INNER JOIN "clients" ON "clients"."id" = "user_clients"."client_id" AND "clients"."deleted_at" IS NULL WHERE "clients"."archived" = $1 AND (user_id = 1 and owner = true)[0m  [["archived", false]]
  [1m[36mClient Load (0.6ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" IN (1, 2, 3)[0m
  [1m[36mEstimate Load (2.3ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" IN (1, 2, 3)[0m
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 1]]
  Rendered clients/_listing.html.haml (14.1ms)
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 2]]
  Rendered clients/_listing.html.haml (5.0ms)
  [1m[35m (1.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 3]]
  Rendered clients/_listing.html.haml (8.8ms)
  Rendered clients/_table.html.haml (32.7ms)
  [1m[36mUserClient Load (1.7ms)[0m  [1m[34mSELECT "user_clients".* FROM "user_clients" INNER JOIN "clients" ON "clients"."id" = "user_clients"."client_id" AND "clients"."deleted_at" IS NULL WHERE "clients"."archived" = $1 AND (user_id = 1 and owner = false)[0m  [["archived", false]]
  Rendered clients/index.html.haml within layouts/application (189.3ms)
  Rendered layouts/_header.html.haml (71.3ms)
Completed 200 OK in 2821ms (Views: 2776.4ms | ActiveRecord: 26.0ms)


Started GET "/estimates?client_id=1" for 127.0.0.1 at 2017-04-27 04:40:16 +0300
Processing by EstimatesController#index as HTML
  Parameters: {"client_id"=>"1"}
  [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mClient Load (0.6ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (0.7ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = 1[0m
  Rendering estimates/index.html.haml within layouts/application
  Rendered estimates/_listing.html.haml (4.4ms)
  [1m[36mClient Load (0.5ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  Rendered estimates/index.html.haml within layouts/application (17.6ms)
  Rendered layouts/_header.html.haml (15.4ms)
Completed 200 OK in 558ms (Views: 545.1ms | ActiveRecord: 2.8ms)


Started DELETE "/estimates/3" for 127.0.0.1 at 2017-04-27 04:40:22 +0300
Processing by EstimatesController#destroy as HTML
  Parameters: {"authenticity_token"=>"6MNI607QG2CWjJjNKF1PN+iUzddn3nd91tHNUGb2HvpkcktiFAgRAbNcBD1V3093kwkfNEWlhxds/vKPdeq86w==", "id"=>"3"}
  [1m[36mEstimate Load (3.7ms)[0m  [1m[34mSELECT  "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mAudited::Audit Load (1.7ms)[0m  [1m[34mSELECT  "audits".* FROM "audits" WHERE "audits"."auditable_id" = $1 AND "audits"."auditable_type" = $2 ORDER BY "audits"."version" DESC LIMIT $3[0m  [["auditable_id", 3], ["auditable_type", "Estimate"], ["LIMIT", 1]]
  [1m[35mSQL (1.0ms)[0m  [1m[32mINSERT INTO "audits" ("auditable_id", "auditable_type", "user_id", "user_type", "action", "audited_changes", "version", "remote_address", "request_uuid", "created_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["auditable_id", 3], ["auditable_type", "Estimate"], ["user_id", 1], ["user_type", "User"], ["action", "destroy"], ["audited_changes", "---\nname: Тестовая смета\nclient_id: 1\nfloors: \nfirst_floor_height: !ruby/object:BigDecimal 18:0.18E4\nsecond_floor_height_min: !ruby/object:BigDecimal 18:0.0\nsecond_floor_height_max: !ruby/object:BigDecimal 18:0.0\nthird_floor_height_min: !ruby/object:BigDecimal 18:0.0\nthird_floor_height_max: !ruby/object:BigDecimal 18:0.0\nprice: !ruby/object:BigDecimal 18:0.56822744E3\narea: !ruby/object:BigDecimal 18:0.1E3\nprice_by_area: \nprice_by_stage:\n- !ruby/object:BigDecimal 18:0.0\n- !ruby/object:BigDecimal 18:0.0\n- !ruby/object:BigDecimal 18:0.0\nprice_by_stage_aggregated:\n- !ruby/object:BigDecimal 18:0.0\n- !ruby/object:BigDecimal 18:0.0\n- !ruby/object:BigDecimal 18:0.0\nprice_by_area_per_stage:\n- !ruby/object:BigDecimal 18:0.0\n- !ruby/object:BigDecimal 18:0.0\n- !ruby/object:BigDecimal 18:0.0\ndiscount_title: Скидка\ndiscount_by_stages:\n- !ruby/object:BigDecimal 18:0.1E1\n- !ruby/object:BigDecimal 18:0.2E1\n- !ruby/object:BigDecimal 18:0.3E1\ndiscount_amount:\n- !ruby/object:BigDecimal 18:0.0\n- !ruby/object:BigDecimal 18:0.0\n- !ruby/object:BigDecimal 18:0.0\nprice_by_stage_aggregated_discounted:\n- !ruby/object:BigDecimal 18:0.0\n- !ruby/object:BigDecimal 18:0.0\n- !ruby/object:BigDecimal 18:0.0\nprice_by_area_per_stage_discounted:\n- !ruby/object:BigDecimal 18:0.0\n- !ruby/object:BigDecimal 18:0.0\n- !ruby/object:BigDecimal 18:0.0\nsigned: false\ndeleted_at: \nsigning_date: \nuser_id: \n"], ["version", 2], ["remote_address", "127.0.0.1"], ["request_uuid", "d282304c-65de-4f2f-9674-58e827fc5af5"], ["created_at", 2017-04-27 01:40:22 UTC]]
  [1m[35mSQL (0.8ms)[0m  [1m[33mUPDATE "estimates" SET "deleted_at" = '2017-04-27 01:40:22.805815', "updated_at" = '2017-04-27 01:40:22.805882' WHERE "estimates"."id" = $1[0m  [["id", 3]]
  [1m[35m (3.1ms)[0m  [1m[35mCOMMIT[0m
Redirected to http://localhost:3000/estimates?client_id=1
Completed 302 Found in 96ms (ActiveRecord: 14.9ms)


Started GET "/estimates?client_id=1" for 127.0.0.1 at 2017-04-27 04:40:22 +0300
Processing by EstimatesController#index as HTML
  Parameters: {"client_id"=>"1"}
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mClient Load (1.9ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (1.8ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = 1[0m
  Rendering estimates/index.html.haml within layouts/application
  Rendered estimates/index.html.haml within layouts/application (14.6ms)
  Rendered layouts/_header.html.haml (10.2ms)
Completed 200 OK in 692ms (Views: 678.9ms | ActiveRecord: 4.7ms)


Started GET "/estimates/new?client_id=1" for 127.0.0.1 at 2017-04-27 04:40:24 +0300
Processing by EstimatesController#new as HTML
  Parameters: {"client_id"=>"1"}
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (0.8ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (1.2ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (2.4ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.6ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (3.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (4.0ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.6ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (2.0ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mUnit Load (4.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  [1m[36mProductTemplateSet Load (0.6ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (1.1ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (1.2ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (1.8ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.4ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering estimates/new.html.haml within layouts/application
  [1m[36mClient Load (1.9ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (20.7ms)
  Rendered estimates/_technical_file_fields.html.haml (7.8ms)
  Rendered estimates/_discount.html.haml (10.4ms)
  Rendered estimates/_stages.html.haml (22.4ms)
  Rendered estimates/_form.html.haml (181.4ms)
  Rendered estimates/new.html.haml within layouts/application (186.3ms)
  Rendered layouts/_header.html.haml (11.1ms)
Completed 200 OK in 1067ms (Views: 772.5ms | ActiveRecord: 73.1ms)


Started POST "/estimates" for 127.0.0.1 at 2017-04-27 04:41:07 +0300
Processing by EstimatesController#create as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"XUmV/Ifn5hAuc4oajBDmGGz85LwNxA9uwVkPc/o0gF7R+JZ13T/scQujFurxkuZYF2E2Xy+//wR7djCs6SgiTw==", "commit"=>"Сохранить", "estimate"=>{"price"=>"568.22744", "name"=>"Тестовая смета", "client_id"=>"1", "area"=>"100", "first_floor_height"=>"1800", "second_floor_height_min"=>"0.0", "second_floor_height_max"=>"0.0", "third_floor_height_min"=>"0.0", "third_floor_height_max"=>"0.0", "discount_title"=>"Скидка", "discount_by_stages"=>{"0"=>"1", "1"=>"2", "2"=>"3"}}, "json_stages"=>"[{\"number\":1,\"text\":{\"name\":\"Первый этап\",\"summ\":\"Итого по первому этапу:\",\"summ_dis\":\"по первому этапу\",\"discount\":\"Итого по первому этапу со скидкой:\"},\"products\":[{\"id\":1,\"name\":\"Простой продукт 1 этап\",\"unit\":\"шт\",\"custom\":false,\"sets\":[],\"profit\":\"100.0\",\"price_with_work\":\"70.0\",\"price_without_work\":\"10.0\",\"$$hashKey\":\"object:21\",\"quantity\":\"1\",\"with_work\":false,\"price\":\"10.0510\"}],\"price\":10.051,\"total_price\":9.95049,\"aggregated_price\":10.051,\"$$hashKey\":\"object:4\"},{\"number\":2,\"text\":{\"name\":\"Второй этап\",\"summ\":\"Итого по двум этапам:\",\"summ_dis\":\"по второму этапу\",\"discount\":\"Итого по двум этапам со скидкой:\"},\"products\":[{\"id\":2,\"name\":\"Простой продукт 2 этап\",\"unit\":\"м3\",\"custom\":false,\"sets\":[],\"profit\":\"50.0\",\"price_with_work\":\"50.0\",\"price_without_work\":\"50.0\",\"$$hashKey\":\"object:27\",\"quantity\":\"1\",\"with_work\":true,\"price\":\"50.0275\"}],\"price\":50.0275,\"total_price\":49.02695000000001,\"aggregated_price\":60.078500000000005,\"$$hashKey\":\"object:5\"},{\"number\":3,\"text\":{\"name\":\"Третий этап\",\"summ\":\"Итого по трем этапам:\",\"summ_dis\":\"по третьему этапу\",\"discount\":\"Итого по трем этапам со скидкой:\"},\"products\":[{\"id\":3,\"name\":\"Конфигурируемый продукт 3 этап\",\"unit\":\"кг\",\"custom\":true,\"sets\":[{\"id\":1,\"name\":\"Сборка 1\",\"items\":[{\"id\":1,\"name\":\"Составляющая 1\",\"value\":{\"id\":1,\"name\":\"Примитив 1\",\"unit\":\"лист\",\"price\":\"10.0\",\"work_primitive\":false},\"$$hashKey\":\"object:36\",\"quantity\":\"1\"},{\"id\":2,\"name\":\"Составляющая 2\",\"value\":{\"id\":6,\"name\":\"Примитив 6\",\"unit\":\"лист\",\"price\":\"60.0\",\"work_primitive\":true},\"$$hashKey\":\"object:37\",\"quantity\":\"1\"}],\"$$hashKey\":\"object:33\",\"selected\":true}],\"profit\":\"150.0\",\"price_with_work\":70,\"price_without_work\":10,\"$$hashKey\":\"object:31\",\"quantity\":1,\"with_work\":false,\"price\":525}],\"price\":525,\"total_price\":509.25,\"aggregated_price\":585.0785,\"$$hashKey\":\"object:6\"}]", "data"=>""}
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (0.8ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.7ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (1.1ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (0.8ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.6ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.9ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mUnit Load (1.2ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  [1m[36mProductTemplateSet Load (1.2ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.8ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (2.6ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (1.0ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Unpermitted parameters: second_floor_height_min, second_floor_height_max, third_floor_height_min, third_floor_height_max, discount_by_stages
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mClient Load (0.8ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35mSQL (1.0ms)[0m  [1m[32mINSERT INTO "estimates" ("name", "client_id", "first_floor_height", "price", "area", "discount_title", "discount_by_stages", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9) RETURNING "id"[0m  [["name", "Тестовая смета"], ["client_id", 1], ["first_floor_height", #<BigDecimal:7fe5fa5cab60,'0.18E4',9(18)>], ["price", #<BigDecimal:7fe5fa5cadb8,'0.56822744E3',18(18)>], ["area", #<BigDecimal:7fe5fa5caca0,'0.1E3',9(18)>], ["discount_title", "Скидка"], ["discount_by_stages", #<struct ActiveRecord::ConnectionAdapters::PostgreSQL::OID::Array::Data encoder=#<PG::TextEncoder::Array:0x00558408c0a788 "decimal[]"  elements_type=nil needs quotation>, values=["1", "2", "3"]>], ["created_at", 2017-04-27 01:41:07 UTC], ["updated_at", 2017-04-27 01:41:07 UTC]]
  [1m[36mAudited::Audit Load (0.7ms)[0m  [1m[34mSELECT  "audits".* FROM "audits" WHERE "audits"."auditable_id" = $1 AND "audits"."auditable_type" = $2 ORDER BY "audits"."version" DESC LIMIT $3[0m  [["auditable_id", 4], ["auditable_type", "Estimate"], ["LIMIT", 1]]
  [1m[35mSQL (3.9ms)[0m  [1m[32mINSERT INTO "audits" ("auditable_id", "auditable_type", "user_id", "user_type", "action", "audited_changes", "version", "remote_address", "request_uuid", "created_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["auditable_id", 4], ["auditable_type", "Estimate"], ["user_id", 1], ["user_type", "User"], ["action", "create"], ["audited_changes", "---\nname: Тестовая смета\nclient_id: 1\nfloors: \nfirst_floor_height: !ruby/object:BigDecimal 18:0.18E4\nsecond_floor_height_min: !ruby/object:BigDecimal 18:0.0\nsecond_floor_height_max: !ruby/object:BigDecimal 18:0.0\nthird_floor_height_min: !ruby/object:BigDecimal 18:0.0\nthird_floor_height_max: !ruby/object:BigDecimal 18:0.0\nprice: !ruby/object:BigDecimal 18:0.56822744E3\narea: !ruby/object:BigDecimal 18:0.1E3\nprice_by_area: \nprice_by_stage:\n- !ruby/object:BigDecimal 18:0.0\n- !ruby/object:BigDecimal 18:0.0\n- !ruby/object:BigDecimal 18:0.0\nprice_by_stage_aggregated:\n- !ruby/object:BigDecimal 18:0.0\n- !ruby/object:BigDecimal 18:0.0\n- !ruby/object:BigDecimal 18:0.0\nprice_by_area_per_stage:\n- !ruby/object:BigDecimal 18:0.0\n- !ruby/object:BigDecimal 18:0.0\n- !ruby/object:BigDecimal 18:0.0\ndiscount_title: Скидка\ndiscount_by_stages:\n- '1'\n- '2'\n- '3'\ndiscount_amount:\n- !ruby/object:BigDecimal 18:0.0\n- !ruby/object:BigDecimal 18:0.0\n- !ruby/object:BigDecimal 18:0.0\nprice_by_stage_aggregated_discounted:\n- !ruby/object:BigDecimal 18:0.0\n- !ruby/object:BigDecimal 18:0.0\n- !ruby/object:BigDecimal 18:0.0\nprice_by_area_per_stage_discounted:\n- !ruby/object:BigDecimal 18:0.0\n- !ruby/object:BigDecimal 18:0.0\n- !ruby/object:BigDecimal 18:0.0\nsigned: false\ndeleted_at: \nsigning_date: \nuser_id: \n"], ["version", 1], ["remote_address", "127.0.0.1"], ["request_uuid", "8cf7743e-bc89-44a5-b47f-d97c6465cd62"], ["created_at", 2017-04-27 01:41:07 UTC]]
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mStage Load (0.7ms)[0m  [1m[34mSELECT  "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1 AND "stages"."number" = $2 LIMIT $3[0m  [["estimate_id", 4], ["number", 1], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "stages" ("estimate_id", "number", "price", "total_price", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["estimate_id", 4], ["number", 1], ["price", #<BigDecimal:7fe5fa93da90,'0.10051E2',18(36)>], ["total_price", #<BigDecimal:7fe5fa93d860,'0.995E1',18(36)>], ["created_at", 2017-04-27 01:41:07 UTC], ["updated_at", 2017-04-27 01:41:07 UTC]]
  [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mStageProduct Load (1.3ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1 AND ("stage_products"."product_id" != 1)[0m  [["stage_id", 8]]
  [1m[36mStageProduct Load (0.7ms)[0m  [1m[34mSELECT  "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1 AND "stage_products"."product_id" = $2 LIMIT $3[0m  [["stage_id", 8], ["product_id", 1], ["LIMIT", 1]]
  [1m[35m (0.6ms)[0m  [1m[35mBEGIN[0m
  [1m[35mSQL (1.1ms)[0m  [1m[32mINSERT INTO "stage_products" ("product_id", "stage_id", "quantity", "price_with_work", "created_at", "updated_at", "with_work", "price_without_work") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["product_id", 1], ["stage_id", 8], ["quantity", 1], ["price_with_work", #<BigDecimal:7fe5fb29bb28,'0.7E2',9(18)>], ["created_at", 2017-04-27 01:41:07 UTC], ["updated_at", 2017-04-27 01:41:07 UTC], ["with_work", false], ["price_without_work", #<BigDecimal:7fe5fb29aea8,'0.1E2',9(18)>]]
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mStage Load (0.7ms)[0m  [1m[34mSELECT  "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1 AND "stages"."number" = $2 LIMIT $3[0m  [["estimate_id", 4], ["number", 2], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35mSQL (1.2ms)[0m  [1m[32mINSERT INTO "stages" ("estimate_id", "number", "price", "total_price", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["estimate_id", 4], ["number", 2], ["price", #<BigDecimal:7fe5fb2396d0,'0.500275E2',18(36)>], ["total_price", #<BigDecimal:7fe5fb239478,'0.4903E2',18(36)>], ["created_at", 2017-04-27 01:41:07 UTC], ["updated_at", 2017-04-27 01:41:07 UTC]]
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mStageProduct Load (1.7ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1 AND ("stage_products"."product_id" != 2)[0m  [["stage_id", 9]]
  [1m[36mStageProduct Load (0.7ms)[0m  [1m[34mSELECT  "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1 AND "stage_products"."product_id" = $2 LIMIT $3[0m  [["stage_id", 9], ["product_id", 2], ["LIMIT", 1]]
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "stage_products" ("product_id", "stage_id", "quantity", "price_with_work", "created_at", "updated_at", "price_without_work") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["product_id", 2], ["stage_id", 9], ["quantity", 1], ["price_with_work", #<BigDecimal:7fe608eaa650,'0.5E2',9(18)>], ["created_at", 2017-04-27 01:41:07 UTC], ["updated_at", 2017-04-27 01:41:07 UTC], ["price_without_work", #<BigDecimal:7fe608ea8fa8,'0.5E2',9(18)>]]
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mStage Load (0.6ms)[0m  [1m[34mSELECT  "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1 AND "stages"."number" = $2 LIMIT $3[0m  [["estimate_id", 4], ["number", 3], ["LIMIT", 1]]
  [1m[35m (0.6ms)[0m  [1m[35mBEGIN[0m
  [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "stages" ("estimate_id", "number", "price", "total_price", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["estimate_id", 4], ["number", 3], ["price", #<BigDecimal:7fe5fb36f540,'0.525E3',9(27)>], ["total_price", #<BigDecimal:7fe5fb36f450,'0.50925E3',18(36)>], ["created_at", 2017-04-27 01:41:07 UTC], ["updated_at", 2017-04-27 01:41:07 UTC]]
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mStageProduct Load (0.7ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1 AND ("stage_products"."product_id" != 3)[0m  [["stage_id", 10]]
  [1m[36mStageProduct Load (0.6ms)[0m  [1m[34mSELECT  "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1 AND "stage_products"."product_id" = $2 LIMIT $3[0m  [["stage_id", 10], ["product_id", 3], ["LIMIT", 1]]
  [1m[35m (0.9ms)[0m  [1m[35mBEGIN[0m
  [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "stage_products" ("product_id", "stage_id", "quantity", "price_with_work", "created_at", "updated_at", "with_work", "price_without_work") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["product_id", 3], ["stage_id", 10], ["quantity", 1], ["price_with_work", #<BigDecimal:7fe5fb5c5150,'0.7E2',9(27)>], ["created_at", 2017-04-27 01:41:07 UTC], ["updated_at", 2017-04-27 01:41:07 UTC], ["with_work", false], ["price_without_work", #<BigDecimal:7fe5fb5c4638,'0.1E2',9(27)>]]
  [1m[35m (1.6ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mStageProductSet Load (1.2ms)[0m  [1m[34mSELECT  "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = $1 AND "stage_product_sets"."product_set_id" = $2 LIMIT $3[0m  [["stage_product_id", 9], ["product_set_id", 1], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[35mSQL (4.2ms)[0m  [1m[32mINSERT INTO "stage_product_sets" ("stage_product_id", "product_set_id", "selected", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["stage_product_id", 9], ["product_set_id", 1], ["selected", true], ["created_at", 2017-04-27 01:41:07 UTC], ["updated_at", 2017-04-27 01:41:07 UTC]]
  [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mStageProductSetValue Load (0.8ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1 AND ("stage_product_set_values"."product_template_id" NOT IN (1, 2))[0m  [["stage_product_set_id", 3]]
  [1m[36mStageProductSetValue Load (0.7ms)[0m  [1m[34mSELECT  "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1 AND "stage_product_set_values"."product_template_id" = $2 LIMIT $3[0m  [["stage_product_set_id", 3], ["product_template_id", 1], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35mSQL (2.1ms)[0m  [1m[32mINSERT INTO "stage_product_set_values" ("stage_product_set_id", "product_template_id", "constructor_object_id", "quantity", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["stage_product_set_id", 3], ["product_template_id", 1], ["constructor_object_id", 1], ["quantity", 1], ["created_at", 2017-04-27 01:41:07 UTC], ["updated_at", 2017-04-27 01:41:07 UTC]]
  [1m[35m (2.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mStageProductSetValue Load (0.5ms)[0m  [1m[34mSELECT  "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1 AND "stage_product_set_values"."product_template_id" = $2 LIMIT $3[0m  [["stage_product_set_id", 3], ["product_template_id", 2], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35mSQL (1.0ms)[0m  [1m[32mINSERT INTO "stage_product_set_values" ("stage_product_set_id", "product_template_id", "constructor_object_id", "quantity", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["stage_product_set_id", 3], ["product_template_id", 2], ["constructor_object_id", 6], ["quantity", 1], ["created_at", 2017-04-27 01:41:07 UTC], ["updated_at", 2017-04-27 01:41:07 UTC]]
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mAudited::Audit Load (0.9ms)[0m  [1m[34mSELECT  "audits".* FROM "audits" WHERE "audits"."auditable_id" = $1 AND "audits"."auditable_type" = $2 ORDER BY "audits"."version" DESC LIMIT $3[0m  [["auditable_id", 4], ["auditable_type", "Estimate"], ["LIMIT", 1]]
  [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "audits" ("auditable_id", "auditable_type", "user_id", "user_type", "action", "audited_changes", "version", "remote_address", "request_uuid", "created_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["auditable_id", 4], ["auditable_type", "Estimate"], ["user_id", 1], ["user_type", "User"], ["action", "update"], ["audited_changes", "---\nfloors:\n- \n- !ruby/object:BigDecimal 18:0.1E1\nprice_by_area:\n- \n- !ruby/object:BigDecimal 18:0.568E1\nprice_by_stage:\n- - !ruby/object:BigDecimal 18:0.0\n  - !ruby/object:BigDecimal 18:0.0\n  - !ruby/object:BigDecimal 18:0.0\n- - !ruby/object:BigDecimal 27:0.10051E2\n  - !ruby/object:BigDecimal 27:0.500275E2\n  - !ruby/object:BigDecimal 18:0.525E3\nprice_by_stage_aggregated:\n- - !ruby/object:BigDecimal 18:0.0\n  - !ruby/object:BigDecimal 18:0.0\n  - !ruby/object:BigDecimal 18:0.0\n- - !ruby/object:BigDecimal 27:0.10051E2\n  - !ruby/object:BigDecimal 18:0.600785E2\n  - !ruby/object:BigDecimal 18:0.5850785E3\nprice_by_area_per_stage:\n- - !ruby/object:BigDecimal 18:0.0\n  - !ruby/object:BigDecimal 18:0.0\n  - !ruby/object:BigDecimal 18:0.0\n- - !ruby/object:BigDecimal 18:0.1E0\n  - !ruby/object:BigDecimal 18:0.6E0\n  - !ruby/object:BigDecimal 18:0.585E1\ndiscount_amount:\n- - !ruby/object:BigDecimal 18:0.0\n  - !ruby/object:BigDecimal 18:0.0\n  - !ruby/object:BigDecimal 18:0.0\n- - !ruby/object:BigDecimal 18:0.1E0\n  - !ruby/object:BigDecimal 18:0.1E1\n  - !ruby/object:BigDecimal 18:0.1575E2\nprice_by_stage_aggregated_discounted:\n- - !ruby/object:BigDecimal 18:0.0\n  - !ruby/object:BigDecimal 18:0.0\n  - !ruby/object:BigDecimal 18:0.0\n- - !ruby/object:BigDecimal 27:0.9951E1\n  - !ruby/object:BigDecimal 18:0.590785E2\n  - !ruby/object:BigDecimal 18:0.5693285E3\nprice_by_area_per_stage_discounted:\n- - !ruby/object:BigDecimal 18:0.0\n  - !ruby/object:BigDecimal 18:0.0\n  - !ruby/object:BigDecimal 18:0.0\n- - !ruby/object:BigDecimal 18:0.1E0\n  - !ruby/object:BigDecimal 18:0.59E0\n  - !ruby/object:BigDecimal 18:0.569E1\n"], ["version", 2], ["remote_address", "127.0.0.1"], ["request_uuid", "8cf7743e-bc89-44a5-b47f-d97c6465cd62"], ["created_at", 2017-04-27 01:41:07 UTC]]
  [1m[35mSQL (1.1ms)[0m  [1m[33mUPDATE "estimates" SET "floors" = $1, "price_by_area" = $2, "price_by_stage" = $3, "price_by_stage_aggregated" = $4, "price_by_area_per_stage" = $5, "discount_amount" = $6, "price_by_stage_aggregated_discounted" = $7, "price_by_area_per_stage_discounted" = $8, "updated_at" = $9 WHERE "estimates"."id" = $10[0m  [["floors", #<BigDecimal:7fe608e83758,'0.1E1',9(27)>], ["price_by_area", #<BigDecimal:7fe608e83668,'0.568E1',18(27)>], ["price_by_stage", #<struct ActiveRecord::ConnectionAdapters::PostgreSQL::OID::Array::Data encoder=#<PG::TextEncoder::Array:0x00558408c0a788 "decimal[]"  elements_type=nil needs quotation>, values=[#<BigDecimal:7fe5fb0cba00,'0.10051E2',18(36)>, #<BigDecimal:7fe5fb0cb820,'0.500275E2',18(36)>, #<BigDecimal:7fe5fb0cb618,'0.525E3',9(27)>]>], ["price_by_stage_aggregated", #<struct ActiveRecord::ConnectionAdapters::PostgreSQL::OID::Array::Data encoder=#<PG::TextEncoder::Array:0x00558408c0a788 "decimal[]"  elements_type=nil needs quotation>, values=[#<BigDecimal:7fe5fb0cba00,'0.10051E2',18(36)>, #<BigDecimal:7fe5fb0cb5a0,'0.600785E2',18(27)>, #<BigDecimal:7fe5fb0cb550,'0.5850785E3',18(27)>]>], ["price_by_area_per_stage", #<struct ActiveRecord::ConnectionAdapters::PostgreSQL::OID::Array::Data encoder=#<PG::TextEncoder::Array:0x00558408c0a788 "decimal[]"  elements_type=nil needs quotation>, values=[#<BigDecimal:7fe5fb0cb258,'0.1E0',9(18)>, #<BigDecimal:7fe5fb0ca740,'0.6E0',9(18)>, #<BigDecimal:7fe5fb0ca150,'0.585E1',18(27)>]>], ["discount_amount", #<struct ActiveRecord::ConnectionAdapters::PostgreSQL::OID::Array::Data encoder=#<PG::TextEncoder::Array:0x00558408c0a788 "decimal[]"  elements_type=nil needs quotation>, values=[#<BigDecimal:7fe5fb0cac40,'0.1E0',9(18)>, #<BigDecimal:7fe5fb0ca420,'0.1E1',9(27)>, #<BigDecimal:7fe5fb0c9e08,'0.1575E2',18(27)>]>], ["price_by_stage_aggregated_discounted", #<struct ActiveRecord::ConnectionAdapters::PostgreSQL::OID::Array::Data encoder=#<PG::TextEncoder::Array:0x00558408c0a788 "decimal[]"  elements_type=nil needs quotation>, values=[#<BigDecimal:7fe5fb0caad8,'0.9951E1',18(36)>, #<BigDecimal:7fe5fb0ca3d0,'0.590785E2',18(27)>, #<BigDecimal:7fe5fb0c9db8,'0.5693285E3',18(27)>]>], ["price_by_area_per_stage_discounted", #<struct ActiveRecord::ConnectionAdapters::PostgreSQL::OID::Array::Data encoder=#<PG::TextEncoder::Array:0x00558408c0a788 "decimal[]"  elements_type=nil needs quotation>, values=[#<BigDecimal:7fe5fb0ca8d0,'0.1E0',9(18)>, #<BigDecimal:7fe5fb0ca2b8,'0.59E0',9(18)>, #<BigDecimal:7fe5fb0c9ca0,'0.569E1',18(27)>]>], ["updated_at", 2017-04-27 01:41:07 UTC], ["id", 4]]
  [1m[35m (4.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
Redirected to http://localhost:3000/estimates
Completed 302 Found in 466ms (ActiveRecord: 96.9ms)


Started GET "/estimates" for 127.0.0.1 at 2017-04-27 04:41:07 +0300
Processing by EstimatesController#index as HTML
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Redirected to http://localhost:3000/clients
Completed 302 Found in 4ms (ActiveRecord: 0.7ms)


Started GET "/clients" for 127.0.0.1 at 2017-04-27 04:41:07 +0300
Processing by ClientsController#index as HTML
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering clients/index.html.haml within layouts/application
  [1m[36mUserClient Load (1.1ms)[0m  [1m[34mSELECT "user_clients".* FROM "user_clients" INNER JOIN "clients" ON "clients"."id" = "user_clients"."client_id" AND "clients"."deleted_at" IS NULL WHERE "clients"."archived" = $1 AND (user_id = 1 and owner = true)[0m  [["archived", false]]
  [1m[36mClient Load (2.1ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" IN (1, 2, 3)[0m
  [1m[36mEstimate Load (0.8ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" IN (1, 2, 3)[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 1]]
  Rendered clients/_listing.html.haml (8.7ms)
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 2]]
  Rendered clients/_listing.html.haml (4.2ms)
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 3]]
  Rendered clients/_listing.html.haml (4.5ms)
  Rendered clients/_table.html.haml (22.1ms)
  [1m[36mUserClient Load (1.0ms)[0m  [1m[34mSELECT "user_clients".* FROM "user_clients" INNER JOIN "clients" ON "clients"."id" = "user_clients"."client_id" AND "clients"."deleted_at" IS NULL WHERE "clients"."archived" = $1 AND (user_id = 1 and owner = false)[0m  [["archived", false]]
  Rendered clients/index.html.haml within layouts/application (44.2ms)
  Rendered layouts/_header.html.haml (18.6ms)
Completed 200 OK in 770ms (Views: 755.9ms | ActiveRecord: 8.1ms)


Started GET "/estimates?client_id=1" for 127.0.0.1 at 2017-04-27 04:41:11 +0300
Processing by EstimatesController#index as HTML
  Parameters: {"client_id"=>"1"}
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mClient Load (0.6ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (0.8ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = 1[0m
  Rendering estimates/index.html.haml within layouts/application
  Rendered estimates/_listing.html.haml (5.5ms)
  [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  Rendered estimates/index.html.haml within layouts/application (57.4ms)
  Rendered layouts/_header.html.haml (16.2ms)
Completed 200 OK in 708ms (Views: 688.7ms | ActiveRecord: 2.9ms)


Started GET "/estimates/4/edit" for 127.0.0.1 at 2017-04-27 04:41:16 +0300
Processing by EstimatesController#edit as HTML
  Parameters: {"id"=>"4"}
  [1m[36mProduct Load (1.2ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (1.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (2.6ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mCACHE (1.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (2.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (2.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (3.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (6.2ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.9ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (0.8ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.6ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  [1m[36mProductTemplateSet Load (0.6ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.5ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.5ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mEstimate Load (0.7ms)[0m  [1m[34mSELECT  "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.4ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStage Load (0.5ms)[0m  [1m[34mSELECT "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1[0m  [["estimate_id", 4]]
  [1m[36mStageProduct Load (0.6ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" IN (8, 9, 10)[0m
  [1m[36mStageProduct Load (0.5ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 8]]
  [1m[36mStageProductSet Load (0.5ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 7[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 1[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mStageProduct Load (0.9ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 9]]
  [1m[36mStageProductSet Load (0.7ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 8[0m
  [1m[36mProduct Load (0.9ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 2[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mStageProduct Load (0.5ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 10]]
  [1m[36mStageProductSet Load (0.5ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 9[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 3[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mStageProductSet Load (0.5ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = $1[0m  [["stage_product_id", 9]]
  [1m[36mStageProductSetValue Load (0.6ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = 3[0m
  [1m[36mProductSet Load (0.7ms)[0m  [1m[34mSELECT  "product_sets".* FROM "product_sets" WHERE "product_sets"."deleted_at" IS NULL AND "product_sets"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStageProductSetValue Load (1.0ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1[0m  [["stage_product_set_id", 3]]
  [1m[36mCACHE (0.1ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  Rendering estimates/edit.html.haml within layouts/application
  [1m[36mClient Load (0.6ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (3.4ms)
  [1m[36mClientFile Load (0.7ms)[0m  [1m[34mSELECT "client_files".* FROM "client_files" WHERE "client_files"."estimate_id" = $1[0m  [["estimate_id", 4]]
  Rendered estimates/_technical_file_fields.html.haml (3.5ms)
  [1m[36mTechnicalFile Load (0.8ms)[0m  [1m[34mSELECT "technical_files".* FROM "technical_files" WHERE "technical_files"."estimate_id" = $1[0m  [["estimate_id", 4]]
  Rendered estimates/_discount.html.haml (9.2ms)
  Rendered estimates/_stages.html.haml (19.6ms)
  Rendered estimates/_form.html.haml (82.1ms)
  Rendered estimates/edit.html.haml within layouts/application (85.1ms)
  Rendered layouts/_header.html.haml (10.1ms)
Completed 200 OK in 814ms (Views: 655.4ms | ActiveRecord: 42.3ms)


Started GET "/estimates/4/edit" for 127.0.0.1 at 2017-04-27 04:41:53 +0300
Processing by EstimatesController#edit as HTML
  Parameters: {"id"=>"4"}
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (0.6ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (1.1ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.6ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.9ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.5ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (0.8ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.7ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (2.4ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  [1m[36mProductTemplateSet Load (4.8ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (2.9ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (1.1ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mEstimate Load (1.1ms)[0m  [1m[34mSELECT  "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (3.6ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStage Load (0.6ms)[0m  [1m[34mSELECT "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1[0m  [["estimate_id", 4]]
  [1m[36mStageProduct Load (0.6ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" IN (8, 9, 10)[0m
  [1m[36mStageProduct Load (0.7ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 8]]
  [1m[36mStageProductSet Load (0.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 7[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 1[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mStageProduct Load (0.7ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 9]]
  [1m[36mStageProductSet Load (0.8ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 8[0m
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 2[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mStageProduct Load (0.7ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 10]]
  [1m[36mStageProductSet Load (3.8ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 9[0m
  [1m[36mProduct Load (2.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 3[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mStageProductSet Load (0.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = $1[0m  [["stage_product_id", 9]]
  [1m[36mStageProductSetValue Load (1.7ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = 3[0m
  [1m[36mProductSet Load (0.7ms)[0m  [1m[34mSELECT  "product_sets".* FROM "product_sets" WHERE "product_sets"."deleted_at" IS NULL AND "product_sets"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStageProductSetValue Load (0.6ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1[0m  [["stage_product_set_id", 3]]
  [1m[36mCACHE (0.1ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.1ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  Rendering estimates/edit.html.haml within layouts/application
  [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (4.1ms)
  [1m[36mClientFile Load (0.6ms)[0m  [1m[34mSELECT "client_files".* FROM "client_files" WHERE "client_files"."estimate_id" = $1[0m  [["estimate_id", 4]]
  Rendered estimates/_technical_file_fields.html.haml (3.3ms)
  [1m[36mTechnicalFile Load (0.7ms)[0m  [1m[34mSELECT "technical_files".* FROM "technical_files" WHERE "technical_files"."estimate_id" = $1[0m  [["estimate_id", 4]]
  Rendered estimates/_discount.html.haml (8.1ms)
  Rendered estimates/_stages.html.haml (17.2ms)
  Rendered estimates/_form.html.haml (84.3ms)
  Rendered estimates/edit.html.haml within layouts/application (87.6ms)
  Rendered layouts/_header.html.haml (35.5ms)
Completed 200 OK in 1973ms (Views: 1750.7ms | ActiveRecord: 46.1ms)


Started GET "/primitives" for 127.0.0.1 at 2017-04-27 04:42:58 +0300
Processing by PrimitivesController#index as HTML
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering primitives/index.html.haml within layouts/application
  [1m[36mCategory Load (0.9ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."product" = $1[0m  [["product", false]]
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL[0m
  [1m[36mCategory Load (0.6ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 1[0m
  [1m[36mPrimitive Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 1[0m
  [1m[36mCategory Load (0.6ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" = 1[0m
  [1m[36mUnit Load (0.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  Rendered primitives/_listing.html.haml (9.2ms)
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 2[0m
  [1m[36mPrimitive Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 2[0m
  [1m[36mCategory Load (0.5ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" = 2[0m
  [1m[36mUnit Load (0.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 2[0m
  Rendered primitives/_listing.html.haml (4.7ms)
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 3[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 4[0m
  [1m[36mPrimitive Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 4[0m
  [1m[36mCategory Load (0.5ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" = 4[0m
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (6, 5)[0m
  Rendered primitives/_listing.html.haml (4.2ms)
  Rendered primitives/_listing.html.haml (6.4ms)
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 5[0m
  [1m[36mPrimitive Load (1.3ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 5[0m
  [1m[36mCategory Load (0.6ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" = 5[0m
  [1m[36mUnit Load (1.3ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" IN (1, 5)[0m
  Rendered primitives/_listing.html.haml (4.5ms)
  Rendered primitives/_listing.html.haml (4.1ms)
  Rendered primitives/_listing.html.haml (5.3ms)
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 6[0m
  [1m[36mPrimitive Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 6[0m
  [1m[36mCategory Load (1.0ms)[0m  [1m[34mSELECT "categories".* FROM "categories" WHERE "categories"."deleted_at" IS NULL AND "categories"."id" = 6[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 2[0m
  Rendered primitives/_listing.html.haml (4.4ms)
  Rendered primitives/_listing.html.haml (6.1ms)
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 7[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 8[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 9[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 10[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 11[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 12[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 13[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 14[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "constructor_objects" WHERE "constructor_objects"."type" IN ('Primitive') AND "constructor_objects"."deleted_at" IS NULL AND "constructor_objects"."category_id" = 15[0m
  Rendered primitives/index.html.haml within layouts/application (154.3ms)
  Rendered layouts/_header.html.haml (12.9ms)
Completed 200 OK in 891ms (Views: 853.1ms | ActiveRecord: 25.8ms)


Started GET "/estimates/4/edit" for 127.0.0.1 at 2017-04-27 04:43:36 +0300
Processing by EstimatesController#edit as HTML
  Parameters: {"id"=>"4"}
  [1m[36mProduct Load (1.1ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (3.3ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (0.8ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (6.4ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (3.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.7ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (0.9ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.8ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (3.2ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  [1m[36mProductTemplateSet Load (1.4ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mEstimate Load (0.9ms)[0m  [1m[34mSELECT  "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  [1m[36mUser Load (1.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.6ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStage Load (0.7ms)[0m  [1m[34mSELECT "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1[0m  [["estimate_id", 4]]
  [1m[36mStageProduct Load (0.7ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" IN (8, 9, 10)[0m
  [1m[36mStageProduct Load (1.1ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 8]]
  [1m[36mStageProductSet Load (0.8ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 7[0m
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 1[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mStageProduct Load (0.7ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 9]]
  [1m[36mStageProductSet Load (2.8ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 8[0m
  [1m[36mProduct Load (0.9ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 2[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mStageProduct Load (0.9ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 10]]
  [1m[36mStageProductSet Load (0.8ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 9[0m
  [1m[36mProduct Load (0.9ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 3[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mStageProductSet Load (0.7ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = $1[0m  [["stage_product_id", 9]]
  [1m[36mStageProductSetValue Load (0.7ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = 3[0m
  [1m[36mProductSet Load (0.7ms)[0m  [1m[34mSELECT  "product_sets".* FROM "product_sets" WHERE "product_sets"."deleted_at" IS NULL AND "product_sets"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStageProductSetValue Load (2.7ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1[0m  [["stage_product_set_id", 3]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  Rendering estimates/edit.html.haml within layouts/application
  [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (3.9ms)
  [1m[36mClientFile Load (0.6ms)[0m  [1m[34mSELECT "client_files".* FROM "client_files" WHERE "client_files"."estimate_id" = $1[0m  [["estimate_id", 4]]
  Rendered estimates/_technical_file_fields.html.haml (3.5ms)
  [1m[36mTechnicalFile Load (0.7ms)[0m  [1m[34mSELECT "technical_files".* FROM "technical_files" WHERE "technical_files"."estimate_id" = $1[0m  [["estimate_id", 4]]
  Rendered estimates/_discount.html.haml (7.4ms)
  Rendered estimates/_stages.html.haml (19.4ms)
  Rendered estimates/_form.html.haml (94.9ms)
  Rendered estimates/edit.html.haml within layouts/application (98.5ms)
  Rendered layouts/_header.html.haml (13.6ms)
Completed 200 OK in 1866ms (Views: 1685.6ms | ActiveRecord: 50.7ms)


Started GET "/estimates/4/edit" for 127.0.0.1 at 2017-04-27 04:44:46 +0300
Processing by EstimatesController#edit as HTML
  Parameters: {"id"=>"4"}
  [1m[36mProduct Load (7.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (0.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (0.9ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mProduct Load (3.3ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (1.2ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.5ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.5ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (1.1ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (1.1ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.9ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mUnit Load (2.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  [1m[36mProductTemplateSet Load (4.2ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (4.2ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (2.8ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (1.4ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mEstimate Load (0.7ms)[0m  [1m[34mSELECT  "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.5ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStage Load (0.5ms)[0m  [1m[34mSELECT "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1[0m  [["estimate_id", 4]]
  [1m[36mStageProduct Load (0.5ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" IN (8, 9, 10)[0m
  [1m[36mStageProduct Load (1.9ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 8]]
  [1m[36mStageProductSet Load (0.5ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 7[0m
  [1m[36mProduct Load (1.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 1[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mStageProduct Load (1.2ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 9]]
  [1m[36mStageProductSet Load (1.5ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 8[0m
  [1m[36mProduct Load (3.5ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 2[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mStageProduct Load (0.8ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 10]]
  [1m[36mStageProductSet Load (2.3ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 9[0m
  [1m[36mProduct Load (1.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 3[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mStageProductSet Load (0.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = $1[0m  [["stage_product_id", 9]]
  [1m[36mStageProductSetValue Load (1.4ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = 3[0m
  [1m[36mProductSet Load (1.3ms)[0m  [1m[34mSELECT  "product_sets".* FROM "product_sets" WHERE "product_sets"."deleted_at" IS NULL AND "product_sets"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStageProductSetValue Load (1.6ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1[0m  [["stage_product_set_id", 3]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  Rendering estimates/edit.html.haml within layouts/application
  [1m[36mClient Load (2.5ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (11.4ms)
  [1m[36mClientFile Load (1.7ms)[0m  [1m[34mSELECT "client_files".* FROM "client_files" WHERE "client_files"."estimate_id" = $1[0m  [["estimate_id", 4]]
  Rendered estimates/_technical_file_fields.html.haml (10.1ms)
  [1m[36mTechnicalFile Load (1.3ms)[0m  [1m[34mSELECT "technical_files".* FROM "technical_files" WHERE "technical_files"."estimate_id" = $1[0m  [["estimate_id", 4]]
  Rendered estimates/_discount.html.haml (9.7ms)
  Rendered estimates/_stages.html.haml (22.0ms)
  Rendered estimates/_form.html.haml (194.6ms)
  Rendered estimates/edit.html.haml within layouts/application (198.9ms)
  Rendered layouts/_header.html.haml (28.0ms)
Completed 200 OK in 1708ms (Views: 1062.5ms | ActiveRecord: 141.1ms)


Started GET "/estimates/4/edit" for 127.0.0.1 at 2017-04-27 04:45:45 +0300
Processing by EstimatesController#edit as HTML
  Parameters: {"id"=>"4"}
  [1m[36mProduct Load (1.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (4.3ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (0.5ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mProduct Load (0.5ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.5ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (2.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (3.5ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (0.8ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (3.3ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (1.6ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mUnit Load (3.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  [1m[36mProductTemplateSet Load (4.2ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mEstimate Load (2.9ms)[0m  [1m[34mSELECT  "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.4ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStage Load (0.5ms)[0m  [1m[34mSELECT "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1[0m  [["estimate_id", 4]]
  [1m[36mStageProduct Load (2.5ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" IN (8, 9, 10)[0m
  [1m[36mStageProduct Load (0.5ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 8]]
  [1m[36mStageProductSet Load (3.7ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 7[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 1[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mStageProduct Load (2.3ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 9]]
  [1m[36mStageProductSet Load (3.5ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 8[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 2[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mStageProduct Load (3.0ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 10]]
  [1m[36mStageProductSet Load (0.5ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 9[0m
  [1m[36mProduct Load (2.5ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 3[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mStageProductSet Load (0.5ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = $1[0m  [["stage_product_id", 9]]
  [1m[36mStageProductSetValue Load (0.5ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = 3[0m
  [1m[36mProductSet Load (0.6ms)[0m  [1m[34mSELECT  "product_sets".* FROM "product_sets" WHERE "product_sets"."deleted_at" IS NULL AND "product_sets"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStageProductSetValue Load (3.0ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1[0m  [["stage_product_set_id", 3]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  Rendering estimates/edit.html.haml within layouts/application
  [1m[36mClient Load (0.5ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (6.2ms)
  [1m[36mClientFile Load (0.5ms)[0m  [1m[34mSELECT "client_files".* FROM "client_files" WHERE "client_files"."estimate_id" = $1[0m  [["estimate_id", 4]]
  Rendered estimates/_technical_file_fields.html.haml (3.5ms)
  [1m[36mTechnicalFile Load (2.0ms)[0m  [1m[34mSELECT "technical_files".* FROM "technical_files" WHERE "technical_files"."estimate_id" = $1[0m  [["estimate_id", 4]]
  Rendered estimates/_discount.html.haml (8.5ms)
  Rendered estimates/_stages.html.haml (32.8ms)
  Rendered estimates/_form.html.haml (121.7ms)
  Rendered estimates/edit.html.haml within layouts/application (124.8ms)
  Rendered layouts/_header.html.haml (11.3ms)
Completed 200 OK in 2171ms (Views: 1980.1ms | ActiveRecord: 63.1ms)


Started GET "/estimates/4/edit" for 127.0.0.1 at 2017-04-27 04:45:59 +0300
Processing by EstimatesController#edit as HTML
  Parameters: {"id"=>"4"}
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (1.3ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (0.7ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (1.1ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (2.1ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (3.2ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (3.0ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (1.2ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (1.6ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mUnit Load (1.8ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  [1m[36mProductTemplateSet Load (1.3ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (1.3ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.9ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (1.4ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mEstimate Load (1.6ms)[0m  [1m[34mSELECT  "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  [1m[36mUser Load (2.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.4ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStage Load (2.8ms)[0m  [1m[34mSELECT "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1[0m  [["estimate_id", 4]]
  [1m[36mStageProduct Load (0.7ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" IN (8, 9, 10)[0m
  [1m[36mStageProduct Load (1.5ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 8]]
  [1m[36mStageProductSet Load (0.7ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 7[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 1[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mStageProduct Load (0.7ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 9]]
  [1m[36mStageProductSet Load (2.8ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 8[0m
  [1m[36mProduct Load (1.4ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 2[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mStageProduct Load (0.7ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 10]]
  [1m[36mStageProductSet Load (0.5ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 9[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 3[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mStageProductSet Load (0.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = $1[0m  [["stage_product_id", 9]]
  [1m[36mStageProductSetValue Load (0.6ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = 3[0m
  [1m[36mProductSet Load (0.8ms)[0m  [1m[34mSELECT  "product_sets".* FROM "product_sets" WHERE "product_sets"."deleted_at" IS NULL AND "product_sets"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStageProductSetValue Load (0.8ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1[0m  [["stage_product_set_id", 3]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  Rendering estimates/edit.html.haml within layouts/application
  [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (3.5ms)
  [1m[36mClientFile Load (0.5ms)[0m  [1m[34mSELECT "client_files".* FROM "client_files" WHERE "client_files"."estimate_id" = $1[0m  [["estimate_id", 4]]
  Rendered estimates/_technical_file_fields.html.haml (3.3ms)
  [1m[36mTechnicalFile Load (0.5ms)[0m  [1m[34mSELECT "technical_files".* FROM "technical_files" WHERE "technical_files"."estimate_id" = $1[0m  [["estimate_id", 4]]
  Rendered estimates/_discount.html.haml (8.0ms)
  Rendered estimates/_stages.html.haml (21.7ms)
  Rendered estimates/_form.html.haml (83.0ms)
  Rendered estimates/edit.html.haml within layouts/application (87.7ms)
  Rendered layouts/_header.html.haml (17.1ms)
Completed 200 OK in 799ms (Views: 619.7ms | ActiveRecord: 48.2ms)


Started GET "/estimates/new" for 127.0.0.1 at 2017-04-27 04:46:50 +0300
Processing by EstimatesController#new as HTML
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (1.4ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (0.6ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.6ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.5ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (1.3ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.6ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.5ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  [1m[36mProductTemplateSet Load (0.7ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.5ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.5ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.3ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering estimates/new.html.haml within layouts/application
  [1m[36mClient Load (0.5ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (7.9ms)
  Rendered estimates/_technical_file_fields.html.haml (5.2ms)
  Rendered estimates/_discount.html.haml (8.8ms)
  Rendered estimates/_stages.html.haml (15.5ms)
  Rendered estimates/_form.html.haml (136.4ms)
  Rendered estimates/new.html.haml within layouts/application (139.4ms)
  Rendered layouts/_header.html.haml (28.0ms)
Completed 200 OK in 1162ms (Views: 809.5ms | ActiveRecord: 72.0ms)


Started POST "/estimates" for 127.0.0.1 at 2017-04-27 04:47:49 +0300
Processing by EstimatesController#create as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"6wzkcq0GI5HoGm7xAPDskRI4NMTaiamNPQ0sgmzVOnNnvef7994p8M3K8gF9cuzRaaXmJ/jyWeeHIhNdf8mYYg==", "commit"=>"Сохранить", "estimate"=>{"price"=>"3795.0631999999996", "name"=>"Тестовая смета", "client_id"=>"1", "area"=>"100", "first_floor_height"=>"1800", "second_floor_height_min"=>"0.0", "second_floor_height_max"=>"0.0", "third_floor_height_min"=>"0.0", "third_floor_height_max"=>"0.0", "discount_title"=>"", "discount_by_stages"=>{"0"=>"0", "1"=>"0", "2"=>"0"}}, "json_stages"=>"[{\"number\":1,\"text\":{\"name\":\"Первый этап\",\"summ\":\"Итого по первому этапу:\",\"summ_dis\":\"по первому этапу\",\"discount\":\"Итого по первому этапу со скидкой:\"},\"products\":[{\"id\":1,\"name\":\"Простой продукт 1 этап\",\"unit\":\"шт\",\"custom\":false,\"sets\":[],\"profit\":\"100.0\",\"price_with_work\":\"70.0\",\"price_without_work\":\"10.0\",\"$$hashKey\":\"object:36\",\"quantity\":\"1\",\"with_work\":true,\"price\":\"70.03570\"}],\"price\":70.0357,\"total_price\":70.0357,\"aggregated_price\":70.0357,\"$$hashKey\":\"object:25\"},{\"number\":2,\"text\":{\"name\":\"Второй этап\",\"summ\":\"Итого по двум этапам:\",\"summ_dis\":\"по второму этапу\",\"discount\":\"Итого по двум этапам со скидкой:\"},\"products\":[{\"id\":2,\"name\":\"Простой продукт 2 этап\",\"unit\":\"м3\",\"custom\":false,\"sets\":[],\"profit\":\"50.0\",\"price_with_work\":\"50.0\",\"price_without_work\":\"50.0\",\"$$hashKey\":\"object:43\",\"quantity\":\"1\",\"with_work\":true,\"price\":\"50.0275\"}],\"price\":50.0275,\"total_price\":50.0275,\"aggregated_price\":120.06320000000001,\"$$hashKey\":\"object:26\"},{\"number\":3,\"text\":{\"name\":\"Третий этап\",\"summ\":\"Итого по трем этапам:\",\"summ_dis\":\"по третьему этапу\",\"discount\":\"Итого по трем этапам со скидкой:\"},\"products\":[{\"id\":3,\"name\":\"Конфигурируемый продукт 3 этап\",\"unit\":\"кг\",\"custom\":true,\"sets\":[{\"id\":1,\"name\":\"Сборка 1\",\"items\":[{\"id\":1,\"name\":\"Составляющая 1\",\"value\":{\"id\":1,\"name\":\"Примитив 1\",\"unit\":\"лист\",\"price\":\"10.0\",\"work_primitive\":false},\"$$hashKey\":\"object:52\",\"quantity\":\"1\"},{\"id\":2,\"name\":\"Составляющая 2\",\"value\":{\"id\":6,\"name\":\"Примитив 6\",\"unit\":\"лист\",\"price\":\"60.0\",\"work_primitive\":true},\"$$hashKey\":\"object:53\",\"quantity\":\"1\"}],\"$$hashKey\":\"object:49\",\"selected\":true}],\"profit\":\"150.0\",\"price_with_work\":70,\"price_without_work\":10,\"$$hashKey\":\"object:47\",\"quantity\":1,\"with_work\":true,\"price\":3674.9999999999995}],\"price\":3674.9999999999995,\"total_price\":3674.9999999999995,\"aggregated_price\":3795.0631999999996,\"$$hashKey\":\"object:27\"}]", "data"=>""}
  [1m[36mProduct Load (4.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (0.9ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.9ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (1.1ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (1.3ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.9ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (2.2ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (2.0ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (1.5ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  [1m[36mProductTemplateSet Load (0.7ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.8ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (1.1ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (3.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Unpermitted parameters: second_floor_height_min, second_floor_height_max, third_floor_height_min, third_floor_height_max, discount_by_stages
  [1m[35m (0.9ms)[0m  [1m[35mBEGIN[0m
  [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35mSQL (3.2ms)[0m  [1m[32mINSERT INTO "estimates" ("name", "client_id", "first_floor_height", "price", "area", "discount_title", "discount_by_stages", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9) RETURNING "id"[0m  [["name", "Тестовая смета"], ["client_id", 1], ["first_floor_height", #<BigDecimal:7fe5f8b8e378,'0.18E4',9(18)>], ["price", #<BigDecimal:7fe5f8b8e800,'0.3795063199 9999996E4',27(27)>], ["area", #<BigDecimal:7fe5f8b8e558,'0.1E3',9(18)>], ["discount_title", ""], ["discount_by_stages", #<struct ActiveRecord::ConnectionAdapters::PostgreSQL::OID::Array::Data encoder=#<PG::TextEncoder::Array:0x00558408c0a788 "decimal[]"  elements_type=nil needs quotation>, values=["0", "0", "0"]>], ["created_at", 2017-04-27 01:47:49 UTC], ["updated_at", 2017-04-27 01:47:49 UTC]]
  [1m[36mAudited::Audit Load (0.9ms)[0m  [1m[34mSELECT  "audits".* FROM "audits" WHERE "audits"."auditable_id" = $1 AND "audits"."auditable_type" = $2 ORDER BY "audits"."version" DESC LIMIT $3[0m  [["auditable_id", 5], ["auditable_type", "Estimate"], ["LIMIT", 1]]
  [1m[35mSQL (4.4ms)[0m  [1m[32mINSERT INTO "audits" ("auditable_id", "auditable_type", "user_id", "user_type", "action", "audited_changes", "version", "remote_address", "request_uuid", "created_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["auditable_id", 5], ["auditable_type", "Estimate"], ["user_id", 1], ["user_type", "User"], ["action", "create"], ["audited_changes", "---\nname: Тестовая смета\nclient_id: 1\nfloors: \nfirst_floor_height: !ruby/object:BigDecimal 18:0.18E4\nsecond_floor_height_min: !ruby/object:BigDecimal 18:0.0\nsecond_floor_height_max: !ruby/object:BigDecimal 18:0.0\nthird_floor_height_min: !ruby/object:BigDecimal 18:0.0\nthird_floor_height_max: !ruby/object:BigDecimal 18:0.0\nprice: !ruby/object:BigDecimal 27:0.37950631999999996E4\narea: !ruby/object:BigDecimal 18:0.1E3\nprice_by_area: \nprice_by_stage:\n- !ruby/object:BigDecimal 18:0.0\n- !ruby/object:BigDecimal 18:0.0\n- !ruby/object:BigDecimal 18:0.0\nprice_by_stage_aggregated:\n- !ruby/object:BigDecimal 18:0.0\n- !ruby/object:BigDecimal 18:0.0\n- !ruby/object:BigDecimal 18:0.0\nprice_by_area_per_stage:\n- !ruby/object:BigDecimal 18:0.0\n- !ruby/object:BigDecimal 18:0.0\n- !ruby/object:BigDecimal 18:0.0\ndiscount_title: ''\ndiscount_by_stages:\n- '0'\n- '0'\n- '0'\ndiscount_amount:\n- !ruby/object:BigDecimal 18:0.0\n- !ruby/object:BigDecimal 18:0.0\n- !ruby/object:BigDecimal 18:0.0\nprice_by_stage_aggregated_discounted:\n- !ruby/object:BigDecimal 18:0.0\n- !ruby/object:BigDecimal 18:0.0\n- !ruby/object:BigDecimal 18:0.0\nprice_by_area_per_stage_discounted:\n- !ruby/object:BigDecimal 18:0.0\n- !ruby/object:BigDecimal 18:0.0\n- !ruby/object:BigDecimal 18:0.0\nsigned: false\ndeleted_at: \nsigning_date: \nuser_id: \n"], ["version", 1], ["remote_address", "127.0.0.1"], ["request_uuid", "8eaabb55-7d03-4dbc-9839-4c681bcccaa7"], ["created_at", 2017-04-27 01:47:49 UTC]]
  [1m[35m (1.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mStage Load (0.7ms)[0m  [1m[34mSELECT  "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1 AND "stages"."number" = $2 LIMIT $3[0m  [["estimate_id", 5], ["number", 1], ["LIMIT", 1]]
  [1m[35m (1.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "stages" ("estimate_id", "number", "price", "total_price", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["estimate_id", 5], ["number", 1], ["price", #<BigDecimal:55840d2df9b0,'0.700357E2',18(36)>], ["total_price", #<BigDecimal:55840d2dea88,'0.7004E2',18(36)>], ["created_at", 2017-04-27 01:47:49 UTC], ["updated_at", 2017-04-27 01:47:49 UTC]]
  [1m[35m (1.9ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mStageProduct Load (0.7ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1 AND ("stage_products"."product_id" != 1)[0m  [["stage_id", 11]]
  [1m[36mStageProduct Load (0.9ms)[0m  [1m[34mSELECT  "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1 AND "stage_products"."product_id" = $2 LIMIT $3[0m  [["stage_id", 11], ["product_id", 1], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35mSQL (5.4ms)[0m  [1m[32mINSERT INTO "stage_products" ("product_id", "stage_id", "quantity", "price_with_work", "created_at", "updated_at", "price_without_work") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["product_id", 1], ["stage_id", 11], ["quantity", 1], ["price_with_work", #<BigDecimal:7fe608d9ee28,'0.7E2',9(18)>], ["created_at", 2017-04-27 01:48:19 UTC], ["updated_at", 2017-04-27 01:48:19 UTC], ["price_without_work", #<BigDecimal:7fe608d9ddc0,'0.1E2',9(18)>]]
  [1m[35m (3.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mStage Load (2.2ms)[0m  [1m[34mSELECT  "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1 AND "stages"."number" = $2 LIMIT $3[0m  [["estimate_id", 5], ["number", 2], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "stages" ("estimate_id", "number", "price", "total_price", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["estimate_id", 5], ["number", 2], ["price", #<BigDecimal:7fe5fa93dd60,'0.500275E2',18(36)>], ["total_price", #<BigDecimal:7fe5fa93da90,'0.5003E2',18(36)>], ["created_at", 2017-04-27 01:48:19 UTC], ["updated_at", 2017-04-27 01:48:19 UTC]]
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mStageProduct Load (0.7ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1 AND ("stage_products"."product_id" != 2)[0m  [["stage_id", 12]]
  [1m[36mStageProduct Load (1.1ms)[0m  [1m[34mSELECT  "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1 AND "stage_products"."product_id" = $2 LIMIT $3[0m  [["stage_id", 12], ["product_id", 2], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "stage_products" ("product_id", "stage_id", "quantity", "price_with_work", "created_at", "updated_at", "price_without_work") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["product_id", 2], ["stage_id", 12], ["quantity", 1], ["price_with_work", #<BigDecimal:7fe5f50e3548,'0.5E2',9(18)>], ["created_at", 2017-04-27 01:48:32 UTC], ["updated_at", 2017-04-27 01:48:32 UTC], ["price_without_work", #<BigDecimal:7fe5f50e2ad0,'0.5E2',9(18)>]]
  [1m[35m (4.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mStage Load (0.6ms)[0m  [1m[34mSELECT  "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1 AND "stages"."number" = $2 LIMIT $3[0m  [["estimate_id", 5], ["number", 3], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "stages" ("estimate_id", "number", "price", "total_price", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["estimate_id", 5], ["number", 3], ["price", #<BigDecimal:7fe5f4dee540,'0.3675E4',9(36)>], ["total_price", #<BigDecimal:7fe5f4dee2e8,'0.3675E4',9(36)>], ["created_at", 2017-04-27 01:48:32 UTC], ["updated_at", 2017-04-27 01:48:32 UTC]]
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mStageProduct Load (0.8ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1 AND ("stage_products"."product_id" != 3)[0m  [["stage_id", 13]]
  [1m[36mStageProduct Load (1.2ms)[0m  [1m[34mSELECT  "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1 AND "stage_products"."product_id" = $2 LIMIT $3[0m  [["stage_id", 13], ["product_id", 3], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35mSQL (1.2ms)[0m  [1m[32mINSERT INTO "stage_products" ("product_id", "stage_id", "quantity", "price_with_work", "created_at", "updated_at", "price_without_work") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["product_id", 3], ["stage_id", 13], ["quantity", 1], ["price_with_work", #<BigDecimal:7fe5f63ea650,'0.7E2',9(27)>], ["created_at", 2017-04-27 01:49:36 UTC], ["updated_at", 2017-04-27 01:49:36 UTC], ["price_without_work", #<BigDecimal:7fe5f63e9bd8,'0.1E2',9(27)>]]
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mStageProductSet Load (0.8ms)[0m  [1m[34mSELECT  "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = $1 AND "stage_product_sets"."product_set_id" = $2 LIMIT $3[0m  [["stage_product_id", 12], ["product_set_id", 1], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "stage_product_sets" ("stage_product_id", "product_set_id", "selected", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["stage_product_id", 12], ["product_set_id", 1], ["selected", true], ["created_at", 2017-04-27 01:49:36 UTC], ["updated_at", 2017-04-27 01:49:36 UTC]]
  [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mStageProductSetValue Load (1.2ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1 AND ("stage_product_set_values"."product_template_id" NOT IN (1, 2))[0m  [["stage_product_set_id", 4]]
  [1m[36mStageProductSetValue Load (1.6ms)[0m  [1m[34mSELECT  "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1 AND "stage_product_set_values"."product_template_id" = $2 LIMIT $3[0m  [["stage_product_set_id", 4], ["product_template_id", 1], ["LIMIT", 1]]
  [1m[35m (0.6ms)[0m  [1m[35mBEGIN[0m
  [1m[35mSQL (1.0ms)[0m  [1m[32mINSERT INTO "stage_product_set_values" ("stage_product_set_id", "product_template_id", "constructor_object_id", "quantity", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["stage_product_set_id", 4], ["product_template_id", 1], ["constructor_object_id", 1], ["quantity", 1], ["created_at", 2017-04-27 01:49:36 UTC], ["updated_at", 2017-04-27 01:49:36 UTC]]
  [1m[35m (1.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mStageProductSetValue Load (0.5ms)[0m  [1m[34mSELECT  "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1 AND "stage_product_set_values"."product_template_id" = $2 LIMIT $3[0m  [["stage_product_set_id", 4], ["product_template_id", 2], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "stage_product_set_values" ("stage_product_set_id", "product_template_id", "constructor_object_id", "quantity", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["stage_product_set_id", 4], ["product_template_id", 2], ["constructor_object_id", 6], ["quantity", 1], ["created_at", 2017-04-27 01:49:36 UTC], ["updated_at", 2017-04-27 01:49:36 UTC]]
  [1m[35m (4.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mAudited::Audit Load (0.8ms)[0m  [1m[34mSELECT  "audits".* FROM "audits" WHERE "audits"."auditable_id" = $1 AND "audits"."auditable_type" = $2 ORDER BY "audits"."version" DESC LIMIT $3[0m  [["auditable_id", 5], ["auditable_type", "Estimate"], ["LIMIT", 1]]
  [1m[35mSQL (2.2ms)[0m  [1m[32mINSERT INTO "audits" ("auditable_id", "auditable_type", "user_id", "user_type", "action", "audited_changes", "version", "remote_address", "request_uuid", "created_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["auditable_id", 5], ["auditable_type", "Estimate"], ["user_id", 1], ["user_type", "User"], ["action", "update"], ["audited_changes", "---\nfloors:\n- \n- !ruby/object:BigDecimal 18:0.1E1\nprice_by_area:\n- \n- !ruby/object:BigDecimal 27:0.3795E2\nprice_by_stage:\n- - !ruby/object:BigDecimal 18:0.0\n  - !ruby/object:BigDecimal 18:0.0\n  - !ruby/object:BigDecimal 18:0.0\n- - !ruby/object:BigDecimal 27:0.700357E2\n  - !ruby/object:BigDecimal 27:0.500275E2\n  - !ruby/object:BigDecimal 27:0.3675E4\nprice_by_stage_aggregated:\n- - !ruby/object:BigDecimal 18:0.0\n  - !ruby/object:BigDecimal 18:0.0\n  - !ruby/object:BigDecimal 18:0.0\n- - !ruby/object:BigDecimal 27:0.700357E2\n  - !ruby/object:BigDecimal 18:0.1200632E3\n  - !ruby/object:BigDecimal 18:0.37950632E4\nprice_by_area_per_stage:\n- - !ruby/object:BigDecimal 18:0.0\n  - !ruby/object:BigDecimal 18:0.0\n  - !ruby/object:BigDecimal 18:0.0\n- - !ruby/object:BigDecimal 18:0.7E0\n  - !ruby/object:BigDecimal 18:0.12E1\n  - !ruby/object:BigDecimal 18:0.3795E2\nprice_by_stage_aggregated_discounted:\n- - !ruby/object:BigDecimal 18:0.0\n  - !ruby/object:BigDecimal 18:0.0\n  - !ruby/object:BigDecimal 18:0.0\n- - !ruby/object:BigDecimal 18:0.700357E2\n  - !ruby/object:BigDecimal 18:0.1200632E3\n  - !ruby/object:BigDecimal 18:0.37950632E4\nprice_by_area_per_stage_discounted:\n- - !ruby/object:BigDecimal 18:0.0\n  - !ruby/object:BigDecimal 18:0.0\n  - !ruby/object:BigDecimal 18:0.0\n- - !ruby/object:BigDecimal 18:0.7E0\n  - !ruby/object:BigDecimal 18:0.12E1\n  - !ruby/object:BigDecimal 18:0.3795E2\n"], ["version", 2], ["remote_address", "127.0.0.1"], ["request_uuid", "8eaabb55-7d03-4dbc-9839-4c681bcccaa7"], ["created_at", 2017-04-27 01:49:36 UTC]]
  [1m[35mSQL (0.8ms)[0m  [1m[33mUPDATE "estimates" SET "floors" = $1, "price_by_area" = $2, "price_by_stage" = $3, "price_by_stage_aggregated" = $4, "price_by_area_per_stage" = $5, "price_by_stage_aggregated_discounted" = $6, "price_by_area_per_stage_discounted" = $7, "updated_at" = $8 WHERE "estimates"."id" = $9[0m  [["floors", #<BigDecimal:7fe5e51b8168,'0.1E1',9(27)>], ["price_by_area", #<BigDecimal:7fe5e51b80c8,'0.3795E2',18(36)>], ["price_by_stage", #<struct ActiveRecord::ConnectionAdapters::PostgreSQL::OID::Array::Data encoder=#<PG::TextEncoder::Array:0x00558408c0a788 "decimal[]"  elements_type=nil needs quotation>, values=[#<BigDecimal:7fe5e51a02e8,'0.700357E2',18(36)>, #<BigDecimal:7fe5e51a0130,'0.500275E2',18(36)>, #<BigDecimal:7fe5e51bbed0,'0.3675E4',9(36)>]>], ["price_by_stage_aggregated", #<struct ActiveRecord::ConnectionAdapters::PostgreSQL::OID::Array::Data encoder=#<PG::TextEncoder::Array:0x00558408c0a788 "decimal[]"  elements_type=nil needs quotation>, values=[#<BigDecimal:7fe5e51a02e8,'0.700357E2',18(36)>, #<BigDecimal:7fe5e51bbcc8,'0.1200632E3',18(27)>, #<BigDecimal:7fe5e51bbc78,'0.37950632E4',18(27)>]>], ["price_by_area_per_stage", #<struct ActiveRecord::ConnectionAdapters::PostgreSQL::OID::Array::Data encoder=#<PG::TextEncoder::Array:0x00558408c0a788 "decimal[]"  elements_type=nil needs quotation>, values=[#<BigDecimal:7fe5e51bb980,'0.7E0',9(18)>, #<BigDecimal:7fe5e51bae68,'0.12E1',18(27)>, #<BigDecimal:7fe5e51ba850,'0.3795E2',18(27)>]>], ["price_by_stage_aggregated_discounted", #<struct ActiveRecord::ConnectionAdapters::PostgreSQL::OID::Array::Data encoder=#<PG::TextEncoder::Array:0x00558408c0a788 "decimal[]"  elements_type=nil needs quotation>, values=[#<BigDecimal:7fe5e51bb1d8,'0.700357E2',18(27)>, #<BigDecimal:7fe5e51baad0,'0.1200632E3',18(27)>, #<BigDecimal:7fe5e51ba4b8,'0.37950632E4',18(27)>]>], ["price_by_area_per_stage_discounted", #<struct ActiveRecord::ConnectionAdapters::PostgreSQL::OID::Array::Data encoder=#<PG::TextEncoder::Array:0x00558408c0a788 "decimal[]"  elements_type=nil needs quotation>, values=[#<BigDecimal:7fe5e51bafa8,'0.7E0',9(18)>, #<BigDecimal:7fe5e51ba9b8,'0.12E1',18(27)>, #<BigDecimal:7fe5e51ba3c8,'0.3795E2',18(27)>]>], ["updated_at", 2017-04-27 01:49:36 UTC], ["id", 5]]
  [1m[35m (3.0ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
Redirected to http://localhost:3000/estimates
Completed 302 Found in 107540ms (ActiveRecord: 113.9ms)


Started GET "/estimates" for 127.0.0.1 at 2017-04-27 04:49:36 +0300
Processing by EstimatesController#index as HTML
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Redirected to http://localhost:3000/clients
Completed 302 Found in 4ms (ActiveRecord: 0.7ms)


Started GET "/clients" for 127.0.0.1 at 2017-04-27 04:49:36 +0300
Processing by ClientsController#index as HTML
  [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering clients/index.html.haml within layouts/application
  [1m[36mUserClient Load (1.3ms)[0m  [1m[34mSELECT "user_clients".* FROM "user_clients" INNER JOIN "clients" ON "clients"."id" = "user_clients"."client_id" AND "clients"."deleted_at" IS NULL WHERE "clients"."archived" = $1 AND (user_id = 1 and owner = true)[0m  [["archived", false]]
  [1m[36mClient Load (0.8ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" IN (1, 2, 3)[0m
  [1m[36mEstimate Load (0.8ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" IN (1, 2, 3)[0m
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 1]]
  Rendered clients/_listing.html.haml (11.4ms)
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 2]]
  Rendered clients/_listing.html.haml (4.7ms)
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 3]]
  Rendered clients/_listing.html.haml (4.5ms)
  Rendered clients/_table.html.haml (26.2ms)
  [1m[36mUserClient Load (2.1ms)[0m  [1m[34mSELECT "user_clients".* FROM "user_clients" INNER JOIN "clients" ON "clients"."id" = "user_clients"."client_id" AND "clients"."deleted_at" IS NULL WHERE "clients"."archived" = $1 AND (user_id = 1 and owner = false)[0m  [["archived", false]]
  Rendered clients/index.html.haml within layouts/application (64.3ms)
  Rendered layouts/_header.html.haml (14.0ms)
Completed 200 OK in 700ms (Views: 675.5ms | ActiveRecord: 14.0ms)


Started GET "/clients/1/edit" for 127.0.0.1 at 2017-04-27 04:50:09 +0300
Processing by ClientsController#edit as HTML
  Parameters: {"id"=>"1"}
  [1m[36mClient Load (3.7ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUserClient Exists (1.5ms)[0m  [1m[34mSELECT  1 AS one FROM "user_clients" WHERE "user_clients"."user_id" = 1 AND "user_clients"."client_id" = 1 LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mUserClient Load (0.5ms)[0m  [1m[34mSELECT "user_clients".* FROM "user_clients" WHERE "user_clients"."client_id" = 1 AND ("user_clients"."user_id" != 1)[0m
  Rendering clients/edit.html.haml within layouts/application
  [1m[36mUserClient Load (0.6ms)[0m  [1m[34mSELECT  "user_clients".* FROM "user_clients" WHERE "user_clients"."user_id" = 1 AND "user_clients"."client_id" = 1 LIMIT $1[0m  [["LIMIT", 1]]
  Rendered clients/_form.html.haml (32.7ms)
  Rendered clients/edit.html.haml within layouts/application (36.0ms)
  Rendered layouts/_header.html.haml (8.8ms)
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE ("users"."id" != $1)[0m  [["id", 1]]
Completed 200 OK in 723ms (Views: 575.9ms | ActiveRecord: 20.5ms)


Started GET "/clients" for 127.0.0.1 at 2017-04-27 04:50:12 +0300
Processing by ClientsController#index as HTML
  [1m[36mUser Load (11.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering clients/index.html.haml within layouts/application
  [1m[36mUserClient Load (0.8ms)[0m  [1m[34mSELECT "user_clients".* FROM "user_clients" INNER JOIN "clients" ON "clients"."id" = "user_clients"."client_id" AND "clients"."deleted_at" IS NULL WHERE "clients"."archived" = $1 AND (user_id = 1 and owner = true)[0m  [["archived", false]]
  [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" IN (1, 2, 3)[0m
  [1m[36mEstimate Load (0.9ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" IN (1, 2, 3)[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 1]]
  Rendered clients/_listing.html.haml (8.5ms)
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 2]]
  Rendered clients/_listing.html.haml (5.6ms)
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 3]]
  Rendered clients/_listing.html.haml (3.8ms)
  Rendered clients/_table.html.haml (23.1ms)
  [1m[36mUserClient Load (1.1ms)[0m  [1m[34mSELECT "user_clients".* FROM "user_clients" INNER JOIN "clients" ON "clients"."id" = "user_clients"."client_id" AND "clients"."deleted_at" IS NULL WHERE "clients"."archived" = $1 AND (user_id = 1 and owner = false)[0m  [["archived", false]]
  Rendered clients/index.html.haml within layouts/application (82.3ms)
  Rendered layouts/_header.html.haml (12.8ms)
Completed 200 OK in 729ms (Views: 701.7ms | ActiveRecord: 21.2ms)


Started GET "/estimates?client_id=1" for 127.0.0.1 at 2017-04-27 04:50:13 +0300
Processing by EstimatesController#index as HTML
  Parameters: {"client_id"=>"1"}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mClient Load (0.5ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (0.7ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = 1[0m
  Rendering estimates/index.html.haml within layouts/application
  Rendered estimates/_listing.html.haml (5.0ms)
  Rendered estimates/_listing.html.haml (1.1ms)
  [1m[36mClient Load (0.6ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  Rendered estimates/index.html.haml within layouts/application (24.4ms)
  Rendered layouts/_header.html.haml (10.5ms)
Completed 200 OK in 617ms (Views: 598.9ms | ActiveRecord: 2.5ms)


Started GET "/estimates/5/edit" for 127.0.0.1 at 2017-04-27 04:50:26 +0300
Processing by EstimatesController#edit as HTML
  Parameters: {"id"=>"5"}
  [1m[36mProduct Load (1.3ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (1.3ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (0.9ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mProduct Load (6.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.8ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (1.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (0.8ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.7ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  [1m[36mProductTemplateSet Load (0.7ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mEstimate Load (1.0ms)[0m  [1m[34mSELECT  "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStage Load (1.0ms)[0m  [1m[34mSELECT "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1[0m  [["estimate_id", 5]]
  [1m[36mStageProduct Load (0.7ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" IN (11, 12, 13)[0m
  [1m[36mStageProduct Load (0.6ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 11]]
  [1m[36mStageProductSet Load (2.4ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 10[0m
  [1m[36mProduct Load (4.1ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 1[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mStageProduct Load (0.6ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 12]]
  [1m[36mStageProductSet Load (0.5ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 11[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 2[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mStageProduct Load (0.5ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 13]]
  [1m[36mStageProductSet Load (0.5ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 12[0m
  [1m[36mProduct Load (1.1ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 3[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mStageProductSet Load (0.7ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = $1[0m  [["stage_product_id", 12]]
  [1m[36mStageProductSetValue Load (0.7ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = 4[0m
  [1m[36mProductSet Load (0.6ms)[0m  [1m[34mSELECT  "product_sets".* FROM "product_sets" WHERE "product_sets"."deleted_at" IS NULL AND "product_sets"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStageProductSetValue Load (0.5ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1[0m  [["stage_product_set_id", 4]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
Started GET "/estimates/5/edit" for 127.0.0.1 at 2017-04-27 04:52:19 +0300
  [1m[36mExpense Load (0.4ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1[0m  [["estimate_id", 5]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" IN (11, 12, 13)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 11]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 10[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 1[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 12]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 11[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 2[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 13]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 12[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 3[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
Processing by EstimatesController#edit as HTML
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = $1[0m  [["stage_product_id", 12]]
  Parameters: {"id"=>"5"}
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = 4[0m
  [1m[36mProduct Load (1.4ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT  "product_sets".* FROM "product_sets" WHERE "product_sets"."deleted_at" IS NULL AND "product_sets"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1[0m  [["stage_product_set_id", 4]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  [1m[36mUnit Load (6.1ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  Rendering estimates/edit.html.haml within layouts/application
  [1m[36mProductComposition Load (24.9ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mClient Load (4.1ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  [1m[36mConstructorObject Load (9.3ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mProduct Load (0.9ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.8ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.9ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (1.9ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.7ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (1.0ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  [1m[36mProductTemplateSet Load (1.0ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (6.6ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mEstimate Load (2.5ms)[0m  [1m[34mSELECT  "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  [1m[36mUser Load (6.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.8ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStage Load (1.1ms)[0m  [1m[34mSELECT "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1[0m  [["estimate_id", 5]]
  [1m[36mStageProduct Load (1.8ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" IN (11, 12, 13)[0m
  [1m[36mStageProduct Load (0.8ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 11]]
  [1m[36mStageProductSet Load (0.9ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 10[0m
  [1m[36mProduct Load (2.1ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 1[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mStageProduct Load (0.6ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 12]]
  [1m[36mStageProductSet Load (0.7ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 11[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 2[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mStageProduct Load (0.5ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 13]]
  [1m[36mStageProductSet Load (0.4ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 12[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 3[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mStageProductSet Load (1.0ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = $1[0m  [["stage_product_id", 12]]
  [1m[36mStageProductSetValue Load (1.2ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = 4[0m
  [1m[36mProductSet Load (0.6ms)[0m  [1m[34mSELECT  "product_sets".* FROM "product_sets" WHERE "product_sets"."deleted_at" IS NULL AND "product_sets"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStageProductSetValue Load (0.9ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1[0m  [["stage_product_set_id", 4]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  Rendering estimates/edit.html.haml within layouts/application
  [1m[36mClient Load (1.0ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (23.8ms)
  Rendered estimates/_client_file_fields.html.haml (14.5ms)
  [1m[36mClientFile Load (3.4ms)[0m  [1m[34mSELECT "client_files".* FROM "client_files" WHERE "client_files"."estimate_id" = $1[0m  [["estimate_id", 5]]
  [1m[36mClientFile Load (3.1ms)[0m  [1m[34mSELECT "client_files".* FROM "client_files" WHERE "client_files"."estimate_id" = $1[0m  [["estimate_id", 5]]
  Rendered estimates/_technical_file_fields.html.haml (5.6ms)
  Rendered estimates/_technical_file_fields.html.haml (1.6ms)
  [1m[36mTechnicalFile Load (2.6ms)[0m  [1m[34mSELECT "technical_files".* FROM "technical_files" WHERE "technical_files"."estimate_id" = $1[0m  [["estimate_id", 5]]
  Rendered estimates/_discount.html.haml (8.0ms)
  Rendered estimates/_stages.html.haml (21.1ms)
  [1m[36mTechnicalFile Load (39.6ms)[0m  [1m[34mSELECT "technical_files".* FROM "technical_files" WHERE "technical_files"."estimate_id" = $1[0m  [["estimate_id", 5]]
  Rendered estimates/_form.html.haml (150.5ms)
  Rendered estimates/_discount.html.haml (2.7ms)
  Rendered estimates/edit.html.haml within layouts/application (156.2ms)
  Rendered estimates/_stages.html.haml (2.1ms)
  Rendered estimates/_form.html.haml (2545.5ms)
  Rendered estimates/edit.html.haml within layouts/application (2582.2ms)
  Rendered layouts/_header.html.haml (10.9ms)
Completed 200 OK in 3719ms (Views: 1288.6ms | ActiveRecord: 107.3ms)


  Rendered layouts/_header.html.haml (3.1ms)
Completed 200 OK in 117160ms (Views: 3659.9ms | ActiveRecord: 157.6ms)


Started GET "/estimates/5/edit" for 127.0.0.1 at 2017-04-27 04:54:07 +0300
Processing by EstimatesController#edit as HTML
  Parameters: {"id"=>"5"}
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (0.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (1.4ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mProduct Load (3.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.9ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.8ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (1.9ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (0.8ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.7ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  [1m[36mProductTemplateSet Load (0.7ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (2.5ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.9ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mEstimate Load (0.8ms)[0m  [1m[34mSELECT  "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.8ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStage Load (0.8ms)[0m  [1m[34mSELECT "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1[0m  [["estimate_id", 5]]
  [1m[36mStageProduct Load (0.7ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" IN (11, 12, 13)[0m
  [1m[36mStageProduct Load (1.7ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 11]]
  [1m[36mStageProductSet Load (3.7ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 10[0m
  [1m[36mProduct Load (1.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 1[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mStageProduct Load (0.6ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 12]]
  [1m[36mStageProductSet Load (0.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 11[0m
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 2[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mStageProduct Load (0.7ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 13]]
  [1m[36mStageProductSet Load (0.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 12[0m
  [1m[36mProduct Load (1.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 3[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mStageProductSet Load (1.5ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = $1[0m  [["stage_product_id", 12]]
  [1m[36mStageProductSetValue Load (1.5ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = 4[0m
  [1m[36mProductSet Load (0.6ms)[0m  [1m[34mSELECT  "product_sets".* FROM "product_sets" WHERE "product_sets"."deleted_at" IS NULL AND "product_sets"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStageProductSetValue Load (0.8ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1[0m  [["stage_product_set_id", 4]]
  [1m[36mCACHE (0.1ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  Rendering estimates/edit.html.haml within layouts/application
  [1m[36mClient Load (0.5ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (3.6ms)
  [1m[36mClientFile Load (0.7ms)[0m  [1m[34mSELECT "client_files".* FROM "client_files" WHERE "client_files"."estimate_id" = $1[0m  [["estimate_id", 5]]
  Rendered estimates/_technical_file_fields.html.haml (3.8ms)
  [1m[36mTechnicalFile Load (0.5ms)[0m  [1m[34mSELECT "technical_files".* FROM "technical_files" WHERE "technical_files"."estimate_id" = $1[0m  [["estimate_id", 5]]
  Rendered estimates/_discount.html.haml (7.4ms)
  Rendered estimates/_stages.html.haml (18.3ms)
  Rendered estimates/_form.html.haml (99.9ms)
  Rendered estimates/edit.html.haml within layouts/application (103.0ms)
  Rendered layouts/_header.html.haml (9.6ms)
Completed 200 OK in 23113ms (Views: 1519.6ms | ActiveRecord: 41.9ms)


Started GET "/estimates/5/edit" for 127.0.0.1 at 2017-04-27 04:55:05 +0300
Processing by EstimatesController#edit as HTML
  Parameters: {"id"=>"5"}
  [1m[36mProduct Load (1.4ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (4.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (1.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (1.2ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.7ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (1.7ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.6ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mUnit Load (1.3ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  [1m[36mProductTemplateSet Load (0.7ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (1.6ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.5ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mCACHE (0.1ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mEstimate Load (1.2ms)[0m  [1m[34mSELECT  "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  [1m[36mUser Load (3.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.7ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStage Load (1.1ms)[0m  [1m[34mSELECT "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1[0m  [["estimate_id", 5]]
  [1m[36mStageProduct Load (1.4ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" IN (11, 12, 13)[0m
  [1m[36mStageProduct Load (0.7ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 11]]
  [1m[36mStageProductSet Load (1.2ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 10[0m
  [1m[36mProduct Load (1.9ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 1[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mStageProduct Load (0.7ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 12]]
  [1m[36mStageProductSet Load (0.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 11[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 2[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mStageProduct Load (0.6ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 13]]
  [1m[36mStageProductSet Load (0.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 12[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 3[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mStageProductSet Load (0.7ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = $1[0m  [["stage_product_id", 12]]
  [1m[36mStageProductSetValue Load (10.6ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = 4[0m
  [1m[36mProductSet Load (7.8ms)[0m  [1m[34mSELECT  "product_sets".* FROM "product_sets" WHERE "product_sets"."deleted_at" IS NULL AND "product_sets"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStageProductSetValue Load (0.7ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1[0m  [["stage_product_set_id", 4]]
  [1m[36mCACHE (0.2ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  Rendering estimates/edit.html.haml within layouts/application
  [1m[36mClient Load (3.3ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (6.0ms)
  [1m[36mClientFile Load (0.9ms)[0m  [1m[34mSELECT "client_files".* FROM "client_files" WHERE "client_files"."estimate_id" = $1[0m  [["estimate_id", 5]]
  Rendered estimates/_technical_file_fields.html.haml (3.5ms)
  [1m[36mTechnicalFile Load (0.8ms)[0m  [1m[34mSELECT "technical_files".* FROM "technical_files" WHERE "technical_files"."estimate_id" = $1[0m  [["estimate_id", 5]]
  Rendered estimates/_discount.html.haml (6.8ms)
  Rendered estimates/_stages.html.haml (18.5ms)
  Rendered estimates/_form.html.haml (97.7ms)
  Rendered estimates/edit.html.haml within layouts/application (101.8ms)
  Rendered layouts/_header.html.haml (10.9ms)
Completed 200 OK in 10598ms (Views: 1542.6ms | ActiveRecord: 65.5ms)


Started GET "/estimates/5/edit" for 127.0.0.1 at 2017-04-27 04:56:55 +0300
Processing by EstimatesController#edit as HTML
  Parameters: {"id"=>"5"}
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (0.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (0.6ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.6ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (1.0ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (2.1ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  [1m[36mProductTemplateSet Load (0.7ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.9ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (2.2ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mEstimate Load (0.8ms)[0m  [1m[34mSELECT  "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.8ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStage Load (0.7ms)[0m  [1m[34mSELECT "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1[0m  [["estimate_id", 5]]
  [1m[36mStageProduct Load (1.4ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" IN (11, 12, 13)[0m
  [1m[36mStageProduct Load (0.6ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 11]]
  [1m[36mStageProductSet Load (0.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 10[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 1[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mStageProduct Load (0.5ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 12]]
  [1m[36mStageProductSet Load (0.5ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 11[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 2[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mStageProduct Load (0.5ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 13]]
  [1m[36mStageProductSet Load (0.5ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 12[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 3[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mStageProductSet Load (0.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = $1[0m  [["stage_product_id", 12]]
  [1m[36mStageProductSetValue Load (0.7ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = 4[0m
  [1m[36mProductSet Load (0.5ms)[0m  [1m[34mSELECT  "product_sets".* FROM "product_sets" WHERE "product_sets"."deleted_at" IS NULL AND "product_sets"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStageProductSetValue Load (0.8ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1[0m  [["stage_product_set_id", 4]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  Rendering estimates/edit.html.haml within layouts/application
  [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (3.6ms)
  [1m[36mClientFile Load (0.7ms)[0m  [1m[34mSELECT "client_files".* FROM "client_files" WHERE "client_files"."estimate_id" = $1[0m  [["estimate_id", 5]]
  Rendered estimates/_technical_file_fields.html.haml (3.6ms)
  [1m[36mTechnicalFile Load (0.6ms)[0m  [1m[34mSELECT "technical_files".* FROM "technical_files" WHERE "technical_files"."estimate_id" = $1[0m  [["estimate_id", 5]]
  Rendered estimates/_discount.html.haml (7.4ms)
  Rendered estimates/_stages.html.haml (15.7ms)
  Rendered estimates/_form.html.haml (82.5ms)
  Rendered estimates/edit.html.haml within layouts/application (88.2ms)
  Rendered layouts/_header.html.haml (9.8ms)
Completed 200 OK in 9386ms (Views: 1579.8ms | ActiveRecord: 31.4ms)


Started GET "/estimates/5/edit" for 127.0.0.1 at 2017-04-27 04:59:13 +0300
Processing by EstimatesController#edit as HTML
  Parameters: {"id"=>"5"}
  [1m[36mProduct Load (1.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (4.1ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (0.8ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (1.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (2.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (3.6ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (3.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (1.9ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (5.5ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (1.9ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  [1m[36mProductTemplateSet Load (2.2ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (1.5ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (1.3ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mEstimate Load (2.3ms)[0m  [1m[34mSELECT  "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Started GET "/estimates/new" for 127.0.0.1 at 2017-04-27 04:59:44 +0300
Started GET "/estimates/5/edit" for 127.0.0.1 at 2017-04-27 04:59:44 +0300
Started GET "/estimates/new" for 127.0.0.1 at 2017-04-27 04:59:44 +0300
  [1m[36mExpense Load (0.5ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Processing by EstimatesController#new as HTML
Processing by EstimatesController#edit as HTML
Processing by EstimatesController#new as HTML
  [1m[36mStage Load (5.5ms)[0m  [1m[34mSELECT "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1[0m  [["estimate_id", 5]]
  Parameters: {"id"=>"5"}
  [1m[36mProduct Load (45.5ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mProduct Load (5.4ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mStageProduct Load (11.0ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" IN (11, 12, 13)[0m
  [1m[36mProduct Load (51.5ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (11.1ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (0.6ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mUnit Load (20.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mProductComposition Load (18.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mStageProduct Load (27.9ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 11]]
  [1m[36mConstructorObject Load (3.1ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mStageProductSet Load (3.4ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 10[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mProduct Load (9.4ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mProductComposition Load (12.2ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 1[0m
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProduct Load (12.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mConstructorObject Load (8.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mProductComposition Load (11.6ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mUnit Load (6.3ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProduct Load (1.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mStageProduct Load (9.0ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 12]]
  [1m[36mConstructorObject Load (7.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mStageProductSet Load (1.1ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 11[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 2[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mUnit Load (3.3ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProduct Load (3.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mStageProduct Load (0.8ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 13]]
  [1m[36mProductComposition Load (24.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mStageProductSet Load (0.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 12[0m
  [1m[36mConstructorObject Load (4.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mProduct Load (3.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 3[0m
  [1m[36mUnit Load (9.9ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProductComposition Load (16.5ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mStageProductSet Load (0.7ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = $1[0m  [["stage_product_id", 12]]
  [1m[36mProductSet Load (8.2ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mConstructorObject Load (5.1ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mCACHE (0.1ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mStageProductSetValue Load (6.3ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = 4[0m
  [1m[36mProductTemplateSet Load (4.3ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProductTemplate Load (1.7ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mProductSet Load (8.7ms)[0m  [1m[34mSELECT  "product_sets".* FROM "product_sets" WHERE "product_sets"."deleted_at" IS NULL AND "product_sets"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mProduct Load (25.1ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mProduct Load (2.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mStageProductSetValue Load (3.6ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1[0m  [["stage_product_set_id", 4]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mUnit Load (7.1ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mUnit Load (4.2ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mUnit Load (12.9ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  [1m[36mProductTemplateSet Load (2.3ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductSet Load (10.0ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductSet Load (14.7ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplate Load (8.4ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mProductTemplateSet Load (6.8ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplateSet Load (10.7ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mConstructorObject Load (10.9ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (4.8ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  Rendering estimates/edit.html.haml within layouts/application
  [1m[36mUnit Load (5.2ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mClient Load (0.8ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  [1m[36mUnit Load (33.3ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  [1m[36mProductTemplate Load (50.7ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mConstructorObject Load (21.8ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  Rendered estimates/_client_file_fields.html.haml (3.7ms)
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplateSet Load (10.6ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mUnit Load (8.3ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  [1m[36mUser Load (10.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mClientFile Load (15.1ms)[0m  [1m[34mSELECT "client_files".* FROM "client_files" WHERE "client_files"."estimate_id" = $1[0m  [["estimate_id", 5]]
  [1m[36mProductTemplateSet Load (8.6ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (22.5ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (15.7ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (1.5ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (5.3ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendered estimates/_technical_file_fields.html.haml (4.1ms)
  Rendering estimates/new.html.haml within layouts/application
  [1m[36mUnit Load (4.5ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (11.9ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTechnicalFile Load (12.8ms)[0m  [1m[34mSELECT "technical_files".* FROM "technical_files" WHERE "technical_files"."estimate_id" = $1[0m  [["estimate_id", 5]]
  [1m[36mProductTemplate Load (7.2ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  Rendered estimates/_discount.html.haml (12.4ms)
  [1m[36mClient Load (20.5ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  [1m[36mConstructorObject Load (30.2ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  Rendered estimates/_stages.html.haml (42.3ms)
  [1m[36mUnit Load (61.2ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  Rendered estimates/_client_file_fields.html.haml (2.5ms)
  Rendered estimates/_form.html.haml (221.2ms)
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (6.4ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  Rendered estimates/_technical_file_fields.html.haml (1.6ms)
  Rendered estimates/edit.html.haml within layouts/application (243.1ms)
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mEstimate Load (10.6ms)[0m  [1m[34mSELECT  "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  Rendered estimates/_discount.html.haml (9.1ms)
  Rendered estimates/_stages.html.haml (4.2ms)
  [1m[36mUser Load (13.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (40.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendered estimates/_form.html.haml (172.9ms)
Started GET "/estimates/5/edit" for 127.0.0.1 at 2017-04-27 04:59:58 +0300
  Rendered estimates/new.html.haml within layouts/application (13225.8ms)
  [1m[36mExpense Load (3.3ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (80.7ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStage Load (33.2ms)[0m  [1m[34mSELECT "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1[0m  [["estimate_id", 5]]
  Rendering estimates/new.html.haml within layouts/application
  [1m[36mStageProduct Load (5.1ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" IN (11, 12, 13)[0m
  [1m[36mStageProduct Load (173.6ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 11]]
  [1m[36mClient Load (46.4ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  [1m[36mStageProductSet Load (35.9ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 10[0m
  Rendered estimates/_client_file_fields.html.haml (4.7ms)
  [1m[36mProduct Load (26.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 1[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  Rendered estimates/_technical_file_fields.html.haml (19.7ms)
  Rendered estimates/_discount.html.haml (12.9ms)
  [1m[36mStageProduct Load (51.9ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 12]]
  [1m[36mStageProductSet Load (4.3ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 11[0m
  [1m[36mProduct Load (4.3ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 2[0m
  Rendered estimates/_stages.html.haml (33.0ms)
  Rendered estimates/_form.html.haml (407.5ms)
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  Rendered estimates/new.html.haml within layouts/application (571.0ms)
  [1m[36mStageProduct Load (8.0ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 13]]
  [1m[36mStageProductSet Load (18.5ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 12[0m
  [1m[36mProduct Load (3.9ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 3[0m
  [1m[36mCACHE (0.2ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mStageProductSet Load (22.4ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = $1[0m  [["stage_product_id", 12]]
  [1m[36mStageProductSetValue Load (14.2ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = 4[0m
  [1m[36mProductSet Load (33.2ms)[0m  [1m[34mSELECT  "product_sets".* FROM "product_sets" WHERE "product_sets"."deleted_at" IS NULL AND "product_sets"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStageProductSetValue Load (14.8ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1[0m  [["stage_product_set_id", 4]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  Rendering estimates/edit.html.haml within layouts/application
  [1m[36mClient Load (14.4ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (1.5ms)
  [1m[36mClientFile Load (29.3ms)[0m  [1m[34mSELECT "client_files".* FROM "client_files" WHERE "client_files"."estimate_id" = $1[0m  [["estimate_id", 5]]
  Rendered estimates/_technical_file_fields.html.haml (1.4ms)
  [1m[36mTechnicalFile Load (1.2ms)[0m  [1m[34mSELECT "technical_files".* FROM "technical_files" WHERE "technical_files"."estimate_id" = $1[0m  [["estimate_id", 5]]
  Rendered estimates/_discount.html.haml (50.5ms)
  Rendered estimates/_stages.html.haml (3.0ms)
  Rendered estimates/_form.html.haml (368.9ms)
  Rendered estimates/edit.html.haml within layouts/application (406.7ms)
  Rendered layouts/_header.html.haml (58.8ms)
Completed 200 OK in 18260ms (Views: 17839.0ms | ActiveRecord: 219.3ms)


  Rendered layouts/_header.html.haml (48.9ms)
Completed 200 OK in 49761ms (Views: 18000.3ms | ActiveRecord: 181.5ms)


  Rendered layouts/_header.html.haml (67.9ms)
Completed 200 OK in 18290ms (Views: 4560.3ms | ActiveRecord: 494.1ms)


  Rendered layouts/_header.html.haml (3.7ms)
Completed 200 OK in 18378ms (Views: 3822.5ms | ActiveRecord: 754.2ms)


Started GET "/estimates/new" for 127.0.0.1 at 2017-04-27 05:00:03 +0300
Processing by EstimatesController#edit as HTML
  Parameters: {"id"=>"5"}
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (0.7ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.7ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (1.1ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (2.9ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (1.0ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (1.0ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.9ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  [1m[36mProductTemplateSet Load (0.9ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (1.8ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (2.3ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mEstimate Load (0.9ms)[0m  [1m[34mSELECT  "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.5ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStage Load (0.6ms)[0m  [1m[34mSELECT "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1[0m  [["estimate_id", 5]]
  [1m[36mStageProduct Load (1.8ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" IN (11, 12, 13)[0m
  [1m[36mStageProduct Load (0.7ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 11]]
  [1m[36mStageProductSet Load (0.9ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 10[0m
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 1[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mStageProduct Load (0.8ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 12]]
  [1m[36mStageProductSet Load (0.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 11[0m
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 2[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mStageProduct Load (0.7ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 13]]
  [1m[36mStageProductSet Load (0.7ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 12[0m
  [1m[36mProduct Load (3.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 3[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mStageProductSet Load (0.7ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = $1[0m  [["stage_product_id", 12]]
  [1m[36mStageProductSetValue Load (1.4ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = 4[0m
  [1m[36mProductSet Load (0.7ms)[0m  [1m[34mSELECT  "product_sets".* FROM "product_sets" WHERE "product_sets"."deleted_at" IS NULL AND "product_sets"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStageProductSetValue Load (0.9ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1[0m  [["stage_product_set_id", 4]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  Rendering estimates/edit.html.haml within layouts/application
  [1m[36mClient Load (0.6ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (12.0ms)
  [1m[36mClientFile Load (0.7ms)[0m  [1m[34mSELECT "client_files".* FROM "client_files" WHERE "client_files"."estimate_id" = $1[0m  [["estimate_id", 5]]
  Rendered estimates/_technical_file_fields.html.haml (5.8ms)
  [1m[36mTechnicalFile Load (0.7ms)[0m  [1m[34mSELECT "technical_files".* FROM "technical_files" WHERE "technical_files"."estimate_id" = $1[0m  [["estimate_id", 5]]
  Rendered estimates/_discount.html.haml (8.3ms)
  Rendered estimates/_stages.html.haml (16.9ms)
  Rendered estimates/_form.html.haml (156.7ms)
  Rendered estimates/edit.html.haml within layouts/application (163.1ms)
  Rendered layouts/_header.html.haml (27.6ms)
Completed 200 OK in 1261ms (Views: 701.0ms | ActiveRecord: 119.0ms)


Processing by EstimatesController#new as HTML
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (9.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (2.2ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (3.5ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mProduct Load (1.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (5.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (3.1ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (1.5ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.5ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mUnit Load (2.1ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  [1m[36mProductTemplateSet Load (3.1ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (1.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (1.8ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (2.2ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mUser Load (2.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (1.4ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering estimates/new.html.haml within layouts/application
  [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (8.6ms)
  Rendered estimates/_technical_file_fields.html.haml (4.6ms)
  Rendered estimates/_discount.html.haml (9.0ms)
  Rendered estimates/_stages.html.haml (23.2ms)
  Rendered estimates/_form.html.haml (149.1ms)
  Rendered estimates/new.html.haml within layouts/application (203.7ms)
  Rendered layouts/_header.html.haml (33.3ms)
Completed 200 OK in 1176ms (Views: 817.2ms | ActiveRecord: 46.7ms)


Started GET "/estimates/5/edit" for 127.0.0.1 at 2017-04-27 05:00:51 +0300
Processing by EstimatesController#edit as HTML
  Parameters: {"id"=>"5"}
  [1m[36mProduct Load (1.2ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (0.6ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (1.5ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mProduct Load (1.2ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.7ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (0.9ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.7ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (1.1ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  [1m[36mProductTemplateSet Load (0.8ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (1.0ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mEstimate Load (0.8ms)[0m  [1m[34mSELECT  "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.7ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStage Load (1.1ms)[0m  [1m[34mSELECT "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1[0m  [["estimate_id", 5]]
  [1m[36mStageProduct Load (1.2ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" IN (11, 12, 13)[0m
  [1m[36mStageProduct Load (1.6ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 11]]
  [1m[36mStageProductSet Load (0.7ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 10[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 1[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mStageProduct Load (0.7ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 12]]
  [1m[36mStageProductSet Load (0.9ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 11[0m
  [1m[36mProduct Load (0.9ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 2[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mStageProduct Load (0.6ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 13]]
  [1m[36mStageProductSet Load (0.7ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 12[0m
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 3[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mStageProductSet Load (0.7ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = $1[0m  [["stage_product_id", 12]]
  [1m[36mStageProductSetValue Load (0.6ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = 4[0m
  [1m[36mProductSet Load (2.8ms)[0m  [1m[34mSELECT  "product_sets".* FROM "product_sets" WHERE "product_sets"."deleted_at" IS NULL AND "product_sets"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStageProductSetValue Load (2.4ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1[0m  [["stage_product_set_id", 4]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  Rendering estimates/edit.html.haml within layouts/application
  [1m[36mClient Load (6.2ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (3.4ms)
  [1m[36mClientFile Load (2.7ms)[0m  [1m[34mSELECT "client_files".* FROM "client_files" WHERE "client_files"."estimate_id" = $1[0m  [["estimate_id", 5]]
  Rendered estimates/_technical_file_fields.html.haml (3.3ms)
  [1m[36mTechnicalFile Load (2.9ms)[0m  [1m[34mSELECT "technical_files".* FROM "technical_files" WHERE "technical_files"."estimate_id" = $1[0m  [["estimate_id", 5]]
  Rendered estimates/_discount.html.haml (7.2ms)
  Rendered estimates/_stages.html.haml (18.6ms)
  Rendered estimates/_form.html.haml (101.6ms)
  Rendered estimates/edit.html.haml within layouts/application (104.8ms)
  Rendered layouts/_header.html.haml (10.4ms)
Completed 200 OK in 2217ms (Views: 1887.3ms | ActiveRecord: 80.7ms)


Started GET "/estimates/5/edit" for 127.0.0.1 at 2017-04-27 05:01:17 +0300
Processing by EstimatesController#edit as HTML
  Parameters: {"id"=>"5"}
  [1m[36mProduct Load (3.1ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (1.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (0.7ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.8ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (1.4ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (1.0ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.6ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mUnit Load (3.1ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  [1m[36mProductTemplateSet Load (1.1ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (2.3ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mEstimate Load (2.7ms)[0m  [1m[34mSELECT  "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.8ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStage Load (0.7ms)[0m  [1m[34mSELECT "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1[0m  [["estimate_id", 5]]
  [1m[36mStageProduct Load (0.7ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" IN (11, 12, 13)[0m
  [1m[36mStageProduct Load (1.8ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 11]]
  [1m[36mStageProductSet Load (0.7ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 10[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 1[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mStageProduct Load (0.7ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 12]]
  [1m[36mStageProductSet Load (1.3ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 11[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 2[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mStageProduct Load (0.7ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 13]]
  [1m[36mStageProductSet Load (0.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 12[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 3[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mStageProductSet Load (0.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = $1[0m  [["stage_product_id", 12]]
  [1m[36mStageProductSetValue Load (1.3ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = 4[0m
  [1m[36mProductSet Load (0.7ms)[0m  [1m[34mSELECT  "product_sets".* FROM "product_sets" WHERE "product_sets"."deleted_at" IS NULL AND "product_sets"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStageProductSetValue Load (0.9ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1[0m  [["stage_product_set_id", 4]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.3ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  Rendering estimates/edit.html.haml within layouts/application
  [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (4.4ms)
  [1m[36mClientFile Load (0.5ms)[0m  [1m[34mSELECT "client_files".* FROM "client_files" WHERE "client_files"."estimate_id" = $1[0m  [["estimate_id", 5]]
  Rendered estimates/_technical_file_fields.html.haml (4.2ms)
  [1m[36mTechnicalFile Load (0.5ms)[0m  [1m[34mSELECT "technical_files".* FROM "technical_files" WHERE "technical_files"."estimate_id" = $1[0m  [["estimate_id", 5]]
  Rendered estimates/_discount.html.haml (8.5ms)
  Rendered estimates/_stages.html.haml (21.9ms)
  Rendered estimates/_form.html.haml (99.7ms)
  Rendered estimates/edit.html.haml within layouts/application (106.4ms)
  Rendered layouts/_header.html.haml (10.6ms)
Completed 200 OK in 906ms (Views: 740.0ms | ActiveRecord: 41.8ms)


Started GET "/estimates/5/edit" for 127.0.0.1 at 2017-04-27 05:01:49 +0300
Processing by EstimatesController#edit as HTML
  Parameters: {"id"=>"5"}
  [1m[36mProduct Load (1.1ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (1.2ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (0.7ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mProduct Load (2.2ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (2.9ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.6ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (0.8ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (1.1ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  [1m[36mProductTemplateSet Load (1.1ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (1.2ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (1.9ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (2.1ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mEstimate Load (0.8ms)[0m  [1m[34mSELECT  "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.6ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStage Load (0.6ms)[0m  [1m[34mSELECT "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1[0m  [["estimate_id", 5]]
  [1m[36mStageProduct Load (2.1ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" IN (11, 12, 13)[0m
  [1m[36mStageProduct Load (0.7ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 11]]
  [1m[36mStageProductSet Load (0.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 10[0m
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 1[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mStageProduct Load (5.8ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 12]]
  [1m[36mStageProductSet Load (0.7ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 11[0m
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 2[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mStageProduct Load (0.8ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 13]]
  [1m[36mStageProductSet Load (1.2ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 12[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 3[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mStageProductSet Load (0.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = $1[0m  [["stage_product_id", 12]]
  [1m[36mStageProductSetValue Load (0.6ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = 4[0m
  [1m[36mProductSet Load (0.7ms)[0m  [1m[34mSELECT  "product_sets".* FROM "product_sets" WHERE "product_sets"."deleted_at" IS NULL AND "product_sets"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStageProductSetValue Load (0.7ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1[0m  [["stage_product_set_id", 4]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  Rendering estimates/edit.html.haml within layouts/application
  [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (4.9ms)
  [1m[36mClientFile Load (0.8ms)[0m  [1m[34mSELECT "client_files".* FROM "client_files" WHERE "client_files"."estimate_id" = $1[0m  [["estimate_id", 5]]
  Rendered estimates/_technical_file_fields.html.haml (3.4ms)
  [1m[36mTechnicalFile Load (0.6ms)[0m  [1m[34mSELECT "technical_files".* FROM "technical_files" WHERE "technical_files"."estimate_id" = $1[0m  [["estimate_id", 5]]
  Rendered estimates/_discount.html.haml (7.7ms)
  Rendered estimates/_stages.html.haml (16.2ms)
  Rendered estimates/_form.html.haml (85.9ms)
  Rendered estimates/edit.html.haml within layouts/application (89.6ms)
  Rendered layouts/_header.html.haml (10.7ms)
Completed 200 OK in 1813ms (Views: 1646.8ms | ActiveRecord: 44.4ms)


Started GET "/estimates/new" for 127.0.0.1 at 2017-04-27 05:02:54 +0300
Processing by EstimatesController#new as HTML
  [1m[36mProduct Load (1.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (1.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (2.5ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (1.1ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mProduct Load (1.3ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.7ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (1.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (1.9ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (1.0ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (2.5ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mUnit Load (1.3ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  [1m[36mProductTemplateSet Load (0.5ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (1.1ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.8ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (3.1ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (1.3ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering estimates/new.html.haml within layouts/application
  [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (5.4ms)
  Rendered estimates/_technical_file_fields.html.haml (3.9ms)
  Rendered estimates/_discount.html.haml (8.8ms)
  Rendered estimates/_stages.html.haml (24.9ms)
  Rendered estimates/_form.html.haml (98.4ms)
  Rendered estimates/new.html.haml within layouts/application (102.3ms)
  Rendered layouts/_header.html.haml (14.2ms)
Completed 200 OK in 900ms (Views: 798.6ms | ActiveRecord: 29.2ms)


Started GET "/estimates/5/edit" for 127.0.0.1 at 2017-04-27 05:05:41 +0300
Processing by EstimatesController#edit as HTML
  Parameters: {"id"=>"5"}
  [1m[36mProduct Load (1.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (6.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (0.8ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (2.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.7ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (5.2ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.9ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  [1m[36mProductTemplateSet Load (0.8ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (1.4ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mEstimate Load (2.7ms)[0m  [1m[34mSELECT  "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.6ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStage Load (0.7ms)[0m  [1m[34mSELECT "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1[0m  [["estimate_id", 5]]
  [1m[36mStageProduct Load (0.8ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" IN (11, 12, 13)[0m
  [1m[36mStageProduct Load (0.7ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 11]]
  [1m[36mStageProductSet Load (0.9ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 10[0m
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 1[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mStageProduct Load (0.5ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 12]]
  [1m[36mStageProductSet Load (0.5ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 11[0m
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 2[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mStageProduct Load (0.8ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 13]]
  [1m[36mStageProductSet Load (0.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 12[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 3[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mStageProductSet Load (0.7ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = $1[0m  [["stage_product_id", 12]]
  [1m[36mStageProductSetValue Load (5.8ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = 4[0m
  [1m[36mProductSet Load (1.4ms)[0m  [1m[34mSELECT  "product_sets".* FROM "product_sets" WHERE "product_sets"."deleted_at" IS NULL AND "product_sets"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStageProductSetValue Load (0.7ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1[0m  [["stage_product_set_id", 4]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  Rendering estimates/edit.html.haml within layouts/application
  [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (3.6ms)
  [1m[36mClientFile Load (0.7ms)[0m  [1m[34mSELECT "client_files".* FROM "client_files" WHERE "client_files"."estimate_id" = $1[0m  [["estimate_id", 5]]
  Rendered estimates/_technical_file_fields.html.haml (3.7ms)
  [1m[36mTechnicalFile Load (0.6ms)[0m  [1m[34mSELECT "technical_files".* FROM "technical_files" WHERE "technical_files"."estimate_id" = $1[0m  [["estimate_id", 5]]
  Rendered estimates/_discount.html.haml (8.0ms)
  Rendered estimates/_stages.html.haml (24.9ms)
  Rendered estimates/_form.html.haml (91.5ms)
  Rendered estimates/edit.html.haml within layouts/application (97.5ms)
  Rendered layouts/_header.html.haml (8.4ms)
Completed 200 OK in 1830ms (Views: 1593.1ms | ActiveRecord: 50.4ms)


Started GET "/estimates/new" for 127.0.0.1 at 2017-04-27 05:08:49 +0300
Processing by EstimatesController#new as HTML
  [1m[36mProduct Load (7.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (2.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (5.9ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (2.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mProduct Load (2.2ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (1.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (1.8ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (1.4ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (2.1ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (1.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (2.5ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (2.3ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (2.1ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mUnit Load (1.9ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  [1m[36mProductTemplateSet Load (2.1ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (2.5ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.9ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (1.1ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (1.0ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mUser Load (1.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.6ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering estimates/new.html.haml within layouts/application
  [1m[36mClient Load (1.4ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (3.2ms)
  Rendered estimates/_technical_file_fields.html.haml (3.4ms)
  Rendered estimates/_discount.html.haml (6.9ms)
  Rendered estimates/_stages.html.haml (16.9ms)
  Rendered estimates/_form.html.haml (89.8ms)
  Rendered estimates/new.html.haml within layouts/application (93.1ms)
  Rendered layouts/_header.html.haml (9.5ms)
Completed 200 OK in 1913ms (Views: 1794.7ms | ActiveRecord: 49.9ms)


Started GET "/estimates/new" for 127.0.0.1 at 2017-04-27 05:11:14 +0300
Processing by EstimatesController#new as HTML
  [1m[36mProduct Load (4.2ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (0.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (0.6ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (2.1ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mProduct Load (0.9ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.8ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.5ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (1.6ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.8ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  [1m[36mProductTemplateSet Load (0.6ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mUser Load (2.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.6ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering estimates/new.html.haml within layouts/application
  [1m[36mClient Load (0.5ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (3.6ms)
  Rendered estimates/_technical_file_fields.html.haml (3.9ms)
  Rendered estimates/_discount.html.haml (7.6ms)
  Rendered estimates/_stages.html.haml (20.2ms)
  Rendered estimates/_form.html.haml (102.1ms)
  Rendered estimates/new.html.haml within layouts/application (105.8ms)
  Rendered layouts/_header.html.haml (8.7ms)
Completed 200 OK in 1870ms (Views: 1772.8ms | ActiveRecord: 23.2ms)


Started GET "/estimates/new" for 127.0.0.1 at 2017-04-27 05:11:27 +0300
Processing by EstimatesController#new as HTML
  [1m[36mProduct Load (2.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (1.1ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (0.7ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (3.5ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.8ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (1.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (1.2ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (1.2ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.6ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  [1m[36mProductTemplateSet Load (0.8ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.9ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.6ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering estimates/new.html.haml within layouts/application
  [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (4.7ms)
  Rendered estimates/_technical_file_fields.html.haml (3.5ms)
  Rendered estimates/_discount.html.haml (8.8ms)
  Rendered estimates/_stages.html.haml (16.1ms)
  Rendered estimates/_form.html.haml (84.2ms)
  Rendered estimates/new.html.haml within layouts/application (87.7ms)
  Rendered layouts/_header.html.haml (12.4ms)
Completed 200 OK in 752ms (Views: 653.1ms | ActiveRecord: 23.3ms)


Started GET "/estimates/new" for 127.0.0.1 at 2017-04-27 05:11:37 +0300
Processing by EstimatesController#new as HTML
  [1m[36mProduct Load (4.5ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (0.9ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (3.7ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mProduct Load (2.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.6ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.9ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.9ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (0.7ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.6ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mUnit Load (1.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  [1m[36mProductTemplateSet Load (0.6ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.5ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (4.5ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mUser Load (2.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (1.1ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering estimates/new.html.haml within layouts/application
  [1m[36mClient Load (0.6ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (3.1ms)
  Rendered estimates/_technical_file_fields.html.haml (3.0ms)
  Rendered estimates/_discount.html.haml (36.7ms)
  Rendered estimates/_stages.html.haml (18.9ms)
  Rendered estimates/_form.html.haml (112.1ms)
  Rendered estimates/new.html.haml within layouts/application (118.9ms)
  Rendered layouts/_header.html.haml (11.6ms)
Completed 200 OK in 1692ms (Views: 1584.6ms | ActiveRecord: 31.4ms)


Started GET "/estimates/new" for 127.0.0.1 at 2017-04-27 05:12:52 +0300
Processing by EstimatesController#new as HTML
  [1m[36mProduct Load (4.1ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (0.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (5.2ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (2.8ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (3.1ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (1.9ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (2.6ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (5.5ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mUnit Load (0.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  [1m[36mProductTemplateSet Load (1.8ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (1.0ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (1.3ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (2.7ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (1.9ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mUser Load (1.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (1.0ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering estimates/new.html.haml within layouts/application
  [1m[36mClient Load (2.3ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (5.3ms)
  Rendered estimates/_technical_file_fields.html.haml (7.3ms)
  Rendered estimates/_discount.html.haml (11.1ms)
  Rendered estimates/_stages.html.haml (28.8ms)
  Rendered estimates/_form.html.haml (113.9ms)
  Rendered estimates/new.html.haml within layouts/application (121.5ms)
  Rendered layouts/_header.html.haml (16.5ms)
Completed 200 OK in 2941ms (Views: 2824.4ms | ActiveRecord: 43.4ms)


Started GET "/estimates/new" for 127.0.0.1 at 2017-04-27 05:13:23 +0300
Processing by EstimatesController#new as HTML
  [1m[36mProduct Load (3.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (3.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (0.7ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (1.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.8ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (2.1ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (1.1ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.8ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  [1m[36mProductTemplateSet Load (0.7ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (1.3ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (2.1ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (1.0ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (1.0ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mCACHE (0.5ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mUser Load (3.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (2.1ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering estimates/new.html.haml within layouts/application
  [1m[36mClient Load (0.5ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (7.4ms)
  Rendered estimates/_technical_file_fields.html.haml (7.4ms)
  Rendered estimates/_discount.html.haml (6.4ms)
  Rendered estimates/_stages.html.haml (21.6ms)
  Rendered estimates/_form.html.haml (96.7ms)
  Rendered estimates/new.html.haml within layouts/application (101.2ms)
  Rendered layouts/_header.html.haml (15.3ms)
Completed 200 OK in 2043ms (Views: 1925.5ms | ActiveRecord: 31.3ms)


Started GET "/estimates/new" for 127.0.0.1 at 2017-04-27 05:13:58 +0300
Processing by EstimatesController#new as HTML
  [1m[36mProduct Load (1.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (5.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (0.8ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mProduct Load (4.3ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (1.2ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (1.3ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.9ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (1.3ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (1.1ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (1.2ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (1.4ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mUnit Load (1.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  [1m[36mProductTemplateSet Load (2.0ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (1.1ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (1.5ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (2.2ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.8ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (1.3ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mUser Load (2.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (1.5ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering estimates/new.html.haml within layouts/application
  [1m[36mClient Load (0.6ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (3.5ms)
  Rendered estimates/_technical_file_fields.html.haml (3.9ms)
  Rendered estimates/_discount.html.haml (7.8ms)
  Rendered estimates/_stages.html.haml (19.1ms)
  Rendered estimates/_form.html.haml (90.4ms)
  Rendered estimates/new.html.haml within layouts/application (93.5ms)
  Rendered layouts/_header.html.haml (13.5ms)
Completed 200 OK in 2049ms (Views: 1948.7ms | ActiveRecord: 35.3ms)


Started GET "/estimates/new" for 127.0.0.1 at 2017-04-27 05:14:40 +0300
Processing by EstimatesController#new as HTML
  [1m[36mProduct Load (3.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (1.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (1.7ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (1.3ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mCACHE (0.1ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.8ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (3.8ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (2.4ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (1.2ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mUnit Load (2.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  [1m[36mProductTemplateSet Load (2.7ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (1.0ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (3.5ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.5ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.5ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering estimates/new.html.haml within layouts/application
  [1m[36mClient Load (2.9ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (8.1ms)
  Rendered estimates/_technical_file_fields.html.haml (5.8ms)
  Rendered estimates/_discount.html.haml (13.5ms)
  Rendered estimates/_stages.html.haml (26.2ms)
  Rendered estimates/_form.html.haml (136.9ms)
  Rendered estimates/new.html.haml within layouts/application (141.5ms)
  Rendered layouts/_header.html.haml (10.1ms)
Completed 200 OK in 2670ms (Views: 2550.9ms | ActiveRecord: 35.5ms)


Started POST "/estimates" for 127.0.0.1 at 2017-04-27 05:16:28 +0300
Processing by EstimatesController#create as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"ROlULlUoIFbtSjOjXFBHe0XjzAvrGFPdZWA9EYzZI+XIWFenD/AqN8iar1Mh0kc7Pn4e6Mljo7ffTwLOn8WB9A==", "commit"=>"Сохранить", "estimate"=>{"price"=>"302", "name"=>"124124", "client_id"=>"1", "area"=>"4214", "first_floor_height"=>"124124", "second_floor_height_min"=>"0.0", "second_floor_height_max"=>"0.0", "third_floor_height_min"=>"0.0", "third_floor_height_max"=>"0.0", "discount_title"=>"", "discount_by_stages"=>{"0"=>"0", "1"=>"0", "2"=>"0"}}, "json_stages"=>"[{\"number\":1,\"text\":{\"name\":\"Первый этап\",\"summ\":\"Итого по первому этапу:\",\"summ_dis\":\"по первому этапу\",\"discount\":\"Итого по первому этапу со скидкой:\"},\"products\":[{\"id\":1,\"name\":\"Простой продукт 1 этап\",\"unit\":\"шт\",\"custom\":false,\"sets\":[],\"profit\":100,\"price_with_work\":70,\"price_without_work\":10,\"$$hashKey\":\"object:14\",\"quantity\":\"1\",\"with_work\":false,\"price\":20.5}],\"price\":20.5,\"total_price\":20.5,\"aggregated_price\":20.5,\"$$hashKey\":\"object:3\"},{\"number\":2,\"text\":{\"name\":\"Второй этап\",\"summ\":\"Итого по двум этапам:\",\"summ_dis\":\"по второму этапу\",\"discount\":\"Итого по двум этапам со скидкой:\"},\"products\":[{\"id\":2,\"name\":\"Простой продукт 2 этап\",\"unit\":\"м3\",\"custom\":false,\"sets\":[],\"profit\":50,\"price_with_work\":50,\"price_without_work\":50,\"$$hashKey\":\"object:21\",\"quantity\":\"1\",\"with_work\":true,\"price\":77.5}],\"price\":77.5,\"total_price\":77.5,\"aggregated_price\":98,\"$$hashKey\":\"object:4\"},{\"number\":3,\"text\":{\"name\":\"Третий этап\",\"summ\":\"Итого по трем этапам:\",\"summ_dis\":\"по третьему этапу\",\"discount\":\"Итого по трем этапам со скидкой:\"},\"products\":[{\"id\":3,\"name\":\"Конфигурируемый продукт 3 этап\",\"unit\":\"кг\",\"custom\":true,\"sets\":[{\"id\":1,\"name\":\"Сборка 1\",\"items\":[{\"id\":1,\"name\":\"Составляющая 1\",\"value\":{\"id\":1,\"name\":\"Примитив 1\",\"unit\":\"лист\",\"price\":10,\"work_primitive\":false},\"$$hashKey\":\"object:31\",\"quantity\":\"2\"},{\"id\":2,\"name\":\"Составляющая 2\",\"value\":{\"id\":6,\"name\":\"Примитив 6\",\"unit\":\"лист\",\"price\":60,\"work_primitive\":true},\"$$hashKey\":\"object:32\",\"quantity\":\"1\"}],\"$$hashKey\":\"object:28\",\"selected\":true}],\"profit\":150,\"price_with_work\":80,\"price_without_work\":20,\"$$hashKey\":\"object:26\",\"quantity\":1,\"with_work\":true,\"price\":204}],\"price\":204,\"total_price\":204,\"aggregated_price\":302,\"$$hashKey\":\"object:5\"}]", "data"=>""}
  [1m[36mProduct Load (0.9ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (0.7ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (1.1ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.7ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (1.2ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (1.0ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.8ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.8ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.1ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  [1m[36mProductTemplateSet Load (2.9ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (1.5ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mUser Load (3.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Unpermitted parameters: second_floor_height_min, second_floor_height_max, third_floor_height_min, third_floor_height_max, discount_by_stages
  [1m[35m (2.5ms)[0m  [1m[35mBEGIN[0m
  [1m[36mClient Load (1.6ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35mSQL (9.1ms)[0m  [1m[32mINSERT INTO "estimates" ("name", "client_id", "first_floor_height", "price", "area", "discount_title", "discount_by_stages", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9) RETURNING "id"[0m  [["name", "124124"], ["client_id", 1], ["first_floor_height", #<BigDecimal:7fe5e6b60390,'0.124124E6',9(18)>], ["price", #<BigDecimal:7fe5e6b60570,'0.302E3',9(18)>], ["area", #<BigDecimal:7fe5e6b60480,'0.4214E4',9(18)>], ["discount_title", ""], ["discount_by_stages", #<struct ActiveRecord::ConnectionAdapters::PostgreSQL::OID::Array::Data encoder=#<PG::TextEncoder::Array:0x00558408c0a788 "decimal[]"  elements_type=nil needs quotation>, values=["0", "0", "0"]>], ["created_at", 2017-04-27 02:16:28 UTC], ["updated_at", 2017-04-27 02:16:28 UTC]]
  [1m[36mAudited::Audit Load (2.6ms)[0m  [1m[34mSELECT  "audits".* FROM "audits" WHERE "audits"."auditable_id" = $1 AND "audits"."auditable_type" = $2 ORDER BY "audits"."version" DESC LIMIT $3[0m  [["auditable_id", 6], ["auditable_type", "Estimate"], ["LIMIT", 1]]
  [1m[35mSQL (1.7ms)[0m  [1m[32mINSERT INTO "audits" ("auditable_id", "auditable_type", "user_id", "user_type", "action", "audited_changes", "version", "remote_address", "request_uuid", "created_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["auditable_id", 6], ["auditable_type", "Estimate"], ["user_id", 1], ["user_type", "User"], ["action", "create"], ["audited_changes", "---\nname: '124124'\nclient_id: 1\nfloors: \nfirst_floor_height: !ruby/object:BigDecimal 18:0.124124E6\nsecond_floor_height_min: !ruby/object:BigDecimal 18:0.0\nsecond_floor_height_max: !ruby/object:BigDecimal 18:0.0\nthird_floor_height_min: !ruby/object:BigDecimal 18:0.0\nthird_floor_height_max: !ruby/object:BigDecimal 18:0.0\nprice: !ruby/object:BigDecimal 18:0.302E3\narea: !ruby/object:BigDecimal 18:0.4214E4\nprice_by_area: \nprice_by_stage:\n- !ruby/object:BigDecimal 18:0.0\n- !ruby/object:BigDecimal 18:0.0\n- !ruby/object:BigDecimal 18:0.0\nprice_by_stage_aggregated:\n- !ruby/object:BigDecimal 18:0.0\n- !ruby/object:BigDecimal 18:0.0\n- !ruby/object:BigDecimal 18:0.0\nprice_by_area_per_stage:\n- !ruby/object:BigDecimal 18:0.0\n- !ruby/object:BigDecimal 18:0.0\n- !ruby/object:BigDecimal 18:0.0\ndiscount_title: ''\ndiscount_by_stages:\n- '0'\n- '0'\n- '0'\ndiscount_amount:\n- !ruby/object:BigDecimal 18:0.0\n- !ruby/object:BigDecimal 18:0.0\n- !ruby/object:BigDecimal 18:0.0\nprice_by_stage_aggregated_discounted:\n- !ruby/object:BigDecimal 18:0.0\n- !ruby/object:BigDecimal 18:0.0\n- !ruby/object:BigDecimal 18:0.0\nprice_by_area_per_stage_discounted:\n- !ruby/object:BigDecimal 18:0.0\n- !ruby/object:BigDecimal 18:0.0\n- !ruby/object:BigDecimal 18:0.0\nsigned: false\ndeleted_at: \nsigning_date: \nuser_id: \n"], ["version", 1], ["remote_address", "127.0.0.1"], ["request_uuid", "da3c7e8a-3d12-4d5f-a80e-9ee0257aa193"], ["created_at", 2017-04-27 02:16:28 UTC]]
  [1m[35m (1.7ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mStage Load (0.7ms)[0m  [1m[34mSELECT  "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1 AND "stages"."number" = $2 LIMIT $3[0m  [["estimate_id", 6], ["number", 1], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "stages" ("estimate_id", "number", "price", "total_price", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["estimate_id", 6], ["number", 1], ["price", #<BigDecimal:7fe5e5c97020,'0.205E2',18(36)>], ["total_price", #<BigDecimal:7fe5e5c96dc8,'0.205E2',18(36)>], ["created_at", 2017-04-27 02:16:28 UTC], ["updated_at", 2017-04-27 02:16:28 UTC]]
  [1m[35m (1.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mStageProduct Load (1.1ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1 AND ("stage_products"."product_id" != 1)[0m  [["stage_id", 14]]
  [1m[36mStageProduct Load (1.0ms)[0m  [1m[34mSELECT  "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1 AND "stage_products"."product_id" = $2 LIMIT $3[0m  [["stage_id", 14], ["product_id", 1], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "stage_products" ("product_id", "stage_id", "quantity", "price_with_work", "created_at", "updated_at", "with_work", "price_without_work") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["product_id", 1], ["stage_id", 14], ["quantity", 1], ["price_with_work", #<BigDecimal:7fe5f5591860,'0.7E2',9(27)>], ["created_at", 2017-04-27 02:16:34 UTC], ["updated_at", 2017-04-27 02:16:34 UTC], ["with_work", false], ["price_without_work", #<BigDecimal:7fe5f5590d98,'0.1E2',9(27)>]]
  [1m[35m (1.6ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mStage Load (0.8ms)[0m  [1m[34mSELECT  "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1 AND "stages"."number" = $2 LIMIT $3[0m  [["estimate_id", 6], ["number", 2], ["LIMIT", 1]]
  [1m[35m (1.7ms)[0m  [1m[35mBEGIN[0m
  [1m[35mSQL (3.1ms)[0m  [1m[32mINSERT INTO "stages" ("estimate_id", "number", "price", "total_price", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["estimate_id", 6], ["number", 2], ["price", #<BigDecimal:7fe5f54fc148,'0.775E2',18(36)>], ["total_price", #<BigDecimal:7fe5f54c7f10,'0.775E2',18(36)>], ["created_at", 2017-04-27 02:16:34 UTC], ["updated_at", 2017-04-27 02:16:34 UTC]]
  [1m[35m (2.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mStageProduct Load (0.8ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1 AND ("stage_products"."product_id" != 2)[0m  [["stage_id", 15]]
  [1m[36mStageProduct Load (1.5ms)[0m  [1m[34mSELECT  "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1 AND "stage_products"."product_id" = $2 LIMIT $3[0m  [["stage_id", 15], ["product_id", 2], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "stage_products" ("product_id", "stage_id", "quantity", "price_with_work", "created_at", "updated_at", "price_without_work") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["product_id", 2], ["stage_id", 15], ["quantity", 1], ["price_with_work", #<BigDecimal:7fe5e67509f8,'0.5E2',9(27)>], ["created_at", 2017-04-27 02:16:35 UTC], ["updated_at", 2017-04-27 02:16:35 UTC], ["price_without_work", #<BigDecimal:7fe5e674fe40,'0.5E2',9(27)>]]
  [1m[35m (2.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mStage Load (3.3ms)[0m  [1m[34mSELECT  "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1 AND "stages"."number" = $2 LIMIT $3[0m  [["estimate_id", 6], ["number", 3], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35mSQL (1.1ms)[0m  [1m[32mINSERT INTO "stages" ("estimate_id", "number", "price", "total_price", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["estimate_id", 6], ["number", 3], ["price", #<BigDecimal:7fe5e66e3448,'0.204E3',9(27)>], ["total_price", #<BigDecimal:7fe5e66e33a8,'0.204E3',9(36)>], ["created_at", 2017-04-27 02:16:35 UTC], ["updated_at", 2017-04-27 02:16:35 UTC]]
  [1m[35m (4.6ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mStageProduct Load (0.6ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1 AND ("stage_products"."product_id" != 3)[0m  [["stage_id", 16]]
  [1m[36mStageProduct Load (1.3ms)[0m  [1m[34mSELECT  "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1 AND "stage_products"."product_id" = $2 LIMIT $3[0m  [["stage_id", 16], ["product_id", 3], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35mSQL (1.1ms)[0m  [1m[32mINSERT INTO "stage_products" ("product_id", "stage_id", "quantity", "price_with_work", "created_at", "updated_at", "price_without_work") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["product_id", 3], ["stage_id", 16], ["quantity", 1], ["price_with_work", #<BigDecimal:7fe5e5ac8ac8,'0.8E2',9(27)>], ["created_at", 2017-04-27 02:16:36 UTC], ["updated_at", 2017-04-27 02:16:36 UTC], ["price_without_work", #<BigDecimal:7fe5e5abbf08,'0.2E2',9(27)>]]
  [1m[35m (2.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mStageProductSet Load (2.1ms)[0m  [1m[34mSELECT  "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = $1 AND "stage_product_sets"."product_set_id" = $2 LIMIT $3[0m  [["stage_product_id", 15], ["product_set_id", 1], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "stage_product_sets" ("stage_product_id", "product_set_id", "selected", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["stage_product_id", 15], ["product_set_id", 1], ["selected", true], ["created_at", 2017-04-27 02:16:36 UTC], ["updated_at", 2017-04-27 02:16:36 UTC]]
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mStageProductSetValue Load (0.7ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1 AND ("stage_product_set_values"."product_template_id" NOT IN (1, 2))[0m  [["stage_product_set_id", 5]]
  [1m[36mStageProductSetValue Load (0.9ms)[0m  [1m[34mSELECT  "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1 AND "stage_product_set_values"."product_template_id" = $2 LIMIT $3[0m  [["stage_product_set_id", 5], ["product_template_id", 1], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "stage_product_set_values" ("stage_product_set_id", "product_template_id", "constructor_object_id", "quantity", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["stage_product_set_id", 5], ["product_template_id", 1], ["constructor_object_id", 1], ["quantity", 2], ["created_at", 2017-04-27 02:16:36 UTC], ["updated_at", 2017-04-27 02:16:36 UTC]]
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mStageProductSetValue Load (0.8ms)[0m  [1m[34mSELECT  "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1 AND "stage_product_set_values"."product_template_id" = $2 LIMIT $3[0m  [["stage_product_set_id", 5], ["product_template_id", 2], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "stage_product_set_values" ("stage_product_set_id", "product_template_id", "constructor_object_id", "quantity", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["stage_product_set_id", 5], ["product_template_id", 2], ["constructor_object_id", 6], ["quantity", 1], ["created_at", 2017-04-27 02:16:36 UTC], ["updated_at", 2017-04-27 02:16:36 UTC]]
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mAudited::Audit Load (1.3ms)[0m  [1m[34mSELECT  "audits".* FROM "audits" WHERE "audits"."auditable_id" = $1 AND "audits"."auditable_type" = $2 ORDER BY "audits"."version" DESC LIMIT $3[0m  [["auditable_id", 6], ["auditable_type", "Estimate"], ["LIMIT", 1]]
  [1m[35mSQL (3.2ms)[0m  [1m[32mINSERT INTO "audits" ("auditable_id", "auditable_type", "user_id", "user_type", "action", "audited_changes", "version", "remote_address", "request_uuid", "created_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["auditable_id", 6], ["auditable_type", "Estimate"], ["user_id", 1], ["user_type", "User"], ["action", "update"], ["audited_changes", "---\nfloors:\n- \n- !ruby/object:BigDecimal 18:0.1E1\nprice_by_area:\n- \n- !ruby/object:BigDecimal 18:0.7E-1\nprice_by_stage:\n- - !ruby/object:BigDecimal 18:0.0\n  - !ruby/object:BigDecimal 18:0.0\n  - !ruby/object:BigDecimal 18:0.0\n- - !ruby/object:BigDecimal 27:0.205E2\n  - !ruby/object:BigDecimal 27:0.775E2\n  - !ruby/object:BigDecimal 18:0.204E3\nprice_by_stage_aggregated:\n- - !ruby/object:BigDecimal 18:0.0\n  - !ruby/object:BigDecimal 18:0.0\n  - !ruby/object:BigDecimal 18:0.0\n- - !ruby/object:BigDecimal 27:0.205E2\n  - !ruby/object:BigDecimal 18:0.98E2\n  - !ruby/object:BigDecimal 18:0.302E3\nprice_by_area_per_stage:\n- - !ruby/object:BigDecimal 18:0.0\n  - !ruby/object:BigDecimal 18:0.0\n  - !ruby/object:BigDecimal 18:0.0\n- - !ruby/object:BigDecimal 27:0.0\n  - !ruby/object:BigDecimal 18:0.2E-1\n  - !ruby/object:BigDecimal 18:0.7E-1\nprice_by_stage_aggregated_discounted:\n- - !ruby/object:BigDecimal 18:0.0\n  - !ruby/object:BigDecimal 18:0.0\n  - !ruby/object:BigDecimal 18:0.0\n- - !ruby/object:BigDecimal 18:0.205E2\n  - !ruby/object:BigDecimal 18:0.98E2\n  - !ruby/object:BigDecimal 18:0.302E3\nprice_by_area_per_stage_discounted:\n- - !ruby/object:BigDecimal 18:0.0\n  - !ruby/object:BigDecimal 18:0.0\n  - !ruby/object:BigDecimal 18:0.0\n- - !ruby/object:BigDecimal 27:0.0\n  - !ruby/object:BigDecimal 18:0.2E-1\n  - !ruby/object:BigDecimal 18:0.7E-1\n"], ["version", 2], ["remote_address", "127.0.0.1"], ["request_uuid", "da3c7e8a-3d12-4d5f-a80e-9ee0257aa193"], ["created_at", 2017-04-27 02:16:36 UTC]]
  [1m[35mSQL (2.2ms)[0m  [1m[33mUPDATE "estimates" SET "floors" = $1, "price_by_area" = $2, "price_by_stage" = $3, "price_by_stage_aggregated" = $4, "price_by_area_per_stage" = $5, "price_by_stage_aggregated_discounted" = $6, "price_by_area_per_stage_discounted" = $7, "updated_at" = $8 WHERE "estimates"."id" = $9[0m  [["floors", #<BigDecimal:7fe5e59829e8,'0.1E1',9(27)>], ["price_by_area", #<BigDecimal:7fe5e5982948,'0.7E-1',9(27)>], ["price_by_stage", #<struct ActiveRecord::ConnectionAdapters::PostgreSQL::OID::Array::Data encoder=#<PG::TextEncoder::Array:0x00558408c0a788 "decimal[]"  elements_type=nil needs quotation>, values=[#<BigDecimal:7fe5e598a490,'0.205E2',18(36)>, #<BigDecimal:7fe5e598a2d8,'0.775E2',18(36)>, #<BigDecimal:7fe5e598a0f8,'0.204E3',9(27)>]>], ["price_by_stage_aggregated", #<struct ActiveRecord::ConnectionAdapters::PostgreSQL::OID::Array::Data encoder=#<PG::TextEncoder::Array:0x00558408c0a788 "decimal[]"  elements_type=nil needs quotation>, values=[#<BigDecimal:7fe5e598a490,'0.205E2',18(36)>, #<BigDecimal:7fe5e598a058,'0.98E2',9(27)>, #<BigDecimal:7fe5e598a008,'0.302E3',9(18)>]>], ["price_by_area_per_stage", #<struct ActiveRecord::ConnectionAdapters::PostgreSQL::OID::Array::Data encoder=#<PG::TextEncoder::Array:0x00558408c0a788 "decimal[]"  elements_type=nil needs quotation>, values=[#<BigDecimal:7fe5e5989d10,'0.0',9(36)>, #<BigDecimal:7fe5e5989108,'0.2E-1',9(27)>, #<BigDecimal:7fe5e5988aa0,'0.7E-1',9(27)>]>], ["price_by_stage_aggregated_discounted", #<struct ActiveRecord::ConnectionAdapters::PostgreSQL::OID::Array::Data encoder=#<PG::TextEncoder::Array:0x00558408c0a788 "decimal[]"  elements_type=nil needs quotation>, values=[#<BigDecimal:7fe5e59894f0,'0.205E2',18(27)>, #<BigDecimal:7fe5e5988d20,'0.98E2',9(18)>, #<BigDecimal:7fe5e5988780,'0.302E3',9(18)>]>], ["price_by_area_per_stage_discounted", #<struct ActiveRecord::ConnectionAdapters::PostgreSQL::OID::Array::Data encoder=#<PG::TextEncoder::Array:0x00558408c0a788 "decimal[]"  elements_type=nil needs quotation>, values=[#<BigDecimal:7fe5e5989298,'0.0',9(36)>, #<BigDecimal:7fe5e5988c08,'0.2E-1',9(27)>, #<BigDecimal:7fe5e5988690,'0.7E-1',9(27)>]>], ["updated_at", 2017-04-27 02:16:36 UTC], ["id", 6]]
  [1m[35m (1.6ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (3.4ms)[0m  [1m[35mCOMMIT[0m
Redirected to http://localhost:3000/estimates
Completed 302 Found in 7862ms (ActiveRecord: 100.7ms)


Started GET "/estimates" for 127.0.0.1 at 2017-04-27 05:16:36 +0300
Processing by EstimatesController#index as HTML
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Redirected to http://localhost:3000/clients
Completed 302 Found in 3ms (ActiveRecord: 0.8ms)


Started GET "/clients" for 127.0.0.1 at 2017-04-27 05:16:36 +0300
Processing by ClientsController#index as HTML
  [1m[36mUser Load (1.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering clients/index.html.haml within layouts/application
  [1m[36mUserClient Load (1.3ms)[0m  [1m[34mSELECT "user_clients".* FROM "user_clients" INNER JOIN "clients" ON "clients"."id" = "user_clients"."client_id" AND "clients"."deleted_at" IS NULL WHERE "clients"."archived" = $1 AND (user_id = 1 and owner = true)[0m  [["archived", false]]
  [1m[36mClient Load (0.8ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" IN (1, 2, 3)[0m
  [1m[36mEstimate Load (1.0ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" IN (1, 2, 3)[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 1]]
  Rendered clients/_listing.html.haml (12.2ms)
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 2]]
  Rendered clients/_listing.html.haml (6.1ms)
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 3]]
  Rendered clients/_listing.html.haml (9.8ms)
  Rendered clients/_table.html.haml (33.3ms)
  [1m[36mUserClient Load (0.9ms)[0m  [1m[34mSELECT "user_clients".* FROM "user_clients" INNER JOIN "clients" ON "clients"."id" = "user_clients"."client_id" AND "clients"."deleted_at" IS NULL WHERE "clients"."archived" = $1 AND (user_id = 1 and owner = false)[0m  [["archived", false]]
  Rendered clients/index.html.haml within layouts/application (80.4ms)
  Rendered layouts/_header.html.haml (10.7ms)
Completed 200 OK in 584ms (Views: 556.9ms | ActiveRecord: 15.1ms)


Started GET "/estimates?client_id=1" for 127.0.0.1 at 2017-04-27 05:16:41 +0300
Processing by EstimatesController#index as HTML
  Parameters: {"client_id"=>"1"}
  [1m[36mUser Load (1.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mClient Load (0.8ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (0.8ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = 1[0m
  Rendering estimates/index.html.haml within layouts/application
  Rendered estimates/_listing.html.haml (5.0ms)
  Rendered estimates/_listing.html.haml (1.1ms)
  Rendered estimates/_listing.html.haml (1.9ms)
  [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  [1m[36mCACHE (0.1ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  Rendered estimates/index.html.haml within layouts/application (34.1ms)
  Rendered layouts/_header.html.haml (13.1ms)
Completed 200 OK in 633ms (Views: 616.2ms | ActiveRecord: 3.8ms)


Started GET "/estimates/6/edit" for 127.0.0.1 at 2017-04-27 05:16:47 +0300
Processing by EstimatesController#edit as HTML
  Parameters: {"id"=>"6"}
  [1m[36mProduct Load (3.3ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (1.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (2.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (1.4ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mProduct Load (3.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (1.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.6ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (0.8ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.5ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.5ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  [1m[36mProductTemplateSet Load (2.5ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (1.0ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (1.8ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mEstimate Load (0.8ms)[0m  [1m[34mSELECT  "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.4ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStage Load (0.6ms)[0m  [1m[34mSELECT "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1[0m  [["estimate_id", 6]]
  [1m[36mStageProduct Load (0.7ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" IN (14, 15, 16)[0m
  [1m[36mStageProduct Load (1.1ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 14]]
  [1m[36mStageProductSet Load (0.5ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 13[0m
  [1m[36mProduct Load (3.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 1[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mStageProduct Load (0.7ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 15]]
  [1m[36mStageProductSet Load (0.7ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 14[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 2[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mStageProduct Load (1.4ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 16]]
  [1m[36mStageProductSet Load (0.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 15[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 3[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mStageProductSet Load (0.7ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = $1[0m  [["stage_product_id", 15]]
  [1m[36mStageProductSetValue Load (0.7ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = 5[0m
  [1m[36mProductSet Load (0.7ms)[0m  [1m[34mSELECT  "product_sets".* FROM "product_sets" WHERE "product_sets"."deleted_at" IS NULL AND "product_sets"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStageProductSetValue Load (0.7ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1[0m  [["stage_product_set_id", 5]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  Rendering estimates/edit.html.haml within layouts/application
  [1m[36mClient Load (0.6ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (3.6ms)
  [1m[36mClientFile Load (0.8ms)[0m  [1m[34mSELECT "client_files".* FROM "client_files" WHERE "client_files"."estimate_id" = $1[0m  [["estimate_id", 6]]
  Rendered estimates/_technical_file_fields.html.haml (3.9ms)
  [1m[36mTechnicalFile Load (0.6ms)[0m  [1m[34mSELECT "technical_files".* FROM "technical_files" WHERE "technical_files"."estimate_id" = $1[0m  [["estimate_id", 6]]
  Rendered estimates/_discount.html.haml (7.5ms)
  Rendered estimates/_stages.html.haml (18.8ms)
  Rendered estimates/_form.html.haml (81.8ms)
  Rendered estimates/edit.html.haml within layouts/application (85.6ms)
  Rendered layouts/_header.html.haml (12.3ms)
Completed 200 OK in 908ms (Views: 748.8ms | ActiveRecord: 42.0ms)


Started GET "/estimates/6/edit" for 127.0.0.1 at 2017-04-27 05:18:02 +0300
Processing by EstimatesController#edit as HTML
  Parameters: {"id"=>"6"}
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (1.2ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (0.7ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.7ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (0.9ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.7ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  [1m[36mProductTemplateSet Load (0.7ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.8ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mEstimate Load (1.2ms)[0m  [1m[34mSELECT  "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.5ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStage Load (0.8ms)[0m  [1m[34mSELECT "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1[0m  [["estimate_id", 6]]
  [1m[36mStageProduct Load (0.7ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" IN (14, 15, 16)[0m
  [1m[36mStageProduct Load (0.7ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 14]]
  [1m[36mStageProductSet Load (0.7ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 13[0m
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 1[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mStageProduct Load (0.6ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 15]]
  [1m[36mStageProductSet Load (0.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 14[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 2[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mStageProduct Load (0.7ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 16]]
  [1m[36mStageProductSet Load (0.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 15[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 3[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mStageProductSet Load (0.7ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = $1[0m  [["stage_product_id", 15]]
  [1m[36mStageProductSetValue Load (0.7ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = 5[0m
  [1m[36mProductSet Load (0.8ms)[0m  [1m[34mSELECT  "product_sets".* FROM "product_sets" WHERE "product_sets"."deleted_at" IS NULL AND "product_sets"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStageProductSetValue Load (0.8ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1[0m  [["stage_product_set_id", 5]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  Rendering estimates/edit.html.haml within layouts/application
  [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (10.2ms)
  [1m[36mClientFile Load (0.7ms)[0m  [1m[34mSELECT "client_files".* FROM "client_files" WHERE "client_files"."estimate_id" = $1[0m  [["estimate_id", 6]]
  Rendered estimates/_technical_file_fields.html.haml (6.6ms)
  [1m[36mTechnicalFile Load (0.6ms)[0m  [1m[34mSELECT "technical_files".* FROM "technical_files" WHERE "technical_files"."estimate_id" = $1[0m  [["estimate_id", 6]]
  Rendered estimates/_discount.html.haml (7.7ms)
  Rendered estimates/_stages.html.haml (25.2ms)
  Rendered estimates/_form.html.haml (153.2ms)
  Rendered estimates/edit.html.haml within layouts/application (156.7ms)
  Rendered layouts/_header.html.haml (29.3ms)
Completed 200 OK in 2075ms (Views: 1605.6ms | ActiveRecord: 29.5ms)


Started PATCH "/estimates/6" for 127.0.0.1 at 2017-04-27 05:18:17 +0300
Processing by EstimatesController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"SMdSbOGOwegQBqGAuQ/2Oq8qFJJ44xts9raK8VVg5uDEdlHlu1bLiTXWPXDEjfZ61LfGcVqY6wZMmbUuRnxE8Q==", "commit"=>"Сохранить", "estimate"=>{"price"=>"272", "name"=>"Тестовая смета 2", "client_id"=>"1", "area"=>"4214", "first_floor_height"=>"124124.0", "second_floor_height_min"=>"0.0", "second_floor_height_max"=>"0.0", "third_floor_height_min"=>"0.0", "third_floor_height_max"=>"0.0", "discount_title"=>"", "discount_by_stages"=>{"0"=>"0", "1"=>"0", "2"=>"0"}}, "json_stages"=>"[{\"number\":1,\"text\":{\"name\":\"Первый этап\",\"summ\":\"Итого по первому этапу:\",\"summ_dis\":\"по первому этапу\",\"discount\":\"Итого по первому этапу со скидкой:\"},\"price\":143.5,\"total_price\":143.5,\"products\":[{\"id\":1,\"name\":\"Простой продукт 1 этап\",\"unit\":\"шт\",\"custom\":false,\"profit\":100,\"price_with_work\":70,\"price_without_work\":10,\"with_work\":true,\"quantity\":1,\"sets\":[],\"price\":143.5,\"$$hashKey\":\"object:14\"}],\"aggregated_price\":143.5,\"$$hashKey\":\"object:3\"},{\"number\":2,\"text\":{\"name\":\"Второй этап\",\"summ\":\"Итого по двум этапам:\",\"summ_dis\":\"по второму этапу\",\"discount\":\"Итого по двум этапам со скидкой:\"},\"price\":77.5,\"total_price\":77.5,\"products\":[{\"id\":2,\"name\":\"Простой продукт 2 этап\",\"unit\":\"м3\",\"custom\":false,\"profit\":50,\"price_with_work\":50,\"price_without_work\":50,\"with_work\":true,\"quantity\":1,\"sets\":[],\"price\":77.5,\"$$hashKey\":\"object:17\"}],\"aggregated_price\":221,\"$$hashKey\":\"object:4\"},{\"number\":3,\"text\":{\"name\":\"Третий этап\",\"summ\":\"Итого по трем этапам:\",\"summ_dis\":\"по третьему этапу\",\"discount\":\"Итого по трем этапам со скидкой:\"},\"price\":51,\"total_price\":51,\"products\":[{\"id\":3,\"name\":\"Конфигурируемый продукт 3 этап\",\"unit\":\"кг\",\"custom\":true,\"profit\":150,\"price_with_work\":80,\"price_without_work\":20,\"with_work\":false,\"quantity\":1,\"sets\":[{\"id\":1,\"name\":\"Сборка 1\",\"selected\":true,\"items\":[{\"id\":1,\"name\":\"Составляющая 1\",\"quantity\":2,\"value\":{\"id\":1,\"name\":\"Примитив 1\",\"unit\":\"лист\",\"price\":10,\"work_primitive\":false}},{\"id\":2,\"name\":\"Составляющая 2\",\"quantity\":1,\"value\":{\"id\":6,\"name\":\"Примитив 6\",\"unit\":\"лист\",\"price\":60,\"work_primitive\":true}}]}],\"price\":51,\"$$hashKey\":\"object:20\"}],\"aggregated_price\":272,\"$$hashKey\":\"object:5\"}]", "data"=>"", "id"=>"6"}
  [1m[36mProduct Load (2.1ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (1.1ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (0.7ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.9ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (2.3ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.8ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (3.9ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (0.9ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.7ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (2.7ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  [1m[36mProductTemplateSet Load (0.9ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (7.8ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (2.9ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mEstimate Load (1.0ms)[0m  [1m[34mSELECT  "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Unpermitted parameters: second_floor_height_min, second_floor_height_max, third_floor_height_min, third_floor_height_max, discount_by_stages
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAudited::Audit Load (1.5ms)[0m  [1m[34mSELECT  "audits".* FROM "audits" WHERE "audits"."auditable_id" = $1 AND "audits"."auditable_type" = $2 ORDER BY "audits"."version" DESC LIMIT $3[0m  [["auditable_id", 6], ["auditable_type", "Estimate"], ["LIMIT", 1]]
  [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "audits" ("auditable_id", "auditable_type", "user_id", "user_type", "action", "audited_changes", "version", "remote_address", "request_uuid", "created_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["auditable_id", 6], ["auditable_type", "Estimate"], ["user_id", 1], ["user_type", "User"], ["action", "update"], ["audited_changes", "---\nname:\n- '124124'\n- Тестовая смета 2\nprice:\n- !ruby/object:BigDecimal 18:0.302E3\n- !ruby/object:BigDecimal 18:0.272E3\n"], ["version", 3], ["remote_address", "127.0.0.1"], ["request_uuid", "318dc768-f538-447b-8d16-6e3c2822ead6"], ["created_at", 2017-04-27 02:18:18 UTC]]
  [1m[35mSQL (0.8ms)[0m  [1m[33mUPDATE "estimates" SET "name" = $1, "price" = $2, "updated_at" = $3 WHERE "estimates"."id" = $4[0m  [["name", "Тестовая смета 2"], ["price", #<BigDecimal:7fe5f8927e90,'0.272E3',9(18)>], ["updated_at", 2017-04-27 02:18:18 UTC], ["id", 6]]
  [1m[35m (1.6ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mStage Load (2.1ms)[0m  [1m[34mSELECT  "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1 AND "stages"."number" = $2 LIMIT $3[0m  [["estimate_id", 6], ["number", 1], ["LIMIT", 1]]
  [1m[35m (0.8ms)[0m  [1m[35mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  [1m[33mUPDATE "stages" SET "price" = $1, "total_price" = $2, "updated_at" = $3 WHERE "stages"."id" = $4[0m  [["price", #<BigDecimal:7fe5f8647720,'0.1435E3',18(36)>], ["total_price", #<BigDecimal:7fe5f86473d8,'0.1435E3',18(36)>], ["updated_at", 2017-04-27 02:18:18 UTC], ["id", 14]]
  [1m[35m (1.6ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mStageProduct Load (3.9ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1 AND ("stage_products"."product_id" != 1)[0m  [["stage_id", 14]]
  [1m[36mStageProduct Load (0.7ms)[0m  [1m[34mSELECT  "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1 AND "stage_products"."product_id" = $2 LIMIT $3[0m  [["stage_id", 14], ["product_id", 1], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[35mSQL (2.7ms)[0m  [1m[33mUPDATE "stage_products" SET "with_work" = $1, "updated_at" = $2 WHERE "stage_products"."id" = $3[0m  [["with_work", true], ["updated_at", 2017-04-27 02:18:18 UTC], ["id", 13]]
  [1m[35m (2.8ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mStage Load (1.7ms)[0m  [1m[34mSELECT  "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1 AND "stages"."number" = $2 LIMIT $3[0m  [["estimate_id", 6], ["number", 2], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mStageProduct Load (2.8ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1 AND ("stage_products"."product_id" != 2)[0m  [["stage_id", 15]]
  [1m[36mStageProduct Load (3.2ms)[0m  [1m[34mSELECT  "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1 AND "stage_products"."product_id" = $2 LIMIT $3[0m  [["stage_id", 15], ["product_id", 2], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mStage Load (0.7ms)[0m  [1m[34mSELECT  "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1 AND "stages"."number" = $2 LIMIT $3[0m  [["estimate_id", 6], ["number", 3], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35mSQL (1.2ms)[0m  [1m[33mUPDATE "stages" SET "price" = $1, "total_price" = $2, "updated_at" = $3 WHERE "stages"."id" = $4[0m  [["price", #<BigDecimal:55840d9c75c0,'0.51E2',9(27)>], ["total_price", #<BigDecimal:55840d9c7390,'0.51E2',9(36)>], ["updated_at", 2017-04-27 02:18:18 UTC], ["id", 16]]
  [1m[35m (1.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mStageProduct Load (0.7ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1 AND ("stage_products"."product_id" != 3)[0m  [["stage_id", 16]]
  [1m[36mStageProduct Load (0.7ms)[0m  [1m[34mSELECT  "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1 AND "stage_products"."product_id" = $2 LIMIT $3[0m  [["stage_id", 16], ["product_id", 3], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35mSQL (3.4ms)[0m  [1m[33mUPDATE "stage_products" SET "with_work" = $1, "updated_at" = $2 WHERE "stage_products"."id" = $3[0m  [["with_work", false], ["updated_at", 2017-04-27 02:18:18 UTC], ["id", 15]]
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mStageProductSet Load (2.1ms)[0m  [1m[34mSELECT  "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = $1 AND "stage_product_sets"."product_set_id" = $2 LIMIT $3[0m  [["stage_product_id", 15], ["product_set_id", 1], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.6ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mStageProductSetValue Load (2.0ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1 AND ("stage_product_set_values"."product_template_id" NOT IN (1, 2))[0m  [["stage_product_set_id", 5]]
  [1m[36mStageProductSetValue Load (0.7ms)[0m  [1m[34mSELECT  "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1 AND "stage_product_set_values"."product_template_id" = $2 LIMIT $3[0m  [["stage_product_set_id", 5], ["product_template_id", 1], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mStageProductSetValue Load (0.7ms)[0m  [1m[34mSELECT  "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1 AND "stage_product_set_values"."product_template_id" = $2 LIMIT $3[0m  [["stage_product_set_id", 5], ["product_template_id", 2], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[36mAudited::Audit Load (0.7ms)[0m  [1m[34mSELECT  "audits".* FROM "audits" WHERE "audits"."auditable_id" = $1 AND "audits"."auditable_type" = $2 ORDER BY "audits"."version" DESC LIMIT $3[0m  [["auditable_id", 6], ["auditable_type", "Estimate"], ["LIMIT", 1]]
  [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "audits" ("auditable_id", "auditable_type", "user_id", "user_type", "action", "audited_changes", "version", "remote_address", "request_uuid", "created_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["auditable_id", 6], ["auditable_type", "Estimate"], ["user_id", 1], ["user_type", "User"], ["action", "update"], ["audited_changes", "---\nprice_by_area:\n- !ruby/object:BigDecimal 18:0.7E-1\n- !ruby/object:BigDecimal 18:0.6E-1\nprice_by_stage:\n- - !ruby/object:BigDecimal 18:0.205E2\n  - !ruby/object:BigDecimal 18:0.775E2\n  - !ruby/object:BigDecimal 18:0.204E3\n- - !ruby/object:BigDecimal 27:0.1435E3\n  - !ruby/object:BigDecimal 27:0.775E2\n  - !ruby/object:BigDecimal 18:0.51E2\nprice_by_stage_aggregated:\n- - !ruby/object:BigDecimal 18:0.205E2\n  - !ruby/object:BigDecimal 18:0.98E2\n  - !ruby/object:BigDecimal 18:0.302E3\n- - !ruby/object:BigDecimal 27:0.1435E3\n  - !ruby/object:BigDecimal 18:0.221E3\n  - !ruby/object:BigDecimal 18:0.272E3\nprice_by_area_per_stage:\n- - !ruby/object:BigDecimal 18:0.0\n  - !ruby/object:BigDecimal 18:0.2E-1\n  - !ruby/object:BigDecimal 18:0.7E-1\n- - !ruby/object:BigDecimal 27:0.3E-1\n  - !ruby/object:BigDecimal 18:0.5E-1\n  - !ruby/object:BigDecimal 18:0.6E-1\nprice_by_stage_aggregated_discounted:\n- - !ruby/object:BigDecimal 18:0.205E2\n  - !ruby/object:BigDecimal 18:0.98E2\n  - !ruby/object:BigDecimal 18:0.302E3\n- - !ruby/object:BigDecimal 18:0.1435E3\n  - !ruby/object:BigDecimal 18:0.221E3\n  - !ruby/object:BigDecimal 18:0.272E3\nprice_by_area_per_stage_discounted:\n- - !ruby/object:BigDecimal 18:0.0\n  - !ruby/object:BigDecimal 18:0.2E-1\n  - !ruby/object:BigDecimal 18:0.7E-1\n- - !ruby/object:BigDecimal 27:0.3E-1\n  - !ruby/object:BigDecimal 18:0.5E-1\n  - !ruby/object:BigDecimal 18:0.6E-1\n"], ["version", 4], ["remote_address", "127.0.0.1"], ["request_uuid", "318dc768-f538-447b-8d16-6e3c2822ead6"], ["created_at", 2017-04-27 02:18:18 UTC]]
  [1m[35mSQL (2.0ms)[0m  [1m[33mUPDATE "estimates" SET "price_by_area" = $1, "price_by_stage" = $2, "price_by_stage_aggregated" = $3, "price_by_area_per_stage" = $4, "price_by_stage_aggregated_discounted" = $5, "price_by_area_per_stage_discounted" = $6, "updated_at" = $7 WHERE "estimates"."id" = $8[0m  [["price_by_area", #<BigDecimal:55840d80fb88,'0.6E-1',9(27)>], ["price_by_stage", #<struct ActiveRecord::ConnectionAdapters::PostgreSQL::OID::Array::Data encoder=#<PG::TextEncoder::Array:0x00558408c0a788 "decimal[]"  elements_type=nil needs quotation>, values=[#<BigDecimal:55840d842718,'0.1435E3',18(36)>, #<BigDecimal:55840d8407b0,'0.775E2',18(36)>, #<BigDecimal:55840d83fa40,'0.51E2',9(27)>]>], ["price_by_stage_aggregated", #<struct ActiveRecord::ConnectionAdapters::PostgreSQL::OID::Array::Data encoder=#<PG::TextEncoder::Array:0x00558408c0a788 "decimal[]"  elements_type=nil needs quotation>, values=[#<BigDecimal:55840d842718,'0.1435E3',18(36)>, #<BigDecimal:55840d83f7e8,'0.221E3',9(27)>, #<BigDecimal:55840d83f798,'0.272E3',9(18)>]>], ["price_by_area_per_stage", #<struct ActiveRecord::ConnectionAdapters::PostgreSQL::OID::Array::Data encoder=#<PG::TextEncoder::Array:0x00558408c0a788 "decimal[]"  elements_type=nil needs quotation>, values=[#<BigDecimal:55840d83e6e0,'0.3E-1',9(36)>, #<BigDecimal:55840d83b238,'0.5E-1',9(27)>, #<BigDecimal:55840d839460,'0.6E-1',9(27)>]>], ["price_by_stage_aggregated_discounted", #<struct ActiveRecord::ConnectionAdapters::PostgreSQL::OID::Array::Data encoder=#<PG::TextEncoder::Array:0x00558408c0a788 "decimal[]"  elements_type=nil needs quotation>, values=[#<BigDecimal:55840d83c070,'0.1435E3',18(27)>, #<BigDecimal:55840d83a4c8,'0.221E3',9(18)>, #<BigDecimal:55840d82bdb0,'0.272E3',9(18)>]>], ["price_by_area_per_stage_discounted", #<struct ActiveRecord::ConnectionAdapters::PostgreSQL::OID::Array::Data encoder=#<PG::TextEncoder::Array:0x00558408c0a788 "decimal[]"  elements_type=nil needs quotation>, values=[#<BigDecimal:55840d83b5f8,'0.3E-1',9(36)>, #<BigDecimal:55840d839fa0,'0.5E-1',9(27)>, #<BigDecimal:55840d82b9c8,'0.6E-1',9(27)>]>], ["updated_at", 2017-04-27 02:18:18 UTC], ["id", 6]]
  [1m[35m (3.8ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.6ms)[0m  [1m[35mCOMMIT[0m
Redirected to http://localhost:3000/estimates
Completed 302 Found in 325ms (ActiveRecord: 91.0ms)


Started GET "/estimates" for 127.0.0.1 at 2017-04-27 05:18:18 +0300
Processing by EstimatesController#index as HTML
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Redirected to http://localhost:3000/clients
Completed 302 Found in 7ms (ActiveRecord: 0.8ms)


Started GET "/clients" for 127.0.0.1 at 2017-04-27 05:18:18 +0300
Processing by ClientsController#index as HTML
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering clients/index.html.haml within layouts/application
  [1m[36mUserClient Load (1.2ms)[0m  [1m[34mSELECT "user_clients".* FROM "user_clients" INNER JOIN "clients" ON "clients"."id" = "user_clients"."client_id" AND "clients"."deleted_at" IS NULL WHERE "clients"."archived" = $1 AND (user_id = 1 and owner = true)[0m  [["archived", false]]
  [1m[36mClient Load (2.8ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" IN (1, 2, 3)[0m
  [1m[36mEstimate Load (1.1ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" IN (1, 2, 3)[0m
  [1m[35m (1.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 1]]
  Rendered clients/_listing.html.haml (11.5ms)
  [1m[35m (2.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 2]]
  Rendered clients/_listing.html.haml (6.5ms)
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 3]]
  Rendered clients/_listing.html.haml (5.3ms)
  Rendered clients/_table.html.haml (28.2ms)
  [1m[36mUserClient Load (1.0ms)[0m  [1m[34mSELECT "user_clients".* FROM "user_clients" INNER JOIN "clients" ON "clients"."id" = "user_clients"."client_id" AND "clients"."deleted_at" IS NULL WHERE "clients"."archived" = $1 AND (user_id = 1 and owner = false)[0m  [["archived", false]]
  Rendered clients/index.html.haml within layouts/application (71.9ms)
  Rendered layouts/_header.html.haml (18.1ms)
Completed 200 OK in 831ms (Views: 797.5ms | ActiveRecord: 17.7ms)


Started GET "/estimates?client_id=1" for 127.0.0.1 at 2017-04-27 05:18:58 +0300
Processing by EstimatesController#index as HTML
  Parameters: {"client_id"=>"1"}
  [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (1.0ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = 1[0m
  Rendering estimates/index.html.haml within layouts/application
  Rendered estimates/_listing.html.haml (9.6ms)
  Rendered estimates/_listing.html.haml (1.4ms)
  Rendered estimates/_listing.html.haml (3.1ms)
  [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  Rendered estimates/index.html.haml within layouts/application (42.5ms)
  Rendered layouts/_header.html.haml (65.9ms)
Completed 200 OK in 925ms (Views: 757.8ms | ActiveRecord: 24.5ms)


Started GET "/estimates/6/edit" for 127.0.0.1 at 2017-04-27 05:19:03 +0300
Processing by EstimatesController#edit as HTML
  Parameters: {"id"=>"6"}
  [1m[36mProduct Load (1.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (0.7ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mProduct Load (1.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (2.4ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.6ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.6ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (0.9ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (1.0ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.5ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mUnit Load (0.5ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  [1m[36mProductTemplateSet Load (0.6ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (1.2ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.7ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mEstimate Load (4.5ms)[0m  [1m[34mSELECT  "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mExpense Load (0.5ms)[0m  [1m[34mSELECT  "expenses".* FROM "expenses" WHERE "expenses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStage Load (0.7ms)[0m  [1m[34mSELECT "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1[0m  [["estimate_id", 6]]
  [1m[36mStageProduct Load (0.6ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" IN (14, 15, 16)[0m
  [1m[36mStageProduct Load (0.8ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 14]]
  [1m[36mStageProductSet Load (0.6ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 13[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 1[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mStageProduct Load (3.4ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 15]]
  [1m[36mStageProductSet Load (1.2ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 14[0m
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 2[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mStageProduct Load (0.6ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1[0m  [["stage_id", 16]]
  [1m[36mStageProductSet Load (0.7ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = 15[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."id" = 3[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mStageProductSet Load (0.7ms)[0m  [1m[34mSELECT "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = $1[0m  [["stage_product_id", 15]]
  [1m[36mStageProductSetValue Load (0.9ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = 5[0m
  [1m[36mProductSet Load (1.5ms)[0m  [1m[34mSELECT  "product_sets".* FROM "product_sets" WHERE "product_sets"."deleted_at" IS NULL AND "product_sets"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mStageProductSetValue Load (0.7ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1[0m  [["stage_product_set_id", 5]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  Rendering estimates/edit.html.haml within layouts/application
  [1m[36mClient Load (1.1ms)[0m  [1m[34mSELECT "clients"."id", "clients"."first_name", "clients"."last_name", "clients"."middle_name" FROM "clients" WHERE "clients"."deleted_at" IS NULL[0m
  Rendered estimates/_client_file_fields.html.haml (14.4ms)
  [1m[36mClientFile Load (0.8ms)[0m  [1m[34mSELECT "client_files".* FROM "client_files" WHERE "client_files"."estimate_id" = $1[0m  [["estimate_id", 6]]
  Rendered estimates/_technical_file_fields.html.haml (5.9ms)
  [1m[36mTechnicalFile Load (0.7ms)[0m  [1m[34mSELECT "technical_files".* FROM "technical_files" WHERE "technical_files"."estimate_id" = $1[0m  [["estimate_id", 6]]
  Rendered estimates/_discount.html.haml (7.2ms)
  Rendered estimates/_stages.html.haml (21.1ms)
  Rendered estimates/_form.html.haml (128.9ms)
  Rendered estimates/edit.html.haml within layouts/application (132.2ms)
  Rendered layouts/_header.html.haml (10.3ms)
Completed 200 OK in 1155ms (Views: 719.4ms | ActiveRecord: 116.5ms)


Started PATCH "/estimates/6" for 127.0.0.1 at 2017-04-27 05:19:15 +0300
Processing by EstimatesController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"pGy0V4Lbi0uJg42zHKnmGxwA5EL2n/lKkQIFGGj8YRQo3bfe2AOBKqxTEUNhK+ZbZ502odTkCSArLTrHe+DDBQ==", "commit"=>"Сохранить", "estimate"=>{"price"=>"425", "name"=>"Тестовая смета 2", "client_id"=>"1", "area"=>"4214", "first_floor_height"=>"124124.0", "second_floor_height_min"=>"0.0", "second_floor_height_max"=>"0.0", "third_floor_height_min"=>"0.0", "third_floor_height_max"=>"0.0", "discount_title"=>"", "discount_by_stages"=>{"0"=>"0", "1"=>"0", "2"=>"0"}}, "json_stages"=>"[{\"number\":1,\"text\":{\"name\":\"Первый этап\",\"summ\":\"Итого по первому этапу:\",\"summ_dis\":\"по первому этапу\",\"discount\":\"Итого по первому этапу со скидкой:\"},\"price\":143.5,\"total_price\":143.5,\"products\":[{\"id\":1,\"name\":\"Простой продукт 1 этап\",\"unit\":\"шт\",\"custom\":false,\"profit\":100,\"price_with_work\":70,\"price_without_work\":10,\"with_work\":true,\"quantity\":1,\"sets\":[],\"price\":143.5,\"$$hashKey\":\"object:15\"}],\"aggregated_price\":143.5,\"$$hashKey\":\"object:4\"},{\"number\":2,\"text\":{\"name\":\"Второй этап\",\"summ\":\"Итого по двум этапам:\",\"summ_dis\":\"по второму этапу\",\"discount\":\"Итого по двум этапам со скидкой:\"},\"price\":77.5,\"total_price\":77.5,\"products\":[{\"id\":2,\"name\":\"Простой продукт 2 этап\",\"unit\":\"м3\",\"custom\":false,\"profit\":50,\"price_with_work\":50,\"price_without_work\":50,\"with_work\":true,\"quantity\":1,\"sets\":[],\"price\":77.5,\"$$hashKey\":\"object:18\"}],\"aggregated_price\":221,\"$$hashKey\":\"object:5\"},{\"number\":3,\"text\":{\"name\":\"Третий этап\",\"summ\":\"Итого по трем этапам:\",\"summ_dis\":\"по третьему этапу\",\"discount\":\"Итого по трем этапам со скидкой:\"},\"price\":204,\"total_price\":204,\"products\":[{\"id\":3,\"name\":\"Конфигурируемый продукт 3 этап\",\"unit\":\"кг\",\"custom\":true,\"profit\":150,\"price_with_work\":80,\"price_without_work\":20,\"with_work\":true,\"quantity\":1,\"sets\":[{\"id\":1,\"name\":\"Сборка 1\",\"selected\":true,\"items\":[{\"id\":1,\"name\":\"Составляющая 1\",\"quantity\":2,\"value\":{\"id\":1,\"name\":\"Примитив 1\",\"unit\":\"лист\",\"price\":10,\"work_primitive\":false}},{\"id\":2,\"name\":\"Составляющая 2\",\"quantity\":1,\"value\":{\"id\":6,\"name\":\"Примитив 6\",\"unit\":\"лист\",\"price\":60,\"work_primitive\":true}}]}],\"price\":204,\"$$hashKey\":\"object:21\"}],\"aggregated_price\":425,\"$$hashKey\":\"object:6\"}]", "data"=>"", "id"=>"6"}
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 1]]
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 1[0m
  [1m[36mProductComposition Load (1.8ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mConstructorObject Load (1.2ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 2]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 3[0m
  [1m[36mProductComposition Load (0.6ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "product_compositions".* FROM "product_compositions" WHERE "product_compositions"."deleted_at" IS NULL AND "product_compositions"."product_id" = $1[0m  [["product_id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (2, 3)[0m
  [1m[36mProduct Load (1.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."deleted_at" IS NULL AND "products"."stage" = $1[0m  [["stage", 3]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 5[0m
  [1m[36mProductSet Load (1.2ms)[0m  [1m[34mSELECT DISTINCT "product_sets".* FROM "product_sets" INNER JOIN "product_template_sets" ON "product_sets"."id" = "product_template_sets"."product_set_id" WHERE "product_sets"."deleted_at" IS NULL AND "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_id" = $1[0m  [["product_id", 3]]
  [1m[36mProductTemplateSet Load (0.5ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = 1[0m
  [1m[36mProductTemplate Load (0.6ms)[0m  [1m[34mSELECT "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" IN (1, 2)[0m
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" IN (1, 6)[0m
  [1m[36mUnit Load (0.6ms)[0m  [1m[34mSELECT "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = 6[0m
  [1m[36mProductTemplateSet Load (0.8ms)[0m  [1m[34mSELECT "product_template_sets".* FROM "product_template_sets" WHERE "product_template_sets"."deleted_at" IS NULL AND "product_template_sets"."product_set_id" = $1 AND "product_template_sets"."product_id" = 3[0m  [["product_set_id", 1]]
  [1m[36mProductTemplate Load (1.1ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.8ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUnit Load (0.7ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mProductTemplate Load (0.9ms)[0m  [1m[34mSELECT  "product_templates".* FROM "product_templates" WHERE "product_templates"."deleted_at" IS NULL AND "product_templates"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mConstructorObject Load (0.7ms)[0m  [1m[34mSELECT  "constructor_objects".* FROM "constructor_objects" WHERE "constructor_objects"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT  "units".* FROM "units" WHERE "units"."deleted_at" IS NULL AND "units"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mEstimate Load (5.3ms)[0m  [1m[34mSELECT  "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mUser Load (4.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Unpermitted parameters: second_floor_height_min, second_floor_height_max, third_floor_height_min, third_floor_height_max, discount_by_stages
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mClient Load (0.9ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAudited::Audit Load (2.3ms)[0m  [1m[34mSELECT  "audits".* FROM "audits" WHERE "audits"."auditable_id" = $1 AND "audits"."auditable_type" = $2 ORDER BY "audits"."version" DESC LIMIT $3[0m  [["auditable_id", 6], ["auditable_type", "Estimate"], ["LIMIT", 1]]
  [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "audits" ("auditable_id", "auditable_type", "user_id", "user_type", "action", "audited_changes", "version", "remote_address", "request_uuid", "created_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["auditable_id", 6], ["auditable_type", "Estimate"], ["user_id", 1], ["user_type", "User"], ["action", "update"], ["audited_changes", "---\nprice:\n- !ruby/object:BigDecimal 18:0.272E3\n- !ruby/object:BigDecimal 18:0.425E3\n"], ["version", 5], ["remote_address", "127.0.0.1"], ["request_uuid", "c4b49c5b-73e6-48fe-979b-68cb51b42de2"], ["created_at", 2017-04-27 02:19:15 UTC]]
  [1m[35mSQL (1.0ms)[0m  [1m[33mUPDATE "estimates" SET "price" = $1, "updated_at" = $2 WHERE "estimates"."id" = $3[0m  [["price", #<BigDecimal:7fe5e51a0928,'0.425E3',9(18)>], ["updated_at", 2017-04-27 02:19:15 UTC], ["id", 6]]
  [1m[35m (4.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mStage Load (0.9ms)[0m  [1m[34mSELECT  "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1 AND "stages"."number" = $2 LIMIT $3[0m  [["estimate_id", 6], ["number", 1], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mStageProduct Load (1.0ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1 AND ("stage_products"."product_id" != 1)[0m  [["stage_id", 14]]
  [1m[36mStageProduct Load (0.7ms)[0m  [1m[34mSELECT  "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1 AND "stage_products"."product_id" = $2 LIMIT $3[0m  [["stage_id", 14], ["product_id", 1], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mStage Load (1.2ms)[0m  [1m[34mSELECT  "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1 AND "stages"."number" = $2 LIMIT $3[0m  [["estimate_id", 6], ["number", 2], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mStageProduct Load (0.7ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1 AND ("stage_products"."product_id" != 2)[0m  [["stage_id", 15]]
  [1m[36mStageProduct Load (5.1ms)[0m  [1m[34mSELECT  "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1 AND "stage_products"."product_id" = $2 LIMIT $3[0m  [["stage_id", 15], ["product_id", 2], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mStage Load (0.7ms)[0m  [1m[34mSELECT  "stages".* FROM "stages" WHERE "stages"."estimate_id" = $1 AND "stages"."number" = $2 LIMIT $3[0m  [["estimate_id", 6], ["number", 3], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  [1m[33mUPDATE "stages" SET "price" = $1, "total_price" = $2, "updated_at" = $3 WHERE "stages"."id" = $4[0m  [["price", #<BigDecimal:7fe5e590a150,'0.204E3',9(27)>], ["total_price", #<BigDecimal:7fe5e5909f98,'0.204E3',9(36)>], ["updated_at", 2017-04-27 02:19:15 UTC], ["id", 16]]
  [1m[35m (3.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mStageProduct Load (0.7ms)[0m  [1m[34mSELECT "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1 AND ("stage_products"."product_id" != 3)[0m  [["stage_id", 16]]
  [1m[36mStageProduct Load (1.1ms)[0m  [1m[34mSELECT  "stage_products".* FROM "stage_products" WHERE "stage_products"."stage_id" = $1 AND "stage_products"."product_id" = $2 LIMIT $3[0m  [["stage_id", 16], ["product_id", 3], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  [1m[33mUPDATE "stage_products" SET "with_work" = $1, "updated_at" = $2 WHERE "stage_products"."id" = $3[0m  [["with_work", true], ["updated_at", 2017-04-27 02:19:15 UTC], ["id", 15]]
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mStageProductSet Load (0.8ms)[0m  [1m[34mSELECT  "stage_product_sets".* FROM "stage_product_sets" WHERE "stage_product_sets"."stage_product_id" = $1 AND "stage_product_sets"."product_set_id" = $2 LIMIT $3[0m  [["stage_product_id", 15], ["product_set_id", 1], ["LIMIT", 1]]
  [1m[35m (1.6ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mStageProductSetValue Load (1.1ms)[0m  [1m[34mSELECT "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1 AND ("stage_product_set_values"."product_template_id" NOT IN (1, 2))[0m  [["stage_product_set_id", 5]]
  [1m[36mStageProductSetValue Load (0.8ms)[0m  [1m[34mSELECT  "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1 AND "stage_product_set_values"."product_template_id" = $2 LIMIT $3[0m  [["stage_product_set_id", 5], ["product_template_id", 1], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mStageProductSetValue Load (1.0ms)[0m  [1m[34mSELECT  "stage_product_set_values".* FROM "stage_product_set_values" WHERE "stage_product_set_values"."stage_product_set_id" = $1 AND "stage_product_set_values"."product_template_id" = $2 LIMIT $3[0m  [["stage_product_set_id", 5], ["product_template_id", 2], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (2.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (2.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mAudited::Audit Load (1.0ms)[0m  [1m[34mSELECT  "audits".* FROM "audits" WHERE "audits"."auditable_id" = $1 AND "audits"."auditable_type" = $2 ORDER BY "audits"."version" DESC LIMIT $3[0m  [["auditable_id", 6], ["auditable_type", "Estimate"], ["LIMIT", 1]]
  [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "audits" ("auditable_id", "auditable_type", "user_id", "user_type", "action", "audited_changes", "version", "remote_address", "request_uuid", "created_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["auditable_id", 6], ["auditable_type", "Estimate"], ["user_id", 1], ["user_type", "User"], ["action", "update"], ["audited_changes", "---\nprice_by_area:\n- !ruby/object:BigDecimal 18:0.6E-1\n- !ruby/object:BigDecimal 18:0.1E0\nprice_by_stage:\n- - !ruby/object:BigDecimal 18:0.1435E3\n  - !ruby/object:BigDecimal 18:0.775E2\n  - !ruby/object:BigDecimal 18:0.51E2\n- - !ruby/object:BigDecimal 27:0.1435E3\n  - !ruby/object:BigDecimal 27:0.775E2\n  - !ruby/object:BigDecimal 18:0.204E3\nprice_by_stage_aggregated:\n- - !ruby/object:BigDecimal 18:0.1435E3\n  - !ruby/object:BigDecimal 18:0.221E3\n  - !ruby/object:BigDecimal 18:0.272E3\n- - !ruby/object:BigDecimal 27:0.1435E3\n  - !ruby/object:BigDecimal 18:0.221E3\n  - !ruby/object:BigDecimal 18:0.425E3\nprice_by_area_per_stage:\n- - !ruby/object:BigDecimal 18:0.3E-1\n  - !ruby/object:BigDecimal 18:0.5E-1\n  - !ruby/object:BigDecimal 18:0.6E-1\n- - !ruby/object:BigDecimal 27:0.3E-1\n  - !ruby/object:BigDecimal 18:0.5E-1\n  - !ruby/object:BigDecimal 18:0.1E0\nprice_by_stage_aggregated_discounted:\n- - !ruby/object:BigDecimal 18:0.1435E3\n  - !ruby/object:BigDecimal 18:0.221E3\n  - !ruby/object:BigDecimal 18:0.272E3\n- - !ruby/object:BigDecimal 18:0.1435E3\n  - !ruby/object:BigDecimal 18:0.221E3\n  - !ruby/object:BigDecimal 18:0.425E3\nprice_by_area_per_stage_discounted:\n- - !ruby/object:BigDecimal 18:0.3E-1\n  - !ruby/object:BigDecimal 18:0.5E-1\n  - !ruby/object:BigDecimal 18:0.6E-1\n- - !ruby/object:BigDecimal 27:0.3E-1\n  - !ruby/object:BigDecimal 18:0.5E-1\n  - !ruby/object:BigDecimal 18:0.1E0\n"], ["version", 6], ["remote_address", "127.0.0.1"], ["request_uuid", "c4b49c5b-73e6-48fe-979b-68cb51b42de2"], ["created_at", 2017-04-27 02:19:15 UTC]]
  [1m[35mSQL (0.9ms)[0m  [1m[33mUPDATE "estimates" SET "price_by_area" = $1, "price_by_stage" = $2, "price_by_stage_aggregated" = $3, "price_by_area_per_stage" = $4, "price_by_stage_aggregated_discounted" = $5, "price_by_area_per_stage_discounted" = $6, "updated_at" = $7 WHERE "estimates"."id" = $8[0m  [["price_by_area", #<BigDecimal:7fe5e5917ee0,'0.1E0',9(27)>], ["price_by_stage", #<struct ActiveRecord::ConnectionAdapters::PostgreSQL::OID::Array::Data encoder=#<PG::TextEncoder::Array:0x00558408c0a788 "decimal[]"  elements_type=nil needs quotation>, values=[#<BigDecimal:7fe5e5fb3ab0,'0.1435E3',18(36)>, #<BigDecimal:7fe5e5fb38d0,'0.775E2',18(36)>, #<BigDecimal:7fe5e5fb36f0,'0.204E3',9(27)>]>], ["price_by_stage_aggregated", #<struct ActiveRecord::ConnectionAdapters::PostgreSQL::OID::Array::Data encoder=#<PG::TextEncoder::Array:0x00558408c0a788 "decimal[]"  elements_type=nil needs quotation>, values=[#<BigDecimal:7fe5e5fb3ab0,'0.1435E3',18(36)>, #<BigDecimal:7fe5e5fb3678,'0.221E3',9(27)>, #<BigDecimal:7fe5e5fb3600,'0.425E3',9(18)>]>], ["price_by_area_per_stage", #<struct ActiveRecord::ConnectionAdapters::PostgreSQL::OID::Array::Data encoder=#<PG::TextEncoder::Array:0x00558408c0a788 "decimal[]"  elements_type=nil needs quotation>, values=[#<BigDecimal:7fe5e5fb3358,'0.3E-1',9(36)>, #<BigDecimal:7fe5e5fb29a8,'0.5E-1',9(27)>, #<BigDecimal:7fe5e5fb23b8,'0.1E0',9(27)>]>], ["price_by_stage_aggregated_discounted", #<struct ActiveRecord::ConnectionAdapters::PostgreSQL::OID::Array::Data encoder=#<PG::TextEncoder::Array:0x00558408c0a788 "decimal[]"  elements_type=nil needs quotation>, values=[#<BigDecimal:7fe5e5fb2d40,'0.1435E3',18(27)>, #<BigDecimal:7fe5e5fb2638,'0.221E3',9(18)>, #<BigDecimal:7fe5e5fb2020,'0.425E3',9(18)>]>], ["price_by_area_per_stage_discounted", #<struct ActiveRecord::ConnectionAdapters::PostgreSQL::OID::Array::Data encoder=#<PG::TextEncoder::Array:0x00558408c0a788 "decimal[]"  elements_type=nil needs quotation>, values=[#<BigDecimal:7fe5e5fb2b10,'0.3E-1',9(36)>, #<BigDecimal:7fe5e5fb2520,'0.5E-1',9(27)>, #<BigDecimal:7fe5e5fb1f08,'0.1E0',9(27)>]>], ["updated_at", 2017-04-27 02:19:15 UTC], ["id", 6]]
  [1m[35m (3.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.6ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
Redirected to http://localhost:3000/estimates?client_id=1
Completed 302 Found in 329ms (ActiveRecord: 76.5ms)


Started GET "/estimates?client_id=1" for 127.0.0.1 at 2017-04-27 05:19:15 +0300
Processing by EstimatesController#index as HTML
  Parameters: {"client_id"=>"1"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mClient Load (2.3ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (0.9ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = 1[0m
  Rendering estimates/index.html.haml within layouts/application
  Rendered estimates/_listing.html.haml (4.8ms)
  Rendered estimates/_listing.html.haml (1.4ms)
  Rendered estimates/_listing.html.haml (2.3ms)
  [1m[36mClient Load (0.6ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  Rendered estimates/index.html.haml within layouts/application (27.8ms)
  Rendered layouts/_header.html.haml (8.7ms)
Completed 200 OK in 597ms (Views: 580.4ms | ActiveRecord: 4.4ms)


Started GET "/estimates?client_id=1" for 127.0.0.1 at 2017-04-27 05:21:54 +0300
Processing by EstimatesController#index as HTML
  Parameters: {"client_id"=>"1"}
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mClient Load (3.3ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (1.8ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = 1[0m
  Rendering estimates/index.html.haml within layouts/application
  Rendered estimates/_listing.html.haml (4.9ms)
  Rendered estimates/_listing.html.haml (1.4ms)
  Rendered estimates/_listing.html.haml (3.6ms)
  [1m[36mClient Load (2.5ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  Rendered estimates/index.html.haml within layouts/application (34.2ms)
Completed 500 Internal Server Error in 294ms (ActiveRecord: 8.7ms)


  
ActionView::Template::Error (SyntaxError: [stdin]:10:26: missing )):
     5:     %title Конструктор сметы - Арт СИП Строй
     6:     = csrf_meta_tags
     7:     = stylesheet_link_tag    'application', media: 'all', 'data-turbolinks-track': 'reload'
     8:     = javascript_include_tag 'application', 'data-turbolinks-track': 'reload'
     9: 
    10:   %body
    11:     = render 'layouts/header'
  
app/views/layouts/application.html.haml:8:in `_app_views_layouts_application_html_haml__2534857530032057850_70312850740520'
app/controllers/application_controller.rb:8:in `render'
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/template_error.html.erb within rescues/layout
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_source.html.erb
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_source.html.erb (9.5ms)
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (3.6ms)
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_request_and_response.html.erb
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_request_and_response.html.erb (1.2ms)
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/template_error.html.erb within rescues/layout (42.0ms)
Started GET "/estimates?client_id=1" for 127.0.0.1 at 2017-04-27 05:22:20 +0300
Processing by EstimatesController#index as HTML
  Parameters: {"client_id"=>"1"}
  [1m[36mUser Load (1.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mClient Load (2.0ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (1.3ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = 1[0m
  Rendering estimates/index.html.haml within layouts/application
  Rendered estimates/_listing.html.haml (7.2ms)
  Rendered estimates/_listing.html.haml (1.3ms)
  Rendered estimates/_listing.html.haml (1.2ms)
  [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  Rendered estimates/index.html.haml within layouts/application (39.2ms)
Completed 500 Internal Server Error in 314ms (ActiveRecord: 5.3ms)


  
ActionView::Template::Error (SyntaxError: [stdin]:15:15: unexpected end of input):
     5:     %title Конструктор сметы - Арт СИП Строй
     6:     = csrf_meta_tags
     7:     = stylesheet_link_tag    'application', media: 'all', 'data-turbolinks-track': 'reload'
     8:     = javascript_include_tag 'application', 'data-turbolinks-track': 'reload'
     9: 
    10:   %body
    11:     = render 'layouts/header'
  
app/views/layouts/application.html.haml:8:in `_app_views_layouts_application_html_haml__2534857530032057850_70312825161180'
app/controllers/application_controller.rb:8:in `render'
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/template_error.html.erb within rescues/layout
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_source.html.erb
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_source.html.erb (7.4ms)
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (3.0ms)
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_request_and_response.html.erb
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_request_and_response.html.erb (1.1ms)
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/template_error.html.erb within rescues/layout (32.4ms)
Started GET "/estimates?client_id=1" for 127.0.0.1 at 2017-04-27 05:24:04 +0300
Processing by EstimatesController#index as HTML
  Parameters: {"client_id"=>"1"}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mClient Load (0.6ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (1.0ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = 1[0m
  Rendering estimates/index.html.haml within layouts/application
  Rendered estimates/_listing.html.haml (4.4ms)
  Rendered estimates/_listing.html.haml (1.0ms)
  Rendered estimates/_listing.html.haml (1.0ms)
  [1m[36mClient Load (5.8ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  Rendered estimates/index.html.haml within layouts/application (30.3ms)
Completed 500 Internal Server Error in 299ms (ActiveRecord: 8.1ms)


  
ActionView::Template::Error (SyntaxError: [stdin]:47:35: reserved word 'function'):
     5:     %title Конструктор сметы - Арт СИП Строй
     6:     = csrf_meta_tags
     7:     = stylesheet_link_tag    'application', media: 'all', 'data-turbolinks-track': 'reload'
     8:     = javascript_include_tag 'application', 'data-turbolinks-track': 'reload'
     9: 
    10:   %body
    11:     = render 'layouts/header'
  
app/views/layouts/application.html.haml:8:in `_app_views_layouts_application_html_haml__2534857530032057850_70312984558600'
app/controllers/application_controller.rb:8:in `render'
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/template_error.html.erb within rescues/layout
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_source.html.erb
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_source.html.erb (8.7ms)
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (3.2ms)
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_request_and_response.html.erb
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_request_and_response.html.erb (1.1ms)
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/template_error.html.erb within rescues/layout (33.8ms)
Started GET "/estimates?client_id=1" for 127.0.0.1 at 2017-04-27 05:24:43 +0300
Processing by EstimatesController#index as HTML
  Parameters: {"client_id"=>"1"}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mClient Load (0.5ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (0.7ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = 1[0m
  Rendering estimates/index.html.haml within layouts/application
  Rendered estimates/_listing.html.haml (4.9ms)
  Rendered estimates/_listing.html.haml (1.1ms)
  Rendered estimates/_listing.html.haml (1.1ms)
  [1m[36mClient Load (1.8ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  Rendered estimates/index.html.haml within layouts/application (31.3ms)
Completed 500 Internal Server Error in 287ms (ActiveRecord: 3.8ms)


  
ActionView::Template::Error (SyntaxError: [stdin]:43:5: reserved word 'var'):
     5:     %title Конструктор сметы - Арт СИП Строй
     6:     = csrf_meta_tags
     7:     = stylesheet_link_tag    'application', media: 'all', 'data-turbolinks-track': 'reload'
     8:     = javascript_include_tag 'application', 'data-turbolinks-track': 'reload'
     9: 
    10:   %body
    11:     = render 'layouts/header'
  
app/views/layouts/application.html.haml:8:in `_app_views_layouts_application_html_haml__2534857530032057850_70312821343800'
app/controllers/application_controller.rb:8:in `render'
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/template_error.html.erb within rescues/layout
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_source.html.erb
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_source.html.erb (7.9ms)
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (3.1ms)
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_request_and_response.html.erb
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_request_and_response.html.erb (1.1ms)
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/template_error.html.erb within rescues/layout (33.0ms)
Started GET "/estimates?client_id=1" for 127.0.0.1 at 2017-04-27 05:25:05 +0300
Processing by EstimatesController#index as HTML
  Parameters: {"client_id"=>"1"}
  [1m[36mUser Load (1.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mClient Load (1.0ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (1.9ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = 1[0m
  Rendering estimates/index.html.haml within layouts/application
  Rendered estimates/_listing.html.haml (3.8ms)
  Rendered estimates/_listing.html.haml (1.0ms)
  Rendered estimates/_listing.html.haml (0.9ms)
  [1m[36mClient Load (0.5ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  Rendered estimates/index.html.haml within layouts/application (25.1ms)
Completed 500 Internal Server Error in 292ms (ActiveRecord: 5.1ms)


  
ActionView::Template::Error (SyntaxError: [stdin]:55:16: reserved word 'function'):
     5:     %title Конструктор сметы - Арт СИП Строй
     6:     = csrf_meta_tags
     7:     = stylesheet_link_tag    'application', media: 'all', 'data-turbolinks-track': 'reload'
     8:     = javascript_include_tag 'application', 'data-turbolinks-track': 'reload'
     9: 
    10:   %body
    11:     = render 'layouts/header'
  
app/views/layouts/application.html.haml:8:in `_app_views_layouts_application_html_haml__2534857530032057850_70312687176360'
app/controllers/application_controller.rb:8:in `render'
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/template_error.html.erb within rescues/layout
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_source.html.erb
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_source.html.erb (9.1ms)
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (5.2ms)
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_request_and_response.html.erb
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_request_and_response.html.erb (1.1ms)
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/template_error.html.erb within rescues/layout (37.6ms)
Started GET "/estimates?client_id=1" for 127.0.0.1 at 2017-04-27 05:25:30 +0300
Processing by EstimatesController#index as HTML
  Parameters: {"client_id"=>"1"}
  [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (1.0ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = 1[0m
  Rendering estimates/index.html.haml within layouts/application
  Rendered estimates/_listing.html.haml (3.9ms)
  Rendered estimates/_listing.html.haml (1.1ms)
  Rendered estimates/_listing.html.haml (1.0ms)
  [1m[36mClient Load (0.7ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  Rendered estimates/index.html.haml within layouts/application (28.0ms)
Completed 500 Internal Server Error in 309ms (ActiveRecord: 3.7ms)


  
ActionView::Template::Error (SyntaxError: [stdin]:42:6: unexpected ():
     5:     %title Конструктор сметы - Арт СИП Строй
     6:     = csrf_meta_tags
     7:     = stylesheet_link_tag    'application', media: 'all', 'data-turbolinks-track': 'reload'
     8:     = javascript_include_tag 'application', 'data-turbolinks-track': 'reload'
     9: 
    10:   %body
    11:     = render 'layouts/header'
  
app/views/layouts/application.html.haml:8:in `_app_views_layouts_application_html_haml__2534857530032057850_47012818414960'
app/controllers/application_controller.rb:8:in `render'
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/template_error.html.erb within rescues/layout
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_source.html.erb
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_source.html.erb (7.9ms)
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (3.0ms)
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_request_and_response.html.erb
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_request_and_response.html.erb (1.1ms)
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/template_error.html.erb within rescues/layout (32.6ms)
Started GET "/estimates?client_id=1" for 127.0.0.1 at 2017-04-27 05:26:08 +0300
Processing by EstimatesController#index as HTML
  Parameters: {"client_id"=>"1"}
  [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mClient Load (0.5ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (0.7ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = 1[0m
  Rendering estimates/index.html.haml within layouts/application
  Rendered estimates/_listing.html.haml (3.8ms)
  Rendered estimates/_listing.html.haml (1.0ms)
  Rendered estimates/_listing.html.haml (1.1ms)
  [1m[36mClient Load (0.5ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  Rendered estimates/index.html.haml within layouts/application (28.9ms)
Completed 500 Internal Server Error in 361ms (ActiveRecord: 2.9ms)


  
ActionView::Template::Error (SyntaxError: [stdin]:56:10: unexpected ():
     5:     %title Конструктор сметы - Арт СИП Строй
     6:     = csrf_meta_tags
     7:     = stylesheet_link_tag    'application', media: 'all', 'data-turbolinks-track': 'reload'
     8:     = javascript_include_tag 'application', 'data-turbolinks-track': 'reload'
     9: 
    10:   %body
    11:     = render 'layouts/header'
  
app/views/layouts/application.html.haml:8:in `_app_views_layouts_application_html_haml__2534857530032057850_70312690617400'
app/controllers/application_controller.rb:8:in `render'
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/template_error.html.erb within rescues/layout
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_source.html.erb
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_source.html.erb (7.8ms)
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (3.1ms)
  Rendering /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_request_and_response.html.erb
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/_request_and_response.html.erb (1.3ms)
  Rendered /home/g1nc/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.2/lib/action_dispatch/middleware/templates/rescues/template_error.html.erb within rescues/layout (33.8ms)
Started GET "/estimates?client_id=1" for 127.0.0.1 at 2017-04-27 05:27:17 +0300
Processing by EstimatesController#index as HTML
  Parameters: {"client_id"=>"1"}
  [1m[36mUser Load (1.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mClient Load (1.3ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (1.1ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = 1[0m
  Rendering estimates/index.html.haml within layouts/application
  Rendered estimates/_listing.html.haml (6.0ms)
  Rendered estimates/_listing.html.haml (1.6ms)
  Rendered estimates/_listing.html.haml (1.1ms)
  [1m[36mClient Load (0.8ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  Rendered estimates/index.html.haml within layouts/application (34.9ms)
  Rendered layouts/_header.html.haml (14.4ms)
Completed 200 OK in 392ms (Views: 371.0ms | ActiveRecord: 4.5ms)


Started GET "/estimates?client_id=1" for 127.0.0.1 at 2017-04-27 05:27:36 +0300
Processing by EstimatesController#index as HTML
  Parameters: {"client_id"=>"1"}
  [1m[36mUser Load (1.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mClient Load (1.9ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (1.0ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = 1[0m
  Rendering estimates/index.html.haml within layouts/application
  Rendered estimates/_listing.html.haml (3.5ms)
  Rendered estimates/_listing.html.haml (0.9ms)
  Rendered estimates/_listing.html.haml (0.9ms)
  [1m[36mClient Load (0.6ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  Rendered estimates/index.html.haml within layouts/application (24.4ms)
  Rendered layouts/_header.html.haml (16.7ms)
Completed 200 OK in 363ms (Views: 346.5ms | ActiveRecord: 5.3ms)


Started GET "/estimates?client_id=1" for 127.0.0.1 at 2017-04-27 05:28:11 +0300
Processing by EstimatesController#index as HTML
  Parameters: {"client_id"=>"1"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mClient Load (2.9ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (0.7ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = 1[0m
  Rendering estimates/index.html.haml within layouts/application
  Rendered estimates/_listing.html.haml (5.5ms)
  Rendered estimates/_listing.html.haml (0.9ms)
  Rendered estimates/_listing.html.haml (1.0ms)
  [1m[36mClient Load (0.6ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  Rendered estimates/index.html.haml within layouts/application (26.6ms)
  Rendered layouts/_header.html.haml (9.0ms)
Completed 200 OK in 1202ms (Views: 1186.1ms | ActiveRecord: 4.9ms)


Started GET "/estimates?client_id=1" for 127.0.0.1 at 2017-04-27 05:28:34 +0300
Processing by EstimatesController#index as HTML
  Parameters: {"client_id"=>"1"}
  [1m[36mUser Load (1.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mClient Load (1.1ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (2.0ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = 1[0m
  Rendering estimates/index.html.haml within layouts/application
  Rendered estimates/_listing.html.haml (4.0ms)
  Rendered estimates/_listing.html.haml (1.1ms)
  Rendered estimates/_listing.html.haml (1.3ms)
  [1m[36mClient Load (0.8ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  Rendered estimates/index.html.haml within layouts/application (24.3ms)
  Rendered layouts/_header.html.haml (8.9ms)
Completed 200 OK in 1136ms (Views: 1123.0ms | ActiveRecord: 5.8ms)


Started GET "/estimates?client_id=1" for 127.0.0.1 at 2017-04-27 05:29:16 +0300
Processing by EstimatesController#index as HTML
  Parameters: {"client_id"=>"1"}
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mClient Load (1.2ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (1.4ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = 1[0m
  Rendering estimates/index.html.haml within layouts/application
  Rendered estimates/_listing.html.haml (4.9ms)
  Rendered estimates/_listing.html.haml (2.4ms)
  Rendered estimates/_listing.html.haml (1.0ms)
  [1m[36mClient Load (2.2ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  Rendered estimates/index.html.haml within layouts/application (35.3ms)
  Rendered layouts/_header.html.haml (19.5ms)
Completed 200 OK in 1501ms (Views: 1487.9ms | ActiveRecord: 5.8ms)


Started GET "/estimates?client_id=1" for 127.0.0.1 at 2017-04-27 05:29:29 +0300
Processing by EstimatesController#index as HTML
  Parameters: {"client_id"=>"1"}
  [1m[36mUser Load (3.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mClient Load (2.0ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (3.2ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = 1[0m
  Rendering estimates/index.html.haml within layouts/application
  Rendered estimates/_listing.html.haml (3.6ms)
  Rendered estimates/_listing.html.haml (1.0ms)
  Rendered estimates/_listing.html.haml (1.2ms)
  [1m[36mClient Load (0.6ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  Rendered estimates/index.html.haml within layouts/application (30.4ms)
  Rendered layouts/_header.html.haml (9.3ms)
Completed 200 OK in 1583ms (Views: 1560.8ms | ActiveRecord: 9.5ms)


Started GET "/estimates?client_id=1" for 127.0.0.1 at 2017-04-27 05:30:50 +0300
Processing by EstimatesController#index as HTML
  Parameters: {"client_id"=>"1"}
  [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mClient Load (5.0ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (1.1ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = 1[0m
  Rendering estimates/index.html.haml within layouts/application
  Rendered estimates/_listing.html.haml (9.3ms)
  Rendered estimates/_listing.html.haml (0.9ms)
  Rendered estimates/_listing.html.haml (0.9ms)
  [1m[36mClient Load (1.0ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  Rendered estimates/index.html.haml within layouts/application (39.7ms)
  Rendered layouts/_header.html.haml (10.9ms)
Completed 200 OK in 1353ms (Views: 1329.8ms | ActiveRecord: 8.3ms)


Started GET "/clients" for 127.0.0.1 at 2017-04-27 05:31:33 +0300
Processing by ClientsController#index as HTML
  [1m[36mUser Load (1.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering clients/index.html.haml within layouts/application
  [1m[36mUserClient Load (6.6ms)[0m  [1m[34mSELECT "user_clients".* FROM "user_clients" INNER JOIN "clients" ON "clients"."id" = "user_clients"."client_id" AND "clients"."deleted_at" IS NULL WHERE "clients"."archived" = $1 AND (user_id = 1 and owner = true)[0m  [["archived", false]]
  [1m[36mClient Load (1.6ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" IN (1, 2, 3)[0m
  [1m[36mEstimate Load (2.8ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" IN (1, 2, 3)[0m
  [1m[35m (1.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 1]]
  Rendered clients/_listing.html.haml (20.2ms)
  [1m[35m (6.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 2]]
  Rendered clients/_listing.html.haml (10.0ms)
  [1m[35m (1.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 3]]
  Rendered clients/_listing.html.haml (5.0ms)
  Rendered clients/_table.html.haml (40.2ms)
  [1m[36mUserClient Load (0.7ms)[0m  [1m[34mSELECT "user_clients".* FROM "user_clients" INNER JOIN "clients" ON "clients"."id" = "user_clients"."client_id" AND "clients"."deleted_at" IS NULL WHERE "clients"."archived" = $1 AND (user_id = 1 and owner = false)[0m  [["archived", false]]
  Rendered clients/index.html.haml within layouts/application (81.3ms)
  Rendered layouts/_header.html.haml (11.8ms)
Completed 200 OK in 766ms (Views: 723.3ms | ActiveRecord: 31.2ms)


Started GET "/clients" for 127.0.0.1 at 2017-04-27 05:31:51 +0300
Processing by ClientsController#index as HTML
  [1m[36mUser Load (1.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering clients/index.html.haml within layouts/application
  [1m[36mUserClient Load (2.5ms)[0m  [1m[34mSELECT "user_clients".* FROM "user_clients" INNER JOIN "clients" ON "clients"."id" = "user_clients"."client_id" AND "clients"."deleted_at" IS NULL WHERE "clients"."archived" = $1 AND (user_id = 1 and owner = true)[0m  [["archived", false]]
  [1m[36mClient Load (3.9ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" IN (1, 2, 3)[0m
  [1m[36mEstimate Load (0.7ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" IN (1, 2, 3)[0m
  [1m[35m (1.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 1]]
  Rendered clients/_listing.html.haml (7.0ms)
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 2]]
  Rendered clients/_listing.html.haml (3.6ms)
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 3]]
  Rendered clients/_listing.html.haml (4.1ms)
  Rendered clients/_table.html.haml (19.4ms)
  [1m[36mUserClient Load (4.5ms)[0m  [1m[34mSELECT "user_clients".* FROM "user_clients" INNER JOIN "clients" ON "clients"."id" = "user_clients"."client_id" AND "clients"."deleted_at" IS NULL WHERE "clients"."archived" = $1 AND (user_id = 1 and owner = false)[0m  [["archived", false]]
  Rendered clients/index.html.haml within layouts/application (47.6ms)
  Rendered layouts/_header.html.haml (7.8ms)
Completed 200 OK in 521ms (Views: 498.2ms | ActiveRecord: 15.4ms)


Started GET "/clients" for 127.0.0.1 at 2017-04-27 05:31:52 +0300
Processing by ClientsController#index as HTML
  [1m[36mUser Load (2.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering clients/index.html.haml within layouts/application
  [1m[36mUserClient Load (2.9ms)[0m  [1m[34mSELECT "user_clients".* FROM "user_clients" INNER JOIN "clients" ON "clients"."id" = "user_clients"."client_id" AND "clients"."deleted_at" IS NULL WHERE "clients"."archived" = $1 AND (user_id = 1 and owner = true)[0m  [["archived", false]]
  [1m[36mClient Load (1.6ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" IN (1, 2, 3)[0m
  [1m[36mEstimate Load (2.3ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" IN (1, 2, 3)[0m
  [1m[35m (23.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 1]]
  Rendered clients/_listing.html.haml (29.6ms)
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 2]]
  Rendered clients/_listing.html.haml (4.3ms)
  [1m[35m (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 3]]
  Rendered clients/_listing.html.haml (4.3ms)
  Rendered clients/_table.html.haml (45.4ms)
  [1m[36mUserClient Load (0.8ms)[0m  [1m[34mSELECT "user_clients".* FROM "user_clients" INNER JOIN "clients" ON "clients"."id" = "user_clients"."client_id" AND "clients"."deleted_at" IS NULL WHERE "clients"."archived" = $1 AND (user_id = 1 and owner = false)[0m  [["archived", false]]
  Rendered clients/index.html.haml within layouts/application (65.0ms)
  Rendered layouts/_header.html.haml (14.5ms)
Completed 200 OK in 605ms (Views: 563.0ms | ActiveRecord: 34.6ms)


Started GET "/estimates?client_id=1" for 127.0.0.1 at 2017-04-27 05:32:01 +0300
Processing by EstimatesController#index as HTML
  Parameters: {"client_id"=>"1"}
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mClient Load (1.4ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (1.6ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = 1[0m
  Rendering estimates/index.html.haml within layouts/application
  Rendered estimates/_listing.html.haml (4.5ms)
  Rendered estimates/_listing.html.haml (1.3ms)
  Rendered estimates/_listing.html.haml (45.7ms)
  [1m[36mClient Load (0.8ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  Rendered estimates/index.html.haml within layouts/application (74.5ms)
  Rendered layouts/_header.html.haml (8.0ms)
Completed 200 OK in 595ms (Views: 577.5ms | ActiveRecord: 4.8ms)


Started GET "/clients" for 127.0.0.1 at 2017-04-27 05:32:06 +0300
Processing by ClientsController#index as HTML
  [1m[36mUser Load (2.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering clients/index.html.haml within layouts/application
  [1m[36mUserClient Load (0.9ms)[0m  [1m[34mSELECT "user_clients".* FROM "user_clients" INNER JOIN "clients" ON "clients"."id" = "user_clients"."client_id" AND "clients"."deleted_at" IS NULL WHERE "clients"."archived" = $1 AND (user_id = 1 and owner = true)[0m  [["archived", false]]
  [1m[36mClient Load (0.6ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" IN (1, 2, 3)[0m
  [1m[36mEstimate Load (1.7ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" IN (1, 2, 3)[0m
  [1m[35m (1.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 1]]
  Rendered clients/_listing.html.haml (9.0ms)
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 2]]
  Rendered clients/_listing.html.haml (3.6ms)
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 3]]
  Rendered clients/_listing.html.haml (4.8ms)
  Rendered clients/_table.html.haml (21.8ms)
  [1m[36mUserClient Load (2.4ms)[0m  [1m[34mSELECT "user_clients".* FROM "user_clients" INNER JOIN "clients" ON "clients"."id" = "user_clients"."client_id" AND "clients"."deleted_at" IS NULL WHERE "clients"."archived" = $1 AND (user_id = 1 and owner = false)[0m  [["archived", false]]
  Rendered clients/index.html.haml within layouts/application (47.3ms)
  Rendered layouts/_header.html.haml (10.5ms)
Completed 200 OK in 611ms (Views: 596.1ms | ActiveRecord: 10.5ms)


Started GET "/clients" for 127.0.0.1 at 2017-04-27 05:32:08 +0300
Processing by ClientsController#index as HTML
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering clients/index.html.haml within layouts/application
  [1m[36mUserClient Load (0.9ms)[0m  [1m[34mSELECT "user_clients".* FROM "user_clients" INNER JOIN "clients" ON "clients"."id" = "user_clients"."client_id" AND "clients"."deleted_at" IS NULL WHERE "clients"."archived" = $1 AND (user_id = 1 and owner = true)[0m  [["archived", false]]
  [1m[36mClient Load (3.4ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" IN (1, 2, 3)[0m
  [1m[36mEstimate Load (1.2ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" IN (1, 2, 3)[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 1]]
  Rendered clients/_listing.html.haml (10.8ms)
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 2]]
  Rendered clients/_listing.html.haml (3.6ms)
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 3]]
  Rendered clients/_listing.html.haml (3.8ms)
  Rendered clients/_table.html.haml (29.3ms)
  [1m[36mUserClient Load (0.8ms)[0m  [1m[34mSELECT "user_clients".* FROM "user_clients" INNER JOIN "clients" ON "clients"."id" = "user_clients"."client_id" AND "clients"."deleted_at" IS NULL WHERE "clients"."archived" = $1 AND (user_id = 1 and owner = false)[0m  [["archived", false]]
  Rendered clients/index.html.haml within layouts/application (52.0ms)
  Rendered layouts/_header.html.haml (9.4ms)
Completed 200 OK in 639ms (Views: 623.9ms | ActiveRecord: 9.1ms)


Started GET "/clients" for 127.0.0.1 at 2017-04-27 05:32:38 +0300
Processing by ClientsController#index as HTML
  [1m[36mUser Load (2.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  Rendering clients/index.html.haml within layouts/application
  [1m[36mUserClient Load (1.0ms)[0m  [1m[34mSELECT "user_clients".* FROM "user_clients" INNER JOIN "clients" ON "clients"."id" = "user_clients"."client_id" AND "clients"."deleted_at" IS NULL WHERE "clients"."archived" = $1 AND (user_id = 1 and owner = true)[0m  [["archived", false]]
  [1m[36mClient Load (0.8ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" IN (1, 2, 3)[0m
  [1m[36mEstimate Load (0.9ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" IN (1, 2, 3)[0m
  [1m[35m (1.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 1]]
  Rendered clients/_listing.html.haml (9.7ms)
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 2]]
  Rendered clients/_listing.html.haml (5.3ms)
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1[0m  [["client_id", 3]]
  Rendered clients/_listing.html.haml (3.6ms)
  Rendered clients/_table.html.haml (23.4ms)
  [1m[36mUserClient Load (3.8ms)[0m  [1m[34mSELECT "user_clients".* FROM "user_clients" INNER JOIN "clients" ON "clients"."id" = "user_clients"."client_id" AND "clients"."deleted_at" IS NULL WHERE "clients"."archived" = $1 AND (user_id = 1 and owner = false)[0m  [["archived", false]]
  Rendered clients/index.html.haml within layouts/application (52.2ms)
  Rendered layouts/_header.html.haml (10.4ms)
Completed 200 OK in 662ms (Views: 642.8ms | ActiveRecord: 11.5ms)


Started GET "/estimates?client_id=1" for 127.0.0.1 at 2017-04-27 05:32:45 +0300
Processing by EstimatesController#index as HTML
  Parameters: {"client_id"=>"1"}
  [1m[36mUser Load (1.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mClient Load (0.6ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (0.8ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = 1[0m
  Rendering estimates/index.html.haml within layouts/application
  Rendered estimates/_listing.html.haml (3.7ms)
  Rendered estimates/_listing.html.haml (1.0ms)
  Rendered estimates/_listing.html.haml (0.9ms)
  [1m[36mClient Load (0.5ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  [1m[36mCACHE (0.0ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  Rendered estimates/index.html.haml within layouts/application (21.6ms)
  Rendered layouts/_header.html.haml (8.8ms)
Completed 200 OK in 614ms (Views: 601.0ms | ActiveRecord: 3.5ms)


Started GET "/estimates?utf8=%E2%9C%93&client_id=1&name=2" for 127.0.0.1 at 2017-04-27 05:33:00 +0300
Processing by EstimatesController#index as HTML
  Parameters: {"utf8"=>"✓", "client_id"=>"1", "name"=>"2"}
  [1m[36mUser Load (3.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 ORDER BY "users"."id" ASC LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mClient Load (2.0ms)[0m  [1m[34mSELECT  "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mEstimate Load (1.0ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = 1[0m
  Rendering estimates/index.html.haml within layouts/application
  [1m[36mEstimate Load (3.8ms)[0m  [1m[34mSELECT "estimates".* FROM "estimates" WHERE "estimates"."deleted_at" IS NULL AND "estimates"."client_id" = $1 AND (lower(name) like '%2%')[0m  [["client_id", 1]]
  Rendered estimates/_listing.html.haml (3.9ms)
  [1m[36mClient Load (0.5ms)[0m  [1m[34mSELECT "clients".* FROM "clients" WHERE "clients"."deleted_at" IS NULL AND "clients"."archived" = $1[0m  [["archived", false]]
  Rendered estimates/index.html.haml within layouts/application (26.2ms)
  Rendered layouts/_header.html.haml (9.2ms)
Completed 200 OK in 611ms (Views: 590.6ms | ActiveRecord: 10.4ms)


